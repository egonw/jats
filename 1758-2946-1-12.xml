<?xml version="1.0"?>
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="research-article" xml:lang="en">
      <?properties open_access?>
      <front>
        <journal-meta>
          <journal-id journal-id-type="publisher-id">13321</journal-id>
          <journal-title-group>
            <journal-title>Journal of Cheminformatics</journal-title>
            <abbrev-journal-title abbrev-type="publisher">J Cheminform</abbrev-journal-title>
          </journal-title-group>
          <issn pub-type="epub">1758-2946</issn>
          <publisher>
            <publisher-name>Springer International Publishing</publisher-name>
            <publisher-loc>Cham</publisher-loc>
          </publisher>
        </journal-meta>
        <article-meta>
          <article-id pub-id-type="publisher-id">BMC1758-2946-1-12</article-id>
          <article-id pub-id-type="manuscript">12</article-id>
          <article-id pub-id-type="doi">10.1186/1758-2946-1-12</article-id>
          <article-categories>
            <subj-group subj-group-type="heading">
              <subject>Software</subject>
            </subj-group>
          </article-categories>
          <title-group>
            <article-title xml:lang="en">Small Molecule Subgraph Detector (SMSD) toolkit</article-title>
          </title-group>
          <contrib-group>
            <contrib contrib-type="author" corresp="yes">
              <name>
                <surname>Rahman</surname>
                <given-names>Syed Asad</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="corresp" rid="IDBMC17582946112_cor1">a</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Bashton</surname>
                <given-names>Matthew</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Holliday</surname>
                <given-names>Gemma L</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Schrader</surname>
                <given-names>Rainer</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff2">2</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Thornton</surname>
                <given-names>Janet M</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <aff id="Aff1">
              <label>1</label>
              <institution-wrap>
                <institution-id institution-id-type="GRID">grid.10306.34</institution-id>
                <institution-id institution-id-type="ISNI">0000000406065382</institution-id>
                <institution content-type="org-division">EMBL-European Bioinformatics Institute</institution>
                <institution content-type="org-name">Wellcome Trust Genome Campus</institution>
              </institution-wrap>
              <addr-line content-type="postcode">CB10 1SD</addr-line>
              <addr-line content-type="city">Hinxton</addr-line>
              <addr-line content-type="state">Cambridge</addr-line>
              <country>UK</country>
            </aff>
            <aff id="Aff2">
              <label>2</label>
              <institution-wrap>
                <institution-id institution-id-type="GRID">grid.6190.e</institution-id>
                <institution-id institution-id-type="ISNI">0000000085803777</institution-id>
                <institution content-type="org-division">Zentrum für Angewandte Informatik (ZAIK)</institution>
                <institution content-type="org-name">Universität zu Köln</institution>
              </institution-wrap>
              <addr-line content-type="street">Weyertal 80</addr-line>
              <addr-line content-type="postcode">D-50931</addr-line>
              <addr-line content-type="city">Köln</addr-line>
              <country>Germany</country>
            </aff>
          </contrib-group>
          <author-notes>
            <corresp id="IDBMC17582946112_cor1">
              <label>a</label>
              <email>HIDDEN</email>
            </corresp>
          </author-notes>
          <pub-date date-type="pub" publication-format="electronic">
            <day>10</day>
            <month>8</month>
            <year>2009</year>
          </pub-date>
          <pub-date date-type="collection" publication-format="electronic">
            <month>12</month>
            <year>2009</year>
          </pub-date>
          <volume>1</volume>
          <issue seq="12">1</issue>
          <elocation-id>12</elocation-id>
          <history>
            <date date-type="registration">
              <day>11</day>
              <month>5</month>
              <year>2009</year>
            </date>
            <date date-type="received">
              <day>11</day>
              <month>5</month>
              <year>2009</year>
            </date>
            <date date-type="accepted">
              <day>10</day>
              <month>8</month>
              <year>2009</year>
            </date>
            <date date-type="online">
              <day>10</day>
              <month>8</month>
              <year>2009</year>
            </date>
          </history>
          <permissions>
            <copyright-statement content-type="compact">© Rahman et al; licensee BioMed Central Ltd. 2009</copyright-statement>
            <copyright-statement content-type="comment">This article is published under license to BioMed Central Ltd. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link xlink:href="http://creativecommons.org/licenses/by/2.0" ext-link-type="uri">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</copyright-statement>
            <copyright-year>2009</copyright-year>
            <copyright-holder>Rahman et al; licensee BioMed Central Ltd.</copyright-holder>
            <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0/">
              <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 2.0 International License (<ext-link xlink:href="https://creativecommons.org/licenses/by/2.0" ext-link-type="uri">https://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
            </license>
          </permissions>
          <abstract xml:lang="en" id="Abs1">
            <title>Abstract</title>
            <sec id="ASec1">
              <title>Background</title>
              <p>Finding one small molecule (query) in a large target library is a challenging task in computational chemistry. Although several heuristic approaches are available using fragment-based chemical similarity searches, they fail to identify exact atom-bond equivalence between the query and target molecules and thus cannot be applied to complex chemical similarity searches, such as searching a complete or partial metabolic pathway.</p>
              <p>In this paper we present a new Maximum Common Subgraph (MCS) tool: SMSD (<bold>S</bold>mall <bold>M</bold>olecule <bold>S</bold>ubgraph <bold>D</bold>etector) to overcome the issues with current heuristic approaches to small molecule similarity searches. The MCS search implemented in SMSD incorporates chemical knowledge (atom type match with bond sensitive and insensitive information) while searching molecular similarity. We also propose a novel method by which solutions obtained by each MCS run can be ranked using chemical filters such as stereochemistry, bond energy, etc.</p>
            </sec>
            <sec id="ASec2">
              <title>Results</title>
              <p>In order to benchmark and test the tool, we performed a 50,000 pair-wise comparison between KEGG ligands and PDB HET Group atoms. In both cases the SMSD was shown to be more efficient than the widely used MCS module implemented in the Chemistry Development Kit (CDK) in generating MCS solutions from our test cases.</p>
            </sec>
            <sec id="ASec3">
              <title>Conclusion</title>
              <p>Presently this tool can be applied to various areas of bioinformatics and chemo-informatics for finding exhaustive MCS matches. For example, it can be used to analyse metabolic networks by mapping the atoms between reactants and products involved in reactions. It can also be used to detect the MCS/substructure searches in small molecules reported by metabolome experiments, as well as in the screening of drug-like compounds with similar substructures.</p>
              <p>Thus, we present a robust tool that can be used for multiple applications, including the discovery of new drug molecules. This tool is freely available on <ext-link xlink:href="http://www.ebi.ac.uk/thornton-srv/software/SMSD/" ext-link-type="uri">http://www.ebi.ac.uk/thornton-srv/software/SMSD/</ext-link></p>
            </sec>
          </abstract>
          <kwd-group xml:lang="en">
            <title>Keywords</title>
            <kwd>Maximum Clique</kwd>
            <kwd>Molecular Graph</kwd>
            <kwd>Node Count</kwd>
            <kwd>Modular Product</kwd>
            <kwd>Maximum Common Subgraph</kwd>
          </kwd-group>
          <custom-meta-group>
            <custom-meta>
              <meta-name>publisher-imprint-name</meta-name>
              <meta-value>Chemistry Central</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-issue-count</meta-name>
              <meta-value>1</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-article-count</meta-name>
              <meta-value>22</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-holder</meta-name>
              <meta-value>The Author(s)</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-year</meta-name>
              <meta-value>2009</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-contains-esm</meta-name>
              <meta-value>Yes</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-year</meta-name>
              <meta-value>2009</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-month</meta-name>
              <meta-value>5</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-day</meta-name>
              <meta-value>11</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-product</meta-name>
              <meta-value>ArchiveJournal</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-grants-type</meta-name>
              <meta-value>OpenChoice</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>metadata-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>abstract-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodypdf-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodyhtml-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bibliography-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>esm-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>online-first</meta-name>
              <meta-value>false</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-file-reference</meta-name>
              <meta-value>BodyRef/PDF/13321_2009_Article_12.pdf</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-type</meta-name>
              <meta-value>Typeset</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>target-type</meta-name>
              <meta-value>OnlinePDF</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-type</meta-name>
              <meta-value>OriginalPaper</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-primary</meta-name>
              <meta-value>Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computer Applications in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Documentation and Information in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Theoretical and Computational Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computational Biology/Bioinformatics</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-collection</meta-name>
              <meta-value>Chemistry and Materials Science</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>open-access</meta-name>
              <meta-value>true</meta-value>
            </custom-meta>
          </custom-meta-group>
        </article-meta>
        <notes notes-type="ESMHint">
          <title>Electronic supplementary material</title>
          <p>The online version of this article (doi:<ext-link xlink:href="10.1186/1758-2946-1-12" ext-link-type="doi">10.1186/1758-2946-1-12</ext-link>) contains supplementary material, which is available to authorized users.</p>
        </notes>
      </front>
      <body>
        <sec id="Sec1">
          <title>Background</title>
          <p>The chemical similarity between two molecules, either at the sub- or superstructure level [<xref ref-type="bibr" rid="CR1">1</xref>], and clustering of similar molecules [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>] are widely used to measure the diversity of the chemical space [<xref ref-type="bibr" rid="CR4">4</xref>]. These methods are of vital importance, as they can be applied towards discovering new drug-like molecules [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR8">8</xref>]. The similarity between the sub- &amp; superstructures can be measured by mathematical coefficients such as the Tanimoto similarity or Euclidean distance [<xref ref-type="bibr" rid="CR9">9</xref>]. One of the most frequently used similarity search approaches is based on "structural descriptors" [<xref ref-type="bibr" rid="CR1">1</xref>] and to date these have proved to be the most effective methods for measuring chemical similarity. Newer methods such as the Maximum Common Subgraph (MCS) have more recently come to the fore as they overcome nearly all of the challenges posed by fragment or descriptor based similarity searches [<xref ref-type="bibr" rid="CR10">10</xref>]. The MCS methods benefit from much improved sensitivity as they can find atom-atom or atom-bond equivalence between query and target molecules [<xref ref-type="bibr" rid="CR11">11</xref>]. It then becomes possible to follow a query substructure or moieties along metabolic pathways or reaction schemes.</p>
          <p>One of the main issues with using the MCS is that it is NP-complete, i.e. no method can guarantee a perfect solution in polynomial time [<xref ref-type="bibr" rid="CR12">12</xref>]. Many MCS algorithms have been proposed to overcome the complexity involved in finding chemically relevant substructures sharing the same pattern. The most widely used algorithm for the MCS problem of molecular graphs is the one designed by Bron and Kerbosch [<xref ref-type="bibr" rid="CR13">13</xref>], which enumerates all cliques of the compatibility graph [<xref ref-type="bibr" rid="CR14">14</xref>]. It applies a branch and bound technique to prune the search tree, which makes it very efficient. Some of these algorithms use heuristic approaches for arriving at non-optimal solutions [<xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR18">18</xref>] while others give optimal solutions [<xref ref-type="bibr" rid="CR19">19</xref>]. Most of these algorithms find the MCS by converting a molecular association graph into a clique detection problem. An alternative MCS method has been proposed, without constructing an association graph, based on the backtracking algorithm [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. Cao et al. [<xref ref-type="bibr" rid="CR22">22</xref>] proposed an MCS algorithm based on the backtracking VF algorithm [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>], with some heuristics for searching and predicting drug-like compounds. While a few of these algorithms [<xref ref-type="bibr" rid="CR25">25</xref>]; Akutsu 2004 [<xref ref-type="bibr" rid="CR16">16</xref>] are based on dynamic programming, others ([<xref ref-type="bibr" rid="CR26">26</xref>] use heuristic algorithms to find subgraph isomorphism. Some of the above mentioned MCS algorithms utilize the labels of the vertices (atoms), the induced edges (bonds), and other important structural feature constraints. Interestingly almost all of them lack chemical knowledge to rank the MCS solutions based on information such as bond energies.</p>
          <p>In this paper we present a chemically sensitive and robust tool, which uses a combination of various graph-matching algorithms for finding the MCS between small molecules.</p>
          <p>This new tool can generate bond sensitive and bond insensitive MCS and it ranks the solution(s) according to minimal fragments, bond breaking energy and stereochemical matches. It can work with explicit hydrogen(s) though it performs faster when the hydrogen(s) are implicit (<italic>i.e</italic>. hydrogen(s) are only considered to be present where explicitly defined by the input molecule's structure). The tool's performance is benchmarked on a small virtual screening test case between KEGG [<xref ref-type="bibr" rid="CR27">27</xref>] and PDB [<xref ref-type="bibr" rid="CR28">28</xref>] molecules (50,000 pair-wise comparisons). It is difficult to compare the MCS algorithms implemented in various chemical tools, since most of them are commercial. Hence we have chosen the widely used MCS module implemented in an open source chemo-informatics library: the MCS algorithm in the Chemistry Development Kit (CDK) [<xref ref-type="bibr" rid="CR29">29</xref>]. The new tool uses the CDK where efficient, but also provides solutions in cases where the MCS routine in the CDK fails to provide a solution.</p>
          <p>The design principles of graph matching algorithms are all closely related to the kind of problem they address. Since the specificity and sensitivity of the chemical similarity/distance searches are a function of time and space, heuristic techniques [<xref ref-type="bibr" rid="CR17">17</xref>] have evolved to map two molecules.</p>
          <sec id="Sec2">
            <title>Chemical Graph Theory and MCS</title>
            <p>Graph theory studies pair-wise relationships between objects. A molecular graph <italic>G</italic> = (<italic>V</italic>, <italic>E</italic>, <italic>l</italic>) consists of a set of vertices <italic>V</italic>(<italic>G</italic>) (i.e. atoms in a molecule), a set of edges <italic>E</italic>(<italic>G</italic>) (i.e. the bonds in a molecule) and <italic>l</italic> is a function that maps the union of <italic>V</italic> and <italic>E</italic> to natural numbers (maps atoms and bonds to their types). Molecular graphs are assumed to be simple, undirected graphs. A molecular graph <italic>G</italic><sub><italic>m</italic></sub>consists of a set of vertices <italic>V</italic>(<italic>G</italic><sub><italic>m</italic></sub>) and a set of edges <italic>E</italic>(<italic>G</italic><sub><italic>m</italic></sub>). The vertices in <italic>G</italic> are connected by an edge if there exists an edge (<italic>v</italic><sub><italic>i</italic></sub>, <italic>v</italic><sub><italic>j</italic></sub>) ∈ <italic>E</italic>(<italic>G</italic>) connecting the vertices <italic>v</italic><sub><italic>i</italic></sub>and <italic>v</italic><sub><italic>j</italic></sub>in <italic>G</italic> such that <italic>v</italic><sub><italic>i</italic></sub>, <italic>v</italic><sub><italic>j</italic></sub>∈ <italic>V</italic>(<italic>G</italic>).</p>
            <p>Two graphs <italic>G</italic><sub><italic>q</italic></sub>(query) and <italic>G</italic><sub><italic>t</italic></sub>(target) are said to be <italic>isomorphic</italic> if there is a one-to-one correspondence (mapping) <italic>f</italic> : <italic>V</italic>(<italic>G</italic><sub><italic>q</italic></sub>) → <italic>V</italic>(<italic>G</italic><sub><italic>t</italic></sub>) between their vertex sets which preserves the adjacency of vertices (i.e. two vertices <italic>u</italic> and <italic>v</italic> from <italic>G</italic><sub><italic>q</italic></sub>are adjacent if and only if <italic>f</italic> (<italic>u</italic>) and <italic>f</italic> (<italic>v</italic>) are adjacent in (<italic>G</italic><sub><italic>t</italic></sub>). The mapping itself is called an <italic>isomorphism</italic>. Two labeled graphs <italic>G</italic><sub><italic>q</italic></sub>and <italic>G</italic><sub><italic>t</italic></sub>are isomorphic if there is an isomorphism <italic>f</italic> between them preserving the labels i.e. <italic>l</italic>(<italic>v</italic>) = <italic>l</italic>(<italic>f</italic> (<italic>v</italic>)) for all <italic>v</italic> ∈ <italic>V</italic>(<italic>G</italic><sub><italic>q</italic></sub>and <italic>l</italic>(<italic>u</italic>, <italic>v</italic>) = <italic>l</italic>(<italic>f</italic> (<italic>u</italic>), <italic>f</italic> (<italic>v</italic>)) for all edges <italic>u</italic>, <italic>v</italic> ∈ <italic>E</italic>(<italic>G</italic><sub><italic>q</italic></sub>).</p>
            <p>A <italic>clique</italic> (ω) in a molecular <italic>G</italic><sub><italic>m</italic></sub>can be defined as a subset of vertices such that each pair of vertices is connected by an edge in the graph <italic>G</italic><sub><italic>m</italic></sub>. We call a subgraph <inline-formula id="IEq1"><inline-graphic xlink:href="MediaObjects/13321_2009_Article_12_IEq1_HTML.gif" /></inline-formula> ⊆ <italic>G</italic><sub><italic>m</italic></sub><italic>complete</italic> if <italic>u</italic>, <italic>v</italic> ∈ <italic>E</italic> for all <italic>u</italic>, <italic>v</italic> ∈ <italic>G</italic>(<italic>V'</italic>). The subgraph <inline-formula id="IEq2"><inline-graphic xlink:href="MediaObjects/13321_2009_Article_12_IEq1_HTML.gif" /></inline-formula> is maximal if it is not a subgraph of a larger subgraph. A maximum clique is the largest maximal clique induced in <italic>G</italic><sub><italic>m</italic></sub>.</p>
            <p>A maximal clique ω(<italic>G</italic><sub><italic>m</italic></sub>) in a graph <italic>G</italic><sub><italic>m</italic></sub>is a clique of a graph that is not a subgraph of a larger clique in <italic>G</italic><sub><italic>m</italic></sub>possessing these criteria (<italic>i.e</italic>. bonds, atom types and their connectivity are preserved), hence this subgraph is referred to as a <italic>Maximum Common Subgraph</italic> (MCS).</p>
            <p>The modular product of two graphs <italic>G</italic><sub><italic>q</italic></sub>(query) and <italic>G</italic><sub><italic>t</italic></sub>(target) is defined on the Cartesian product <italic>V</italic>(<italic>G</italic><sub><italic>q</italic></sub>) ⊗ <italic>V</italic>(<italic>G</italic><sub><italic>t</italic></sub>) with any two vertices <italic>u</italic><sub><italic>q</italic></sub>, <italic>v</italic><sub><italic>q</italic></sub>and <italic>u</italic><sub><italic>t</italic></sub>, <italic>v</italic><sub><italic>t</italic></sub>being adjacent in the modular graph. The modular product will be denoted by <italic>G</italic><sub><italic>q</italic></sub>⊗ <italic>G</italic><sub><italic>t</italic></sub>. In the case of molecular graphs (labelled graphs), the modular product of two graphs can be further restricted by constraints such as the vertex and edge labels satisfying certain compatibility criterion. Hence, in the case of molecular graphs, the modular product graph is often called compatibility graph (Figure <xref rid="Fig1" ref-type="fig">1</xref>).<fig id="Fig1"><label>Figure 1</label><caption xml:lang="en"><p><bold>The compatibility graph between Isobutane and Cyclopropane will generate a compatibility graph with 36 edges and 12 vertices</bold>. There are 18 c-edges (green dotted lines) and non <italic>c-edges</italic> (red lines). This will lead to 18 MCS solutions, each of size 3.</p></caption><graphic specific-use="HTML" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2009_Article_12_Fig1_HTML.jpg" /></fig></p>
          </sec>
        </sec>
        <sec id="Sec3">
          <title>Implementation</title>
          <p>We propose a new Java based tool called Small Molecule Subgraph Detector (SMSD) to find the MCS in small molecules. The SMSD is distinguished from previous algorithms in that it uses a combination of various algorithms (summarised in appendix 1) to find the MCS and filters the results in a manner that is chemically relevant (Figure <xref rid="Fig2" ref-type="fig">2</xref>). In the following section we describe the underlying algorithm and the subroutines (Figure <xref rid="Fig3" ref-type="fig">3</xref>), which take account of the chemistry in the SMSD for the MCS. The SMSD calculates the MCS between two molecules by combining the power of the VF+ Lib, the MCS+, and the CDK based MCS algorithm. These algorithms are used automatically on a case-by-case basis, which is dependent on the molecules under consideration for the MCS search.<fig id="Fig2"><label>Figure 2</label><caption xml:lang="en"><p><bold>Flowchart describing the post-filtering step in the SMSD algorithm</bold>.</p></caption><graphic specific-use="HTML" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2009_Article_12_Fig2_HTML.jpg" /></fig><fig id="Fig3"><label>Figure 3</label><caption xml:lang="en"><p><bold>Flowchart outlining the methodology of the Maximum Common Subgraph (MCS) algorithm used by SMSD</bold>.</p></caption><graphic specific-use="HTML" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2009_Article_12_Fig3_HTML.jpg" /></fig></p>
          <sec id="Sec4">
            <title>Revisiting the MCS routine in the CDK (Chemistry Development Kit)</title>
            <p>The MCS algorithm as coded in the CDK [<xref ref-type="bibr" rid="CR30">30</xref>] (CDKMCS) is based upon the common pattern recognition concept and the principle of Maximum Common Induced Subgraph (MCIS) [<xref ref-type="bibr" rid="CR19">19</xref>]. In that approach, a given molecular graph <italic>G</italic><sub><italic>m</italic></sub>is reduced to a MCIS graph <italic>G'</italic>. This algorithm is designed in such a way that it selects the common features between two graphs using bit strings. Thus, a compatibility graph between two molecules can be traversed in a much faster way. In order to traverse the edges on the graph it uses an approach similar to the Bron and Kerbosch [<xref ref-type="bibr" rid="CR13">13</xref>] algorithm.</p>
            <p>The disadvantages of the MCS algorithm in the CDK are:</p>
            <p>a) It may treat two chemically non-identical molecules as identical because it works on the MCIS principle, e.g. cyclopropane (CAS: 75-19-4) and isobutane (CAS: 75-28-5).</p>
            <p>b) The runtime is high if two graphs are large with few dissimilar edges e.g. between aquacob(III)alamin (CAS: 13422-52-1) and ferroheme (CAS: 14875-96-8).</p>
            <p>These challenges were resolved in the SMSD, by first using the atom and bond count filter to discriminate between two dissimilar structures (which the CDKMCS might consider similar) before performing the MCS search, and secondly, by using the VF+ Lib and MCS+ method developed herein.</p>
          </sec>
          <sec id="Sec5">
            <title>MCS+</title>
            <p>The MCS+ method has been designed using a combination of a compatibility graph based clique detection algorithm and a backtracking algorithm. Koch [<xref ref-type="bibr" rid="CR31">31</xref>] presented an efficient algorithm called <italic>c-cliques</italic> based on the MCES (or maximum overlapping set (MOS)) concept that identifies cliques by pruning a given graph on the basis of certain constraints (<italic>c-edges</italic> and <italic>d-edges</italic>) before using the Bron Kerbosch algorithm to find the MCS. Leber [<xref ref-type="bibr" rid="CR32">32</xref>] used this algorithm to find MCS between reactants and products in a reaction. The drawback to this algorithm is that it is not guaranteed to give the optimal solution (maximum clique), <italic>i.e</italic>. the <italic>c-cliques</italic> reported by this method might not contain the complete maximum match. Hence Leber [<xref ref-type="bibr" rid="CR32">32</xref>] used McGregor's backtracking algorithm to further extend the clique when possible. Thus, the resulting clique will contain the complete maximum match. The performance of the MCS+ algorithm is robust (in terms of time) especially in cases where two graphs are not identical as the unconnected/dissimilar parts are restricted in the pre-processing module (<italic>c-edges</italic> &amp;<italic>d-edges</italic>).</p>
            <p>In the Koch approach, an edge in the compatibility graph is designated a c-edge if two adjacent vertices in the graphs <italic>G</italic><sub><italic>q</italic></sub>and <italic>G</italic><sub><italic>t</italic></sub>are connected and they share similar properties. In our tool, these properties can be described as a similar bond type. However, if an adjacent edge in the graph is not connected then it is termed as a <italic>d-edge</italic>. As the <italic>d-edges</italic> represent edges that are not connected to the atoms (vertices) being compared, they are removed from the search space (for the bond-insensitive algorithm). Here we consider as <italic>d-edges</italic> only those edges that do not share similar bond types (for the bond-sensitive algorithm). Thus, by performing this initial pre-processing we limit the search space of the MCS. For example in the case of cyclopropane and isobutane the compatibility graph (Figure <xref rid="Fig1" ref-type="fig">1</xref>) will generate 12 vertices and 36 edges (18 of which are c-edges). With an increase in the number of bonds and atoms, the search space also increases due to the combination of edges and vertices. For example the compatibility graph between aqua(III)alamin (CAS:13422-52-1) and ferroheme B (CAS:14875-96-8) will generate 2,220 vertices with 2,706 c-edges and 1,526 d-edges, thus reducing the MCS search space. From the <italic>c-edges</italic>, we can obtain c-cliques using a modified Bron Kerbosch algorithm.</p>
            <p>We have replaced the Koch [<xref ref-type="bibr" rid="CR31">31</xref>] algorithm with an improved <italic>c-cliques</italic> algorithm for reporting unique cliques (i.e. removing cliques from the search space that had already been reported) proposed by Cazals and Karande [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR34">34</xref>]. We extended the algorithm to make it sensitive to bond type searches. A third improvement was introduced, which allowed only 10% of the reported d-edges (e.g. if the number of the <italic>d-edges</italic> are more than 20000 then only 2000 <italic>d-edges</italic> are selected) to find maximum c-cliques. This heuristic increases the speed of the algorithm by compromising on the size of the reported c-cliques, which are further extended by McGregor algorithm.</p>
          </sec>
          <sec id="Sec6">
            <title>Interplay Between CDKMCS and MCS+</title>
            <p>The proposed algorithm in the SMSD checks if two molecules are identical or dissimilar based on the atom count and bond count before performing the MCS search. If the two molecules have identical atom count and bond count or their bond count and atom count are both dissimilar, then the native MCS module of the CDK (CDKMCS) is used. Else, the MCS+ algorithm is used. Hence the CDKMCS approach is used in cases where two molecules are identical or are complete subgraphs of each another. However, if the CDKMCS method is unable to find an optimal solution in the given time, the algorithm automatically uses the MCS+ method. This often occurs in cases of subgraphs with matching ring structures and dissimilar peripherals, <italic>e.g</italic>. ATP, ADP.</p>
          </sec>
          <sec id="Sec7">
            <title>VF+ library</title>
            <p>VF algorithm is able to efficiently solve the graph isomorphism and subgraph isomorphism problems on Attributed Relational Graphs (ARG) [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]. It works effectively on very large graphs, since its memory requirements are smaller than those of other algorithms of the same kind. This makes it an obvious choice for handling larger graphs where the clique finding algorithms need more memory and time (such as CDKMCS and MCSPlus). Since this algorithm is very fast when graphs represent exact isomorphism or one is a subgraph of another, it is an ideal choice for substructure searches in cheminformatics. The Java code for VF algorithm for computing substructures was adapted from the MX library available at <ext-link xlink:href="http://metamolecular.com/mx" ext-link-type="uri">http://metamolecular.com/mx</ext-link>. The CDK compatible version of the code is available on <ext-link xlink:href="http://wiki.github.com/asad/VFLib" ext-link-type="uri">http://wiki.github.com/asad/VFLib</ext-link>.</p>
            <p>This algorithm also generates approximate MCS if two graphs are not isomorphic. Hence this becomes an ideal choice for big graphs where these approximate MCS solutions can further be extended <italic>via</italic> McGregor algorithm to find MCS. This makes it very efficient for finding MCS without compromising on the speed and memory usage. Therefore we further extended the original code to compute substructure search and MCS between two molecules.</p>
          </sec>
          <sec id="Sec8">
            <title>Introducing Chemical Knowledge into the MCS</title>
            <p>The MCS search is based on two types of chemical constraints – a <italic>bond-sensitive</italic> MCS search and a <italic>bond-insensitive</italic> search. The bond sensitive module can be employed to screen compounds that mimic the substructure of the query molecule(s) based on the MCS. The bond-insensitive algorithm can be used for atom-atom mapping in a reaction where the focus is on bond changes, thus leading to a better understanding of the structural changes that emerge during a reaction. The runtime of the bond insensitive algorithm is longer than the bond-sensitive search as the former leads to an exponential increase in the search space. The SMSD software also contains several similarity (<italic>i.e</italic>. Tanimoto etc.) and distance descriptors (i.e. Euclidean etc.), which can be used as filters.</p>
            <p>An MCS algorithm usually reports more than one solution when matching two molecules. Thus, even when the molecules are of identical size and chemical shape, there can be more than one feasible set of the MCS solutions (for example two benzene rings may have multiple MCS solutions but the solution can be filtered/constraint by chemical knowledge such as bond type).</p>
            <p>We propose a chemically aware post-filtering (Figure <xref rid="Fig2" ref-type="fig">2</xref>) subroutine that deals with the ambiguous solutions arising from the MCS search. There are three filters applied:</p>
            <p>a. Specific matching of the chemical functional groups, bond types (aromatic, non-aromatic, double, single etc.) and stereochemistry, e.g. phosphate, -SH, nitrite etc. are identified and matched.</p>
            <p>b. The resulting solutions are sorted in ascending order of the total bond breaking energy (energy required to break the bonds between matched parts and unmatched parts) required by this MCS match (i.e. lowest energy is highest ranked).</p>
            <p>c. The best set of solutions are chosen based on the above two steps and the solutions are then sorted in decreasing order according to the number of fragments generated if the matched part of the molecule is removed from the reference structure (i.e. if a three member ring is matched to a single ring structure then solutions which match the rings on the periphery are preferred over the central ring).</p>
            <p>This leads to a set(s) of chemically relevant MCS solutions, keeping intact the chemical significance of the reported substructures.</p>
          </sec>
          <sec id="Sec9">
            <title>SMSD (Small Molecule Subgraph Detector)</title>
            <p>SMSD is a combination of various algorithms (i.e. CDMCS, MCS+ and VF+ Lib). The decision to use an algorithm is purely based on the complexity of the input molecule. For example molecules, which potentially can be a subgraph based on atoms are handled by VF+ Lib first. Molecules whose bond count and atoms count are not equal are first matched by CDKMCS. If the solution is not computed within a limited time (i.e. timeout occurs) then it's passed to the MCS+, which starts the search from the scratch (i.e. solutions from CDKMCS is ignored). If the <italic>d-edge</italic> count is more than 99,999 then VF+ Lib is used to find MCS, as this is very efficient in handling medium and large sized graphs. McGregor further extends solution generated by VF+ Lib where possible to find MCS. A turbo-matching option was introduced in the SMSD, to return the first MCS match.</p>
            <p>The MCS solution(s) are then passed to the chemical filters, which ranks the solutions in a chemically meaningful way. Thus we get chemically relevant MCS solutions computed in polynomial time.</p>
          </sec>
        </sec>
        <sec id="Sec10">
          <title>Results and Discussion</title>
          <p>The MCS in the SMSD was benchmarked (Figure <xref rid="Fig4" ref-type="fig">4</xref>) against the standard MCS module available in the CDK [<xref ref-type="bibr" rid="CR30">30</xref>]. A random test set of 50,000 comparisons between PDB HET molecules [<xref ref-type="bibr" rid="CR28">28</xref>] and KEGG ligands [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR35">35</xref>] was created. This list was filtered so that no comparison was repeated either with the same target and query, or <italic>vice versa</italic>. Thirty-eight examples in the test set did not find any similarity in either of the systems (CDKMCS and SMSD) due to unrecognised atom types, corresponding to heavy metal atoms in HET groups. This reduced the comparisons list to 49,962 jobs. The SMSD was able to compute all the jobs (except one which ran for more than an hour) while the native CDK-MCS failed to finish 24 jobs (~0.4%), mostly due to time-out or errors (jobs which ran more than 12 hours were automatically terminated by the machine).<fig id="Fig4"><label>Figure 4</label><caption xml:lang="en"><p><bold>Head to head comparison of MCS jobs processed by SMSD and CDK-MCS</bold>. The similarity score frequencies (left axis) between each pair (colored boxes) of MCS solutions derived by the CDKMCS and the SMSD algorithm were sorted into bins ranging from 0 to 1 increasing in 0.01 increments. The cumulative percentage of the overall dataset for each bin is also shown (curves and right axis). Data shown in blue correspond to results from the SMSD algorithm while those in mauve correspond to CDKMCS. Data shown in yellow correspond to all the jobs that ran successfully by SMSD (includes 24 jobs which failed to run by CDKMCS). It is clear from the graph that the reported frequency of the SMSD similarity is almost similar to the CDKMCS similarity between the molecules. However the overall similarity between SMSD and CDKMCS is different because SMSD was able to process higher number of jobs than the latter. A good cut-off Tanimoto similarity score for reporting significant matches seems to be above 0.77 (at 99.9 percentile of the curve) for MCS based searches (indicated by the rightmost set of dashed lines).</p></caption><graphic specific-use="HTML" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2009_Article_12_Fig4_HTML.jpg" /></fig></p>
          <sec id="Sec11">
            <title>SMSD versus CDK similarity validation</title>
            <p>A molecular fingerprint is derived by enumerating on various structural features of chemical space [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR36">36</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]. The rationale behind such an approach is to find "globally" analogous features between the query and target molecules under less stringent constraints than the MCS. There are several heuristic fragment based chemical similarity search approaches, like the 2-D fingerprint method, which represents chemical structure as a vector in a high-dimensional space. These approaches are usually very fast and good for the pre-screening of small molecules. One of the major limitations of such approaches is that they are unable to identify "local" similarity between structures thereby increasing the false-negative rates (i.e. identifying cases with weaker similarities).</p>
            <p>In order to measure and benchmark validity (Figure <xref rid="Fig5" ref-type="fig">5</xref>) of the reported MCS solutions, we compared the SMSD results (49,962 jobs) with that of the Fingerprint similarity generated using the CDK fingerprint module. The results were compared to each other by binning according to the frequency of the similarity reported. The similarity scores between each pair of comparison molecules were sorted into bins. The cumulative percentage of the overall dataset for each bin was also calculated (Figure <xref rid="Fig5" ref-type="fig">5</xref>). A graph-matching score defined as <italic>c</italic>/(<italic>a</italic> + <italic>b</italic> - <italic>c</italic>) where c is the size of the MCS and a, b are number of atoms in query and target respectively. A score of 0.49–0.50 was found to represent a good cut-off to use for graph matching using the SMSD, as 99% of all random matches occur below this threshold. Likewise, a similarity score of ~0.77 represents a good cut-off to use the SMSD and fingerprint matching using the CDK Fingerprints, as 99.9% of all random matches occur below this threshold. These cut-off scores (similarity) can be used to filter out molecules [<xref ref-type="bibr" rid="CR38">38</xref>] which have a very high probability of being dissimilar. This analysis also highlights the fact that the similarity range covered by fingerprints is very different to that of the MCS search as reported earlier [<xref ref-type="bibr" rid="CR39">39</xref>].<fig id="Fig5"><label>Figure 5</label><caption xml:lang="en"><p><bold>The similarity score frequencies (left axis) between each pair (colored boxes) of MCS solutions derived by the CDK-Fingerprint and the SMSD algorithm were sorted into bins ranging from 0 to 1 increasing in 0.01 increments</bold>. The cumulative percentage of the overall dataset for each bin is also shown (curves and right axis). Data shown in blue correspond to results from the SMSD algorithm while those in lilac correspond to CDK-Fingerprint. It is clear from the graph that the reported frequency of the SMSD similarity is different from the fingerprint similarity between the molecules. A good cut-off Tanimoto similarity score for reporting significant matches seems to be above 0.77 (at 99.9 percentile of the curve) for Fingerprint based searches and the MCS based search (indicated by the rightmost set of dashed lines).</p></caption><graphic specific-use="HTML" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2009_Article_12_Fig5_HTML.jpg" /></fig></p>
          </sec>
          <sec id="Sec12">
            <title>SMSD versus CDKMCS similarity</title>
            <p>A second set of benchmarks (Figure <xref rid="Fig4" ref-type="fig">4</xref>) was performed between the CDKMCS and the SMSD on the subset of intersection (45,139 jobs that reported at least one match between query and target molecules) between successful cases reported by both the methods. A detailed analysis shows that in 43,711 (~96.83%) cases, the SMSD and the CDKMCS searches reported an MCS of similar size. In 1,361 (~3.01%) cases the SMSD reported an MCS of a longer length than the MCS reported by the CDKMCS and in only 67 (~0.14%) instances was it vice versa. The difference in the size of the matches is not due to time out. If a time out occurs in CDKMCS then the MCS+ starts to compute MCS from the beginning. Previously, the CDKMCS used to provide better matches (though very expensive in terms of time and memory) than MCS+, in a few cases. This was due to the fact that these molecules had a very high <italic>d-edge</italic> count; hence MCS+ use to switch into heuristic mode. We have now been able to resolve this issue using VF+ Lib, which can handle larger graphs efficiently. The analysis presented in this paper is performed without VF+ Lib so as to highlight the strength of the combination of MCS+ and CDKMCS. Some larger matches reported by CDKMCS are incorrect due to the MCIS vs MCES problem. For example in the case of cyclopropane and isobutene, CDKMCS reports 3 matched atoms whereas MCS+ reports only 2, which is correct. This highlights the strength of the SMSD and its ability to calculate the MCS in a reasonably acceptable time without clogging the comparison pipeline.</p>
          </sec>
          <sec id="Sec13">
            <title>The MCS Execution Runtime</title>
            <p>All these test cases were run on EBI farm nodes (processor speed varies across the nodes) with an average of 300 jobs processed in parallel. The overall execution time for all the processed jobs can be obtained by summing up the CPU time. This time does not have a direct, one to one correlation between the run times of jobs (e.g. Job "A" fired from the SMSD ran on a slower machine whereas same job "A" fired by the CDKMCS ran on a faster machine or vice versa). Hence this is just an indicative measure of the runtime performance between the algorithms.</p>
            <p>The total time required by a single processor to run 49,961 test cases using the SMSD was ~21 hours whereas 49,938 test cases processed by the CDKMCS, took ~113 hours (excluding 25 jobs which were still running even after 6 hours). Hence the average execution time (in the completed job list) for each comparison by the SMSD is less than ~1.5 seconds and ~8.2 seconds by the CDKMCS. Thus overall, execution of the SMSD is far faster than the CDKMCS.</p>
          </sec>
        </sec>
        <sec id="Sec14" sec-type="conclusions">
          <title>Conclusion</title>
          <p>MCS have been previously applied to identify biochemical activity in the metabolic pathways by mapping atom-atom equivalences between reactants and products in a chemical reaction [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR40">40</xref>–<xref ref-type="bibr" rid="CR43">43</xref>]. The algorithms used for screening similar molecules are usually bond sensitive (i.e. discriminate between single and double bonds) whereas MCS similarity checks between reactant and product molecules in a reaction are often bond insensitive (i.e. atom-atom mapping is preferred over bond type matches). We propose the SMSD as a robust software for calculating substructure similarity using the MCS algorithm. The SMSD returns more MCS solutions than CDKMCS, as in many cases the latter fails to detect similarity due to timeout. The SMSD software encapsulates the power of various algorithms and generates chemically relevant MCS solutions. Another merit of this software is that the MCS solutions are ranked on the basis of their chemical relevance such as bond energy, fragment size etc. This is one of the first attempts at ranking the MCS solutions in a chemically meaningful manner.</p>
          <p>Presently this tool can be applied to various areas of bioinformatics and chemo-informatics for finding exhaustive MCS matches. For example, it can be used to analyse metabolic networks by mapping the atoms between reactants and products involved in a reaction. It can also be used to detect the MCS/substructure searches in small molecules reported by metabolome experiments, as well as in the screening of drug-like compounds with similar substructures.</p>
          <p>This can be used to determine whether or not a query was a substructure of the target, as this question does not require an exhaustive MCS match with all possible maximum cliques.</p>
        </sec>
        <sec id="Sec15">
          <title>Availability and requirements</title>
          <p>Project name: Small Molecule Subgraph Detector (SMSD)</p>
          <p>Project home page: <ext-link xlink:href="http://www.ebi.ac.uk/thornton-srv/software/SMSD/" ext-link-type="uri">http://www.ebi.ac.uk/thornton-srv/software/SMSD/</ext-link></p>
          <p>Operating system(s): Platform independent (Windows, MAC, Linux/Unix)</p>
          <p>Programming language: Java</p>
          <p>Other requirements: Java 1.6 or higher</p>
          <p>License: Creative Commons http://creativecommons.org/licenses/by/3.0/</p>
          <p>Any restrictions to use by non-academics: NONE</p>
        </sec>
        <sec id="Sec16">
          <title>Authors' informations</title>
          <p><bold>SAR</bold> is a Research Fellow in the JMT group.</p>
          <p><bold>MB</bold> is a Research Fellow in the JMT group.</p>
          <p><bold>GLH</bold> is a Research Fellow in the JMT group.</p>
          <p><bold>RS</bold> is a full time Professor at ZAIK, University of Cologne, Germany.</p>
          <p><bold>JMT</bold> is the Director, Research Programme Coordinator and Group Leader at EMBL-EBI, Cambridge, UK. She has been a Fellow of The Royal Society since 1999.</p>
        </sec>
        <sec id="Sec17">
          <title>Appendix 1: SMSD Algorithm for Calculating MCS</title>
          <p>
            <bold>PROCEDURE SMSD</bold>
          </p>
          <p>   INPUT: Given a query Gq and a target Gt graph</p>
          <p>   OUTPUT: the MCS mappings between the two graphs</p>
          <p>   IF atoms of query Gq is a subset of Gt or<italic>vice versa</italic></p>
          <p>      THEN CALL VF+ (Gq, Gt)</p>
          <p>   ELSE IF the Gq bond count NOT EQUAL TO Gt &amp;&amp; Gq bond</p>
          <p>      count NOT EQUAL TO Gt</p>
          <p>      THEN CALL CDK+ (Gq, Gt)</p>
          <p>      IF CDKMCS (Gq, Gt) EQUALS TO NULL</p>
          <p>         THEN CALL MCS+ (Gq, Gt)</p>
          <p>      END IF</p>
          <p>      IF MCS+ (Gq, Gt) EQUALS TO NULL</p>
          <p>         THEN CALL VF+ (Gq, Gt)</p>
          <p>      END IF</p>
          <p>   ELSE</p>
          <p>      CALL VF+ (Gq, Gt)</p>
          <p>      END IF</p>
          <p>   END IF</p>
          <p>
            <bold>END PROCEDURE</bold>
          </p>
          <p>
            <bold>PROCEDURE VF+ Lib</bold>
          </p>
          <p>   INPUT: Given a query Gq and a target Gt graph</p>
          <p>   OUTPUT: the mappings between the two graphs</p>
          <p>   IF node count of Gq > node count Gt</p>
          <p>      THEN CALL VF+ (Gt, Gq)</p>
          <p>   ELSE CALL VF+ (Gq, Gt)</p>
          <p>   END IF</p>
          <p>   IF the MCS size EQUALS Gq node count OR</p>
          <p>      MCS Size EQUALS Gt node Count</p>
          <p>      THEN return MCS</p>
          <p>   ELSE CALL McGregor (Gq, Gt, MCS)</p>
          <p>   END IF</p>
          <p>
            <bold>END PROCEDURE</bold>
          </p>
          <p>
            <bold>PROCEDURE MCS+</bold>
          </p>
          <p>   INPUT: Given a query Gq and a target Gt graph</p>
          <p>   OUTPUT: the mappings between the two graphs</p>
          <p>   Construct compatibility graph and mark c-edges and d-edges</p>
          <p>   IF heuristic flag False and d-edge count > 99,999</p>
          <p>      THEN return NULL</p>
          <p>   ELSE</p>
          <p>      Choose only 10% of the reported<italic>d-edges</italic></p>
          <p>   ENDIF</p>
          <p>   CALL CazalsKarandeKoch (CompatibilityGraph, c-edges, d-edges)</p>
          <p>   IF the MCS size EQUALS Gq node count OR</p>
          <p>      MCS Size EQUALS Gt node Count THEN return MCS</p>
          <p>   ELSE CALL McGregor (Gq, Gt, MCS)</p>
          <p>   END IF</p>
          <p>
            <bold>END PROCEDURE</bold>
          </p>
          <p>
            <bold>PROCEDURE CDKMCS</bold>
          </p>
          <p>   INPUT: Given a query Gq and a target Gt graph</p>
          <p>   OUTPUT: the mappings between the two graphs</p>
          <p>   IF node count of Gq > node count Gt</p>
          <p>      THEN CALL UniversalIsomorphismTester (Gt, Gq)</p>
          <p>   ELSE CALL UniversalIsomorphismTester (Gq, Gt)</p>
          <p>   END IF</p>
          <p>   IF timeout is TRUE THEN return NULL</p>
          <p>   ELSE return MCS</p>
          <p>
            <bold>END PROCEDURE</bold>
          </p>
        </sec>
      </body>
      <back>
        <ack>
          <title>Acknowledgements</title>
          <p>Authors would like to thank Dr. M. Leber and Prof. Dr. D. Schomburg for the initial discussions on the MCS algorithm. Dr. M. Leber provided C/C++ version of the c-cliques MCS library (from his PhD work), which was referred to during the software development. Authors would also like to thank Dr. R. Laskowski, for his comments on the manuscript and Dr. L. Baldacci for his feedback on the tool. We would like to thank the Chemistry Development Kit (CDK) developers who were prompt in addressing our queries. MB was supported as part of the mid-west Structural Genomic Consortium (SGC) by NIH grant (GM62414), US DOE under contract (W-31-109-ENG38). yED <ext-link xlink:href="http://www.yworks.com" ext-link-type="uri">http://www.yworks.com</ext-link> was used to sketch the flowcharts. JMT, GLH, SAR would like to acknowledge EMBL, Wellcome Trust, IBM etc for support and funding.</p>
        </ack>
        <ref-list id="Bib1">
          <title>References</title>
          <ref-list>
            <ref id="CR1">
              <label>1.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Gasteiger</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Engel</surname>
                    <given-names>T</given-names>
                  </name>
                </person-group>
                <source>Chemoinformatics: A Textbook</source>
                <year>2003</year>
                <pub-id pub-id-type="doi">10.1002/3527601643</pub-id>
                <comment>WILEY-VCH GmbH &amp; Co</comment>
              </mixed-citation>
            </ref>
            <ref id="CR2">
              <label>2.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Gardiner</surname>
                    <given-names>EJ</given-names>
                  </name>
                  <name>
                    <surname>Gillet</surname>
                    <given-names>VJ</given-names>
                  </name>
                  <name>
                    <surname>Willett</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Cosgrove</surname>
                    <given-names>DA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Representing clusters using a maximum common edge substructure algorithm applied to reduced graphs and molecular graphs</article-title>
                <source>Journal of chemical information and modeling</source>
                <year>2007</year>
                <volume>47</volume>
                <issue>2</issue>
                <fpage>354</fpage>
                <lpage>366</lpage>
                <pub-id pub-id-type="doi">10.1021/ci600444g</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2sXhvVGqu78%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR3">
              <label>3.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Raymond</surname>
                    <given-names>JW</given-names>
                  </name>
                  <name>
                    <surname>Blankley</surname>
                    <given-names>CJ</given-names>
                  </name>
                  <name>
                    <surname>Willett</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Comparison of chemical clustering methods using graph- and fingerprint-based similarity measures</article-title>
                <source>J Mol Graph Model</source>
                <year>2003</year>
                <volume>21</volume>
                <issue>5</issue>
                <fpage>421</fpage>
                <lpage>433</lpage>
                <pub-id pub-id-type="doi">10.1016/S1093-3263(02)00188-2</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3sXkvFarsw%3D%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR4">
              <label>4.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Voigt</surname>
                    <given-names>JH</given-names>
                  </name>
                  <name>
                    <surname>Bienfait</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>Wang</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Nicklaus</surname>
                    <given-names>MC</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Comparison of the NCI open database with seven large chemical structural databases</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>2001</year>
                <volume>41</volume>
                <issue>3</issue>
                <fpage>702</fpage>
                <lpage>712</lpage>
                <pub-id pub-id-type="doi">10.1021/ci000150t</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3MXit1Sks78%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR5">
              <label>5.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Li</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Hao</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Zheng</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Tu</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Fan</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Zhu</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Ding</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Dong</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Wang</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Li</surname>
                    <given-names>X</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Gene expression module-based chemical function similarity search</article-title>
                <source>Nucleic acids research</source>
                <year>2008</year>
                <volume>36</volume>
                <issue>20</issue>
                <fpage>e137</fpage>
                <pub-id pub-id-type="doi">10.1093/nar/gkn610</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR6">
              <label>6.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Barreiro</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Guimaraes</surname>
                    <given-names>CR</given-names>
                  </name>
                  <name>
                    <surname>Tubert-Brohman</surname>
                    <given-names>I</given-names>
                  </name>
                  <name>
                    <surname>Lyons</surname>
                    <given-names>TM</given-names>
                  </name>
                  <name>
                    <surname>Tirado-Rives</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Jorgensen</surname>
                    <given-names>WL</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Search for non-nucleoside inhibitors of HIV-1 reverse transcriptase using chemical similarity, molecular docking, and MM-GB/SA scoring</article-title>
                <source>Journal of chemical information and modeling</source>
                <year>2007</year>
                <volume>47</volume>
                <issue>6</issue>
                <fpage>2416</fpage>
                <lpage>2428</lpage>
                <pub-id pub-id-type="doi">10.1021/ci700271z</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2sXhtF2gsrjP</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR7">
              <label>7.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Sheridan</surname>
                    <given-names>RP</given-names>
                  </name>
                  <name>
                    <surname>Kearsley</surname>
                    <given-names>SK</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Why do we need so many chemical similarity search methods?</article-title>
                <source>Drug Discov Today</source>
                <year>2002</year>
                <volume>7</volume>
                <issue>17</issue>
                <fpage>903</fpage>
                <lpage>911</lpage>
                <pub-id pub-id-type="doi">10.1016/S1359-6446(02)02411-X</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR8">
              <label>8.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Gillet</surname>
                    <given-names>VJ</given-names>
                  </name>
                  <name>
                    <surname>Willett</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Bradshaw</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Similarity searching using reduced graphs</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>2003</year>
                <volume>43</volume>
                <issue>2</issue>
                <fpage>338</fpage>
                <lpage>345</lpage>
                <pub-id pub-id-type="doi">10.1021/ci025592e</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3sXhtVOjtbs%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR9">
              <label>9.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Willett</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Chemoinformatics – similarity and diversity in chemical libraries</article-title>
                <source>Curr Opin Biotechnol</source>
                <year>2000</year>
                <volume>11</volume>
                <issue>1</issue>
                <fpage>85</fpage>
                <lpage>88</lpage>
                <pub-id pub-id-type="doi">10.1016/S0958-1669(99)00059-2</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3cXhtlymsLs%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR10">
              <label>10.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Cuissart</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>Touffet</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Cremilleux</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>Bureau</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Rault</surname>
                    <given-names>S</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The maximum common substructure as a molecular depiction in a supervised classification context: experiments in quantitative structure/biodegradability relationships</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>2002</year>
                <volume>42</volume>
                <issue>5</issue>
                <fpage>1043</fpage>
                <lpage>1052</lpage>
                <pub-id pub-id-type="doi">10.1021/ci020017w</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD38Xnt1GqtLc%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR11">
              <label>11.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Cerruela García</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Luque Ruiz</surname>
                    <given-names>I</given-names>
                  </name>
                  <name>
                    <surname>Gómez-Nieto</surname>
                    <given-names>MA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Step-by-step calculation of all maximum common substructures through a constraint satisfaction based algorithm</article-title>
                <source>Journal of Chemical Information and Computer Sciences</source>
                <year>2004</year>
                <volume>44</volume>
                <fpage>30</fpage>
                <lpage>41</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR12">
              <label>12.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Garey</surname>
                    <given-names>MR</given-names>
                  </name>
                  <name>
                    <surname>Johnson</surname>
                    <given-names>DS</given-names>
                  </name>
                </person-group>
                <source>Computers and Intractability; A Guide to the Theory of NP-Completeness</source>
                <year>1990</year>
                <comment>W. H. Freeman &amp; Co</comment>
              </mixed-citation>
            </ref>
            <ref id="CR13">
              <label>13.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Bron</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Kerbosch</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Finding all the cliques in an undirected graph</article-title>
                <source>Communication of the ACM</source>
                <year>1973</year>
                <volume>16</volume>
                <fpage>189</fpage>
                <lpage>201</lpage>
                <pub-id pub-id-type="doi">10.1145/362342.362367</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR14">
              <label>14.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Samudrala</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Moult</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">A graph-theoretic algorithm for comparative modeling of protein structure</article-title>
                <source>Journal of molecular biology</source>
                <year>1998</year>
                <volume>279</volume>
                <issue>1</issue>
                <fpage>287</fpage>
                <lpage>302</lpage>
                <pub-id pub-id-type="doi">10.1006/jmbi.1998.1689</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK1cXjvVyisro%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR15">
              <label>15.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Hattori</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Okuno</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Goto</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Kanehisa</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Development of a chemical structure comparison method for integrated analysis of chemical and genomic information in the metabolic pathways</article-title>
                <source>Journal of the American Chemical Society</source>
                <year>2003</year>
                <volume>125</volume>
                <issue>39</issue>
                <fpage>11853</fpage>
                <lpage>11865</lpage>
                <pub-id pub-id-type="doi">10.1021/ja036030u</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3sXnt1Knuro%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR16">
              <label>16.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Akutsu</surname>
                    <given-names>T</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Efficient extraction of mapping rules of atoms from enzymatic reaction data</article-title>
                <source>J Comput Biol</source>
                <year>2004</year>
                <volume>11</volume>
                <issue>2–3</issue>
                <fpage>449</fpage>
                <lpage>462</lpage>
                <pub-id pub-id-type="doi">10.1089/1066527041410337</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2cXls1Omur8%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR17">
              <label>17.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Raymond</surname>
                    <given-names>JW</given-names>
                  </name>
                  <name>
                    <surname>Gardiner</surname>
                    <given-names>EJ</given-names>
                  </name>
                  <name>
                    <surname>Willett</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Heuristics for similarity searching of chemical graphs using a maximum common edge subgraph algorithm</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>2002</year>
                <volume>42</volume>
                <issue>2</issue>
                <fpage>305</fpage>
                <lpage>316</lpage>
                <pub-id pub-id-type="doi">10.1021/ci010381f</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD38XhtVKgt78%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR18">
              <label>18.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Raymond</surname>
                    <given-names>JW</given-names>
                  </name>
                  <name>
                    <surname>Willett</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Maximum common subgraph isomorphism algorithms for the matching of chemical structures</article-title>
                <source>Journal of computer-aided molecular design</source>
                <year>2002</year>
                <volume>16</volume>
                <issue>7</issue>
                <fpage>521</fpage>
                <lpage>533</lpage>
                <pub-id pub-id-type="doi">10.1023/A:1021271615909</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD38XovF2jsrc%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR19">
              <label>19.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Tonnelier</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Jauffret</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Hanser</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Kaufmann</surname>
                    <given-names>G</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Machine learning of generic reactions: 3. an efficient algorithm for maximal common substructure determination</article-title>
                <source>Tetrahedron Computer Methodology</source>
                <year>1990</year>
                <volume>3</volume>
                <issue>6</issue>
                <fpage>351</fpage>
                <lpage>358</lpage>
                <pub-id pub-id-type="doi">10.1016/0898-5529(90)90061-C</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK38XlvVemtQ%3D%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR20">
              <label>20.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>McGregor</surname>
                    <given-names>JJ</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Backtrack search algorithms and the maximal common sub-graph problem</article-title>
                <source>Software Practice and Exprerience</source>
                <year>1982</year>
                <volume>12</volume>
                <fpage>23</fpage>
                <lpage>24</lpage>
                <pub-id pub-id-type="doi">10.1002/spe.4380120103</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR21">
              <label>21.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>McGregor</surname>
                    <given-names>JJ</given-names>
                  </name>
                  <name>
                    <surname>Willet</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Use of a maximal common subgraph algorithm in the automatic identification of the ostensible bond changes occurring in chemical reactions</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>1981</year>
                <volume>21</volume>
                <fpage>137</fpage>
                <lpage>140</lpage>
                <pub-id pub-id-type="doi">10.1021/ci00031a005</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaL3MXltFCitLk%3D</pub-id>
                <comment>http://pubs.acs.org/doi/abs/10.1021/ci00031a005</comment>
              </mixed-citation>
            </ref>
            <ref id="CR22">
              <label>22.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Cao</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Jiang</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Girke</surname>
                    <given-names>T</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">A maximum common substructure-based algorithm for searching and predicting drug-like compounds</article-title>
                <source>Bioinformatics (Oxford, England)</source>
                <year>2008</year>
                <volume>24</volume>
                <issue>13</issue>
                <fpage>i366</fpage>
                <lpage>374</lpage>
                <pub-id pub-id-type="doi">10.1093/bioinformatics/btn186</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1cXnvV2rtb8%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR23">
              <label>23.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Cordella</surname>
                    <given-names>LP</given-names>
                  </name>
                  <name>
                    <surname>Foggia</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Sansone</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Vento</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <source>An Improved Algorithm for Matching Large Graphs</source>
                <year>2008</year>
                <fpage>8</fpage>
                <comment>http://amalfi.dis.unina.it/graph/db/papers/vf-algorithm.pdf</comment>
              </mixed-citation>
            </ref>
            <ref id="CR24">
              <label>24.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Cordella</surname>
                    <given-names>LP</given-names>
                  </name>
                  <name>
                    <surname>Foggia</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Sansone</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Vento</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">A (sub)graph isomorphism algorithm for matching large graphs</article-title>
                <source>IEEE T Pattern Anal</source>
                <year>2004</year>
                <volume>26</volume>
                <fpage>1367</fpage>
                <lpage>1372</lpage>
                <pub-id pub-id-type="doi">10.1109/TPAMI.2004.75</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR25">
              <label>25.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Wong</surname>
                    <given-names>AKC</given-names>
                  </name>
                  <name>
                    <surname>Akinniyi</surname>
                    <given-names>FA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">An algorithm for the largest common subgraph isomorphism using the implicit net</article-title>
                <source>Proc. 1983 Int. Conf. Syst., Man, and Cybern</source>
                <year>1983</year>
                <fpage>197</fpage>
                <lpage>201</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR26">
              <label>26.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Ullmann</surname>
                    <given-names>JR</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">An Algorithm for Subgraph Isomorphism</article-title>
                <source>J ACM</source>
                <year>1976</year>
                <volume>23</volume>
                <issue>1</issue>
                <fpage>31</fpage>
                <lpage>42</lpage>
                <pub-id pub-id-type="doi">10.1145/321921.321925</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR27">
              <label>27.</label>
              <mixed-citation publication-type="other">Kanehisa M, Goto S, Hattori M, Aoki-Kinoshita KF, Itoh M, Kawashima S, Katayama T, Araki M, Hirakawa M: From genomics to chemical genomics: new developments in KEGG. Nucleic acids research. 2006, D354-357. 10.1093/nar/gkj102. 34 Database</mixed-citation>
            </ref>
            <ref id="CR28">
              <label>28.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Berman</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Henrick</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Nakamura</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Markley</surname>
                    <given-names>JL</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The worldwide Protein Data Bank (wwPDB): ensuring a single, uniform archive of PDB data</article-title>
                <source>Nucleic acids research</source>
                <year>2007</year>
                <volume>35</volume>
                <fpage>D301</fpage>
                <lpage>303</lpage>
                <pub-id pub-id-type="doi">10.1093/nar/gkl971</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2sXivFKmtQ%3D%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR29">
              <label>29.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Steinbeck</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Hoppe</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Kuhn</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Floris</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Guha</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Willighagen</surname>
                    <given-names>EL</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Recent developments of the chemistry development kit (CDK) – an open-source java library for chemo- and bioinformatics</article-title>
                <source>Curr Pharm Des</source>
                <year>2006</year>
                <volume>12</volume>
                <issue>17</issue>
                <fpage>2111</fpage>
                <lpage>2120</lpage>
                <pub-id pub-id-type="doi">10.2174/138161206777585274</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD28XmslWqsL0%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR30">
              <label>30.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Steinbeck</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Han</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Kuhn</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Horlacher</surname>
                    <given-names>O</given-names>
                  </name>
                  <name>
                    <surname>Luttmann</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Willighagen</surname>
                    <given-names>E</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The Chemistry Development Kit (CDK): an open-source Java library for Chemo- and Bioinformatics</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>2003</year>
                <volume>43</volume>
                <issue>2</issue>
                <fpage>493</fpage>
                <lpage>500</lpage>
                <pub-id pub-id-type="doi">10.1021/ci025584y</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3sXhtVaktbg%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR31">
              <label>31.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Koch</surname>
                    <given-names>I</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Enumerating all connected maximal common subgraphs in two graphs</article-title>
                <source>Theoretical Computer Science</source>
                <year>2001</year>
                <volume>250</volume>
                <issue>1–2</issue>
                <fpage>1</fpage>
                <lpage>30</lpage>
                <pub-id pub-id-type="doi">10.1016/S0304-3975(00)00286-3</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR32">
              <label>32.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Leber</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <source>Kodierung enzymatischer Reaktionen</source>
                <year>2008</year>
                <comment>University of Cologne</comment>
              </mixed-citation>
            </ref>
            <ref id="CR33">
              <label>33.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Cazals</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Karande</surname>
                    <given-names>C</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">A note on the problem of reporting maximal cliques</article-title>
                <source>Theoretical Computer Science</source>
                <year>2008</year>
                <volume>407</volume>
                <issue>1–3</issue>
                <fpage>564</fpage>
                <lpage>568</lpage>
                <pub-id pub-id-type="doi">10.1016/j.tcs.2008.05.010</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR34">
              <label>34.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Cazals</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Karande</surname>
                    <given-names>C</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">An algorithm for reporting maximal c-cliques</article-title>
                <source>Theoretical Computer Science</source>
                <year>2005</year>
                <volume>349</volume>
                <issue>3</issue>
                <fpage>484</fpage>
                <lpage>490</lpage>
                <pub-id pub-id-type="doi">10.1016/j.tcs.2005.09.038</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR35">
              <label>35.</label>
              <mixed-citation publication-type="other">Kanehisa M, Araki M, Goto S, Hattori M, Hirakawa M, Itoh M, Katayama T, Kawashima S, Okuda S, Tokimatsu T, et al: KEGG for linking genomes to life and the environment. Nucleic acids research. 2008, D480-484. 36 Database</mixed-citation>
            </ref>
            <ref id="CR36">
              <label>36.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Holliday</surname>
                    <given-names>JD</given-names>
                  </name>
                  <name>
                    <surname>Salim</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Whittle</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Willett</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Analysis and display of the size dependence of chemical similarity coefficients</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>2003</year>
                <volume>43</volume>
                <issue>3</issue>
                <fpage>819</fpage>
                <lpage>828</lpage>
                <pub-id pub-id-type="doi">10.1021/ci034001x</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3sXislSitL4%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR37">
              <label>37.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Chen</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Holliday</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Bradshaw</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">A machine learning approach to weighting schemes in the data fusion of similarity coefficients</article-title>
                <source>Journal of chemical information and modeling</source>
                <year>2009</year>
                <volume>49</volume>
                <issue>2</issue>
                <fpage>185</fpage>
                <lpage>194</lpage>
                <pub-id pub-id-type="doi">10.1021/ci800292d</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXktVyjtg%3D%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR38">
              <label>38.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Godden</surname>
                    <given-names>JW</given-names>
                  </name>
                  <name>
                    <surname>Xue</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Bajorath</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Combinatorial preferences affect molecular similarity/diversity calculations using binary fingerprints and Tanimoto coefficients</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>2000</year>
                <volume>40</volume>
                <issue>1</issue>
                <fpage>163</fpage>
                <lpage>166</lpage>
                <pub-id pub-id-type="doi">10.1021/ci990316u</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK1MXns1Sis7o%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR39">
              <label>39.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Raymond</surname>
                    <given-names>JW</given-names>
                  </name>
                  <name>
                    <surname>Willett</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Effectiveness of graph-based and fingerprint-based similarity measures for virtual screening of 2D chemical structure databases</article-title>
                <source>Journal of computer-aided molecular design</source>
                <year>2002</year>
                <volume>16</volume>
                <issue>1</issue>
                <fpage>59</fpage>
                <lpage>71</lpage>
                <pub-id pub-id-type="doi">10.1023/A:1016387816342</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD38XltlSqsL4%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR40">
              <label>40.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Arita</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">In silico atomic tracing by substrate-product relationships in Escherichia coli intermediary metabolism</article-title>
                <source>Genome Res</source>
                <year>2003</year>
                <volume>13</volume>
                <issue>11</issue>
                <fpage>2455</fpage>
                <lpage>2466</lpage>
                <pub-id pub-id-type="doi">10.1101/gr.1212003</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3sXovFWrsbg%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR41">
              <label>41.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Arita</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The metabolic world of Escherichia coli is not small</article-title>
                <source>Proceedings of the National Academy of Sciences of the United States of America</source>
                <year>2004</year>
                <volume>101</volume>
                <issue>6</issue>
                <fpage>1543</fpage>
                <lpage>1547</lpage>
                <pub-id pub-id-type="doi">10.1073/pnas.0306458101</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2cXhsFaqsbk%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR42">
              <label>42.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Birkemeyer</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Luedemann</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Wagner</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Erban</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Kopka</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Metabolome analysis: the potential of in vivo labeling with stable isotopes for metabolite profiling</article-title>
                <source>Trends in biotechnology</source>
                <year>2005</year>
                <volume>23</volume>
                <issue>1</issue>
                <fpage>28</fpage>
                <lpage>33</lpage>
                <pub-id pub-id-type="doi">10.1016/j.tibtech.2004.12.001</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2MXktVOn</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR43">
              <label>43.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Mu</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Williams</surname>
                    <given-names>RF</given-names>
                  </name>
                  <name>
                    <surname>Unkefer</surname>
                    <given-names>CJ</given-names>
                  </name>
                  <name>
                    <surname>Unkefer</surname>
                    <given-names>PJ</given-names>
                  </name>
                  <name>
                    <surname>Faeder</surname>
                    <given-names>JR</given-names>
                  </name>
                  <name>
                    <surname>Hlavacek</surname>
                    <given-names>WS</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Carbon-fate maps for metabolic reactions</article-title>
                <source>Bioinformatics (Oxford, England)</source>
                <year>2007</year>
                <volume>23</volume>
                <issue>23</issue>
                <fpage>3193</fpage>
                <lpage>3199</lpage>
                <pub-id pub-id-type="doi">10.1093/bioinformatics/btm498</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2sXhtlOqsbbN</pub-id>
              </mixed-citation>
            </ref>
          </ref-list>
        </ref-list>
        <app-group>
          <app id="App1">
            <sec id="Sec18">
              <title>Authors’ original submitted files for images</title>
              <p>Below are the links to the authors’ original submitted files for images.<supplementary-material content-type="local-data" id="MOESM1" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="bmp" xlink:href="MediaObjects/13321_2009_12_MOESM1_ESM.bmp" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 1</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM2" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="bmp" xlink:href="MediaObjects/13321_2009_12_MOESM2_ESM.bmp" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 2</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM3" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="bmp" xlink:href="MediaObjects/13321_2009_12_MOESM3_ESM.bmp" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 3</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM4" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="bmp" xlink:href="MediaObjects/13321_2009_12_MOESM4_ESM.bmp" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 4</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM5" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="bmp" xlink:href="MediaObjects/13321_2009_12_MOESM5_ESM.bmp" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 5</p></caption></media></supplementary-material></p>
            </sec>
          </app>
        </app-group>
        <glossary>
          <title>Abbreviations</title>
          <def-list>
            <def-item>
              <term>MCS</term>
              <def>
                <p>Maximum Common Subgraph</p>
              </def>
            </def-item>
            <def-item>
              <term>CDK</term>
              <def>
                <p>Chemistry Development Kit</p>
              </def>
            </def-item>
            <def-item>
              <term>PDB</term>
              <def>
                <p>Protein Data Bank</p>
              </def>
            </def-item>
            <def-item>
              <term>KEGG</term>
              <def>
                <p>Kyoto Encyclopedia of Genes and Genomes</p>
              </def>
            </def-item>
            <def-item>
              <term>CDKMCS</term>
              <def>
                <p>MCS in the Chemistry Development Kit</p>
              </def>
            </def-item>
            <def-item>
              <term>SMSD</term>
              <def>
                <p>Small Molecule Subgraph Detector</p>
              </def>
            </def-item>
            <def-item>
              <term>MCS+</term>
              <def>
                <p>Maximum Common Subgraph Plus</p>
              </def>
            </def-item>
            <def-item>
              <term>MCIS</term>
              <def>
                <p>Maximum Common Induced Subgraph</p>
              </def>
            </def-item>
            <def-item>
              <term>MCES</term>
              <def>
                <p>Maximum Common Edge Subgraph</p>
              </def>
            </def-item>
            <def-item>
              <term>
                <italic>G</italic>
                <sub>
                  <italic>m</italic>
                </sub>
              </term>
              <def>
                <p>Molecular graph</p>
              </def>
            </def-item>
            <def-item>
              <term>
                <italic>G</italic>
                <sub>
                  <italic>q</italic>
                </sub>
              </term>
              <def>
                <p>Query graph</p>
              </def>
            </def-item>
            <def-item>
              <term>
                <italic>G</italic>
                <sub>
                  <italic>t</italic>
                </sub>
              </term>
              <def>
                <p>Target graph.</p>
              </def>
            </def-item>
          </def-list>
        </glossary>
        <notes notes-type="Misc">
          <title>Competing interests</title>
          <p>The authors declare that they have no competing interests.</p>
        </notes>
        <notes notes-type="Misc">
          <title>Authors' contributions</title>
          <p>SAR was involved in designing the algorithm, coding the software and manuscript preparation. He was also involved in testing and benchmarking the tool. MB was involved in testing and benchmarking the tool. GLH was involved in testing the chemical relevance of the tool and in the process of the manuscript preparation. RS was involved in the supervision of the algorithm development. JMT was involved in the overall supervision of the project, manuscript preparation, intellectual inputs and guidance.</p>
        </notes>
      </back>
    </article>
