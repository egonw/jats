<?xml version="1.0"?>
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="research-article" xml:lang="en">
      <front>
        <journal-meta>
          <journal-id journal-id-type="publisher-id">13321</journal-id>
          <journal-title-group>
            <journal-title>Journal of Cheminformatics</journal-title>
            <abbrev-journal-title abbrev-type="publisher">J Cheminform</abbrev-journal-title>
          </journal-title-group>
          <issn pub-type="epub">1758-2946</issn>
          <publisher>
            <publisher-name>Springer International Publishing</publisher-name>
            <publisher-loc>Cham</publisher-loc>
          </publisher>
        </journal-meta>
        <article-meta>
          <article-id pub-id-type="publisher-id">BMC1758-2946-4-21</article-id>
          <article-id pub-id-type="manuscript">365</article-id>
          <article-id pub-id-type="doi">10.1186/1758-2946-4-21</article-id>
          <article-categories>
            <subj-group subj-group-type="heading">
              <subject>Software</subject>
            </subj-group>
          </article-categories>
          <title-group>
            <article-title xml:lang="en">OMG: Open Molecule Generator</article-title>
          </title-group>
          <contrib-group>
            <contrib contrib-type="author">
              <name>
                <surname>Peironcely</surname>
                <given-names>Julio E</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="aff" rid="Aff2">2</xref>
              <xref ref-type="aff" rid="Aff3">3</xref>
              <xref ref-type="aff" rid="Aff4">4</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Rojas-Chertó</surname>
                <given-names>Miguel</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff2">2</xref>
              <xref ref-type="aff" rid="Aff3">3</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Fichera</surname>
                <given-names>Davide</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff4">4</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Reijmers</surname>
                <given-names>Theo</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff2">2</xref>
              <xref ref-type="aff" rid="Aff3">3</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Coulier</surname>
                <given-names>Leon</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="aff" rid="Aff3">3</xref>
            </contrib>
            <contrib contrib-type="author" corresp="yes">
              <name>
                <surname>Faulon</surname>
                <given-names>Jean-Loup</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff4">4</xref>
              <xref ref-type="corresp" rid="IDBMC17582946421_cor6">f</xref>
            </contrib>
            <contrib contrib-type="author" corresp="yes">
              <name>
                <surname>Hankemeier</surname>
                <given-names>Thomas</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff2">2</xref>
              <xref ref-type="aff" rid="Aff3">3</xref>
              <xref ref-type="corresp" rid="IDBMC17582946421_cor7">g</xref>
            </contrib>
            <aff id="Aff1">
              <label>1</label>
              <institution-wrap>
                <institution content-type="org-name">TNO Research Group Quality &amp; Safety</institution>
              </institution-wrap>
              <addr-line content-type="postbox">P.O. Box 360</addr-line>
              <addr-line content-type="postcode">NL-3700</addr-line>
              <addr-line content-type="city">Zeist</addr-line>
              <addr-line content-type="state">AJ</addr-line>
              <country country="NL">The Netherlands</country>
            </aff>
            <aff id="Aff2">
              <label>2</label>
              <institution-wrap>
                <institution-id institution-id-type="GRID">grid.5132.5</institution-id>
                <institution-id institution-id-type="ISNI">0000000123121970</institution-id>
                <institution content-type="org-division">Leiden/Amsterdam Center for Drug Research</institution>
                <institution content-type="org-name">Leiden University</institution>
              </institution-wrap>
              <addr-line content-type="street">Einsteinweg 55</addr-line>
              <addr-line content-type="postcode">2333</addr-line>
              <addr-line content-type="city">Leiden</addr-line>
              <addr-line content-type="state">CC</addr-line>
              <country country="NL">The Netherlands</country>
            </aff>
            <aff id="Aff3">
              <label>3</label>
              <institution-wrap>
                <institution-id institution-id-type="GRID">grid.450196.f</institution-id>
                <institution-id institution-id-type="ISNI">0000000446783135</institution-id>
                <institution content-type="org-name">Netherlands Metabolomics Centre</institution>
              </institution-wrap>
              <addr-line content-type="street">Einsteinweg 55</addr-line>
              <addr-line content-type="postcode">2333</addr-line>
              <addr-line content-type="city">Leiden</addr-line>
              <addr-line content-type="state">CC</addr-line>
              <country country="NL">The Netherlands</country>
            </aff>
            <aff id="Aff4">
              <label>4</label>
              <institution-wrap>
                <institution-id institution-id-type="GRID">grid.8390.2</institution-id>
                <institution-id institution-id-type="ISNI">0000 0001 2180 5818</institution-id>
                <institution content-type="org-division">iSSB, Institute of Systems and Synthetic Biology</institution>
                <institution content-type="org-name">University of Evry, EVRY</institution>
              </institution-wrap>
              <addr-line content-type="street">Genopole Campus 1, Genavenir 6, 5 rue Henri Desbruères</addr-line>
              <addr-line content-type="postcode">91030</addr-line>
              <addr-line content-type="city">Cedex</addr-line>
              <country country="FR">France</country>
            </aff>
          </contrib-group>
          <author-notes>
            <corresp id="IDBMC17582946421_cor6">
              <label>f</label>
              <email>HIDDEN</email>
            </corresp>
            <corresp id="IDBMC17582946421_cor7">
              <label>g</label>
              <email>HIDDEN</email>
            </corresp>
          </author-notes>
          <pub-date date-type="pub" publication-format="electronic">
            <day>17</day>
            <month>9</month>
            <year>2012</year>
          </pub-date>
          <pub-date date-type="collection" publication-format="electronic">
            <month>12</month>
            <year>2012</year>
          </pub-date>
          <volume>4</volume>
          <issue seq="35">1</issue>
          <elocation-id>21</elocation-id>
          <history>
            <date date-type="registration">
              <day>18</day>
              <month>5</month>
              <year>2012</year>
            </date>
            <date date-type="received">
              <day>18</day>
              <month>5</month>
              <year>2012</year>
            </date>
            <date date-type="accepted">
              <day>3</day>
              <month>9</month>
              <year>2012</year>
            </date>
            <date date-type="online">
              <day>17</day>
              <month>9</month>
              <year>2012</year>
            </date>
          </history>
          <permissions>
            <copyright-statement content-type="compact">© Peironcely et al.; licensee Chemistry Central Ltd. 2012</copyright-statement>
            <copyright-statement content-type="comment">This article is published under license to BioMed Central Ltd. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link xlink:href="http://creativecommons.org/licenses/by/2.0" ext-link-type="uri">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</copyright-statement>
            <copyright-year>2012</copyright-year>
            <copyright-holder>Peironcely et al.; licensee Chemistry Central Ltd.</copyright-holder>
            <license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/2.0">
              <license-p><bold>Open Access</bold>
 This article is distributed under the terms of the Creative Commons Attribution 2.0 International License (
    <ext-link xlink:href="https://creativecommons.org/licenses/by/2.0" ext-link-type="uri">https://creativecommons.org/licenses/by/2.0</ext-link>
    ), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.
</license-p>
            </license>
          </permissions>
          <abstract xml:lang="en" id="Abs1">
            <title>Abstract</title>
            <p>Computer Assisted Structure Elucidation has been used for decades to discover the chemical structure of unknown compounds. In this work we introduce the first open source structure generator, Open Molecule Generator (OMG), which for a given elemental composition produces all non-isomorphic chemical structures that match that elemental composition. Furthermore, this structure generator can accept as additional input one or multiple non-overlapping prescribed substructures to drastically reduce the number of possible chemical structures. Being open source allows for customization and future extension of its functionality. OMG relies on a modified version of the Canonical Augmentation Path, which grows intermediate chemical structures by adding bonds and checks that at each step only unique molecules are produced. In order to benchmark the tool, we generated chemical structures for the elemental formulas and substructures of different metabolites and compared the results with a commercially available structure generator. The results obtained, i.e. the number of molecules generated, were identical for elemental compositions having only C, O and H. For elemental compositions containing C, O, H, N, P and S, OMG produces all the chemically valid molecules while the other generator produces more, yet chemically impossible, molecules. The chemical completeness of the OMG results comes at the expense of being slower than the commercial generator. In addition to being open source, OMG clearly showed the added value of constraining the solution space by using multiple prescribed substructures as input. We expect this structure generator to be useful in many fields, but to be especially of great importance for metabolomics, where identifying unknown metabolites is still a major bottleneck.</p>
          </abstract>
          <kwd-group xml:lang="en">
            <title>Keywords</title>
            <kwd>Computer assisted structure elucidation</kwd>
            <kwd>Structure generator</kwd>
            <kwd>Molecule generator</kwd>
            <kwd>Open source</kwd>
            <kwd>Chemical structures</kwd>
            <kwd>Metabolite identification</kwd>
            <kwd>Metabolite</kwd>
            <kwd>Metabolomics</kwd>
          </kwd-group>
          <custom-meta-group>
            <custom-meta>
              <meta-name>publisher-imprint-name</meta-name>
              <meta-value>Chemistry Central</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-issue-count</meta-name>
              <meta-value>1</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-article-count</meta-name>
              <meta-value>39</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-holder</meta-name>
              <meta-value>The Author(s)</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-year</meta-name>
              <meta-value>2012</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-contains-esm</meta-name>
              <meta-value>No</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-year</meta-name>
              <meta-value>2012</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-month</meta-name>
              <meta-value>5</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-day</meta-name>
              <meta-value>18</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-product</meta-name>
              <meta-value>ArchiveJournal</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-grants-type</meta-name>
              <meta-value>OpenChoice</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>metadata-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>abstract-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodypdf-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodyhtml-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bibliography-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>esm-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>online-first</meta-name>
              <meta-value>false</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-file-reference</meta-name>
              <meta-value>BodyRef/PDF/13321_2012_Article_365.pdf</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-type</meta-name>
              <meta-value>Typeset</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>target-type</meta-name>
              <meta-value>OnlinePDF</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-type</meta-name>
              <meta-value>OriginalPaper</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-primary</meta-name>
              <meta-value>Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computer Applications in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Documentation and Information in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Theoretical and Computational Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computational Biology/Bioinformatics</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-collection</meta-name>
              <meta-value>Chemistry and Materials Science</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>open-access</meta-name>
              <meta-value>true</meta-value>
            </custom-meta>
          </custom-meta-group>
        </article-meta>
      </front>
      <body>
        <sec id="Sec1">
          <title>Background</title>
          <p>Computer Assisted Structure Elucidation (CASE) of chemical compounds is one of the classical problems positioned at the intersection of informatics, chemistry, and mathematics. CASE tools have been employed during decades to elucidate the chemical structure of small organic molecules. In its most general definition, a structure elucidation system receives experimental chemistry data of an unknown molecule as input, and outputs a list of possible chemical structures. The input can be the elemental composition of the elusive molecule, nuclear magnetic resonance (NMR) and/or mass spectrometry (MS) spectra (provided the generator can simulate spectra and match it to the experimental ones) or information of prescribed substructures. The output is a list of candidate structures matching these conditions, ideally containing all possible structures without duplications. A small list of candidates is dependent on the number of constraints derived from experimental data; the higher the number of constraints we use the smaller the candidate list will be. The ultimate goal for such a system being fully automated and returning only one and correct molecule is not yet at our reach, despite decades of research [<xref ref-type="bibr" rid="CR1">1</xref>].</p>
          <p>The DENDRAL [<xref ref-type="bibr" rid="CR2">2</xref>] project is widely regarded as the initiator of the use of these methods to provide a system for Computer Assisted Structure Elucidation (CASE). It involved the development of artificial intelligence algorithms that would extract heuristics from MS and NMR data and use them to constrain the output of a structure generator. CONGEN was the structure generator developed within DENDRAL, which preceded a more advanced generator known as GENOA [<xref ref-type="bibr" rid="CR3">3</xref>]. Many commercial structure generators were developed later, most renowned ones being CHEMICS [<xref ref-type="bibr" rid="CR4">4</xref>], ASSEMBLE [<xref ref-type="bibr" rid="CR5">5</xref>], SMOG [<xref ref-type="bibr" rid="CR6">6</xref>], and the most widely used of all of them, the general purpose structure generator MOLGEN [<xref ref-type="bibr" rid="CR7">7</xref>]. These closed source software tools work like a black box, where the user cannot, on the one hand, understand the functioning of the software and on the other hand, customize the tool to his needs. These drawbacks of closed source software (where the source code is not provided) can be circumvented by open source tools. Two open source structure generators have been developed that work with NMR data, the deterministic LSD [<xref ref-type="bibr" rid="CR8">8</xref>] and the stochastic SENECA [<xref ref-type="bibr" rid="CR9">9</xref>]. Implementation of open source stochastic and deterministic structure generators have been explored within the Chemistry Development Kit (CDK) [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. Unfortunately, these generators failed to generate all chemical structures possible and were discontinued in recent releases of CDK. Despite these efforts, no general purpose deterministic structure generator has been developed in an open source format so far.</p>
          <p>The advance of “omics” sciences in the last decade, in particular of metabolomics [<xref ref-type="bibr" rid="CR12">12</xref>], has renewed the interest of researchers in developing better structure generators. Metabolomics aims at detecting and identifying metabolites in an organism and has resulted in a large list of potential biomarkers for which the chemical structure is unknown [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. When trying to identify the structure of unknown molecules, scientists first perform an identity search by querying reference databases using their experimental information [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR16">16</xref>]. In such case, they use the elemental composition of the metabolite derived from mass spectrometry (MS) or the spectra of nuclear magnetic resonance (NMR). When the metabolite is a real unknown it is not present in any database, therefore the query returns no results. This forces scientists to propose candidate structures using a different approach, one of them is using a structure generator [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>], which produces all possible molecules given an elemental composition and optional, other constraints. Examples of constraints are prescribed substructures that each output molecules should contain and that are derived from experimental NMR, MS<sup>2</sup>, or MS<sup>n</sup> data. Hence, the need for deterministic and flexible structure generators in the field of metabolomics presents should be met with new algorithms [<xref ref-type="bibr" rid="CR1">1</xref>].</p>
          <p>The majority of structure generators rely on graph theory to produce their desired output. Interestingly, compounds can be represented as molecular graphs where atoms and bonds are translated into vertices and edges, respectively, to which theorems and algorithms proposed by graph theory can be applied. This ensures that the output is correct, exhaustive, and free of isomorphs. Such methods can be the orderly enumeration proposed by Read [<xref ref-type="bibr" rid="CR19">19</xref>] and Faradzev [<xref ref-type="bibr" rid="CR20">20</xref>], a stochastic generator [<xref ref-type="bibr" rid="CR21">21</xref>], the homomorphism principle [<xref ref-type="bibr" rid="CR22">22</xref>] used by MOLGEN, or the “canonical augmentation path” proposed by McKay [<xref ref-type="bibr" rid="CR23">23</xref>]. This last method, originally intended to generate simple graphs by adding vertices, has been applied to the generation of some families of graphs and also to generate the chemical universe of molecules up to 11 atoms [<xref ref-type="bibr" rid="CR24">24</xref>] and recently to 13 atoms [<xref ref-type="bibr" rid="CR25">25</xref>]. Despite the goal was to generate molecules, these two approaches initially employed canonical path augmentation to generate all possible simple graphs up to 11 and 13 vertices, respectively. Posterior topological and ring system filter were used to remove unwanted graphs. Lastly, the vertices were colored with chemical elements and the edges with a bond order, which turned the graphs into molecules. Simple chemical constraints like connectivity and atom valence were applied to reduce the list of final molecules. This process, which relies on generating simple graph, is necessarily limited on the size of the molecules that can be generated because a linear increase in the number of atoms produces an exponential increase of both the number of graphs and molecules. Here we present the Open Molecule Generator (OMG), a structure generator based too on McKay augmentation algorithms, but rather than first generating graphs and secondly transforming these graphs into molecules, our implementation of McKay technique directly constructs molecules. In this way we can generate chemical structures much greater than 13 atoms. Essential concepts of graph theory will be introduced in the methods section.</p>
          <p>Chen mentioned two future challenges facing CASE systems [<xref ref-type="bibr" rid="CR26">26</xref>]. The first challenge for elucidating structures is to have a knowledge system of previously identified compounds, as well as mining tools for such data. In this direction, Rojas-Chertó et al. [<xref ref-type="bibr" rid="CR27">27</xref>] developed a system to store spectral data and mine the database to extract substructure information that can be used as prescribed substructures in our structure generator. The second challenge is the need for filtering and selecting candidate structures. This is often performed by predicting a property of the candidate structures that is related to the field of research, for instance, predicting the spectra in analytical chemistry, the bioactivity in ligand design, or the Metabolite-Likeness [<xref ref-type="bibr" rid="CR28">28</xref>] in metabolomics studies, to name a few. Furthermore, the need of a structure generator tool that can be adapted to the requirements of the field in which it is going to be applied, demonstrates the usefulness of open source tools compared to commercial "black box" generators.</p>
          <p>In this paper we present the first general purpose open source structure generator, Open Molecule Generator. OMG adapts methodologies from the field of graph theory and deterministic graph enumeration to the classical problem of chemical structure generation. In this sense, we have used the approach of “canonical path augmentation” to ensure that we exhaustively generate non-isomorphic chemical structures for a given elemental composition. This generation tool has been implemented using CDK [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>], a widely used open source library for the development of chemoinformatics software. It allowed the representation of entities such as molecules, atoms, and bonds in our program and the use of functions like removing hydrogen atoms, checking the saturation of a molecule, removing a bond, and many more. The resulting tool generates all possible non-duplicate chemical structures for a given elemental composition, with the option to generate only those that contain one or multiple non-overlapping substructures, which is the most important constrain to reduce the number of resulting candidate structures when a knowledge system is not available [<xref ref-type="bibr" rid="CR18">18</xref>]. We have used OMG to generate molecules for the elemental composition of well known metabolites, also including one or more prescribed substructures as input. These results are compared to those obtained by MOLGEN.</p>
        </sec>
        <sec id="Sec2" sec-type="materials|methods">
          <title>Materials and methods</title>
          <sec id="Sec3">
            <title>Chemical elements and atom types</title>
            <p>We would like to describe some concepts related to atoms that are necessary to understand the theory and algorithm behind OMG and the use of CDK to handle chemistry.</p>
            <p>In nature, atoms of different chemical elements (carbon, nitrogen, oxygen, and others) are connected to each other by bonds in order to form molecules. The valence, to which we will also refer as degree, of these chemical elements determine how many bonds each element can have. Carbon has a valence of 4, oxygen of 2, nitrogen of 3 or 5, sulfur of 2,4 or 6, phosphor of 3 or 5. Thus a carbon atom becomes saturated when it has 4 bonds, where a single bond counts as one bond, a double as two bonds, and a triple as three bonds. Regarding molecules, we consider a molecule to be saturated when all its atoms are saturated. In some special occasions, atoms are charged, which makes them having a different valence. In the case of OMG, we only use neutral atoms and as a consequence only neutral molecules are produced, therefore all finished molecules will contain atoms with the valences mentioned before.</p>
            <p>A chemical element can have multiple atom types, also for the same valence of an element, as defined by the dictionary of atom types in CDK. This dictionary defines for each atom the number of neighbors, pi bonds, charges, lone electron pairs, and hybridizations, in order to accommodate the different states a chemical element can have due to different bonds, number of neighboring atoms, charges and hybridizations. These atom types are based on the chemical elements that have been observed in nature for saturated molecules. This is why we use the CDK atom dictionary to validate the atoms of our finished molecules.</p>
            <p>OMG will output only molecules that are saturated and that contain the atoms specified in the elemental composition. Apart from finished molecules, OMG has to represent during the generation process intermediate chemical structures that are not finished yet. These might contain disconnected fragments and atoms that are not saturated. CDK atom types are not designed to represent atom types of unsaturated chemical elements; therefore we opted for implementing a simple atom dictionary. For each chemical element, this dictionary defines its valence, in other words, the maximum degree. Hence for intermediate chemical structures we only check that the current degree of each atom does not exceed the maximum degree.</p>
            <p>MOLGEN can also produce molecules with multiple valences, but it handles them in a different way. While with OMG only the elemental composition needs to be provided to generate molecules with multiple valences, MOLGEN requires knowing a priori which one of the multiple valences has to be used. It uses by default the lowest valence, this is, N valence 3, P valence 3, and S valence 2, unless a different valence is specified. In Table <xref rid="Tab1" ref-type="table">1</xref> the atom types produced by OMG and MOLGEN for non-default valences are presented. Using sulfur as an example, OMG will output molecules with containing sulfur valence 2, 4 and 6. For the same chemical element, MOLGEN will produce by default molecules with sulfur valence 2. If one sets the valence of sulfur to 6, it will only produce sulfur valence 6 and not valence 2 and valence 4. MOLGEN cannot generate molecules with atoms of different valences for the same chemical element, this is, if molecule has two sulfur atoms, one will not be of valence 4 and the other of valence 6, both will be either valence 2, 4 or 6.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p><bold>Atom types produced by OMG and MOLGEN for non-default valences of N(5), P(5) and S(4 and 6)</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th><p>Valence</p></th><th><p>MOLGEN</p></th><th><p>OMG</p></th></tr></thead><tbody><tr><td><p><bold>N valence 5</bold></p></td><td><p><inline-formula id="IEq1"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq1_HTML.gif" /></inline-formula></p></td><td><p><inline-formula id="IEq2"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq2_HTML.gif" /></inline-formula></p></td></tr><tr><td><p><bold>P valence 5</bold></p></td><td><p><inline-formula id="IEq3"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq3_HTML.gif" /></inline-formula></p></td><td><p><inline-formula id="IEq4"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq4_HTML.gif" /></inline-formula></p></td></tr><tr><td><p><bold>S valencee 4</bold></p></td><td><p><inline-formula id="IEq5"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq5_HTML.gif" /></inline-formula></p></td><td><p><inline-formula id="IEq6"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq6_HTML.gif" /></inline-formula></p></td></tr><tr><td><p><bold>S valence 6</bold></p></td><td><p><inline-formula id="IEq7"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq7_HTML.gif" /></inline-formula></p></td><td><p><inline-formula id="IEq8"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq8_HTML.gif" /></inline-formula></p></td></tr></tbody></table><table-wrap-foot><p>By default OMG outputs molecules with valences N(3 and 5), P(3 and 5), and S (2,4 and 6). By default MOLGEN outputs molecules with valences N(3), P(3), and S(2).</p></table-wrap-foot></table-wrap></p>
            <p>The principle followed by CDK to build its atom dictionary is to allow atom types with valences for which there is a consensus agreement on their existence, this is, for which known molecules exist with such valences. Conversely, MOLGEN produces all theoretically possible combinations of bond orders for a given valence, as it can be observed in Table <xref rid="Tab1" ref-type="table">1</xref>. For example, as it can be seen for P valence 5 OMG only produces one atom type with one double bond and three single bonds. In comparison, MOLGEN produces all the combinations of single, double, and triple bonds that add to 5. As a consequence, when the desired valence is unknown, which is usually the case in metabolite identification, molecules need to be generated with all possible valences. As a result, the number of output molecules by both generators is different for elemental compositions that contain chemical elements with multiple valences. This deterministic generation of valences in MOLGEN comes at the expense of generating molecules having unrealistic structures.</p>
          </sec>
          <sec id="Sec4">
            <title>Graph theory and chemistry</title>
            <p>The chemical structure of molecules can be represented as a graph, where atoms and bonds in molecules correspond to vertices and edges, respectively, in graphs. In molecules, bonds connecting two atoms can have a degree depending on the number of electrons they share. Such a degree can also be assigned to the edges of a graph, which is called a multigraph. The different chemical elements present in the periodic table are represented in graphs as colors assigned to the vertices. We define a non-directed colored multigraph <italic>G</italic> = (<italic>V</italic>, <italic>E</italic>) as where <italic>V</italic> is a set of vertices and <italic>E</italic> is a multiset of edges, where each edge is an unordered pair of vertices, and a function <italic>Col</italic> : <italic>V</italic> → <italic>colors</italic>. In this multigraph, we say that <italic>a</italic>, <italic>b</italic> ∈ <italic>V</italic> are <italic>n-connected</italic> if there are exactly <italic>n</italic> edges (<italic>a</italic>, <italic>b</italic>) ∈ <italic>V</italic>. Apart from the color function, a multigraph is characterized by the function <italic>d</italic> : <italic>V</italic> × <italic>V</italic> → <italic>N</italic> which returns the degree of the edge connecting each couple of vertices. From now on we will indistinctively refer to graphs and multigraphs.</p>
            <p>In chemistry, the valence rule determines the maximum number of bonds each chemical element has. In order to take this into account, we define <italic>d</italic><sub><italic>v</italic></sub> : <italic>V</italic> → <italic>N</italic> which returns the number of edges of a given vertex and a <italic>max-degree</italic> function <italic>md</italic> : <italic>V</italic> → <italic>M</italic>, which returns the maximum number of edges of a given vertex. We say that a multigraph is under-saturated if ∀ <italic>v</italic> ∈ <italic>V</italic>, <italic>d</italic><sub><italic>v</italic></sub>(<italic>v</italic>) ≤ <italic>md</italic>(<italic>v</italic>) there is at least one vertex such that <italic>d</italic><sub><italic>v</italic></sub>(<italic>v</italic><sup>′</sup>) &lt; <italic>md</italic>(<italic>v</italic><sup>′</sup>). A multigraph is saturated if the equality <italic>dv</italic> = <italic>md</italic> holds for every vertex. In chemistry, molecules correspond to saturated colored multigraphs and <italic>max-degree</italic> depends on the color, which is the chemical element. For instance, for a carbon element, <italic>md</italic>(<italic>C</italic>) = 4  and for an oxygen element, <italic>md</italic>(<italic>O</italic>) = 2.</p>
            <p>We consider a multigraph to be connected if ∀ <italic>v</italic>, <italic>w</italic> ∈ <italic>V</italic>,  ∃ <italic>S</italic><sub>{<italic>V</italic>,<italic>W</italic>}</sub> = {<italic>v</italic><sub>1</sub>, ⋯, <italic>v</italic><sub><italic>m</italic></sub>} such that <italic>v</italic>, <italic>v</italic><sub>1</sub> and <italic>v</italic><sub><italic>m</italic></sub>, <italic>w</italic> are connected and for each <italic>i</italic> &lt; <italic>m</italic>, <italic>v</italic><sub><italic>i</italic></sub> is connected to <italic>v</italic><sub><italic>i</italic> + 1</sub>. In other words, a multigraph is connected if for all pair of vertices, there exists at least one path <italic>S</italic><sub>{<italic>V</italic>,<italic>W</italic>}</sub> connecting both vertices. This condition is necessary for chemistry, since intermediate chemical structures in the generation process can be composed of disconnected fragments, it ensures that the generated molecules are one fully connected structure and not made of disconnected substructures. Notice that hydrogen atoms (the most frequently found chemical elements with degree 1) are not considered in the generation process, since they are terminal elements of the molecule and they cannot connect two disconnected elements of the molecule. Hydrogen atoms are only used to validate the completeness of finished molecules. Halogen atoms like fluorine, chlorine, and iodine, also of degree 1, are considered during the generation process.</p>
          </sec>
          <sec id="Sec5">
            <title>Graph labeling</title>
            <p>An isomorphism π is a function that for each vertex <italic>v</italic> ∈ <italic>V</italic>, <italic>Col</italic>(<italic>π</italic>(<italic>v</italic>)) = <italic>Col</italic>(<italic>v</italic>) and for each pair of vertices <italic>v</italic> ∈ <italic>V</italic>, <italic>v</italic> <sup>′</sup> ∈ <italic>V</italic> <sup>′</sup>, <italic>d</italic>(<italic>π</italic>(<italic>v</italic>), <italic>π</italic>(<italic>v</italic><sup>′</sup>)) = <italic>d</italic>(<italic>v</italic>, <italic>v</italic><sup>′</sup>). A labeling function <italic>σ</italic> : <italic>V</italic> → {1, ⋯, <italic>n</italic>} is a bijective map from the vertices of a colored multigraph to an ordered list labels with a cardinality equal to the number of vertices. Put simple σ, assigns to each vertex a label. Let <italic>σ</italic><sup>− 1</sup> be the inverse function of σ, which returns the vertex corresponding to a label. We say a labeling function is canonical if given any two isomorphic colored multigraphs <italic>G</italic> = (<italic>V</italic>, <italic>E</italic>) and <italic>G</italic> <sup>′</sup> = (<italic>V</italic> <sup>′</sup>, <italic>E</italic> <sup>′</sup>), the bijective function <italic>π</italic> : <italic>V</italic> → <italic>V</italic> <sup>′</sup> defined as <italic>π</italic>(<italic>a</italic>) = <italic>σ</italic><sup>− 1</sup>(<italic>σ</italic>(<italic>a</italic>)) is an isomorphism of <italic>V</italic> in  <italic>V</italic> <sup>′</sup>. Therefore, a canonically labeled multigraph is a multigraph whose vertices are associated to an ordered list through a canonical labeling function. Furthermore, a canonical hash of the labeling is a bijective function between the space of the canonically labeled multigraphs and the value space and it is represented as a string of integers. It is interesting to note here that two isomorphic graphs have the same canonical hash, a fact that will be used to remove duplicated molecules during the generation process.</p>
          </sec>
          <sec id="Sec6">
            <title>Using fragments</title>
            <p>A fragment or substructure of a molecule is equivalent to a fragment or subgraph of a graph. We define a fragment as a subset of a graph and it is characterized by the function <italic>d</italic><sub><italic>f</italic></sub> : <italic>V</italic> × <italic>V</italic> → <italic>N</italic> where <italic>N</italic> is the number of edges connecting each pair of vertices in the subgraph. Such <italic>d</italic><sub><italic>f</italic></sub> has to fulfill the condition <italic>d</italic><sub><italic>f</italic></sub>(<italic>a</italic>, <italic>b</italic>) ≤ <italic>d</italic>(<italic>a</italic>, <italic>b</italic>), ∀ <italic>a</italic>, <italic>b</italic> ∈ <italic>V</italic> and at least for one edge <italic>d</italic><sub><italic>f</italic></sub> &lt; <italic>d</italic>, this is, the fragment should have fewer edges than the graph.</p>
          </sec>
          <sec id="Sec7">
            <title>Canonical augmentation</title>
            <p>An augmentation of a multigraph <italic>G</italic> = (<italic>V</italic>, <italic>E</italic>) is a multigraph <italic>G</italic><sup>′</sup> = (<italic>V</italic><sup>′</sup>, <italic>E</italic><sup>′</sup>), defined on the same set of vertices, such that <inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq9_HTML.gif" /></alternatives></inline-formula>, except for one and only one pair where  <italic>d</italic><sub><italic>G</italic> ′</sub>(<italic>a</italic>, <italic>b</italic>) = <italic>d</italic><sub><italic>G</italic></sub>(<italic>a</italic>, <italic>b</italic>) + 1. Let <italic>e</italic> <sup>′</sup> ∈ <italic>E</italic> <sup>′</sup> be the edge which degree has been increased, <italic>d</italic>(<italic>e</italic><sup>′</sup>) = <italic>d</italic>(<italic>e</italic>) + 1.</p>
            <p>Let <italic>e</italic><sup><italic>c</italic> ′</sup> be the last edge of <italic>σ</italic>(<italic>G</italic><sup>′</sup>) and <italic>a</italic><sup><italic>c</italic> ′</sup>, <italic>b</italic><sup><italic>c</italic> ′</sup> ∈ <italic>V</italic> the vertices of <italic>e</italic><sup><italic>c</italic> ′</sup>. Consider <italic>σ</italic><sup>− 1</sup>(<italic>a</italic><sup><italic>c</italic> ′</sup>, <italic>b</italic><sup><italic>c</italic> ′</sup>) = <italic>a</italic> <sup>′</sup> <sup>′</sup>, <italic>b</italic> <sup>′</sup> <sup>′</sup> to vertices of <italic>G</italic> <sup>′</sup> <sup>′</sup>, a copy of <italic>G</italic><sup>′</sup>, to which a bond order decrease is performed <italic>d</italic>(<italic>a</italic><sup>′ ′</sup>, <italic>b</italic><sup>′ ′</sup>) = <italic>d</italic>(<italic>a</italic><sup>′ ′</sup>, <italic>b</italic><sup>′ ′</sup>) − 1. The resulting multigraph <italic>G</italic><sup>′ ′</sup> after this decrease in bond order, can be seen as the result of a canonical deletion on <italic>G</italic><sup>′</sup>, the reverse operation of a canonical augmentation. In our definition of canonical augmentation we consider a multigraph <italic>G</italic><sup>′</sup> = (<italic>V</italic><sup>′</sup>, <italic>E</italic><sup>′</sup>) to be canonically augmented from <italic>G</italic> = (<italic>V</italic>, <italic>E</italic>) if it is an augmentation and <italic>σ</italic>(<italic>G</italic><sup>′</sup> <sup>′</sup>) = <italic>σ</italic>(<italic>G</italic>). In other words, we consider <italic>G</italic><sup>′</sup> to be a canonical augmentation of <italic>G</italic> if a canonical deletion in <italic>G</italic><sup>′</sup> results in <italic>G</italic>.</p>
          </sec>
          <sec id="Sec8">
            <title>Description of the algorithm</title>
            <p>The generation of structures can be seen as a tree of intermediate chemical structures that our tool explores. At the root of the tree we find a collection of fully isolated/disconnected atoms. One bond is added at each level of the tree, resulting in fully connected/finished molecules at the leaves. The canonical augmentation path is a depth-first backtracking algorithm, where the recursive function <italic>generate</italic> described in Algorithm 1, implements the addition of one bond in all possible ways for a given intermediate chemical structure, and evaluates for each extended molecule that this extension has been performed in a canonical way, as described before. Here adding one bond means increasing the degree of the bond between two atoms, hence a single bond becomes a double bond and a double bond becomes a triple bond. If there is no bond between two atoms, a single bond is created.</p>
            <p>Between lines 2 and 9 of Algorithm 1, the molecule is stored if it is finished, which occurs when the molecule is saturated and all the atoms of the elemental composition, including the hydrogen atoms, have been used, all the atoms are validated by the CDK atom dictionary and are connected forming one single structure and not multiple disconnected fragments.</p>
            <p>In the case the molecule is not finished, it would be extended in all possible ways by adding one bond. If there exists a bond between a pair of atoms function <italic>extend</italic>, in line 12 of Algorithm 1, will increase the multiplicity. The generation of new bonds is controlled by OMG atom type definitions for intermediate chemical structures, which guarantee that the degree of the atoms does not exceed the maximum degree allowed for its chemical element.</p>
            <p>Function <italic>canonize</italic>, in line 15 of Algorithm 1, returns the canonical version of the molecule. We modified the graph canonizer Nauty [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR29">29</xref>] in order to allow multigraphs and not only simple graphs. Other canonizers for graphs exist like MOLGEN-CID [<xref ref-type="bibr" rid="CR30">30</xref>] or the Signature Canonizer [<xref ref-type="bibr" rid="CR31">31</xref>], but Nauty has been the most widely used for graphs as well as for chemistry problems, like InChI [<xref ref-type="bibr" rid="CR32">32</xref>] codes. Nauty is the canonizer of choice because it is the fastest of all available canonizers for bounded valence graphs below 100 vertices [<xref ref-type="bibr" rid="CR33">33</xref>] (molecules are examples of this class of graphs). Firstly, the function <italic>canonize</italic> translates the molecule into a colored multigraph. Secondly, it utilizes Nauty to calculate the canonical labeling of the multigraph. Thirdly, this canonical labeling is used to construct the canonical version of the input molecule. Lastly, the canonical hash string of each augmented molecule is stored in a hash map, lines 16 and 17, in order to remove duplicated extensions at each level of the tree. Each unique extension is checked for canonical augmentation, line 18, using Algorithm 2, or Algorithm 3 in case prescribed substructures were provided. If this extension is successful, the function <italic>generate</italic> is called, line 19 of Algorithm 1, and the molecule we want to continue extending is passed as a parameter. When a molecule cannot be extended any further, the recursion is terminated and the program backtracks in the search tree.</p>
          </sec>
          <sec id="Sec9">
            <title>Input and output</title>
            <p>The minimum input required is the elemental composition of the structures that have to be generated. Optionally, a structure-data file (SDF) can be provided containing one or more prescribed substructures that we want our output molecules to contain. Since OMG does not take hydrogen atoms into account during the generation of intermediate chemical structures, the hydrogen atoms present in the substructures will be removed before the generation process begins. These substructures should be non-overlapping, i.e. they should not share any atoms. This limitation is due to the fact that our algorithm grows molecules by adding bonds and, if two atoms in different fragments were in fact the same atom, our algorithm would create bonds between those atoms, which would clearly lead to incorrect results.</p>
            <p>In practice, multiple substructures can be available, but the user does not know if they overlap. This limitation can be circumvented by using the largest substructure as constraint for the generation and the remaining substructures as a posterior filtering, only keeping the molecules with those substructures.</p>
            <p>By default, the structure generator returns the count of molecules it generated. Optionally, it can store all the molecules in an SDF file. If prescribed fragments are provided, OMG outputs only the molecules containing such fragments. We have opted to use SDF as our input and output format, but via CDK, other formats can easily be implemented in OMG.</p>
          </sec>
          <sec id="Sec10">
            <title>Data</title>
            <p>As mentioned in the introduction, the identification of the chemical structure of metabolites is one of the current bottlenecks of metabolomics. In this sense, a structure generator can contribute to overcome this bottleneck, since it can provide candidate structures for an unknown metabolite. Therefore, metabolites appear to be a relevant family of compounds to test our structure generator. A list of metabolites was selected and their elemental composition was compiled to evaluate the performance of our structure generator on different inputs. The source of the compounds employed was the Human Metabolome Database (HMDB) [<xref ref-type="bibr" rid="CR34">34</xref>], which contains almost 8,000 metabolites and is the most comprehensive database of human metabolites. A study of the human metabolite space and the properties of the metabolites that occupy it, has been previously reported [<xref ref-type="bibr" rid="CR28">28</xref>]. The selection criteria were to include cyclic and acyclic compounds, of different molecular weights, and containing different chemical elements like C, O, N, P, and S. A first test set included metabolites with C, O, and H, chemical elements with one valence. A second test set included metabolites with C,O,H and also chemical elements with multiple valences, like N, P, and S. Furthermore, for some of these metabolites, several substructures were drawn and provided to the structure generator as additional input. These substructures are easily identified by an expert from direct inspection of MS<sup>2</sup> or MS<sup>n</sup> experimental data. The aim was to assess the importance of having fragment information to reduce the list of generated structures.</p>
          </sec>
        </sec>
        <sec id="Sec11">
          <title>Results and discussion</title>
          <sec id="Sec12">
            <title>Structure generation from elemental formula</title>
            <p>The algorithm presented in this work, the Open Molecule Generator, was tested and compared with the commercial structure generator, MOLGEN. Both generators take resonance into account producing all the contributing structures. As a result, the two resonant forms of benzene will be considered as different molecules. Both OMG and MOLGEN are not limited to acyclic structures [<xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR36">36</xref>],thus the two structure generators tested can generate molecules with rings. Furthermore, both tools generate molecules containing common chemical elements present in metabolites, like C, O, N, H, P, and S, and are not limited to only 4 chemical elements [<xref ref-type="bibr" rid="CR36">36</xref>]. Both structure generators generate molecules for a given elemental composition by exhaustively producing all non-redundant chemical structures.</p>
            <p>The number of molecules produced after using the elemental compositions of a diverse selection of metabolites containing only C, O and H, is presented in Table <xref rid="Tab2" ref-type="table">2</xref>. For all these metabolites, the same number of molecules is generated by both generators. While both generators produce complete results, MOLGEN does it in less time. The time between initialization and finalization was measured using time functions in JAVA for OMG and equivalent functions in python for MOLGEN. We can observe in Table <xref rid="Tab2" ref-type="table">2</xref> the time in seconds to generate all the candidate structures and the time to generate each molecule in milliseconds. If we look at time per molecule, MOLGEN is 4 times faster than OMG for small molecules like pyruvic acid. For larger molecules MOLGEN obtains a constant time per molecule between 0.008 and 0.009 milliseconds, while OMG ranges from 18 to 45 milliseconds depending on the elemental composition. Lightweight profiling of OMG was performed using VisualVM (version 1.3.4), in order to have an understanding of the limiting points in the performance of OMG. The most relevant finding was that the canonization process, which uses Nauty, took half of the total running time.<table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p><bold>Number of chemical structures generated by OMG and MOLGEN using as input only the elemental compositions of metabolites containing C,O and H elements</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="center" rowspan="2"><p>Structure</p></th><th align="center" rowspan="2"><p>Name HMDB ID elemental composition</p></th><th align="center" colspan="3"><p>MOLGEN</p></th><th align="center" colspan="3"><p>OMG</p></th></tr><tr><th align="center"><p># Candidate structures</p></th><th align="center"><p>Time (s)</p></th><th align="center"><p>Time per molecule (ms)</p></th><th align="center"><p># Candidate structures</p></th><th align="center"><p>Time (s)</p></th><th align="center"><p>Time per molecule (ms)</p></th></tr></thead><tbody><tr><td align="center"><p><inline-formula id="IEq10"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq10_HTML.gif" /></inline-formula></p></td><td align="center"><p>Pyruvic acid HMDB00243 C3H4O3</p></td><td align="center"><p>152</p></td><td align="center"><p>0.129</p></td><td align="center"><p>0.849</p></td><td align="center"><p>152</p></td><td align="center"><p>0.509</p></td><td align="center"><p>3.349</p></td></tr><tr><td align="center"><p><inline-formula id="IEq11"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq11_HTML.gif" /></inline-formula></p></td><td align="center"><p>Malic acid HMDB00156 C4H6O5</p></td><td align="center"><p>8,070</p></td><td align="center"><p>0.222</p></td><td align="center"><p>0.028</p></td><td align="center"><p>8,070</p></td><td align="center"><p>27.074</p></td><td align="center"><p>3.355</p></td></tr><tr><td align="center"><p><inline-formula id="IEq12"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq12_HTML.gif" /></inline-formula></p></td><td align="center"><p>D-Xylose HMDB00098 C5H10O5</p></td><td align="center"><p>18,092</p></td><td align="center"><p>0.332</p></td><td align="center"><p>0.018</p></td><td align="center"><p>18,092</p></td><td align="center"><p>125.783</p></td><td align="center"><p>6.952</p></td></tr><tr><td align="center"><p><inline-formula id="IEq13"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq13_HTML.gif" /></inline-formula></p></td><td align="center"><p>D-Fructose HMDB00660 C6H12O6</p></td><td align="center"><p>267,258</p></td><td align="center"><p>2.381</p></td><td align="center"><p>0.009</p></td><td align="center"><p>267,258</p></td><td align="center"><p>5,035.371</p></td><td align="center"><p>18.841</p></td></tr><tr><td align="center"><p><inline-formula id="IEq14"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq14_HTML.gif" /></inline-formula></p></td><td align="center"><p>Sedoheptulose HMDB03219 C7H14O7</p></td><td align="center"><p>4,106,823</p></td><td align="center"><p>38.945</p></td><td align="center"><p>0.009</p></td><td align="center"><p>4,106,823</p></td><td align="center"><p>186,248.085</p></td><td align="center"><p>45.351</p></td></tr><tr><td align="center"><p><inline-formula id="IEq15"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq15_HTML.gif" /></inline-formula></p></td><td align="center"><p>Pectin HMDB03402 C6H10O7</p></td><td align="center"><p>3,183,337</p></td><td align="center"><p>26.512</p></td><td align="center"><p>0.008</p></td><td align="center"><p>3,183,337</p></td><td align="center"><p>46,320.522</p></td><td align="center"><p>14.551</p></td></tr><tr><td align="center"><p><inline-formula id="IEq16"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq16_HTML.gif" /></inline-formula></p></td><td align="center"><p>Galactonic acid HMDB00565 C6H12O7</p></td><td align="center"><p>767,569</p></td><td align="center"><p>6.957</p></td><td align="center"><p>0.009</p></td><td align="center"><p>767,569</p></td><td align="center"><p>22,475.987</p></td><td align="center"><p>29.282</p></td></tr><tr><td align="center"><p><inline-formula id="IEq17"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq17_HTML.gif" /></inline-formula></p></td><td align="center"><p>Galactaric acid HMDB00639 C6H10O8</p></td><td align="center"><p>8,568,129</p></td><td align="center"><p>78.354</p></td><td align="center"><p>0.009</p></td><td align="center"><p>8,568,129</p></td><td align="center"><p>186,730.365</p></td><td align="center"><p>21.794</p></td></tr><tr><td align="center"><p><inline-formula id="IEq18"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq18_HTML.gif" /></inline-formula></p></td><td align="center"><p>Cholic acid HMDB00619 C24H40O5</p></td><td align="center"><p>* More than 2,147,483,646</p></td><td align="center"><p>* not available</p></td><td align="center"><p>* not available</p></td><td align="center"><p>* More than 2,147,483,646</p></td><td align="center"><p>* not available</p></td><td align="center"><p>* not available</p></td></tr><tr><td align="center"><p><inline-formula id="IEq19"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq19_HTML.gif" /></inline-formula></p></td><td align="center"><p>Phenyllactic acid HMDB00779 C9H10O3</p></td><td align="center"><p>48,496,265</p></td><td align="center"><p>404.052</p></td><td align="center"><p>0.008</p></td><td align="center"><p>** More than 48,496,265</p></td><td align="center"><p>** not available</p></td><td align="center"><p>** not available</p></td></tr></tbody></table><table-wrap-foot><p>*Results were not generated due to excessive computational time needed to generate all the candidate structures. However, we expect OMG to generate more molecules than MOLGEN, due to the larger amount of atom types produced by OMG.</p><p>**Results were not generated due to excessive computational time needed to generate all the candidate structures.</p></table-wrap-foot></table-wrap></p>
            <p>We observed that MOLGEN stops the generation of molecules after two billion molecules, as it can be observed for a large molecule like cholic acid (Table <xref rid="Tab2" ref-type="table">2</xref>). Since both generators produce the same molecules for elemental composition with C, O and H, we can only assume that more than two billion molecules could be generated. In the case of phenyllactic acid, MOLGEN produces more than 48 million molecules in 404 seconds. Due to excessive computational time, no results for this elemental composition are reported for OMG, though the same number of molecules is expected (if executed for enough time) as is the case for all the other elemental compositions in this subset.</p>
            <p>As stated in Methods, both generators treat atoms having multiple valences in different ways, this is the reason to use a second set of molecules containing also N, P and S. The default valences used by MOLGEN for N is 3, for P is 3, and for S is 2, unless stated otherwise. The results for these molecules are presented in Table <xref rid="Tab3" ref-type="table">3</xref>. As expected, the number of candidate structures differs between both generators. For the elemental composition of glycine, MOLGEN produces 84 molecules only with N valence 3 and 162 molecules only with N valence 5. For the same elemental composition, OMG produces 97 molecules with valence 3 and 5 for N, which include the 84 of MOLGEN N valence 3 and 13 additional molecules with valence 5, containing N with the atom types depicted in Table <xref rid="Tab1" ref-type="table">1</xref> for OMG-CDK. The difference in the number of candidate structures is larger for elemental compositions containing many atoms with multiple valences, as is the case of creatinine. For this metabolite, MOLGEN generates 93,323 candidate structures with the default valence 3 for N. On the contrary, OMG produces 303,601 candidate structures, containing N valence 3 and 5.<table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p><bold>Number of chemical structures generated by OMG and MOLGEN using as input only the elemental compositions of metabolites containing C, O, H, N, P and S elements</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="center" rowspan="2"><p>Structure</p></th><th align="center" rowspan="2"><p>Name HMDB ID elemental composition</p></th><th align="center" colspan="3"><p>MOLGEN</p></th><th align="center" colspan="3"><p>OMG</p></th></tr><tr><th align="center"><p># Candidate structures</p></th><th align="center"><p>Time (s)</p></th><th align="center"><p>Time per molecule (ms)</p></th><th align="center"><p># Candidate structures</p></th><th align="center"><p>Time (s)</p></th><th align="center"><p>Time per molecule (ms)</p></th></tr></thead><tbody><tr><td align="center"><p><inline-formula id="IEq20"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq20_HTML.gif" /></inline-formula></p></td><td align="center"><p>Glycine HMDB00123 C2H5NO2</p></td><td align="center"><p>N_3 84</p></td><td align="center"><p>0.118</p></td><td align="center"><p>1.405</p></td><td align="center"><p>97</p></td><td align="center"><p>0.452</p></td><td align="center"><p>4.660</p></td></tr><tr><td /><td /><td align="center"><p>N_5 162</p></td><td align="center"><p>0.120</p></td><td align="center"><p>0.741</p></td><td /><td /><td /></tr><tr><td align="center"><p><inline-formula id="IEq21"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq21_HTML.gif" /></inline-formula></p></td><td align="center"><p>Acetyl-HMDB00532 C4H7NO3</p></td><td align="center"><p>18,469</p></td><td align="center"><p>0.282</p></td><td align="center"><p>0.015</p></td><td align="center"><p>26,530</p></td><td align="center"><p>126.117</p></td><td align="center"><p>4.754</p></td></tr><tr><td align="center"><p><inline-formula id="IEq22"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq22_HTML.gif" /></inline-formula></p></td><td align="center"><p>Phenylalanine HMDB00159 C9H11NO2</p></td><td align="center"><p>277,810,163</p></td><td align="center"><p>2227.796</p></td><td align="center"><p>0.008</p></td><td align="center"><p>* More than 277,810,163</p></td><td align="center"><p>* not available</p></td><td align="center"><p>* not available</p></td></tr><tr><td align="center"><p><inline-formula id="IEq23"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq23_HTML.gif" /></inline-formula></p></td><td align="center"><p>Glutamic acid HMDB00148 C5H9NO4</p></td><td align="center"><p>440,821</p></td><td align="center"><p>2.945</p></td><td align="center"><p>0.007</p></td><td align="center"><p>685,392</p></td><td align="center"><p>12,348.456</p></td><td align="center"><p>18.017</p></td></tr><tr><td align="center"><p><inline-formula id="IEq24"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq24_HTML.gif" /></inline-formula></p></td><td align="center"><p>Phosphoenolpyruvic acid HMDB00263 C3H5O6P</p></td><td align="center"><p>P_3 51,323</p></td><td align="center"><p>0.562</p></td><td align="center"><p>0.011</p></td><td align="center"><p>83,977</p></td><td align="center"><p>761.378</p></td><td align="center"><p>9.067</p></td></tr><tr><td /><td /><td align="center"><p>P_5 129,421</p></td><td align="center"><p>1.398</p></td><td align="center"><p>0.011</p></td><td /><td /><td /></tr><tr><td align="center"><p><inline-formula id="IEq25"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq25_HTML.gif" /></inline-formula></p></td><td align="center"><p>Creatinine HMDB00562 C4H7N3O</p></td><td align="center"><p>93,323</p></td><td align="center"><p>0.933</p></td><td align="center"><p>0.010</p></td><td align="center"><p>303,601</p></td><td align="center"><p>3,921.157</p></td><td align="center"><p>12.915</p></td></tr><tr><td align="center"><p><inline-formula id="IEq26"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq26_HTML.gif" /></inline-formula></p></td><td align="center"><p>Guanidinoacetic acid HMDB00128 C3H7N3O2</p></td><td align="center"><p>45,626</p></td><td align="center"><p>0.585</p></td><td align="center"><p>0.013</p></td><td align="center"><p>124,808</p></td><td align="center"><p>1,962.532</p></td><td align="center"><p>15.724</p></td></tr><tr><td align="center"><p><inline-formula id="IEq27"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq27_HTML.gif" /></inline-formula></p></td><td align="center"><p>Cytosine HMDB00630 C4H5N3O</p></td><td align="center"><p>108,769</p></td><td align="center"><p>1.149</p></td><td align="center"><p>0.011</p></td><td align="center"><p>491,299</p></td><td align="center"><p>3,952.098</p></td><td align="center"><p>8.044</p></td></tr><tr><td align="center"><p><inline-formula id="IEq28"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq28_HTML.gif" /></inline-formula></p></td><td align="center"><p>Uric acid HMDB00289 C5H4N4O3</p></td><td align="center"><p>464,899,034</p></td><td align="center"><p>3488.097</p></td><td align="center"><p>0.008</p></td><td align="center"><p>* More than 464,899,034</p></td><td align="center"><p>* not available</p></td><td align="center"><p>* not available</p></td></tr><tr><td align="center"><p><inline-formula id="IEq29"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq29_HTML.gif" /></inline-formula></p></td><td align="center"><p>Histamine HMDB00870 C5H9N3</p></td><td align="center"><p>46,125</p></td><td align="center"><p>0.631</p></td><td align="center"><p>0.014</p></td><td align="center"><p>134,278</p></td><td align="center"><p>3,566.544</p></td><td align="center"><p>26.561</p></td></tr><tr><td align="center"><p><inline-formula id="IEq30"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq30_HTML.gif" /></inline-formula></p></td><td align="center"><p>D-Cysteine HMDB03417 C3H7NO2S</p></td><td align="center"><p>3,838</p></td><td align="center"><p>0.156</p></td><td align="center"><p>0.041</p></td><td align="center"><p>15,978</p></td><td align="center"><p>131.004</p></td><td align="center"><p>8.199</p></td></tr><tr><td align="center"><p><inline-formula id="IEq31"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq31_HTML.gif" /></inline-formula></p></td><td align="center"><p>p-Cresol sulfate HMDB11635 C7H8O4S</p></td><td align="center"><p>S_6</p></td><td align="center"><p>5078.132</p></td><td align="center"><p>0.009</p></td><td align="center"><p>* More than 82,000,000</p></td><td align="center"><p>* not available</p></td><td align="center"><p>* not available</p></td></tr><tr><td /><td /><td align="center"><p>592,625,133</p></td><td /><td /><td /><td /><td /></tr></tbody></table><table-wrap-foot><p>* Results were not generated due to excessive computational time needed to generate all the candidate structures. We expect OMG to generate more molecules than MOLGEN, due to the larger amount of atom types produced by OMG.</p></table-wrap-foot></table-wrap></p>
            <p>In the case of phosphoenolpyruvic acid, we require P valence 5 to be considered. On the one hand, running MOLGEN with the default valence for P yields 51,323 candidate structures but the correct molecule is missing. On the other hand, forcing the valence of P to be 5, returns 129,421 candidate structures, with the correct molecule also produced but also an excessive quantity of unrealistic molecules due to unrealistic atom types for P. Alternatively, OMG generates 83,977 candidate structures with P valence 3 and 5, including the desired molecule, where all of them are valid molecules as defined by the CDK atom dictionary.</p>
            <p>We observe in Table <xref rid="Tab3" ref-type="table">3</xref> that the running time per generated molecule now ranges between 0.008 and 0.041 milliseconds, while OMG requires between 4.8 and 26.6 milliseconds. Such difference in execution speed between MOLGEN and OMG makes that for some large elemental compositions, only results are reported for MOLGEN. This is the case of phenylalanine, uric acid and p-cresol sulfate. However, for these metabolites, we assume that the number of candidate structures would have been higher with OMG than the one reported by MOLGEN using the default valences.</p>
          </sec>
          <sec id="Sec13">
            <title>Structure generation from elemental formula and prescribed substructures</title>
            <p>Structure generation is a combinatorial problem where the number of output molecules grows exponentially with to the number of input atoms. When using one or more prescribed substructures as input to the generators in addition to elemental composition, less candidate structures are obtained (Table <xref rid="Tab4" ref-type="table">4</xref>). Whereas MOLGEN can only accept one substructure, OMG can accept multiple substructures as input with the constraint that these do not overlap, i.e., they should not share any atom. Phenylalanine is a good example how the number of generated structures can be reduced by using more prescribed substructures, as will be discussed below in more detail.<table-wrap id="Tab4"><label>Table 4</label><caption xml:lang="en"><p><bold>Number of chemical structures generated by OMG and MOLGEN using as input an elemental composition and one or more prescribed and non-overlapping fragments</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="center" rowspan="2"><p>Structure</p></th><th align="center" rowspan="2"><p>Name HMDB ID elemental composition</p></th><th align="center" rowspan="2"><p>Prescribed substructure(s)</p></th><th align="center" colspan="3"><p>MOLGEN</p></th><th align="center" colspan="3"><p>OMG</p></th></tr><tr><th align="center"><p># Candidate structures</p></th><th align="center"><p>Time (s)</p></th><th align="center"><p>Time per molecule (ms)</p></th><th align="center"><p># Candidate structures</p></th><th align="center"><p>Time (s)</p></th><th align="center"><p>Time per molecule (ms)</p></th></tr></thead><tbody><tr><td align="center" rowspan="3"><p><inline-formula id="IEq32"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq32_HTML.gif" /></inline-formula></p></td><td align="center"><p>Glycine</p></td><td align="center" rowspan="3"><p><inline-formula id="IEq33"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq33_HTML.gif" /></inline-formula></p></td><td align="center" rowspan="3"><p>6</p></td><td align="center" rowspan="3"><p>0.167</p></td><td align="center" rowspan="3"><p>27.833</p></td><td align="center" rowspan="3"><p>6</p></td><td align="center" rowspan="3"><p>0.539</p></td><td align="center" rowspan="3"><p>89.833</p></td></tr><tr><td align="center"><p>HMDB00123</p></td></tr><tr><td align="center"><p>C2H5NO2</p></td></tr><tr><td align="center" rowspan="3"><p><inline-formula id="IEq34"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq33_HTML.gif" /></inline-formula></p></td><td align="center"><p>D-Cysteine</p></td><td align="center" rowspan="3"><p><inline-formula id="IEq35"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq34_HTML.gif" /></inline-formula></p></td><td align="center" rowspan="3"><p>100</p></td><td align="center" rowspan="3"><p>0.193</p></td><td align="center" rowspan="3"><p>1.930</p></td><td align="center" rowspan="3"><p>210</p></td><td align="center" rowspan="3"><p>3.177</p></td><td align="center" rowspan="3"><p>15.129</p></td></tr><tr><td align="center"><p>HMDB03417</p></td></tr><tr><td align="center"><p>C3H7NO2S</p></td></tr><tr><td align="center"><p><inline-formula id="IEq36"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq35_HTML.gif" /></inline-formula></p></td><td align="center"><p>Phenylalanine</p></td><td align="center"><p><inline-formula id="IEq37"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq36_HTML.gif" /></inline-formula></p></td><td align="center"><p>76,247</p></td><td align="center"><p>52.774</p></td><td align="center"><p>0.692</p></td><td align="center"><p>107,155</p></td><td align="center"><p>19386.019</p></td><td align="center"><p>180.916</p></td></tr><tr><td /><td align="center"><p>HMDB00159</p></td><td /><td /><td /><td /><td /><td /><td /></tr><tr><td /><td align="center"><p>C9H11NO2</p></td><td /><td /><td /><td /><td /><td /><td /></tr><tr><td align="center" /><td align="center" /><td align="center"><p><inline-formula id="IEq38"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq37_HTML.gif" /></inline-formula></p></td><td align="center"><p>* not possible</p></td><td align="center"><p>* not possible</p></td><td align="center"><p>* not possible</p></td><td align="center"><p>595</p></td><td align="center"><p>271.809</p></td><td align="center"><p>456.822</p></td></tr><tr><td align="center" /><td align="center" /><td align="center"><p><inline-formula id="IEq39"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq38_HTML.gif" /></inline-formula></p></td><td align="center"><p>* not possible</p></td><td align="center"><p>* not possible</p></td><td align="center"><p>* not possible</p></td><td align="center"><p>289</p></td><td align="center"><p>172.655</p></td><td align="center"><p>597.422</p></td></tr><tr><td align="center" /><td align="center" /><td align="center"><p><inline-formula id="IEq40"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq39_HTML.gif" /></inline-formula></p></td><td align="center"><p>* not possible</p></td><td align="center"><p>* not possible</p></td><td align="center"><p>* not possible</p></td><td align="center"><p>26</p></td><td align="center"><p>25.147</p></td><td align="center"><p>967.192</p></td></tr><tr><td align="center"><p><inline-formula id="IEq41"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq40_HTML.gif" /></inline-formula></p></td><td align="center"><p>Cholic acid</p></td><td align="center"><p><inline-formula id="IEq42"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq41_HTML.gif" /></inline-formula></p></td><td align="center"><p>** not possible</p></td><td align="center"><p>** not possible</p></td><td align="center"><p>* not possible</p></td><td align="center"><p>334</p></td><td align="center"><p>120.519</p></td><td align="center"><p>360.835</p></td></tr><tr><td /><td align="center"><p>HMDB00619</p></td><td /><td /><td /><td /><td /><td /><td /></tr><tr><td /><td align="center"><p>C24H40O5</p></td><td /><td /><td /><td /><td /><td /><td /></tr><tr><td align="center" /><td align="center" /><td align="center"><p><inline-formula id="IEq43"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq42_HTML.gif" /></inline-formula></p></td><td align="center"><p>* not possible</p></td><td align="center"><p>* not possible</p></td><td align="center"><p>* not possible</p></td><td align="center"><p>2,505</p></td><td align="center"><p>119.418</p></td><td align="center"><p>47.672</p></td></tr><tr><td align="center"><p><inline-formula id="IEq44"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq43_HTML.gif" /></inline-formula></p></td><td align="center"><p>Malic acid</p></td><td align="center"><p><inline-formula id="IEq45"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq44_HTML.gif" /></inline-formula></p></td><td align="center"><p>1,436</p></td><td align="center"><p>0.229</p></td><td align="center"><p>0.159</p></td><td align="center"><p>1,436</p></td><td align="center"><p>4.688</p></td><td align="center"><p>3.265</p></td></tr><tr><td /><td align="center"><p>HMDB00156</p></td><td /><td /><td /><td /><td /><td /><td /></tr><tr><td /><td align="center"><p>C4H6O5</p></td><td /><td /><td /><td /><td /><td /><td /></tr><tr><td align="center"><p><inline-formula id="IEq46"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq45_HTML.gif" /></inline-formula></p></td><td align="center"><p>Uric acid</p></td><td align="center"><p><inline-formula id="IEq47"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq46_HTML.gif" /></inline-formula></p></td><td align="center"><p>150,114</p></td><td align="center"><p>962.016</p></td><td align="center"><p>6.409</p></td><td align="center"><p>6,069,863</p></td><td align="center"><p>155828.437</p></td><td align="center"><p>25.672</p></td></tr><tr><td /><td align="center"><p>HMDB00289</p></td><td /><td /><td /><td /><td /><td /><td /></tr><tr><td /><td align="center"><p>C5H4N4O3</p></td><td /><td /><td /><td /><td /><td /><td /></tr><tr><td align="center"><p><inline-formula id="IEq48"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq47_HTML.gif" /></inline-formula></p></td><td align="center"><p>Phenyllactic acid</p></td><td align="center"><p><inline-formula id="IEq49"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq48_HTML.gif" /></inline-formula></p></td><td align="center"><p>21,040</p></td><td align="center"><p>15.674</p></td><td align="center"><p>0.745</p></td><td align="center"><p>26,164</p></td><td align="center"><p>163.904</p></td><td align="center"><p>6.264</p></td></tr><tr><td /><td align="center"><p>HMDB00779</p></td><td /><td /><td /><td /><td /><td /><td /></tr><tr><td /><td align="center"><p>C9H10O3</p></td><td /><td /><td /><td /><td /><td /><td /></tr><tr><td align="center" /><td align="center" /><td align="center"><p><inline-formula id="IEq50"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq49_HTML.gif" /></inline-formula></p></td><td align="center"><p>* not possible</p></td><td align="center"><p>* not possible</p></td><td align="center"><p>* not possible</p></td><td align="center"><p>525</p></td><td align="center"><p>3.973</p></td><td align="center"><p>7.568</p></td></tr><tr><td align="center"><p><inline-formula id="IEq51"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq50_HTML.gif" /></inline-formula></p></td><td align="center"><p>p-Cresol sulfate</p></td><td align="center"><p><inline-formula id="IEq52"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq51_HTML.gif" /></inline-formula></p></td><td align="center"><p>S_6 13,177</p></td><td align="center"><p>65.667</p></td><td align="center"><p>4.983</p></td><td align="center"><p>13,177</p></td><td align="center"><p>63.047</p></td><td align="center"><p>4.785</p></td></tr><tr><td /><td align="center"><p>HMDB11635</p></td><td /><td /><td /><td /><td /><td /><td /></tr><tr><td rowspan="2" /><td align="center"><p>C7H8O4S</p></td><td /><td /><td /><td /><td /><td /><td /></tr><tr><td align="center" /><td align="center"><p><inline-formula id="IEq53"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_365_IEq52_HTML.gif" /></inline-formula></p></td><td align="center"><p>S_6 70,330</p></td><td align="center"><p>94.898</p></td><td align="center"><p>1.349</p></td><td align="center"><p>17,232</p></td><td align="center"><p>1204.357</p></td><td align="center"><p>69.891</p></td></tr></tbody></table><table-wrap-foot><p>*MOLGEN can only accept one prescribed substructure, while OMG accepts multiple substructures, provided that these do not overlap, this is, they do not share any atom.</p><p>**MOLGEN is not able to generate molecules using this large substructure as input. The reason could not be found.</p></table-wrap-foot></table-wrap></p>
            <p>Substructure information is of great relevance for metabolomics experiments involving MS<sup>n</sup> data, where often the only information available of an unknown metabolite that needs to be identified is the elemental composition and in some cases substructures. Provided that no database entries exist for this experimental information, one is forced to generate the structures via CASE. The inclusion of substructure information brings the list of candidate structures to a manageable size. For p-cresol sulfate, using the sulfate group with both generators as prescribed substructure, produces 13,177 molecules. When benzene is the prescribed substructure, OMG generates 17,232 candidate structures and MOLGEN 70,330, all containing sulfur with valence 6, hence the difference between both generators.</p>
            <p>Whereas only the elemental composition of phenylalanine as input generates 277 million structures with MOLGEN and for OMG an even higher number of candidate structures is expected as both nitrogen valences of 3 and 5 are taken into account (Table <xref rid="Tab3" ref-type="table">3</xref>), using benzene as a substructure provides only 107,155 (OMG) and 76,247 (MOLGEN) candidate structures (Table <xref rid="Tab4" ref-type="table">4</xref>). The number of generated molecules for the elemental composition of phenylalanine is even further reduced by prescribing multiple fragments as input: OMG outputs 595 molecules when provided with two fragments and 289 molecules for three fragments (Table <xref rid="Tab4" ref-type="table">4</xref>). The use of large fragments yields the larger reduction in output molecules, as it can be seen for the last example of phenylalanine, where two big fragments describe most of its structure and return only 26 chemical structures.</p>
            <p>For larger molecules containing ten or more carbon atoms, which is a common situation in chemistry, it is not practical for the identification of metabolites to exhaustively generate candidate structures without using substructure constraints, with MOLGEN and OMG, due to the large number of results. Using the elemental composition of a large metabolite like cholic acid, both structure generators cannot produce all possible candidate structures, which are expected in the order of billions. This was only possible using substructure information to reduce the size of the search tree: when providing a substructure that describes a large part of the molecule, OMG generates only 334 structures (Table <xref rid="Tab4" ref-type="table">4</xref>). When using two substructures, OMG returned 2,505 candidate structures. However, MOLGEN was unable to return results using the same large substructure or two substructures as an input and the reason could not be found by us.</p>
            <p>The use of prescribed substructures affected the running time of both generators. For MOLGEN, the time per molecule ranged between 0.16 and 27.8 milliseconds, which represents in some cases a 10,000-fold increase in computation time compared to using only elemental compositions. Concerning OMG, the time per molecule ranged between 3.3 and 967. 2 milliseconds, a 100-fold increase in running time. Despite this deterioration of execution time, the advantage of using one or ideally multiple prescribed substructures is clear: the number of candidate substructures is significantly reduced and the total time to calculate candidate structures is also reduced compared to not using any substructure.</p>
            <p>The results here presented show that if we want MOLGEN to generate the correct molecule when the valence of some atoms is not the default one, like phosphoenolpyruvic acid or p-cresol sulfate, we need to know the valence in advance. Otherwise, MOLGEN should be executed using all possible valences for all atoms. This limitation is not present in OMG, which can produce different valences in the same execution. Unfortunately, the atom dictionary provided by CDK is not comprehensive concerning non-standard valences. On the positive side, the dynamic open source community of CDK keeps adding new atom types with each release of the library and we expect that this will improve the capabilities of OMG. This open source nature of CDK allows users to suggest or implement new atom types.</p>
            <p>The generation of the molecules in the Open Molecule Generator has the shape of a tree. As stated by McKay [<xref ref-type="bibr" rid="CR23">23</xref>], the check for canonical augmentation is branchindependent, which would allow to process branches of the generation trees in parallel. Theoretically the algorithm allows for parallelization, in practice this has not been implemented but it is one future extension of this work.</p>
            <p>However, we have observed that OMG is in most of the cases slower than MOLGEN and this fact was more noticeable when generating millions of candidate molecules. The speed of OMG could be improved and we see several possibilities to achieve this, i.e. the use of a different canonizer or a less computationally demanding canonicity test for intermediate chemical structures, could significantly speed up the execution. Actually, obtaining millions of molecules as a result, quickly or slowly, is not desirable, but ideally, the goal of metabolite identification is to obtain a list of candidate structures that is short in order to examine it and find the structure belonging to the unknown metabolite. Exhaustive profiling, covering both on execution time and memory use, would be beneficial to discover improvement points for OMG. Fortunately, OMG allows multiple prescribed substructures and can handle large fragments, which reduced the number of generated molecules significantly. Handling multiple substructures allows OMG to provide a short list of candidate structures and additionally, its open source nature permits users to implement specific constraints to further reduce the candidate list, both during and after the generation process. Examples of such constraints would reject intermediate chemical structures with high steric energy values or other physicochemical properties. Therefore we expect OMG to be useful in different application areas and its functionality to be extended in the near future.</p>
          </sec>
        </sec>
        <sec id="Sec14" sec-type="conclusions">
          <title>Conclusion</title>
          <p>In this work we have presented the Open Molecule Generator, to the best of our knowledge, the first implementation to chemical structure generation of the Canonical Path Augmentation approach, originally designed for simple graph enumeration adding vertices. We have adapted it to generate organic chemical structures and extended so that (i) it grows molecules by adding bonds, (ii) it can handle multigraphs, and (iii) accepts one or multiple non overlapping prescribed substructures. In addition, this is the first open source implementation of a deterministic structure generator. This will enable future developments like parallelization or the inclusion of constraints that are specific to the class of compounds being generated.</p>
          <p>Our results show that the implementation of our algorithm generates all possible and valid chemical structures for a given elemental composition and optionally prescribed substructures. It is as complete as the best commercially available generator. Moreover, the current implementation of the OMG program presents an extra advantage over existing generators when large or multiple fragments are available to be used as constraints: we have demonstrated the benefit of incorporating constraints to reduce the number of output molecules significantly. The ability of OMG to generate multiple valences for an atom has proven to be useful as often no prior information is known on the desired chemical elements and multiple valences of an element can be present in a molecule. When compared to MOLGEN, the only disadvantage of OMG is its speed, which is more severe when using only elemental compositions and less when including prescribed substructures. This issue will be addressed in future improvements of the program. We expect this tool to be used in various fields, one of them being metabolomics, where there is a clear need for flexible structure generators. We have successfully used OMG to propose candidate structures using prescribed substructures, in several on-going metabolite identification projects in our lab.</p>
        </sec>
        <sec id="Sec15">
          <title>Availability and requirements</title>
          <p><bold>Project name:</bold> openmg</p>
          <p>
            <bold>Project home page:</bold>
            <ext-link xlink:href="http://sourceforge.net/p/openmg" ext-link-type="uri">http://sourceforge.net/p/openmg</ext-link>
          </p>
          <p><bold>Operating system:</bold> Linux 64bits, Linux 32bits, Mac OS X</p>
          <p><bold>Programming languages:</bold> Java, C</p>
          <p>
            <bold>Other requirements (if compiling):</bold>
          </p>
          <p><bold>License:</bold> GNU AGPL v3</p>
          <p><bold>Any restrictions to use by non-academics</bold>: None other than those specified by the license</p>
        </sec>
        <sec id="Sec16">
          <title>Algorithms</title>
          <p>1: <bold><italic>generate</italic></bold><bold>(M)</bold></p>
          <p>2:  <bold>If</bold><italic>saturated</italic>(M) AND <italic>are_all_H_used</italic>(M)</p>
          <p>3:    <bold>If</bold><italic>connected_fragments</italic>(M) == 1</p>
          <p>4:     <italic>store_to_file</italic>(M)</p>
          <p>5:     Nmols = Nmols + 1</p>
          <p>6:     <bold>If</bold> degree(M) &lt; max_degree(M)</p>
          <p>7:       <italic>generate</italic>(M)</p>
          <p>8:     <bold>Endif</bold></p>
          <p>9:    <bold>Endif</bold></p>
          <p>10:  <bold>Else</bold></p>
          <p>11:   New Map</p>
          <p>12:   List_of_bonds = <italic>extend</italic>(M)</p>
          <p>13:   <bold>Foreach</bold> bond <bold>in</bold> list_of_bonds</p>
          <p>14:     M’ = <italic>add_bond</italic>(bond,M)</p>
          <p>15:     canonM’ = <italic>canonize</italic>(M’)</p>
          <p>16:     <bold>If</bold> not <italic>is_present</italic>(map,canonM’)</p>
          <p>17:       <italic>add</italic>(map,canonM’)</p>
          <p>18:       <bold>If</bold><italic>is_canonical_augmentation</italic> (canonM’,M’,M)</p>
          <p>19:          <italic>generate</italic>(M’)</p>
          <p>20:       <bold>EndIf</bold></p>
          <p>21:     <bold>EndIf</bold></p>
          <p>22:   <bold>End</bold></p>
          <p>23:  <bold>EndIf</bold></p>
          <p>24: <bold>End</bold></p>
          <p>
            <bold>Algorithm 1</bold>
          </p>
          <p>1: <bold>Is_canonical_augmentation(canonM’, M’, M)</bold></p>
          <p>2:  last_bond = <italic>get_last_bond</italic>(canonM’)</p>
          <p>3:  M” = <italic>remove_bond</italic>(M’, last_bond)</p>
          <p>4:  <bold>return</bold><italic>are_the_same</italic>(M”, M)</p>
          <p>5: <bold>End</bold></p>
          <p>
            <bold>Algorithm 2</bold>
          </p>
          <p>1: <bold>Is_canonical_augmentation_fragments(canonM’, M’, M)</bold></p>
          <p>2:  last_bond = <italic>get_last_bond</italic>(canonM’)</p>
          <p>3:  <bold>While</bold><italic>bond_belongs_to_fragment</italic>(last_bond, canonM’)</p>
          <p>4:     last_bond = <italic>get_previous_bond</italic>(canonM’)</p>
          <p>5:  <bold>Endwhile</bold></p>
          <p>6:  M” = <italic>remove_bond</italic>(M’, last_bond)</p>
          <p>7:  <bold>return</bold><italic>are_the_same</italic>(M”, M)</p>
          <p>8: <bold>End</bold></p>
          <p>
            <bold>Algorithm 3</bold>
          </p>
        </sec>
      </body>
      <back>
        <ack>
          <title>Acknowledgements</title>
          <p>This study was financed by the research programme of the Netherlands Metabolomics Centre (NMC) which is a part of The Netherlands Genomics Initiative/Netherlands Organization for Scientific Research. Jean-Loup Faulon and Davide Fichera were financed by a Genopole ATIGE and a ANR Chair of Excellence grant. We thank M. M. Jaghoori for his contributions to the discussions to improve our algorithm.</p>
        </ack>
        <ref-list id="Bib1">
          <title>References</title>
          <ref-list>
            <ref id="CR1">
              <label>1.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Kind</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Fiehn</surname>
                    <given-names>O</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Advances in structure elucidation of small molecules using mass spectrometry</article-title>
                <source>Bioanal Rev</source>
                <year>2010</year>
                <volume>2</volume>
                <fpage>23</fpage>
                <lpage>60</lpage>
                <pub-id pub-id-type="doi">10.1007/s12566-010-0015-9</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR2">
              <label>2.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Lindsay</surname>
                    <given-names>RK</given-names>
                  </name>
                  <name>
                    <surname>Buchanan</surname>
                    <given-names>BG</given-names>
                  </name>
                  <name>
                    <surname>Feigenbaum</surname>
                    <given-names>EA</given-names>
                  </name>
                  <name>
                    <surname>Lederberg</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <source>Applications of Artificial Intelligence for Organic Chemistry: The DENDRAL Project</source>
                <year>1980</year>
                <publisher-loc>New York</publisher-loc>
                <publisher-name>McGraw-Hill Book</publisher-name>
              </mixed-citation>
            </ref>
            <ref id="CR3">
              <label>3.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Carhart</surname>
                    <given-names>RE</given-names>
                  </name>
                  <name>
                    <surname>Smith</surname>
                    <given-names>DH</given-names>
                  </name>
                  <name>
                    <surname>Gray</surname>
                    <given-names>NAB</given-names>
                  </name>
                  <name>
                    <surname>Nourse</surname>
                    <given-names>JG</given-names>
                  </name>
                  <name>
                    <surname>Djerassi</surname>
                    <given-names>C</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">GENOA: A computer program for structure elucidation utilizing overlapping and alternative substructures</article-title>
                <source>J Org Chem</source>
                <year>1981</year>
                <volume>46</volume>
                <fpage>1708</fpage>
                <lpage>1718</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaL3MXhvFWjtbg%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/jo00321a037</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR4">
              <label>4.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Funatsu</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Miyabayaski</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Sasaki</surname>
                    <given-names>S</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Further development of structure generation in the automated structure elucidation system CHEMICS</article-title>
                <source>J Chem Inf Model</source>
                <year>1988</year>
                <volume>28</volume>
                <fpage>18</fpage>
                <lpage>28</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaL1cXnsVeqsg%3D%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci00057a003</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR5">
              <label>5.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Badertscher</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Korytko</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Schulz</surname>
                    <given-names>K-P</given-names>
                  </name>
                  <name>
                    <surname>Madison</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Munk</surname>
                    <given-names>ME</given-names>
                  </name>
                  <name>
                    <surname>Portmann</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Junghans</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Fontana</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Pretsch</surname>
                    <given-names>E</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Assemble 2.0: a structure generator</article-title>
                <source>Chemom Intell Lab Syst</source>
                <year>2000</year>
                <volume>51</volume>
                <fpage>73</fpage>
                <lpage>79</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3cXjtVGjt7o%3D</pub-id>
                <pub-id pub-id-type="doi">10.1016/S0169-7439(00)00056-3</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR6">
              <label>6.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Molchanova</surname>
                    <given-names>MS</given-names>
                  </name>
                  <name>
                    <surname>Shcherbukhin</surname>
                    <given-names>VV</given-names>
                  </name>
                  <name>
                    <surname>Zefirov</surname>
                    <given-names>NS</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Computer Generation of Molecular Structures by the SMOG Program</article-title>
                <source>J Chem Inf Model</source>
                <year>1996</year>
                <volume>36</volume>
                <fpage>888</fpage>
                <lpage>899</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK28XjvFWmtL8%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci950393z</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR7">
              <label>7.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Kerber</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Laue</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Grüner</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Meringer</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">MOLGEN 4.0. Match Communications</article-title>
                <source>Math Comput Chem</source>
                <year>1998</year>
                <volume>37</volume>
                <fpage>205</fpage>
                <lpage>208</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK1cXjslejtL8%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR8">
              <label>8.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Ley</surname>
                    <given-names>SV</given-names>
                  </name>
                  <name>
                    <surname>Doherty</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Massiot</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Nuzillard</surname>
                    <given-names>JM</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Connectivist approach to organic structure determination. LSD-program assisted NMR analysis of the insect antifeedant azadirachtin</article-title>
                <source>Tetrahedron</source>
                <year>1994</year>
                <volume>50</volume>
                <fpage>12267</fpage>
                <lpage>12280</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK2MXhslehsbg%3D</pub-id>
                <pub-id pub-id-type="doi">10.1016/S0040-4020(01)89576-4</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR9">
              <label>9.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Steinbeck</surname>
                    <given-names>C</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">SENECA: A platform-independent, distributed, and parallel system for computer-assisted structure elucidation in organic chemistry</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>2001</year>
                <volume>41</volume>
                <fpage>1500</fpage>
                <lpage>7</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3MXnt12qurc%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci000407n</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR10">
              <label>10.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Steinbeck</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Han</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Kuhn</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Horlacher</surname>
                    <given-names>O</given-names>
                  </name>
                  <name>
                    <surname>Luttmann</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Willighagen</surname>
                    <given-names>E</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The Chemistry Development Kit (CDK): an open-source Java library for Chemo- and Bioinformatics</article-title>
                <source>J Chem Inform Comput Sci</source>
                <year>2003</year>
                <volume>43</volume>
                <fpage>493</fpage>
                <lpage>500</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3sXhtVaktbg%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci025584y</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR11">
              <label>11.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Steinbeck</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Hoppe</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Kuhn</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Floris</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Guha</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Willighagen</surname>
                    <given-names>EL</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Recent Developments of the Chemistry Development Kit (CDK) - An Open-Source Java Library for Chemo- and Bioinformatics</article-title>
                <source>Curr Pharm Des</source>
                <year>2006</year>
                <volume>12</volume>
                <fpage>2111</fpage>
                <lpage>2120</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD28XmslWqsL0%3D</pub-id>
                <pub-id pub-id-type="doi">10.2174/138161206777585274</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR12">
              <label>12.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Nielsen</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Oliver</surname>
                    <given-names>S</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The next wave in metabolome analysis</article-title>
                <source>Trends Biotechnol</source>
                <year>2005</year>
                <volume>23</volume>
                <fpage>544</fpage>
                <lpage>6</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2MXhtFektb%2FJ</pub-id>
                <pub-id pub-id-type="doi">10.1016/j.tibtech.2005.08.005</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR13">
              <label>13.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Scalbert</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Brennan</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Fiehn</surname>
                    <given-names>O</given-names>
                  </name>
                  <name>
                    <surname>Hankemeier</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Kristal</surname>
                    <given-names>BS</given-names>
                  </name>
                  <name>
                    <surname>van Ommen</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>Pujos-Guillot</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Verheij</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Wishart</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Wopereis</surname>
                    <given-names>S</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Mass-spectrometry-based metabolomics: limitations and recommendations for future progress with particular focus on nutrition research</article-title>
                <source>Metabolomics</source>
                <year>2009</year>
                <volume>5</volume>
                <fpage>435</fpage>
                <lpage>458</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXhsFGrurfL</pub-id>
                <pub-id pub-id-type="doi">10.1007/s11306-009-0168-0</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR14">
              <label>14.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Dunn</surname>
                    <given-names>WB</given-names>
                  </name>
                  <name>
                    <surname>Broadhurst</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Begley</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Zelena</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Francis-McIntyre</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Anderson</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Brown</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Knowles</surname>
                    <given-names>JD</given-names>
                  </name>
                  <name>
                    <surname>Halsall</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Haselden</surname>
                    <given-names>JN</given-names>
                  </name>
                  <name>
                    <surname>Nicholls</surname>
                    <given-names>AW</given-names>
                  </name>
                  <name>
                    <surname>Wilson</surname>
                    <given-names>ID</given-names>
                  </name>
                  <name>
                    <surname>Kell</surname>
                    <given-names>DB</given-names>
                  </name>
                  <name>
                    <surname>Goodacre</surname>
                    <given-names>R</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Procedures for large-scale metabolic profiling of serum and plasma using gas chromatography and liquid chromatography coupled to mass spectrometry</article-title>
                <source>Nat Protoc</source>
                <year>2011</year>
                <volume>6</volume>
                <fpage>1060</fpage>
                <lpage>1083</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXotlCmtL8%3D</pub-id>
                <pub-id pub-id-type="doi">10.1038/nprot.2011.335</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR15">
              <label>15.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Mohamed</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Varesio</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Ivosev</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Burton</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Bonner</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Hopfgartner</surname>
                    <given-names>G</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Comprehensive analytical strategy for biomarker identification based on liquid chromatography coupled to mass spectrometry and new candidate confirmation tools</article-title>
                <source>Anal Chem</source>
                <year>2009</year>
                <volume>81</volume>
                <fpage>7677</fpage>
                <lpage>94</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXhtVens7%2FI</pub-id>
                <pub-id pub-id-type="doi">10.1021/ac901087t</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR16">
              <label>16.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Zhang</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Creek</surname>
                    <given-names>DJ</given-names>
                  </name>
                  <name>
                    <surname>Barrett</surname>
                    <given-names>MP</given-names>
                  </name>
                  <name>
                    <surname>Blackburn</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Watson</surname>
                    <given-names>DG</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Evaluation of Coupling Reversed Phase, Aqueous Normal Phase, and Hydrophilic Interaction Liquid Chromatography with Orbitrap Mass Spectrometry for Metabolomic Studies of Human Urine</article-title>
                <source>Analytical Chemistry</source>
                <year>2012</year>
                <volume>84</volume>
                <fpage>1994</fpage>
                <lpage>2001</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC38XosFejug%3D%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ac2030738</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR17">
              <label>17.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Schymanski</surname>
                    <given-names>EL</given-names>
                  </name>
                  <name>
                    <surname>Meinert</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Meringer</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Brack</surname>
                    <given-names>W</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The use of MS classifiers and structure generation to assist in the identification of unknowns in effect-directed analysis</article-title>
                <source>Anal Chim Acta</source>
                <year>2008</year>
                <volume>615</volume>
                <fpage>136</fpage>
                <lpage>147</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1cXlvVWhu7Y%3D</pub-id>
                <pub-id pub-id-type="doi">10.1016/j.aca.2008.03.060</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR18">
              <label>18.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Schymanski</surname>
                    <given-names>EL</given-names>
                  </name>
                  <name>
                    <surname>Meringer</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Brack</surname>
                    <given-names>W</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Automated Strategies To Identify Compounds on the Basis of GC/EI-MS and Calculated Properties</article-title>
                <source>Anal Chem</source>
                <year>2011</year>
                <volume>83</volume>
                <fpage>903</fpage>
                <lpage>912</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXlsFShuw%3D%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ac102574h</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR19">
              <label>19.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Colbourn</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Read</surname>
                    <given-names>R</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Orderly algorithms for graph generation</article-title>
                <source>Int J Comput Math</source>
                <year>1979</year>
                <volume>7</volume>
                <fpage>167</fpage>
                <lpage>172</lpage>
                <pub-id pub-id-type="doi">10.1080/00207167908803169</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR20">
              <label>20.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Faradzev</surname>
                    <given-names>IA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Constructive Enumeration of Combinatorial Objects</article-title>
                <source>Problèmes combinatoires et théorie des graphes</source>
                <year>1978</year>
                <publisher-loc>Orsay</publisher-loc>
                <publisher-name>University of Paris</publisher-name>
                <fpage>131</fpage>
                <lpage>135</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR21">
              <label>21.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Faulon</surname>
                    <given-names>J-L</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Stochastic Generator of Chemical Structure. 1. Application to the Structure Elucidation of Large Molecules</article-title>
                <source>J Chem Inf Model</source>
                <year>1994</year>
                <volume>34</volume>
                <fpage>1204</fpage>
                <lpage>1218</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK2cXmtVCntLo%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci00021a031</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR22">
              <label>22.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Kerber</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Laue</surname>
                    <given-names>R</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Group Actions, Double Cosets, and Homomorphisms: Unifying Concepts for the Constructive Theory of Discrete Structures</article-title>
                <source>Acta Applicandae Mathematicae</source>
                <year>1998</year>
                <volume>52</volume>
                <fpage>63</fpage>
                <lpage>90</lpage>
                <pub-id pub-id-type="doi">10.1023/A:1005998722658</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR23">
              <label>23.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>McKay</surname>
                    <given-names>B</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Isomorph-Free Exhaustive Generation</article-title>
                <source>J Algorithm</source>
                <year>1998</year>
                <volume>26</volume>
                <fpage>306</fpage>
                <lpage>324</lpage>
                <pub-id pub-id-type="doi">10.1006/jagm.1997.0898</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR24">
              <label>24.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Fink</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Reymond</surname>
                    <given-names>J-L</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Virtual exploration of the chemical universe up to 11 atoms of C, N, O, F: assembly of 26.4 million structures (110.9 million stereoisomers) and analysis for new ring systems, stereochemistry, physicochemical properties, compound classes, and drug discove</article-title>
                <source>J Chem Inf Model</source>
                <year>2007</year>
                <volume>47</volume>
                <fpage>342</fpage>
                <lpage>53</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2sXhtVens7k%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci600423u</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR25">
              <label>25.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Blum</surname>
                    <given-names>LC</given-names>
                  </name>
                  <name>
                    <surname>Reymond</surname>
                    <given-names>J-L</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">970 Million Druglike Small Molecules for Virtual Screening in the Chemical Universe Database GDB-13</article-title>
                <source>J Am Chem Soc</source>
                <year>2009</year>
                <volume>131</volume>
                <fpage>8732</fpage>
                <lpage>8733</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXmvFWru7k%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ja902302h</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR26">
              <label>26.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Chen</surname>
                    <given-names>WL</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Chemoinformatics: past, present, and future</article-title>
                <source>J Chem Inf Model</source>
                <year>2006</year>
                <volume>46</volume>
                <fpage>2230</fpage>
                <lpage>55</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD28Xlt1ehs7w%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci060016u</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR27">
              <label>27.</label>
              <mixed-citation publication-type="other">Rojas-Chertó M, Peironcely JE, Kasper PT, van der Hooft JJJ, de Vos RCH, Vreeken R, Hankemeier T, Reijmers T: Metabolite identification using automated comparison of high resolution MSn spectral trees. submitted</mixed-citation>
            </ref>
            <ref id="CR28">
              <label>28.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Peironcely</surname>
                    <given-names>JE</given-names>
                  </name>
                  <name>
                    <surname>Reijmers</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Coulier</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Bender</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Hankemeier</surname>
                    <given-names>T</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Understanding and Classifying Metabolite Space and Metabolite-Likeness</article-title>
                <source>PLoS One</source>
                <year>2011</year>
                <volume>6</volume>
                <fpage>e28966</fpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC38XhsFentw%3D%3D</pub-id>
                <pub-id pub-id-type="doi">10.1371/journal.pone.0028966</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR29">
              <label>29.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Mckay</surname>
                    <given-names>BD</given-names>
                  </name>
                </person-group>
                <source>Nauty User’s Guide ( Version 2.4 )</source>
                <year>2009</year>
              </mixed-citation>
            </ref>
            <ref id="CR30">
              <label>30.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Braun</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Gugisch</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Kerber</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Laue</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Meringer</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Rücker</surname>
                    <given-names>C</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">MOLGEN-CID–A canonizer for molecules and graphs accessible through the Internet</article-title>
                <source>J Chem Inform Comput Sci</source>
                <year>2004</year>
                <volume>44</volume>
                <fpage>542</fpage>
                <lpage>8</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2cXit12rsrk%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci030404l</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR31">
              <label>31.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Faulon</surname>
                    <given-names>J-L</given-names>
                  </name>
                  <name>
                    <surname>Collins</surname>
                    <given-names>MJ</given-names>
                  </name>
                  <name>
                    <surname>Carr</surname>
                    <given-names>RD</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The signature molecular descriptor. 4. Canonizing molecules using extended valence sequences</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>2004</year>
                <volume>44</volume>
                <fpage>427</fpage>
                <lpage>36</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2cXitFOhug%3D%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci0341823</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR32">
              <label>32.</label>
              <mixed-citation publication-type="other">IUPAC International Chemical Identifier (InChI): Technical Manual. <ext-link xlink:href="http://www.inchi-trust.org/sites/default/files/inchi-1.04/InChI_TechMan.pdf" ext-link-type="uri">http://www.inchi-trust.org/sites/default/files/inchi-1.04/InChI_TechMan.pdf</ext-link>,</mixed-citation>
            </ref>
            <ref id="CR33">
              <label>33.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Foggia</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Sansone</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Vento</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">A Performance Comparison of Five Algorithms for Graph Isomorphism</article-title>
                <source>3rd IAPR TC-15 Workshop on Graph-based Representations in Pattern Recognition</source>
                <year>2001</year>
                <fpage>188</fpage>
                <lpage>199</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR34">
              <label>34.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Wishart</surname>
                    <given-names>DS</given-names>
                  </name>
                  <name>
                    <surname>Knox</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Guo</surname>
                    <given-names>AC</given-names>
                  </name>
                  <name>
                    <surname>Eisner</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Young</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Gautam</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>Hau</surname>
                    <given-names>DD</given-names>
                  </name>
                  <name>
                    <surname>Psychogios</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Dong</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Bouatra</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Mandal</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Sinelnikov</surname>
                    <given-names>I</given-names>
                  </name>
                  <name>
                    <surname>Xia</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Jia</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Cruz</surname>
                    <given-names>JA</given-names>
                  </name>
                  <name>
                    <surname>Lim</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Sobsey</surname>
                    <given-names>CA</given-names>
                  </name>
                  <name>
                    <surname>Shrivastava</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Huang</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Liu</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Fang</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Peng</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Fradette</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Cheng</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Tzur</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Clements</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Lewis</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Souza</surname>
                    <given-names>AD</given-names>
                  </name>
                  <name>
                    <surname>Zuniga</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Dawe</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Xiong</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Clive</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Greiner</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Nazyrova</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Shaykhutdinov</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Li</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Vogel</surname>
                    <given-names>HJ</given-names>
                  </name>
                  <name>
                    <surname>Forsythe</surname>
                    <given-names>I</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">HMDB: a knowledgebase for the human metabolome</article-title>
                <source>Nucleic Acids Res</source>
                <year>2009</year>
                <volume>37</volume>
                <fpage>D603</fpage>
                <lpage>610</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1cXhsFejt7fO</pub-id>
                <pub-id pub-id-type="doi">10.1093/nar/gkn810</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR35">
              <label>35.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Fujiwara</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Wang</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Zhao</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Nagamochi</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Akutsu</surname>
                    <given-names>T</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Enumerating treelike chemical graphs with given path frequency</article-title>
                <source>J Chem Inf Model</source>
                <year>2008</year>
                <volume>48</volume>
                <fpage>1345</fpage>
                <lpage>57</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1cXnvV2js70%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci700385a</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR36">
              <label>36.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Imada</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Ota</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Nagamochi</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Akutsu</surname>
                    <given-names>T</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Efficient enumeration of stereoisomers of tree structured molecules using dynamic programming</article-title>
                <source>J Math Chem</source>
                <year>2011</year>
                <volume>49</volume>
                <fpage>910</fpage>
                <lpage>970</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXivVCgtr4%3D</pub-id>
                <pub-id pub-id-type="doi">10.1007/s10910-010-9789-9</pub-id>
              </mixed-citation>
            </ref>
          </ref-list>
        </ref-list>
        <notes notes-type="Misc">
          <title>Competing interests</title>
          <p>The authors declare that they have no competing interests.</p>
        </notes>
        <notes notes-type="Misc">
          <title>Authors’ contributions</title>
          <p>JEP designed and implemented the software, and drafted most of the manuscript. MRC and DF contributed to the implementation of the software. JLF contributed to the design of the algorithm and supervised specific parts of the project. TR, LC and TH supervised specific parts of the project, fed it with new ideas, and participated in testing the software. All authors approved the final manuscript.</p>
        </notes>
      </back>
    </article>
