<?xml version="1.0"?>
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="research-article" xml:lang="en">
      <front>
        <journal-meta>
          <journal-id journal-id-type="publisher-id">13321</journal-id>
          <journal-title-group>
            <journal-title>Journal of Cheminformatics</journal-title>
            <abbrev-journal-title abbrev-type="publisher">J Cheminform</abbrev-journal-title>
          </journal-title-group>
          <issn pub-type="epub">1758-2946</issn>
          <publisher>
            <publisher-name>Springer International Publishing</publisher-name>
            <publisher-loc>Cham</publisher-loc>
          </publisher>
        </journal-meta>
        <article-meta>
          <article-id pub-id-type="publisher-id">s13321-019-0391-2</article-id>
          <article-id pub-id-type="manuscript">391</article-id>
          <article-id pub-id-type="doi">10.1186/s13321-019-0391-2</article-id>
          <article-categories>
            <subj-group subj-group-type="heading">
              <subject>Research Article</subject>
            </subj-group>
          </article-categories>
          <title-group>
            <article-title xml:lang="en">Dataset’s chemical diversity limits the generalizability of machine learning predictions</article-title>
          </title-group>
          <contrib-group>
            <contrib contrib-type="author" id="Au1">
              <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4691-0240</contrib-id>
              <name>
                <surname>Glavatskikh</surname>
                <given-names>Marta</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="aff" rid="Aff2">2</xref>
            </contrib>
            <contrib contrib-type="author" id="Au2">
              <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6808-7806</contrib-id>
              <name>
                <surname>Leguy</surname>
                <given-names>Jules</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author" id="Au3">
              <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9061-3609</contrib-id>
              <name>
                <surname>Hunault</surname>
                <given-names>Gilles</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="aff" rid="Aff3">3</xref>
            </contrib>
            <contrib contrib-type="author" corresp="yes" id="Au4">
              <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4259-3257</contrib-id>
              <name>
                <surname>Cauchy</surname>
                <given-names>Thomas</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff2">2</xref>
              <xref ref-type="corresp" rid="IDs1332101903912_cor4">d</xref>
            </contrib>
            <contrib contrib-type="author" id="Au5">
              <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0807-8892</contrib-id>
              <name>
                <surname>Da Mota</surname>
                <given-names>Benoit</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <aff id="Aff1">
              <label>1</label>
              <institution-wrap>
                <institution-id institution-id-type="ISNI">0000 0001 2248 3363</institution-id>
                <institution-id institution-id-type="GRID">grid.7252.2</institution-id>
                <institution content-type="org-division">LERIA</institution>
                <institution content-type="org-name">University of Angers</institution>
              </institution-wrap>
              <addr-line content-type="street">2 Bd Lavoisier</addr-line>
              <addr-line content-type="postcode">49045</addr-line>
              <addr-line content-type="city">Angers</addr-line>
              <country country="FR">France</country>
            </aff>
            <aff id="Aff2">
              <label>2</label>
              <institution-wrap>
                <institution-id institution-id-type="ISNI">0000 0001 2248 3363</institution-id>
                <institution-id institution-id-type="GRID">grid.7252.2</institution-id>
                <institution content-type="org-division">Laboratoire MOLTECH-Anjou, UMR CNRS 6200, SFR MATRIX</institution>
                <institution content-type="org-name">UNIV Angers</institution>
              </institution-wrap>
              <addr-line content-type="street">2 Bd Lavoisier</addr-line>
              <addr-line content-type="postcode">49045</addr-line>
              <addr-line content-type="city">Angers</addr-line>
              <country country="FR">France</country>
            </aff>
            <aff id="Aff3">
              <label>3</label>
              <institution-wrap>
                <institution-id institution-id-type="ISNI">0000 0001 2248 3363</institution-id>
                <institution-id institution-id-type="GRID">grid.7252.2</institution-id>
                <institution content-type="org-division">HIFIH, EA 3859, Institut de Biologie en Santé PBH-IRIS, CHU</institution>
                <institution content-type="org-name">University of Angers</institution>
              </institution-wrap>
              <addr-line content-type="street">4, Rue Larrey</addr-line>
              <addr-line content-type="postcode">49933</addr-line>
              <addr-line content-type="city">Angers</addr-line>
              <country country="FR">France</country>
            </aff>
          </contrib-group>
          <author-notes>
            <corresp id="IDs1332101903912_cor4">
              <label>d</label>
              <email>HIDDEN</email>
            </corresp>
          </author-notes>
          <pub-date date-type="pub" publication-format="electronic">
            <day>12</day>
            <month>11</month>
            <year>2019</year>
          </pub-date>
          <pub-date date-type="collection" publication-format="electronic">
            <month>12</month>
            <year>2019</year>
          </pub-date>
          <volume>11</volume>
          <issue seq="69">1</issue>
          <elocation-id>69</elocation-id>
          <history>
            <date date-type="registration">
              <day>29</day>
              <month>10</month>
              <year>2019</year>
            </date>
            <date date-type="received">
              <day>26</day>
              <month>7</month>
              <year>2019</year>
            </date>
            <date date-type="accepted">
              <day>28</day>
              <month>10</month>
              <year>2019</year>
            </date>
            <date date-type="online">
              <day>12</day>
              <month>11</month>
              <year>2019</year>
            </date>
          </history>
          <permissions>
            <copyright-statement content-type="compact">© The Author(s) 2019</copyright-statement>
            <copyright-year>2019</copyright-year>
            <copyright-holder>The Author(s)</copyright-holder>
            <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
              <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (http://creativecommons.org/publicdomain/zero/1.0/) applies to the data made available in this article, unless otherwise stated.</license-p>
            </license>
          </permissions>
          <abstract xml:lang="en" id="Abs1">
            <title>Abstract</title>
            <p id="Par1">The QM9 dataset has become the golden standard for Machine Learning (ML) predictions of various chemical properties. QM9 is based on the GDB, which is a combinatorial exploration of the chemical space. ML molecular predictions have been recently published with an accuracy on par with Density Functional Theory calculations. Such ML models need to be tested and generalized on real data. PC9, a new QM9 equivalent dataset (only H, C, N, O and F and up to 9 “heavy” atoms) of the PubChemQC project is presented in this article. A statistical study of bonding distances and chemical functions shows that this new dataset encompasses more chemical diversity. Kernel Ridge Regression, Elastic Net and the Neural Network model provided by SchNet have been used on both datasets. The overall accuracy in energy prediction is higher for the QM9 subset. However, a model trained on PC9 shows a stronger ability to predict energies of the other dataset. <fig id="Figa" position="anchor"><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_391_Figa_HTML.png" position="anchor" id="MO111" /></fig></p>
          </abstract>
          <kwd-group xml:lang="en">
            <title>Keywords</title>
            <kwd>Molecular chemistry</kwd>
            <kwd>SchNet</kwd>
            <kwd>QM9</kwd>
            <kwd>PC9</kwd>
            <kwd>DFT</kwd>
          </kwd-group>
          <funding-group>
            <award-group>
              <funding-source>
                <institution-wrap>
                  <institution>Conseil Régional des Pays de la Loire</institution>
                  <institution-id institution-id-type="doi" vocab="open-funder-registry">http://dx.doi.org/10.13039/501100013414</institution-id>
                </institution-wrap>
              </funding-source>
              <award-id award-type="FundRef grant">AIQU</award-id>
              <principal-award-recipient>
                <name>
                  <surname>Glavatskikh</surname>
                  <given-names>Marta</given-names>
                </name>
              </principal-award-recipient>
            </award-group>
            <award-group>
              <funding-source>
                <institution-wrap>
                  <institution>Universite Angers</institution>
                  <institution-id institution-id-type="doi" vocab="open-funder-registry">http://dx.doi.org/10.13039/501100008280</institution-id>
                </institution-wrap>
              </funding-source>
              <award-id award-type="FundRef grant">AIQU</award-id>
              <principal-award-recipient>
                <name>
                  <surname>Glavatskikh</surname>
                  <given-names>Marta</given-names>
                </name>
              </principal-award-recipient>
            </award-group>
          </funding-group>
          <custom-meta-group>
            <custom-meta>
              <meta-name>publisher-imprint-name</meta-name>
              <meta-value>Springer</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-issue-count</meta-name>
              <meta-value>1</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-article-count</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-pricelist-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-holder</meta-name>
              <meta-value>The Author(s)</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-contains-esm</meta-name>
              <meta-value>Yes</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-month</meta-name>
              <meta-value>10</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-day</meta-name>
              <meta-value>29</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-product</meta-name>
              <meta-value>ArchiveJournal</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-grants-type</meta-name>
              <meta-value>OpenChoice</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>metadata-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>abstract-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodypdf-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodyhtml-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bibliography-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>esm-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>online-first</meta-name>
              <meta-value>false</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-file-reference</meta-name>
              <meta-value>BodyRef/PDF/13321_2019_Article_391.pdf</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-type</meta-name>
              <meta-value>Typeset</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>target-type</meta-name>
              <meta-value>OnlinePDF</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-type</meta-name>
              <meta-value>OriginalPaper</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-primary</meta-name>
              <meta-value>Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computer Applications in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Documentation and Information in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Theoretical and Computational Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computational Biology/Bioinformatics</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-collection</meta-name>
              <meta-value>Chemistry and Materials Science</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>open-access</meta-name>
              <meta-value>true</meta-value>
            </custom-meta>
          </custom-meta-group>
        </article-meta>
      </front>
      <body>
        <sec id="Sec1">
          <title>Introduction</title>
          <p id="Par2">Quantum mechanical (QM) calculation is so far the most accurate method to obtain molecular energetic characteristics like the total energy and the frontier molecular orbitals energies (HOMO and LUMO). However, a huge computational cost prevents its daily usage for exhaustive exploration of chemical space. Till recently the only alternative in overcoming the time factor was to use less accurate approximation of QM or classical molecular mechanics. Yet, with those methods, the gain in time means a loss in precision. An appealing alternative is to use a computationally much more efficient approach based on machine learning (ML) models, which could be trained on any kind of data. It is indeed a hot topic. Just in 2019, an impressive amount of studies have been devoted to the application of ML for the prediction of molecular energetic characteristics [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR11">11</xref>].</p>
          <p id="Par4">In chemistry-oriented ML, especially for molecular energies, the employed methods encompass Kernel Ridge Regression (KRR) [<xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR18">18</xref>], sometimes Gaussian process regression (GPR), linear regressions (Elastic Net, Bayesian Ridge Regression) and Random Forest (RF) [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. The most recent state-of-the-art predictions have been obtained by neural networks (NN) [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR21">21</xref>–<xref ref-type="bibr" rid="CR28">28</xref>]. ML performance as well depends on the molecular representation used. Graph representations can be employed [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR25">25</xref>], but the most common approaches are based on derivatives of geometry features like the Coulomb Matrix (CM) proposed by Rupp et al. [<xref ref-type="bibr" rid="CR12">12</xref>], the Bag of Bonds (BoB) proposed by Hansen et al. [<xref ref-type="bibr" rid="CR13">13</xref>] or Bonds and Angles ML (BAML) descriptors [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]. More complex representations have been also proposed. The idea behind those “alchemical” descriptors is to introduce a part of the Hamiltonian before the ML treatment for better predictive power and generalizability. We can cite for example smooth overlap of atomic potentials (SOAP) paired sometimes with Gaussian approximation potential (GAP) [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR30">30</xref>] and multidimensional distributions of interatomic many-body expansion [<xref ref-type="bibr" rid="CR31">31</xref>].</p>
          <p id="Par5">Furthermore, the ML performance depends heavily on the dataset size and quality. Most of the works related to ML modeling of quantum chemical properties are using either the QM7(b) collection or its enlarged version QM9 [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. They are both subsets of the combinatorially enumerated chemical universe GDB up to 13 or 17 heavy atoms [<xref ref-type="bibr" rid="CR33">33</xref>]. Whereas the QM7 is composed of 7211 molecules (C, H, N, O, S and Cl), the QM9 dataset encompasses 133,885 molecules with up to nine “heavy” atoms from the range C, O, N and F. The geometric, energetic, electronic, and thermodynamic properties of theirs were computed with a DFT method at the B3LYP/6-31G(2df,p) level of theory. This dataset has become a classical benchmark for ML studies due to its homogeneity, purity and lack of noise.</p>
          <p id="Par6">So, since 2012, the ML modeling of total molecular energies and the HOMO/LUMO energies, among other properties, has been the focus of several studies. Table <xref rid="Tab1" ref-type="table">1</xref> presents the evolution of the published mean absolute errors (MAE) reported in the literature. Clearly, with QM7 and QM9 datasets, a well tuned KRR model can almost reach chemical accuracy for the three properties with descriptors like the BoB or the BAML [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. With more complex “alchemical” representations and radially scaled KRR /GPR, they can even compete with the best Neural Networks results [<xref ref-type="bibr" rid="CR30">30</xref>]. Such accuracy is really tempting, taking into account the relatively low computational cost of KRR/GPR methods.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Mean absolute errors for atomisation energies <inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:msub><mml:mi>U</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq1.gif" /></alternatives></inline-formula> in kcal/mol, HOMO and LUMO energies (in eV) for several models Kernel Ridge regression (KRR), Elastic Net (EN), Gaussian process regression (KRR), and neural networks (NN) reported in the literature (from oldest to most recent)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>References</p></th><th align="left"><p>ML method/descriptor</p></th><th align="left"><p>Dataset</p></th><th align="left"><p>(Training–Test sizes)</p></th><th align="left"><p><inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:msub><mml:mi>U</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq2.gif" /></alternatives></inline-formula></p></th><th align="left"><p>HOMO</p></th><th align="left"><p>LUMO</p></th></tr></thead><tbody><tr><td align="left"><p>Rupp [<xref ref-type="bibr" rid="CR12">12</xref>]</p></td><td align="left"><p>KRR/CM</p></td><td align="left"><p>QM7</p></td><td align="left"><p>(7000–165)</p></td><td align="left"><p>10.0</p></td><td align="left"><p>–</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>Montavon [<xref ref-type="bibr" rid="CR21">21</xref>]</p></td><td align="left"><p>multitask NN</p></td><td align="left"><p>QM7b</p></td><td align="left"><p>(CV 5000–2211)</p></td><td align="left"><p>3.7</p></td><td align="left"><p>0.15</p></td><td align="left"><p>0.13</p></td></tr><tr><td align="left"><p>Hansen [<xref ref-type="bibr" rid="CR14">14</xref>]</p></td><td align="left"><p>KRR/BoB</p></td><td align="left"><p>QM7</p></td><td align="left"><p>(CV 5732–1433)</p></td><td align="left"><p>1.5</p></td><td align="left"><p>–</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>Huang [<xref ref-type="bibr" rid="CR16">16</xref>]</p></td><td align="left"><p>KRR/BoB</p></td><td align="left"><p>QM7b</p></td><td align="left"><p>(5011–2200)</p></td><td align="left"><p>1.8</p></td><td align="left"><p>0.15</p></td><td align="left"><p>0.16</p></td></tr><tr><td align="left"><p>Huang [<xref ref-type="bibr" rid="CR16">16</xref>]</p></td><td align="left"><p>KRR/BAML</p></td><td align="left"><p>QM7b</p></td><td align="left"><p>(5011–2200)</p></td><td align="left"><p>1.2</p></td><td align="left"><p>0.10</p></td><td align="left"><p>0.11</p></td></tr><tr><td align="left"><p>Faber [<xref ref-type="bibr" rid="CR17">17</xref>]</p></td><td align="left"><p>EN/CM</p></td><td align="left"><p>QM9</p></td><td align="left"><p>(CV 118k–13k)</p></td><td align="left"><p>21.0</p></td><td align="left"><p>0.34</p></td><td align="left"><p>0.63</p></td></tr><tr><td align="left"><p>Faber [<xref ref-type="bibr" rid="CR17">17</xref>]</p></td><td align="left"><p>EN/BoB</p></td><td align="left"><p>QM9</p></td><td align="left"><p>(CV 118k–13k)</p></td><td align="left"><p>13.9</p></td><td align="left"><p>0.28</p></td><td align="left"><p>0.52</p></td></tr><tr><td align="left"><p>Faber [<xref ref-type="bibr" rid="CR17">17</xref>]</p></td><td align="left"><p>KRR/CM</p></td><td align="left"><p>QM9</p></td><td align="left"><p>(CV 118k–13k)</p></td><td align="left"><p>3.0</p></td><td align="left"><p>0.13</p></td><td align="left"><p>0.18</p></td></tr><tr><td align="left"><p>Faber [<xref ref-type="bibr" rid="CR17">17</xref>]</p></td><td align="left"><p>KRR/BoB</p></td><td align="left"><p>QM9</p></td><td align="left"><p>(CV 118k–13k)</p></td><td align="left"><p>1.5</p></td><td align="left"><p>0.09</p></td><td align="left"><p>0.12</p></td></tr><tr><td align="left"><p>Faber [<xref ref-type="bibr" rid="CR17">17</xref>]</p></td><td align="left"><p>KRR/BAML</p></td><td align="left"><p>QM9</p></td><td align="left"><p>(CV 118k–13k)</p></td><td align="left"><p>1.2</p></td><td align="left"><p>0.09</p></td><td align="left"><p>0.12</p></td></tr><tr><td align="left"><p>Bartók [<xref ref-type="bibr" rid="CR19">19</xref>]</p></td><td align="left"><p>GPR/SOAP-GAP</p></td><td align="left"><p>QM7b</p></td><td align="left"><p>(5411–1800)</p></td><td align="left"><p>0.40</p></td><td align="left"><p>–</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>Bartók [<xref ref-type="bibr" rid="CR19">19</xref>]</p></td><td align="left"><p>GPR/SOAP-GAP</p></td><td align="left"><p>QM9</p></td><td align="left"><p>(100k–31k)</p></td><td align="left"><p>0.28</p></td><td align="left"><p>–</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>Gilmer [<xref ref-type="bibr" rid="CR23">23</xref>]</p></td><td align="left"><p>NMP NN</p></td><td align="left"><p>QM9</p></td><td align="left"><p>(120k–10k)</p></td><td align="left"><p>0.45</p></td><td align="left"><p>0.04</p></td><td align="left"><p>0.04</p></td></tr><tr><td align="left"><p>Smith [<xref ref-type="bibr" rid="CR22">22</xref>]</p></td><td align="left"><p>ANI-1 NN</p></td><td align="left"><p>ANI</p></td><td align="left"><p>(13.7M–1.7M)</p></td><td align="left"><p>&lt;1.5</p></td><td align="left"><p>–</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>Hou [<xref ref-type="bibr" rid="CR26">26</xref>]</p></td><td align="left"><p>multitask NN</p></td><td align="left"><p>QM9</p></td><td align="left"><p>(119k–13k)</p></td><td align="left"><p>44.0</p></td><td align="left"><p>0.38</p></td><td align="left"><p>0.63</p></td></tr><tr><td align="left"><p>Schütt [<xref ref-type="bibr" rid="CR24">24</xref>]</p></td><td align="left"><p>SchNet NN</p></td><td align="left"><p>QM9</p></td><td align="left"><p>(CV 110k–10k)</p></td><td align="left"><p>0.32</p></td><td align="left"><p>0.04</p></td><td align="left"><p>0.03</p></td></tr><tr><td align="left"><p>Lubbers [<xref ref-type="bibr" rid="CR27">27</xref>]</p></td><td align="left"><p>HIP-NN</p></td><td align="left"><p>QM9</p></td><td align="left"><p>(CV 110k–20k)</p></td><td align="left"><p>0.26</p></td><td align="left"><p>–</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>Unke [<xref ref-type="bibr" rid="CR28">28</xref>]</p></td><td align="left"><p>HDNN</p></td><td align="left"><p>QM9</p></td><td align="left"><p>(CV 100k–30k)</p></td><td align="left"><p>0.41</p></td><td align="left"><p>–</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>Willatt [<xref ref-type="bibr" rid="CR30">30</xref>]</p></td><td align="left"><p>KRR/SOAP</p></td><td align="left"><p>QM9</p></td><td align="left"><p>(CV 100k–30k)</p></td><td align="left"><p>0.14</p></td><td align="left"><p>–</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>Unke [<xref ref-type="bibr" rid="CR2">2</xref>]</p></td><td align="left"><p>PhysNet NN</p></td><td align="left"><p>QM9</p></td><td align="left"><p>(CV 110k–20k)</p></td><td align="left"><p>0.14</p></td><td align="left"><p>–</p></td><td align="left"><p>–</p></td></tr></tbody></table><table-wrap-foot><p>CV denotes a cross validation procedure. Since NN descriptors can be quite complex, they have been omitted</p></table-wrap-foot></table-wrap></p>
          <p id="Par7">Alongside with kernel methods, several Neural Networks (NN) have been proposed and tested for the prediction of energetic and electronic properties of QM9. Complex NN architectures have been carefully designed to achieve good predictive performances. For instance, some convolutional layers are inspired by the “alchemical” descriptors mentioned above. Such models can be expected to have a good capacity for generalization. The precise description of those NN architectures is beyond the scope of this article. Gilmer et al. have proposed a framework called Message Passing Neural Networks (MPNNs), that shares common attributes of several promising existing NN models for graph structured data and uses bond type features in addition to interatomic distances [<xref ref-type="bibr" rid="CR23">23</xref>]. It achieved exciting performances on QM9 benchmark where 11 out of 13 properties were predicted within chemical accuracy (1 kcal/mol on total energies and 0.1 eV for orbital energies). It is worth noting here that the reported values in the literature correspond to scores on test sets (a random sample of the dataset unseen during training) generally after cross validation (average over different runs with different subsets of data). The next study was a neural network engine for molecular energies called ANI, representing transferable neural network potentials and utilizing a Behler and Parrinello symmetry functions to build single-atom atomic environment vector [<xref ref-type="bibr" rid="CR22">22</xref>]. ANI has been shown to predict total molecular energies at the level of &lt; 1.5 kcal/mol albeit with a much larger training set size (a subset of GDB-11). This model has been very recently refined and errors in total energies prediction equal to 0.14 kcal/mol were reported by Smith et al. [<xref ref-type="bibr" rid="CR1">1</xref>] Schütt et al. have proposed a deep tensor neural network (DTNN) to mimic many-body Hamiltonians [<xref ref-type="bibr" rid="CR34">34</xref>]. Then they have introduced continuous filter convolutional layers as novel building blocks for deep neural networks [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR35">35</xref>]. The architecture has been called SchNet. The reported accuracy achieved by SchNet on QM9 is 0.32 kcal/mol for <inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:msub><mml:mi>U</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq3.gif" /></alternatives></inline-formula> and 0.04 − 0.03 eV for HOMO and LUMO energies. Finally, Willatt et al. published a KRR model with a SOAP descriptor and Unke et al. a complex NN architecture PhysNet. Both also reach a MAE of 0.14 kcal/mol on total energies [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR30">30</xref>]. The advances in accuracy achieved for energetic properties of QM9 is truly enthusiastic. However, the correspondence of the virtual combinatorial dataset to subsets of real molecules has not yet been examined. The expectation of a scientist working with a custom dataset, regarding the performance achievable by the variety of ML methods and tools built upon QM9, could hence be overestimated.</p>
          <p id="Par8">We propose here to address to the largest database of existing compounds, PubChem [<xref ref-type="bibr" rid="CR36">36</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]. Approximately <inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:mo>≈</mml:mo></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\approx$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq4.gif" /></alternatives></inline-formula> 3 million molecules in PubChem have been calculated by Nakata et al. within the framework of PubChemQC project, with a DFT method at the B3LYP/6-31G(d) level [<xref ref-type="bibr" rid="CR38">38</xref>]. In this article we have applied the limitations of QM9 dataset (size of up to 9 heavy atoms in the range C, N, O and F) to isolate a new dataset. Named PC9, it can be used for benchmarking comparison with QM9.</p>
          <p id="Par9">This study is constructed in accordance with the workflow given in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. In the context of our research, we started by reproducing simple models, ie. Elastic Net (EN) and Kernel Ridge Regression (KRR) with Coulomb Matrices (CM), on QM9 and trying to assess their performances on PC9. As a first more complex model we began to look at SchNet, which was easily available. Results suggest generalization issues. So, in the last part we investigate the role of the dataset.</p>
          <p id="Par10">In the reproducibility and assessment parts, the comparison with QM9 results has been made possible by an identical modeling protocol. In the generalizability part, the ability to predict molecules of the other dataset, that were not seen during training, was evaluated. It consists in testing a model, trained on one of the datasets, for its prediction performance on molecules of the other dataset notwithstanding of their different chemical nature, occasional conformational discrepancies and different level of DFT theory. This topic is indeed almost never treated. Collins et al. has shown that a KRR model trained on QM7 and applied on QM9 displays an increase in MAE for <inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:msub><mml:mi>U</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq5.gif" /></alternatives></inline-formula> from 3.4 to 106 kcal/mol with CM and from 2.4 to 30 kcal/mol with BoB [<xref ref-type="bibr" rid="CR18">18</xref>]. However, HOMO and LUMO energies accuracy has been maintained around 0.15 eV. As it has already been observed by Faber et al. [<xref ref-type="bibr" rid="CR31">31</xref>], the association of KRR and CM or BoB descriptors generalize badly compared to models which decompose the energies into atomic contributions. Can a complex NN architecture like SchNet that does such decomposition generalize better?</p>
          <p id="Par11">The last part of this article is devoted to the study of the differences between QM9 and PC9 in terms of chemical composition, abundance of functional groups and bond length distribution. Similarities and differences between the two datasets are exposed and visualized, providing insights concerning the ML performances.</p>
        </sec>
        <sec id="Sec2" sec-type="methods">
          <title>Method</title>
          <sec id="Sec3">
            <title>PubChemQC subset: PC9</title>
            <p id="Par12">Contrary to the pure in silico approach of QM9, PubChemQC represents so-far the largest quantum chemistry database of publicly reported molecules [<xref ref-type="bibr" rid="CR38">38</xref>]. PubChemQC calculations are based on a DFT approach at the B3LYP/6-31G(d) level of theory and comprises more than 3 million molecules. The ground state geometries were optimized but no frequency calculations have been performed. To compare the ML predictions on QM9 and PubChemQC datasets, a congruent subset that meets QM9 limitations, i.e. restricted to up to 9 heavy atoms of the series H, C, N, O and F has been extracted. Chemical species were compared using the IUPAC International Chemical Identifier (InChI) notation [<xref ref-type="bibr" rid="CR39">39</xref>]. The InChI for PubChemQC have been generated from the 3D Cartesian coordinates using the Open Babel software (version 2.4.1) [<xref ref-type="bibr" rid="CR40">40</xref>]. A comparison has been performed between the InChI strings of the two datasets without the enantiomeric sublayer. Out of 3 million molecules in PubChemQC database, 118,662 met QM9 limitations. Out of this number, 99,234 InChI were unique since enantiomers, tautomers, isotopes or specific artefacts in PubChem lead to duplicated InChIs.</p>
            <p id="Par13">Different conformations for same chemical structure have been observed comparing QM9 and PC9. This point, as well as the composition and chemical function diversity of the two datasets, will be discussed further in section of generalization ability of SchNet models (see "<xref rid="Sec13" ref-type="sec">Generalization ability of SchNet neural networks
models</xref>" and <xref rid="Sec16" ref-type="sec">Chemical differences between QM9 and PC9</xref> sections). The prepared subset of 99,234 molecules is composed of two groups, the one comprising molecules that also belong to QM9 and the one with the molecules unique for PubChemQC. The former encompass 18,357 compounds and the latter contains 80,877 compounds. Hereafter we will only discuss the set of 99,234 molecules, which is indicated as PC9, but not the whole PubChemQC data.</p>
            <p id="Par14">As opposed to QM9, where all the molecules are constrained to be closed-shelled neutral compounds, a crucial point of PC9 is the presence of species whose multiplicity is <inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:mrow><mml:mo>></mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$> 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq6.gif" /></alternatives></inline-formula>. That represents 5,325 molecules out of 99,234. Among which, 4442 are radicals (<inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_s = 2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq7.gif" /></alternatives></inline-formula>) and the remain 883 have a multiplicity of 3 (triplets). The prediction of those compounds has been analyzed separately and discussed further below.</p>
          </sec>
          <sec id="Sec4">
            <title>Predicted properties</title>
            <p id="Par15">Three key energetic properties have been considered in this article: total molecular energy E or <inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:msub><mml:mi>U</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq8.gif" /></alternatives></inline-formula> (kcal/mol), energy of HOMO (eV) and energy of LUMO (eV). In QM9 dataset those values are readily available. However, the <inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:msub><mml:mi>U</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq9.gif" /></alternatives></inline-formula> incorporates the zero point vibrational energy (zpve), when the total (SCF) energies of PubChemQC do not include it. Therefore, when speaking of reproducibility of the reported QM9 modeling results ( "<xref rid="Sec11" ref-type="sec">Reproducibility of QM9</xref>" section) we refer to the original <inline-formula id="IEq10"><alternatives><mml:math id="IEq10_Math"><mml:msub><mml:mi>U</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq10.gif" /></alternatives></inline-formula> values, while the part of generalization ability of SchNet models ("<xref rid="Sec13" ref-type="sec">Generalization ability of SchNet Neural Networks
models</xref>" section) implies recalculation of E from <inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:msub><mml:mi>U</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq11.gif" /></alternatives></inline-formula> in QM9 by subtraction of zpve, <inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mi>z</mml:mi><mml:mi>p</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E = U_0 - zpve$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq12.gif" /></alternatives></inline-formula>. Thus, both QM9 and PC9 datasets were attributed with a property of the same type.</p>
            <p id="Par16">It is important to mention that during modeling procedure, the atomization energies were used instead of total energies E (or <inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:msub><mml:mi>U</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq13.gif" /></alternatives></inline-formula>), for all ML methods. The atomization energy is the energy that remains after subtraction of the energies of all constituent atoms from the total energy of a molecule. Prediction of atomization energies instead of total energies is a common practice and is done in order to facilitate the training and to lower the magnitude of the property. The values of HOMO and LUMO were left in its original.</p>
          </sec>
          <sec id="Sec5">
            <title>Molecular representation</title>
            <p id="Par17">As stated in the introduction, several molecular representation have been used. The most common one is the Coulomb Matrix (CM) [<xref ref-type="bibr" rid="CR12">12</xref>]. CM is a square atom by atom matrix constructed from atomic nuclear charges (Z) and Cartesian coordinates of each atom (R):<disp-formula id="Equ1"><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">II</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mspace width="0.166667em" /></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow /><mml:mn>0.5</mml:mn><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>I</mml:mi><mml:mrow><mml:mn>2.4</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow /><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi mathvariant="italic">IJ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mspace width="0.166667em" /></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow /><mml:mfrac><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:msub><mml:mi>Z</mml:mi><mml:mi>J</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="1em" /><mml:mi>I</mml:mi><mml:mo>≠</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} C_{II} =\, &amp; {} 0.5 Z_I^{2.4} \\ C_{IJ} =\, &amp; {} \frac{Z_I Z_J}{|\mathbf R _I - \mathbf R _J|} \quad I \ne J \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_Equ1.gif" /></alternatives></disp-formula>The off-diagonal elements of the CM then correspond to Coulomb nuclear repulsion terms whereas the diagonal elements approximate the electronic potential energies of the free atoms. Atom indexes in CM can then be sorted. This representation is invariant under translations and orthogonal transformations of Cartesian coordinates as well as under permutation of the indexing order of atomic numbers. Prior to modeling, CM have been standardized, i.e. scaled to zero mean and a standard deviation equal to one.</p>
            <p id="Par18">Neural Networks training has been performed with SchNet, whose predefined architecture implies row Cartesian coordinates as an input. The initial coordinates are then transformed by the algorithm in a set of layer-dependent features [<xref ref-type="bibr" rid="CR35">35</xref>].</p>
          </sec>
          <sec id="Sec6">
            <title>Machine learning techniques</title>
            <sec id="Sec7">
              <title>Kernel ridge regression (KRR)</title>
              <p id="Par19">KRR represents a non-parametric form of ridge regression (linear least squares with L2-norm regularization) combined with kernel trick. The goal is thus to find a linear relationship in a space induced by the corresponding kernel by minimizing a squared loss:<disp-formula id="Equ2"><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>∑</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} C = \frac{1}{2} \sum (y_i - w^T x_i )^2 + \frac{1}{2} \lambda \Vert w\Vert \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_Equ2.gif" /></alternatives></disp-formula>where <italic>w</italic> is the matrix of weights, <italic>x</italic> is the predicted value, <italic>y</italic> is the reference value. A closed solution form could be written as:<disp-formula id="Equ3"><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mi>y</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} w = y (K +\lambda I )^{-1} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_Equ3.gif" /></alternatives></disp-formula>where <italic>K</italic> is the kernel matrix. The parameters of the method were set up in accordance with Faber’s work [<xref ref-type="bibr" rid="CR17">17</xref>]. The modeling has been performed with the scikit-learn package [<xref ref-type="bibr" rid="CR41">41</xref>]. The regularization parameter <inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:mi>α</mml:mi></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq14.gif" /></alternatives></inline-formula> has been set to <inline-formula id="IEq15"><alternatives><mml:math id="IEq15_Math"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{-9}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq15.gif" /></alternatives></inline-formula>. Two types of kernels, Laplacian and RBF were used. Their widths have been chosen by a grid search on base-2 logarithmic grid (from 0.25 to 8192 for RBF kernel and from 0.1 to 16,384 for Laplacian kernel) for 10% of training set. Prior to learning, the feature vectors were normalized by the Euclidean (RBF kernel) or Manhattan (Laplacian kernel) norms.</p>
            </sec>
            <sec id="Sec8">
              <title>Elastic net (EN)</title>
              <p id="Par20">EN [<xref ref-type="bibr" rid="CR42">42</xref>] could be represented as a combination of lasso regression [<xref ref-type="bibr" rid="CR43">43</xref>] and ridge regression [<xref ref-type="bibr" rid="CR44">44</xref>]. It is a linear model with the penalty being a mix of L1 and L2 terms. Similar to modeling with KRR, EN hyperparameters were tuned up in a way it has been described in the article of Faber [<xref ref-type="bibr" rid="CR17">17</xref>]. The l1 ratio was left at the default value of 0.5. A grid search has been performed to find an optimal regularization parameter (<inline-formula id="IEq16"><alternatives><mml:math id="IEq16_Math"><mml:mi>α</mml:mi></mml:math><tex-math id="IEq16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq16.gif" /></alternatives></inline-formula>) on a base-10 logarithmic scale from <inline-formula id="IEq17"><alternatives><mml:math id="IEq17_Math"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{-6}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq17.gif" /></alternatives></inline-formula> to 1.0 on the whole dataset. It is by far, the simplest and fastest method. It can serve as a crude approach to highlight the added value of more complex approaches, like NN.</p>
            </sec>
            <sec id="Sec9">
              <title>SchNet neural networks</title>
              <p id="Par21">NN is a class of ML algorithms whose structure is modelled after the paradigm of biological nervous system functioning [<xref ref-type="bibr" rid="CR45">45</xref>–<xref ref-type="bibr" rid="CR48">48</xref>]. The architecture of NN consists of a network of neurons interconnected via weights and arranged in layers. The SchNet deep learning architecture is a variant of deep tensor neural networks (DTNN) and its architecture therefore includes such blocks as atom embeddings, interaction refinements and atom-wise energy contributions [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR35">35</xref>]. At each layer, the atomistic system is represented atom-wise and refined using pairwise interactions with the surrounding atoms. To deal with unevenly spaced data such as atom positions, SchNet is provided with the continuous-filter convolutional layer (cfconv) that models the interaction term. The detailed architecture of SchNet is explained in Ref. [<xref ref-type="bibr" rid="CR24">24</xref>].</p>
              <p id="Par22">In accordance to the original publications, the following parameters have been used while training: initial learning rate <inline-formula id="IEq18"><alternatives><mml:math id="IEq18_Math"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{-4}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq18.gif" /></alternatives></inline-formula>, batch size 32, number of features 256, number of interaction blocks 6, learning rate decay 0.5. The size of the training set has been set to 110,000 molecules, 1000 were used for early stopping and the remain quantity was assigned to test set.<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>Workflow of this study</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_391_Fig1_HTML.png" id="MO4" /></fig></p>
            </sec>
          </sec>
        </sec>
        <sec id="Sec10">
          <title>Results and discussion</title>
          <sec id="Sec11">
            <title>Reproducibility of QM9</title>
            <sec id="Sec22">
              <title>EN and KRR</title>
              <p>Following the original work [<xref ref-type="bibr" rid="CR17">17</xref>] and with some guidance by Faber, we were able to reproduce the EN and KRR results on QM9 using Coulomb Matrix as molecular descriptors (see Tables <xref rid="Tab1" ref-type="table">1</xref> and <xref rid="Tab2" ref-type="table">2</xref>). For <inline-formula id="IEq19"><alternatives><mml:math id="IEq19_Math"><mml:msub><mml:mi>U</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq19.gif" /></alternatives></inline-formula> a MAE of 4.9 kcal/mol has been obtained instead of 3.0 kcal/mol for KRR. Small changes have been made in the grid search to estimate the best hyperparameters. It has been done once in a 10-fold cross-validation on the whole dataset for EN and on 10% of a dataset (randomly chosen) for KRR. The best <inline-formula id="IEq20"><alternatives><mml:math id="IEq20_Math"><mml:mi>α</mml:mi></mml:math><tex-math id="IEq20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq20.gif" /></alternatives></inline-formula> for EN was always 0.001 and the best <inline-formula id="IEq21"><alternatives><mml:math id="IEq21_Math"><mml:mi>γ</mml:mi></mml:math><tex-math id="IEq21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq21.gif" /></alternatives></inline-formula> of KRR were 1.0 (<inline-formula id="IEq22"><alternatives><mml:math id="IEq22_Math"><mml:msub><mml:mi>U</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq22.gif" /></alternatives></inline-formula>), 2.0 (HOMO) and 4.0 (LUMO). Like for Faber, Laplacian kernel performed best in all three cases. The model performance has been evaluated during repeated random shuffling [20 times (EN)/5 times (KRR)] with 90% data being training set and the remain 10% being test. The average statistics is referred in Table <xref rid="Tab2" ref-type="table">2</xref>. KRR requires a strict hyperparameter adjustment. Its performance is more sensitive toward data selection and may lead to different results depending on the training subset. EN and KRR can be trained to predict E with almost the same precision as for <inline-formula id="IEq23"><alternatives><mml:math id="IEq23_Math"><mml:msub><mml:mi>U</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq23.gif" /></alternatives></inline-formula>.<table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>Mean absolute errors for total energies (<inline-formula id="IEq24"><alternatives><mml:math id="IEq24_Math"><mml:msub><mml:mi>U</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq24.gif" /></alternatives></inline-formula> and E in kcal/mol), HOMO and LUMO energies (in eV) using different ML methods on different training and prediction datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Method</p></th><th align="left"><p>Train</p></th><th align="left"><p>Test</p></th><th align="left"><p><inline-formula id="IEq25"><alternatives><mml:math id="IEq25_Math"><mml:msub><mml:mi>U</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq25.gif" /></alternatives></inline-formula></p></th><th align="left"><p>E</p></th><th align="left"><p>HOMO</p></th><th align="left"><p>LUMO</p></th></tr></thead><tbody><tr><td align="left"><p>EN (CM)</p></td><td align="left"><p>QM9</p></td><td align="left"><p>QM9</p></td><td align="left"><p>21.1</p></td><td align="left"><p>22.0</p></td><td align="left"><p>0.34</p></td><td align="left"><p>0.64</p></td></tr><tr><td align="left"><p>KRR (CM)</p></td><td align="left"><p>QM9</p></td><td align="left"><p>QM9</p></td><td align="left"><p>4.9</p></td><td align="left"><p>5.2</p></td><td align="left"><p>0.18</p></td><td align="left"><p>0.25</p></td></tr><tr><td align="left"><p>SchNet</p></td><td align="left"><p>QM9</p></td><td align="left"><p>QM9</p></td><td align="left"><p>0.3</p></td><td align="left"><p>1.0</p></td><td align="left"><p>0.04</p></td><td align="left"><p>0.03</p></td></tr><tr><td align="left"><p>EN (CM)</p></td><td align="left"><p>PC9</p></td><td align="left"><p>PC9</p></td><td align="left"><p>–</p></td><td align="left"><p>38.2</p></td><td align="left"><p>0.47</p></td><td align="left"><p>0.66</p></td></tr><tr><td align="left"><p>KRR (CM)</p></td><td align="left"><p>PC9</p></td><td align="left"><p>PC9</p></td><td align="left"><p>–</p></td><td align="left"><p>22.8</p></td><td align="left"><p>0.31</p></td><td align="left"><p>0.36</p></td></tr><tr><td align="left"><p>SchNet</p></td><td align="left"><p>PC9</p></td><td align="left"><p>PC9</p></td><td align="left"><p>–</p></td><td align="left"><p>1.6</p></td><td align="left"><p>0.06</p></td><td align="left"><p>0.05</p></td></tr><tr><td align="left"><p>SchNet</p></td><td align="left"><p>QM9</p></td><td align="left"><p>PC9(A)</p></td><td align="left"><p>–</p></td><td align="left"><p>3.0</p></td><td align="left"><p>0.07</p></td><td align="left"><p>0.06</p></td></tr><tr><td align="left"><p>SchNet</p></td><td align="left"><p>QM9</p></td><td align="left"><p>PC9(B)</p></td><td align="left"><p>–</p></td><td align="left"><p>8.9</p></td><td align="left"><p>0.33</p></td><td align="left"><p>0.27</p></td></tr><tr><td align="left"><p>SchNet</p></td><td align="left"><p>PC9</p></td><td align="left"><p>QM9(A)</p></td><td align="left"><p>–</p></td><td align="left"><p>3.4</p></td><td align="left"><p>0.05</p></td><td align="left"><p>0.05</p></td></tr><tr><td align="left"><p>SchNet</p></td><td align="left"><p>PC9</p></td><td align="left"><p>QM9(B)</p></td><td align="left"><p>–</p></td><td align="left"><p>4.2</p></td><td align="left"><p>0.12</p></td><td align="left"><p>0.11</p></td></tr></tbody></table><table-wrap-foot><p>(A) corresponds to the subset of molecules that belongs to QM9 and PC9, whereas (B) indicates molecules exclusive to the dataset</p></table-wrap-foot></table-wrap></p>
            </sec>
            <sec id="Sec34">
              <title>SchNet NN</title>
              <p>The reproduction of QM9 predictions with SchNet is made easier owing to the recently published SchNetpack toolbox [<xref ref-type="bibr" rid="CR49">49</xref>]. According to the reported results, the accuracy of SchNet that could be achieved with a training size of 110,000 compounds on QM9 is around 0.3 kcal/mol for <inline-formula id="IEq26"><alternatives><mml:math id="IEq26_Math"><mml:msub><mml:mi>U</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq26.gif" /></alternatives></inline-formula>, 0.04 eV for HOMO energies and 0.03 eV for LUMO energies. The verification of this result could be done following the modeling procedure described in the source paper and thanks to indications from K.T.Schütt and M.Gastegger [<xref ref-type="bibr" rid="CR35">35</xref>]. After <inline-formula id="IEq27"><alternatives><mml:math id="IEq27_Math"><mml:mo>≈</mml:mo></mml:math><tex-math id="IEq27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\approx$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq27.gif" /></alternatives></inline-formula> 18 hours of calculation and passing from 300 to 500 epochs per property, the training reached MAE of 0.32 kcal/mol for <inline-formula id="IEq28"><alternatives><mml:math id="IEq28_Math"><mml:msub><mml:mi>U</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq28.gif" /></alternatives></inline-formula>, 0.04 eV for HOMO and 0.03 eV for LUMO (see Table <xref rid="Tab2" ref-type="table">2</xref>). It is worth noting that the performance of SchNet on QM9 using the total scf energies E correspond to an increased MAE of 1.0 kcal/mol keeping the same training parameters as for <inline-formula id="IEq29"><alternatives><mml:math id="IEq29_Math"><mml:msub><mml:mi>U</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq29.gif" /></alternatives></inline-formula>, loosing more precision than the KRR model when going from <inline-formula id="IEq30"><alternatives><mml:math id="IEq30_Math"><mml:msub><mml:mi>U</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><tex-math id="IEq30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq30.gif" /></alternatives></inline-formula> to E. A factor of 3 in the MAE of the predictions for similar properties could indicate a generalization issue. Nevertheless, we confirm here that SchNetpack toolbox can easily and effectively predict within chemical accuracy molecular properties of QM9 dataset.</p>
            </sec>
          </sec>
          <sec id="Sec12">
            <title>PC9 modeling results</title>
            <p id="Par25">The same three ML algorithms were considered on PC9 dataset: EN and KRR trained on Coulomb Matrix and SchNet NN. The whole set of 99,234 compounds has been used. Grid search for best parameters led to <inline-formula id="IEq31"><alternatives><mml:math id="IEq31_Math"><mml:mi>γ</mml:mi></mml:math><tex-math id="IEq31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq31.gif" /></alternatives></inline-formula> 2.0, 8.0 and 8.0 (E/HOMO/LUMO) for KRR (Laplacian kernel) and <inline-formula id="IEq32"><alternatives><mml:math id="IEq32_Math"><mml:mi>α</mml:mi></mml:math><tex-math id="IEq32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq32.gif" /></alternatives></inline-formula> value of 0.001 (E/HOMO/LUMO) for EN.</p>
            <p id="Par26">The results of the modeling are given in Table <xref rid="Tab2" ref-type="table">2</xref>. The numbers for EN and KRR refer to an average of 20/5 (EN/KRR) times random shuffling with training/test proportion of 90%/10%. The accuracy achieved on PC9 by all models is lower compared to the one achieved on QM9 data. This result could derive from higher chemical homogeneity of QM9 and a more curated workflow of quantum computational calculations (see "<xref rid="Sec16" ref-type="sec">Chemical differences between QM9 and PC9</xref>" section). For KRR, the performances are quite disappointing even for the Molecular Orbitals energies. In Fig. <xref rid="Fig2" ref-type="fig">2</xref> the learning curves for total SCF energies E of SchNet and KRR models with Coulomb matrices are reported for both datasets. When the training set encompasses more than 10000 compounds the NN models become competitive. The performance of SchNet on a new dataset is promising. The PC9 dataset appears to be a bit more challenging than QM9.<fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>Mean absolute error assessed by a 10 fold cross validation with an increasing training set size for KRR and SchNet models. Training and test sets belongs to the same data set, either QM9 or PC9</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_391_Fig2_HTML.png" id="MO11" /></fig></p>
          </sec>
          <sec id="Sec13">
            <title>Generalization ability of SchNet neural networks models</title>
            <p id="Par27">Since the QM9 and PC9 are quite comparable in size, we were able to test the generalizability of the SchNet models.</p>
            <sec id="Sec14">
              <title>Predicting PC9 with QM9 models</title>
              <p id="Par28">The SchNet model trained on QM9 data has been used to predict two subsets of PC9. The first one (A) is a subset which is common for both QM9 and PC9 (see "<xref rid="Sec3" ref-type="sec">Reproducibility of QM9</xref>") and the second subset (B) consists of compounds that did not appear in QM9. However, the molecules in subset A are not identical. The differences in energies and in nuclear repulsion energy (NRE) between the corresponding compounds from QM9 and from PC9 are shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, b. Some compounds present a huge NRE difference. That is due to InChI comparison that could match different tautomeric or conformational forms. Figure <xref rid="Fig4" ref-type="fig">4</xref> demonstrates the examples with <inline-formula id="IEq34"><alternatives><mml:math id="IEq34_Math"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math><tex-math id="IEq34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq34.gif" /></alternatives></inline-formula>NRE >10,000 kcal/mol). Due to the slightly different level of theory, total energies of QM9 are also consistently lower compared to energies of PC9 (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b), with a maximum at − 20 kcal/mol. But, a linear relationship could compensate the divergence caused by different basis sets (B3LYP/6-31G(2df,p) <italic>vs.</italic> B3LYP/6-31G(d)). Once the energetic values of PC9 have been predicted by the model, we used an a posteriori linear correction to compare them with the original DFT calculated energies. The best fit has been obtained with the Huber regression linear models [<xref ref-type="bibr" rid="CR50">50</xref>]. The fitted values were then compared with the original values. It is worth noting here that this regression is essentially useful for total molecular energies since the differences in HOMO and LUMO energies between QM9 and PC9 are centered at 0 eV (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>c).<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>Histogram of distribution of the difference in <bold>a</bold> total energies E, <bold>b</bold> in Nuclear Repulsion Energies (NRE), <bold>c</bold> in HOMO (darker) and LUMO energies for 18,357 molecules present in both QM9 and PC9</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_391_Fig3_HTML.png" id="MO5" /></fig><fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>Examples of structures with large difference in Nuclear Repulsion Energies (NRE) calculated for QM9 and PubChemQC geometry</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_391_Fig4_HTML.png" id="MO6" /></fig></p>
              <p id="Par29"><italic>Performance on E</italic>, <inline-formula id="IEq35"><alternatives><mml:math id="IEq35_Math"><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mi>O</mml:mi><mml:mi>M</mml:mi><mml:mi>O</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math><tex-math id="IEq35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _{(HOMO)}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq35.gif" /></alternatives></inline-formula><italic>and</italic><inline-formula id="IEq36"><alternatives><mml:math id="IEq36_Math"><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mi>U</mml:mi><mml:mi>M</mml:mi><mml:mi>O</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math><tex-math id="IEq36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _{(LUMO)}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq36.gif" /></alternatives></inline-formula>. The results for the predictions of the three properties on subsets A and B after linear correction are reported in Table <xref rid="Tab2" ref-type="table">2</xref>. For E, a MAE of 3.0 kcal/mol is found on the subset A. It is more than the 1.0 kcal/mol found on QM9 when trained on QM9. But, an increase in MAE was expected since the QM9-PC9 energy differences has been found to be quite spread (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). The predictions are above the chemical accuracy but still much better than a KRR prediction on PC9, trained on PC9. However, the prediction of E on subset B gives a MAE of 8.9 kcal/mol. Figure <xref rid="Fig5" ref-type="fig">5</xref> shows the density plot for subset B predictions. For clarity reasons, we have cut the x-axis range of the graph from −50 to +100 kcal/mol. Some 231 extreme and spread outliers were omitted by this way (225 of QM9 model and 6 of PC9 model). The blue color represents the results obtained with the model trained on QM9 and applied on subset B of PC9. The plot for total energies has a clear bias toward overestimated energy of certain part of data. An analysis of the outliers follows in the next paragraph. Concerning the results for HOMO and LUMO energies predictions, the MAE for subset A are almost the same as observed on the training set (see Table <xref rid="Tab2" ref-type="table">2</xref>). The density plots for subset B correspond to spread and asymmetrical curves (Fig. <xref rid="Fig5" ref-type="fig">5</xref>, blue), associated with MAE of 0.33 and 0.27 eV.<fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p>Generalization ability results: error density plots for the prediction of total energies E (kcal/mol), HOMO and LUMO energies (eV) of set B. The blue (pink) curve represents predictions by a model trained on QM9 (PC9) on unknown molecules exclusive to PC9 (QM9)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_391_Fig5_HTML.png" id="MO9" /></fig></p>
              <p id="Par30"><italic>Outliers analysis.</italic> To propose a rationale for the observed degraded performance, the species with an absolute prediction error over 30 kcal/mol for E and 1.5 eV for HOMO and LUMO energies were extracted and analyzed. Out of 80,877 compounds of subset B, 5,305 (6.5%) present MAE over 30 kcal/mol on E and 1527 (1.88%) present MAE over 1.5 eV on HOMO energy. They can be classified mainly into two main classes: (1) outliers with multiplicity different than one and (2) outliers with specific functional groups</p>
              <p id="Par31">As it was mentioned earlier (see "<xref rid="Sec3" ref-type="sec">PubChemQC subset: PC9</xref>"), PC9 contains compounds with multiplicities ranging from one to three whereas QM9 data are strictly closed shelled systems. Radicals and triplets possess indeed electronic structures that are usually more reactive. Out of 5,325 PC9 compounds with a multiplicity not equal to one, 2,476 were outliers. Among them, there were 883 molecules bearing multiplicity of 3, which is 100% of all the triplet compounds. 35.5% of all monoradicals are outliers in PC9. The histogram of the original and predicted total energies for the 5,325 molecules with non single multiplicity is shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. It can be observed that the neural network always overestimates the stability of such compounds, since not provided the information about the multiplicity. For the HOMO energies, out of 1527 outliers, 1200 were attributed to molecules with the multiplicity> 1.<fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><p>Original vs predicted by QM9 SchNet model total molecular energies (E, kcal/mol) of PC9 molecules with multiplicity equal to two or three</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_391_Fig6_HTML.png" id="MO10" /></fig></p>
              <p id="Par32">The next class of structures with large prediction errors includes molecules with specific functional groups. Even with the same atom list (H, C, N, O and F), the chemical diversity of QM9 and PC9 are different (see Table <xref rid="Tab3" ref-type="table">3</xref> and "<xref rid="Sec16" ref-type="sec">Chemical differences between QM9 and PC9</xref>" section). Three chemical functions, determined by Checkmol software, have been constantly spotted among outliers [<xref ref-type="bibr" rid="CR51">51</xref>]. These were diaryl ethers (0.01% of PC9 and absent in QM9), peroxydes (0.17% of PC9 and absent in QM9) and dyarilamines (very few cases in PC9 and absent in QM9). Out of 5,305 outliers, 1,320 belong to one of these three classes. Finally, it could be noted that 568 structures of the outliers present rare functional groups that were not detected by Checkmol (such as peroxyacetylnitrates, diflouroamines, perfluoroallenes, nitramines, tetraenes...).<table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p>Selection of functional groups detected by Checkmol with their corresponding number of molecules in PC9 and QM9 datasets and MAE in generalization conditions</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"><p>Selection</p></th><th align="left" rowspan="2"><p>Functional group classes</p></th><th align="left" colspan="2"><p>PC9 data</p></th><th align="left" colspan="2"><p>QM9 data</p></th></tr><tr><th align="left"><p>Occurrences</p></th><th align="left"><p>QM9 model</p></th><th align="left"><p>Occurrences</p></th><th align="left"><p>PC9 model</p></th></tr></thead><tbody><tr><td align="left" rowspan="5"><p>CF and NN bonds</p></td><td align="left"><p>Azide</p></td><td char="." align="char"><p>358</p></td><td align="left"><p>11.5</p></td><td char="." align="char"><p>0</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>Azo compound</p></td><td char="." align="char"><p>272</p></td><td align="left"><p>5.3</p></td><td char="." align="char"><p>10</p></td><td align="left"><p>4.1</p></td></tr><tr><td align="left"><p>Acyl fluoride</p></td><td char="." align="char"><p>105</p></td><td align="left"><p>6.4</p></td><td char="." align="char"><p>0</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>Aryl fluoride</p></td><td char="." align="char"><p>936</p></td><td align="left"><p>9.4</p></td><td char="." align="char"><p>1562</p></td><td align="left"><p>4.1</p></td></tr><tr><td align="left"><p>Alkyl fluoride</p></td><td char="." align="char"><p>4576</p></td><td align="left"><p>6.8</p></td><td char="." align="char"><p>52</p></td><td align="left"><p>4.3</p></td></tr><tr><td align="left" rowspan="8"><p>Abundant in QM9</p></td><td align="left"><p>Carbonitrile</p></td><td char="." align="char"><p>4624</p></td><td align="left"><p>5.4</p></td><td char="." align="char"><p><italic>10315</italic></p></td><td align="left"><p>4.7</p></td></tr><tr><td align="left"><p>Secondary alcohol</p></td><td char="." align="char"><p>6282</p></td><td align="left"><p>6.2</p></td><td char="." align="char"><p><italic>10668</italic></p></td><td align="left"><p>4.3</p></td></tr><tr><td align="left"><p>Trialkylamine</p></td><td char="." align="char"><p>3301</p></td><td align="left"><p>6.4</p></td><td char="." align="char"><p><italic>10687</italic></p></td><td align="left"><p>4.2</p></td></tr><tr><td align="left"><p>Alkyne</p></td><td char="." align="char"><p>3906</p></td><td align="left"><p>6.1</p></td><td char="." align="char"><p><italic>10873</italic></p></td><td align="left"><p>4.5</p></td></tr><tr><td align="left"><p>Tertiary amine</p></td><td char="." align="char"><p>3388</p></td><td align="left"><p>6.4</p></td><td char="." align="char"><p><italic>11057</italic></p></td><td align="left"><p>4.2</p></td></tr><tr><td align="left"><p>Aromatic compound</p></td><td char="." align="char"><p>12728</p></td><td align="left"><p>8.2</p></td><td char="." align="char"><p><italic>15863</italic></p></td><td align="left"><p>4.3</p></td></tr><tr><td align="left"><p>Dialkyl ether</p></td><td char="." align="char"><p>9275</p></td><td align="left"><p>6.2</p></td><td char="." align="char"><p><italic>24012</italic></p></td><td align="left"><p>4.3</p></td></tr><tr><td align="left"><p>Heterocyclic compound</p></td><td char="." align="char"><p>42665</p></td><td align="left"><p>7.0</p></td><td char="." align="char"><p><italic>61904</italic></p></td><td align="left"><p>4.3</p></td></tr><tr><td align="left" rowspan="3"><p>QM9 model focus</p></td><td align="left"><p>Hydroperoxide</p></td><td char="." align="char"><p>717</p></td><td align="left"><p><italic>45.4</italic></p></td><td char="." align="char"><p>0</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>Diaryl ether</p></td><td char="." align="char"><p>22</p></td><td align="left"><p><italic>39.1</italic></p></td><td char="." align="char"><p>0</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>Peroxide</p></td><td char="." align="char"><p>430</p></td><td align="left"><p><italic>32.7</italic></p></td><td char="." align="char"><p>0</p></td><td align="left"><p>–</p></td></tr><tr><td align="left" rowspan="7" /><td align="left"><p>Diarylamine</p></td><td char="." align="char"><p>11</p></td><td align="left"><p><italic>32.6</italic></p></td><td char="." align="char"><p>0</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>Carbamic acid halide</p></td><td char="." align="char"><p>16</p></td><td align="left"><p><italic>24.4</italic></p></td><td char="." align="char"><p>0</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>Nitrite</p></td><td char="." align="char"><p>1</p></td><td align="left"><p><italic>22.7</italic></p></td><td char="." align="char"><p>0</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>Hydroxamic acid</p></td><td char="." align="char"><p>46</p></td><td align="left"><p><italic>19.4</italic></p></td><td char="." align="char"><p>0</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>Nitroso compound</p></td><td char="." align="char"><p>48</p></td><td align="left"><p><italic>17.0</italic></p></td><td char="." align="char"><p>0</p></td><td align="left"><p>–</p></td></tr><tr><td align="left"><p>Hydroxylamine</p></td><td char="." align="char"><p>805</p></td><td align="left"><p><italic>16.2</italic></p></td><td char="." align="char"><p>13</p></td><td align="left"><p>3.4</p></td></tr><tr><td align="left"><p>Hemiacetal</p></td><td char="." align="char"><p>819</p></td><td align="left"><p><italic>2.8</italic></p></td><td char="." align="char"><p>0</p></td><td align="left"><p>–</p></td></tr><tr><td align="left" rowspan="5"><p>PC9 model focus</p></td><td align="left"><p>Enol ether</p></td><td char="." align="char"><p>1977</p></td><td align="left"><p>4.4</p></td><td char="." align="char"><p>2</p></td><td align="left"><p><italic>16.0</italic></p></td></tr><tr><td align="left"><p>Amide acetal</p></td><td char="." align="char"><p>59</p></td><td align="left"><p>14.2</p></td><td char="." align="char"><p>28</p></td><td align="left"><p><italic>7.1</italic></p></td></tr><tr><td align="left"><p>Carboxylci acid</p></td><td char="." align="char"><p>4213</p></td><td align="left"><p>6.6</p></td><td char="." align="char"><p>106</p></td><td align="left"><p><italic>6.2</italic></p></td></tr><tr><td align="left"><p>Hemiaminal</p></td><td char="." align="char"><p>3034</p></td><td align="left"><p>6.5</p></td><td char="." align="char"><p>207</p></td><td align="left"><p><italic>6.0</italic></p></td></tr><tr><td align="left"><p>Acyl cyanide</p></td><td char="." align="char"><p>67</p></td><td align="left"><p>4.0</p></td><td char="." align="char"><p>281</p></td><td align="left"><p><italic>6.0</italic></p></td></tr></tbody></table><table-wrap-foot><p>The selection italic CF and NN interactions, the most prominent groups in QM9, the largest MAE of the model trained on QM9 and the largest MAE of the model trained on PC9</p></table-wrap-foot></table-wrap></p>
            </sec>
            <sec id="Sec15">
              <title>Predicting QM9 with PC9 model</title>
              <p id="Par33">In a reciprocal approach, the SchNet NN trained on PC9 data has been used for the prediction of QM9. Two subsets of QM9 have been prepared, subset A with the molecules common for both databases (18,357) and subset B (110,286) with the molecules exclusive to QM9. Subset A is therefore the same for QM9 and PC9, but their modeled values and their geometries are different with regard to the basis set. To compensate the basis set effect and to fit the predicted <italic>vs</italic> original values of QM9, the best correction was also found with an <italic>a posteriori</italic> Huber linear regression models [<xref ref-type="bibr" rid="CR52">52</xref>].</p>
              <p id="Par34">Table <xref rid="Tab2" ref-type="table">2</xref> shows the results of the prediction for the two subsets. For subset A, the results obtained by PC9 model are similar to the subset A results with the QM9 model. With 3.0 compared to 3.4 kcal/mol for E and 0.07/0.06 compared to 0.05/0.05 for HOMO and LUMO energies, the two models can therefore transfer their training on familiar data. But the most interesting result is the ability of PC9 model to predict unfamiliar data with a minimal loss of precision (4.2 compared to 3.4 kcal/mol for E in contrast to QM9 model with 8.9 and 3.0 kcal/mol). The accuracy for the HOMO and LUMO energies is almost at the 0.1 eV goal. Figure <xref rid="Fig5" ref-type="fig">5</xref> demonstrates the generalization ability of the model trained on PC9 over the subset B of QM9 (in pink) compared with the performance of QM9 model on subset B of PC9 (in blue). Indeed, error density plots of PC9 model are much narrower than their QM9 counterparts, indicating that there is not much of QM9 that is unfamiliar to PC9. This fact could speak for better generalization ability of PC9 models due to higher chemical diversity or even fewer purity or organization of data, which to a certain limit could make the model more stable toward noise and over-fitting.</p>
            </sec>
          </sec>
          <sec id="Sec16">
            <title>Chemical differences between QM9 and PC9</title>
            <sec id="Sec17">
              <title>Bond distances analysis</title>
              <p id="Par35">A way of looking at chemical diversity could be a pairwise analysis of bond length distributions over the two datasets. It has been done for the following pairs: C–C, C–H, C–N, C–O, C–F, N–N, N–H, O–N and O–H. Density distributions of those pairs is represented in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. There are clearly more alkynes (CC distance around 120 pm) in QM9. The distribution of C–H bonds is identical for both datasets and the slight shift can be assigned to the difference in the basis sets. An interesting observation could be found for the C–F and N–N bond distributions. In both cases the density of QM9 is located to the left. The fact that PC9 shows a much broader range of interactions designates that PC9 encompasses a more diverse chemistry.<fig id="Fig7"><label>Fig. 7</label><caption xml:lang="en"><p>Density distribution of pairwise bond lengths in QM9 and PC9</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_391_Fig7_HTML.png" id="MO7" /></fig></p>
            </sec>
            <sec id="Sec18">
              <title>Functional groups analysis</title>
              <p id="Par36">Therefore, an analysis of chemical composition and chemical diversity of QM9 and PC9 has been carried out. The functional group analysis has been achieved with the Checkmol software, capable of recognising 200 different functional groups [<xref ref-type="bibr" rid="CR51">51</xref>]. The difference in the number of identified functional groups between QM9 and PC9 is quite substantial with 97 groups spotted at least once in PC9 for 71 groups in QM9. Furthermore, the average number of functional groups per molecule is also different with 2.0 chemical group per molecule in PC9 compared to 3.1 in QM9. QM9 data therefore presents less diversity but also a higher concentration of chemical functions in only 9 “heavy” atoms at most. The functional groups were explicitly added during the molecular generation in QM9 to an extend that exceeds a real-life dataset.</p>
              <p id="Par37">A list of the number of molecules in QM9 and PC9 with specific groups is given in Table <xref rid="Tab3" ref-type="table">3</xref>. The complete table is available as an additional file. Different kinds of amines, alcohols, heterocycles, ether and aromatic compounds form the largest classes for both datasets. However, the table emphasizes MAE per functional group. 12 of the 16 functional groups with MAE over 10 kcal/mol on PC9 data for the model trained on QM9 are totally absent from QM9. It is the case of hydroperoxide, diarylether, peroxide, diaryl amine, nitrite, nitroso, cyanate... Keep in mind that small subsets predictions (molecules with specific uncommon functional groups) will be also more affected by outliers. Nevertheless, the Table <xref rid="Tab3" ref-type="table">3</xref> and the Fig. <xref rid="Fig8" ref-type="fig">8</xref> show that many unseen functional groups can also be correctly predicted by QM9 model like the hemiacetal. There is clearly some knowledge transfer. The model trained on PC9 shows a much homogeneous description of all functional groups. Apart from the 2 molecules with an enol ether function in QM9 (MAE > 10 kcal/mol), the biggest error is 7.1 kcal/mol for the amide acetal.<fig id="Fig8"><label>Fig. 8</label><caption xml:lang="en"><p>Generalization ability results: Mean absolute error for each functional groups subsets vs the number of molecules with the functional group on the test set. The blue dots (red triangles) represent predictions by a model trained on QM9 (PC9) on the other dataset PC9 (QM9)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_391_Fig8_HTML.png" id="MO12" /></fig></p>
            </sec>
            <sec id="Sec19">
              <title>Scaffold analysis</title>
              <p id="Par38">Chemical diversity has also been studied by the mean of scaffolds analysis [<xref ref-type="bibr" rid="CR53">53</xref>–<xref ref-type="bibr" rid="CR59">59</xref>]. We have used Scaffold network generator to generate the first layer of scaffolds for both datasets [<xref ref-type="bibr" rid="CR56">56</xref>]. Those scaffolds correspond to (poly)cyclic core. However, there are two issues for such analysis on QM9 and PC9. Firstly, QM9 and PC9 are limited up to nine “heavy” atoms. Many graph frameworks are missing compared to the ones found in organic chemistry by Lipkus et al. or in the PubChem analysis by Velkoborsky et al. Secondly, the ratio of acyclic compounds is radically different in the two datasets. In QM9, 10.5% of the molecules are acyclic and 24844 different scaffolds are found on the rest . For PC9, 40% of the molecules are acyclic and 11883 different scaffolds are found on the rest. QM9 does present much more scaffolds than PC9 with more complex polycyclic architectures. But, as it has been observed with the bond length analysis, QM9 lacks chemical diversity in the acyclic part. To resume the scaffold analysis, their cumulative frequency plots are represented in Fig. <xref rid="Fig9" ref-type="fig">9</xref>. The solid lines correspond to the compounds with a cyclic core. Both curves are straight lines for the last two thirds of the scaffolds. That means that both datasets are mainly composed of singletons (unique graph frameworks). In fact, for both datasets the most abundant core scaffold is the three member ring C1CC1 (4.8% in QM9 and 3.7% in PC9). In Fig. <xref rid="Fig9" ref-type="fig">9</xref>, we have also tried to put in perspective the missing acyclic chemical diversity. The dashed and dotted lines represent the two limit cases where all the acyclic compounds are considered in the same scaffold (upper limit) and where all the acyclic compounds are considered in unique scaffolds (lower limit). It appears that a scaffold analysis seems to be quite unreliable with a high ratio of acyclic molecules as it is the case for PC9.<fig id="Fig9"><label>Fig. 9</label><caption xml:lang="en"><p>Cumulative scaffold frequency plots of Level 1 scaffolds of the QM9 and PC9 datasets</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_391_Fig9_HTML.png" id="MO13" /></fig></p>
            </sec>
            <sec id="Sec20">
              <title>Self organizing maps analysis</title>
              <p id="Par39">We have used Self Organizing Maps (SOM) to visually represent a chemical space divergence between QM9 and PC9. R ’kohonen’ package has been used to produce a 2D discrete map with the Coulomb matrices as input [<xref ref-type="bibr" rid="CR60">60</xref>]. Grids were set to 50x50 for QM9 and 48x48 for PC9. Default parameters have been used. In Fig. <xref rid="Fig10" ref-type="fig">10</xref>, the left maps represent the obtained organization with red dots corresponding to higher data concentration and grey points indicating empty regions. Taking into account the scale of nodes occurrence, one can notice that PC9 SOM has more overpopulated regions compared to QM9 SOM. Data distribution of the latter is more uniform, which speaks for higher consistency in chemical classes ratio in QM9. The right maps of Fig. <xref rid="Fig10" ref-type="fig">10</xref> represent the projection of another data. In the upper right, the projected PC9 data is evenly spread onto the QM9 map, whereas in the lower right, the QM9 data leaves many nodes of PC9 map empty. By this way we can conclude that QM9 is lacking some chemistry included in PC9. However, that does not prove that PC9 possesses the whole chemical diversity associated with H, C, N, O and F.<fig id="Fig10"><label>Fig. 10</label><caption xml:lang="en"><p>Self Organizing Maps based on the Coulomb matrices of the QM9 and PC9 datasets (grey = empty dots, red = most crowded dots) and the corresponding projections of the other dataset</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_391_Fig10_HTML.png" id="MO14" /></fig></p>
              <p id="Par40">Furthermore, we propose here a formula to quantify the <italic>affinity</italic> of a projected dataset B onto a SOM built on the other dataset A. It accounts for two terms. The first term captures the similarity of molecular density distribution over the SOM, expressed as <inline-formula id="IEq37"><alternatives><mml:math id="IEq37_Math"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close="|" open="|" separators=""><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:msup></mml:math><tex-math id="IEq37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e^{-\left| p_{A,i} - p_{B,i} \right| }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq37.gif" /></alternatives></inline-formula>, where <inline-formula id="IEq38"><alternatives><mml:math id="IEq38_Math"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{A,i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq38.gif" /></alternatives></inline-formula> (resp. <inline-formula id="IEq39"><alternatives><mml:math id="IEq39_Math"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{B,i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq39.gif" /></alternatives></inline-formula>) is the proportion of molecules in node <italic>i</italic> for the set A (resp. B). The second term captures the degree of similarity in distances between the two sets in a node. This term as well reflects a chemical resemblance of molecules in set A and B since molecules of same chemical class/cluster would have analogous distances. This last term is expressed as <inline-formula id="IEq40"><alternatives><mml:math id="IEq40_Math"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mfenced close="|" open="|" separators=""><mml:mover><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>¯</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mover><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>¯</mml:mo></mml:mover></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>d</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="IEq40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e^{-(\left| \overline{d_{A,i}} - \overline{d_{B,i}} \right| /(dmax_{A,i}-dmin_{A,i}))}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq40.gif" /></alternatives></inline-formula>, where <inline-formula id="IEq41"><alternatives><mml:math id="IEq41_Math"><mml:mover><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>¯</mml:mo></mml:mover></mml:math><tex-math id="IEq41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{d_{A,i}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq41.gif" /></alternatives></inline-formula> (resp. <inline-formula id="IEq42"><alternatives><mml:math id="IEq42_Math"><mml:mover><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>¯</mml:mo></mml:mover></mml:math><tex-math id="IEq42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{d_{B,i}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq42.gif" /></alternatives></inline-formula>) is the average distance of molecules in a node <italic>i</italic> for the set A (resp. B) and <inline-formula id="IEq43"><alternatives><mml:math id="IEq43_Math"><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$dmax_{A,i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq43.gif" /></alternatives></inline-formula> (resp. <inline-formula id="IEq44"><alternatives><mml:math id="IEq44_Math"><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$dmin_{A,i}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq44.gif" /></alternatives></inline-formula>) is a maximal (resp. minimal) distance of molecules in the node <italic>i</italic> for the set A. (See Additional files: <xref ref-type="supplementary-material" rid="MOESM1">1</xref>, <xref ref-type="supplementary-material" rid="MOESM2">2</xref> and <xref ref-type="supplementary-material" rid="MOESM3">3</xref> for more details).<disp-formula id="Equ4"><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="italic">Nnodes</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfenced close="|" open="|" separators=""><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mfrac><mml:mfenced close="|" open="|" separators=""><mml:mover><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>¯</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mover><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>¯</mml:mo></mml:mover></mml:mfenced><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>d</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} S_a= \sum _{i=1}^{Nnodes}p_{B,i} \times e^{- \left( \left| p_{A,i} - p_{B,i} \right| + \frac{\left| \overline{d_{A,i}} - \overline{d_{B,i}}\right| }{dmax_{A,i}-dmin_{A,i}}\right) } \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_Equ4.gif" /></alternatives></disp-formula>This score ranges from 0 to 1, where 0 means that the affinity of the projected data B to the SOM built on data A is very low. According to the calculated affinity scores reported in the Table <xref rid="Tab4" ref-type="table">4</xref>, the density term is very similar for both projections meaning that both SOMs are proportionally distributed. However, the distance term of QM9 SOM is lower compared to PC9 SOM. Fewer diversity of functional groups of QM9 leads to a less universal SOM, upon which the PC9 molecules of uncommon classes would be projected mixed with the known classes. That will lead to lower chemical purity per a node and decrease the distance term.<table-wrap id="Tab4"><label>Table 4</label><caption xml:lang="en"><p>Affinity score of PC9 and QM9 data projected onto the other dataset SOM</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" /><th align="left"><p><inline-formula id="IEq33"><alternatives><mml:math id="IEq33_Math"><mml:msub><mml:mi>S</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math><tex-math id="IEq33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_a$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_391_Article_IEq33.gif" /></alternatives></inline-formula></p></th><th align="left"><p>Density</p></th><th align="left"><p>Distance</p></th></tr></thead><tbody><tr><td align="left"><p>PC9 data on QM9 SOM</p></td><td align="left"><p>0.8456</p></td><td align="left"><p>0.9973</p></td><td align="left"><p>0.8480</p></td></tr><tr><td align="left"><p>QM9 data on PC9 SOM</p></td><td align="left"><p>0.9370</p></td><td align="left"><p>0.9989</p></td><td align="left"><p>0.9381</p></td></tr></tbody></table><table-wrap-foot><p>The affinity score, the density term and the distance term are defined in "<xref rid="Sec20" ref-type="sec">Self organizing maps analysis</xref>" section</p></table-wrap-foot></table-wrap></p>
            </sec>
          </sec>
        </sec>
        <sec id="Sec21" sec-type="conclusions">
          <title>Conclusion</title>
          <p id="Par41">Machine Learning models are able to predict molecular properties such as total molecular energies and frontier molecular orbitals energies in a reproducible way and within chemical accuracy. But, those ML models are sensitive to setup of hyperparameters. We have managed to tune those correctly in order to reproduce the literature results for EN, KRR (with Coulomb matrices) and SchNet neural networks, albeit with the help from the authors of the models. Thus, reproduction of such results is time consuming.</p>
          <p id="Par42">We have shown here that an ML model able to be generalized with enough accuracy on unknown molecules requires to be trained on a wide chemical diversity. The golden standard dataset QM9 is limited to H, C, N, O and F but still lacks chemical functional groups associated with this list of atoms. A new dataset, PC9, is presented here. It has been extracted from the PubChemQC data, and mimic the QM9 limitations (same atom types and size limit). Comparable in size, we have found that only 18% of PC9 is common with QM9. More importantly, we managed to study the generalization ability of the built SchNet models for each dataset by means of prediction of molecules from the other dataset, despite slightly different levels of quantum theory. We found that models trained on PC9 demonstrate better generalization ability than the models trained on QM9. It is related both to the presence of radicals, triplets and more functional groups.</p>
          <p id="Par43">This work highlights the crucial problem of chemical diversity in standard datasets. Checking every functional groups in every molecules allowed for a list of under represented functions in QM9. We found that such under representation in the training data is indeed a major cause of outliers in predictions. Going through all bonding distances pairs in the datasets confirmed a tangible chemical divergence between QM9 and PC9, especially for C–F, N–N and N–O. A scaffold analysis showed a larger collections of graph frameworks in QM9 and high ratio of acyclic compounds in PC9. Finally, a visual chemical space analysis was preformed with Self Organising Map, revealing the presence of zones in PC9 chemical space not occupied by QM9 data, contrary to the absence of those in case of the projection of QM9 onto PC9 map. To quantify the affinity of a projected data for a SOM, we have proposed a novel affinity index. Its value for PC9 SOM is higher than for QM9 SOM and driven mainly by the difference in distances between projected and initial data. SOM is one of the visualization tool but a real quantification method of the chemical diversity is still an open problem and a key point for an automatic generation of a dataset that maximize chemical diversity.</p>
        </sec>
      </body>
      <back>
        <ack>
          <title>Acknowledgements</title>
          <p>The calculation resources were provided by the LERIA laboratory. The authors would also like to thanks Jean-Mathieu Chantrein for his technical help.</p>
        </ack>
        <sec sec-type="author-contribution">
          <title>Authors’ contributions</title>
          <p>MG developed the PC9 dataset, performed the chemical functions analysis and made all the ML work. JL performed the bond distances analysis. GH contributed on the QM9/PC9 analysis. TC and BDM planned and coordinated the work. MG, TC and BDM contributed to the manuscript writeup. All authors read and approved the final manuscript.</p>
        </sec>
        <sec>
          <title>Funding</title>
          <p>This work was funded by the <italic>Pays de la Loire</italic> region and the University of Angers through the AIQU project of the Atlanstic 2020 program.</p>
        </sec>
        <sec sec-type="data-availability">
          <title>Availability of data and materials</title>
          <p>The PC9 dataset has been shaped to mimic the QM9 dataset and has been deposited in the public repository figshare with DOI: 10.6084/m9.figshare.9033977</p>
        </sec>
        <sec sec-type="ethics-statement">
          <sec id="FPar1" sec-type="COI-statement">
            <title>Competing interests</title>
            <p id="Par48">The authors declare that they have no competing interests.</p>
          </sec>
        </sec>
        <ref-list id="Bib1">
          <title>References</title>
          <ref-list>
            <ref id="CR1">
              <label>1.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Smith</surname>
                    <given-names>JS</given-names>
                  </name>
                  <name>
                    <surname>Nebgen</surname>
                    <given-names>BT</given-names>
                  </name>
                  <name>
                    <surname>Zubatyuk</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Lubbers</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Devereux</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Barros</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Tretiak</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Isayev</surname>
                    <given-names>O</given-names>
                  </name>
                  <name>
                    <surname>Roitberg</surname>
                    <given-names>AE</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Approaching coupled cluster accuracy with a general-purpose neural network potential through transfer learning</article-title>
                <source>Nat Commun</source>
                <year>2019</year>
                <volume>10</volume>
                <issue>1</issue>
                <fpage>2903</fpage>
                <pub-id pub-id-type="pmid">31263102</pub-id>
                <pub-id pub-id-type="pmcid">6602931</pub-id>
                <pub-id pub-id-type="doi">10.1038/s41467-019-10827-4</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXhtlWisbrP</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR2">
              <label>2.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Unke</surname>
                    <given-names>OT</given-names>
                  </name>
                  <name>
                    <surname>Meuwly</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">PhysNet: a neural network for predicting energies, forces, dipole moments, and partial charges</article-title>
                <source>J Chem Theory Comput</source>
                <year>2019</year>
                <volume>15</volume>
                <issue>6</issue>
                <fpage>3678</fpage>
                <lpage>3693</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXosF2ms7g%3D</pub-id>
                <pub-id pub-id-type="pmid">31042390</pub-id>
                <pub-id pub-id-type="doi">10.1021/acs.jctc.9b00181</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR3">
              <label>3.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Wilkins</surname>
                    <given-names>DM</given-names>
                  </name>
                  <name>
                    <surname>Grisafi</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Yang</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Lao</surname>
                    <given-names>KU</given-names>
                  </name>
                  <name>
                    <surname>DiStasio</surname>
                    <given-names>RA</given-names>
                  </name>
                  <name>
                    <surname>Ceriotti</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Accurate molecular polarizabilities with coupled cluster theory and machine learning</article-title>
                <source>Proc Natl Acad Sci</source>
                <year>2019</year>
                <volume>116</volume>
                <issue>9</issue>
                <fpage>3401</fpage>
                <lpage>3406</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXjslOhsbo%3D</pub-id>
                <pub-id pub-id-type="pmid">30733292</pub-id>
                <pub-id pub-id-type="doi">10.1073/pnas.1816132116</pub-id>
                <pub-id pub-id-type="pmcid">30733292</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR4">
              <label>4.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Iype</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Urolagin</surname>
                    <given-names>S</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Machine learning model for non-equilibrium structures and energies of simple molecules</article-title>
                <source>J Chem Phys</source>
                <year>2019</year>
                <volume>150</volume>
                <issue>2</issue>
                <fpage>024307</fpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:STN:280:DC%2BB3cjhslKkug%3D%3D</pub-id>
                <pub-id pub-id-type="pmid">30646726</pub-id>
                <pub-id pub-id-type="doi">10.1063/1.5054968</pub-id>
                <pub-id pub-id-type="pmcid">30646726</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR5">
              <label>5.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Duan</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Janet</surname>
                    <given-names>JP</given-names>
                  </name>
                  <name>
                    <surname>Liu</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Nandy</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Kulik</surname>
                    <given-names>HJ</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Learning from failure: predicting electronic structure calculation outcomes with machine learning models</article-title>
                <source>J Chem Theory Comput</source>
                <year>2019</year>
                <volume>15</volume>
                <issue>4</issue>
                <fpage>2331</fpage>
                <lpage>2345</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXkslWqtrc%3D</pub-id>
                <pub-id pub-id-type="pmid">30860839</pub-id>
                <pub-id pub-id-type="doi">10.1021/acs.jctc.9b00057</pub-id>
                <pub-id pub-id-type="pmcid">30860839</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR6">
              <label>6.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Grisafi</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Fabrizio</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Meyer</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>Wilkins</surname>
                    <given-names>DM</given-names>
                  </name>
                  <name>
                    <surname>Corminboeuf</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Ceriotti</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Transferable machine-learning model of the electron density</article-title>
                <source>ACS Cent Sci</source>
                <year>2019</year>
                <volume>5</volume>
                <issue>1</issue>
                <fpage>57</fpage>
                <lpage>64</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXisFymtr%2FE</pub-id>
                <pub-id pub-id-type="pmid">30693325</pub-id>
                <pub-id pub-id-type="doi">10.1021/acscentsci.8b00551</pub-id>
                <pub-id pub-id-type="pmcid">30693325</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR7">
              <label>7.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Okamoto</surname>
                    <given-names>Y</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Data sampling scheme for reproducing energies along reaction coordinates in high-dimensional neural network potentials</article-title>
                <source>J Chem Phys</source>
                <year>2019</year>
                <volume>150</volume>
                <issue>13</issue>
                <fpage>134103</fpage>
                <pub-id pub-id-type="pmid">30954039</pub-id>
                <pub-id pub-id-type="doi">10.1063/1.5078394</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXmslagsLk%3D</pub-id>
                <pub-id pub-id-type="pmcid">30954039</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR8">
              <label>8.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Chandrasekaran</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Kamal</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Batra</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Kim</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Chen</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Ramprasad</surname>
                    <given-names>R</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Solving the electronic structure problem with machine learning</article-title>
                <source>NPJ Comput Mater</source>
                <year>2019</year>
                <volume>5</volume>
                <issue>1</issue>
                <fpage>22</fpage>
                <pub-id pub-id-type="doi">10.1038/s41524-019-0162-7</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR9">
              <label>9.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Amabilino</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Bratholm</surname>
                    <given-names>LA</given-names>
                  </name>
                  <name>
                    <surname>Bennie</surname>
                    <given-names>SJ</given-names>
                  </name>
                  <name>
                    <surname>Vaucher</surname>
                    <given-names>AC</given-names>
                  </name>
                  <name>
                    <surname>Reiher</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Glowacki</surname>
                    <given-names>DR</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Training neural nets to learn reactive potential energy surfaces using interactive quantum chemistry in virtual reality</article-title>
                <source>J Phys Chem A</source>
                <year>2019</year>
                <volume>123</volume>
                <issue>20</issue>
                <fpage>4486</fpage>
                <lpage>4499</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXlsFemsL0%3D</pub-id>
                <pub-id pub-id-type="pmid">30892040</pub-id>
                <pub-id pub-id-type="doi">10.1021/acs.jpca.9b01006</pub-id>
                <pub-id pub-id-type="pmcid">30892040</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR10">
              <label>10.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Cheng</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Welborn</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Christensen</surname>
                    <given-names>AS</given-names>
                  </name>
                  <name>
                    <surname>Miller</surname>
                    <given-names>TF</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">A universal density matrix functional from molecular orbital-based machine learning: transferability across organic molecules</article-title>
                <source>J Chem Phys</source>
                <year>2019</year>
                <volume>150</volume>
                <issue>13</issue>
                <fpage>131103</fpage>
                <pub-id pub-id-type="pmid">30954042</pub-id>
                <pub-id pub-id-type="doi">10.1063/1.5088393</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXmslartb0%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR11">
              <label>11.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Ghosh</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Stuke</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Todorović</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Jørgensen</surname>
                    <given-names>PB</given-names>
                  </name>
                  <name>
                    <surname>Schmidt</surname>
                    <given-names>MN</given-names>
                  </name>
                  <name>
                    <surname>Vehtari</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Rinke</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Deep learning spectroscopy: neural networks for molecular excitation spectra</article-title>
                <source>Adv Sci</source>
                <year>2019</year>
                <volume>6</volume>
                <issue>9</issue>
                <fpage>1801367</fpage>
                <pub-id pub-id-type="doi">10.1002/advs.201801367</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXhtFWqsbzL</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR12">
              <label>12.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Rupp</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Tkatchenko</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Müller</surname>
                    <given-names>K-R</given-names>
                  </name>
                  <name>
                    <surname>von Lilienfeld</surname>
                    <given-names>OA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Fast and accurate modeling of molecular atomization energies with machine learning</article-title>
                <source>Phys Rev Lett</source>
                <year>2012</year>
                <volume>108</volume>
                <issue>5</issue>
                <fpage>058301</fpage>
                <pub-id pub-id-type="pmid">22400967</pub-id>
                <pub-id pub-id-type="doi">10.1103/PhysRevLett.108.058301</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC38XisFant70%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR13">
              <label>13.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Hansen</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Montavon</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Biegler</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Fazli</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Rupp</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Scheffler</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>von Lilienfeld</surname>
                    <given-names>OA</given-names>
                  </name>
                  <name>
                    <surname>Tkatchenko</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Müller</surname>
                    <given-names>K-R</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Assessment and validation of machine learning methods for predicting molecular atomization energies</article-title>
                <source>J Chem Theory Comput</source>
                <year>2013</year>
                <volume>9</volume>
                <issue>8</issue>
                <fpage>3404</fpage>
                <lpage>3419</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3sXhtV2ktLzL</pub-id>
                <pub-id pub-id-type="pmid">26584096</pub-id>
                <pub-id pub-id-type="doi">10.1021/ct400195d</pub-id>
                <pub-id pub-id-type="pmcid">26584096</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR14">
              <label>14.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Hansen</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Biegler</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Ramakrishnan</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Pronobis</surname>
                    <given-names>W</given-names>
                  </name>
                  <name>
                    <surname>von Lilienfeld</surname>
                    <given-names>OA</given-names>
                  </name>
                  <name>
                    <surname>Müller</surname>
                    <given-names>K-R</given-names>
                  </name>
                  <name>
                    <surname>Tkatchenko</surname>
                    <given-names>A</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Machine learning predictions of molecular properties: accurate many-body potentials and nonlocality in chemical space</article-title>
                <source>J Phys Chem Lett</source>
                <year>2015</year>
                <volume>6</volume>
                <issue>12</issue>
                <fpage>2326</fpage>
                <lpage>2331</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2MXpsFOmsrg%3D</pub-id>
                <pub-id pub-id-type="pmid">26113956</pub-id>
                <pub-id pub-id-type="pmcid">4476293</pub-id>
                <pub-id pub-id-type="doi">10.1021/acs.jpclett.5b00831</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR15">
              <label>15.</label>
              <mixed-citation publication-type="other">Ramakrishnan R, von Lilienfeld OA (2015) Many molecular properties from one Kernel in chemical space. <ext-link xlink:href="http://arxiv.org/abs/1502.04563" ext-link-type="uri">arXiv:1502.04563</ext-link> [physics.chem-ph], 140022</mixed-citation>
            </ref>
            <ref id="CR16">
              <label>16.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Huang</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>von Lilienfeld</surname>
                    <given-names>OA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Communication: understanding molecular representations in machine learning: the role of uniqueness and target similarity</article-title>
                <source>J Chem Phys</source>
                <year>2016</year>
                <volume>145</volume>
                <issue>16</issue>
                <fpage>161102</fpage>
                <pub-id pub-id-type="pmid">27802646</pub-id>
                <pub-id pub-id-type="doi">10.1063/1.4964627</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC28XhslGrsbnP</pub-id>
                <pub-id pub-id-type="pmcid">27802646</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR17">
              <label>17.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Faber</surname>
                    <given-names>FA</given-names>
                  </name>
                  <name>
                    <surname>Hutchison</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Huang</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>Gilmer</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Schoenholz</surname>
                    <given-names>SS</given-names>
                  </name>
                  <name>
                    <surname>Dahl</surname>
                    <given-names>GE</given-names>
                  </name>
                  <name>
                    <surname>Vinyals</surname>
                    <given-names>O</given-names>
                  </name>
                  <name>
                    <surname>Kearnes</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Riley</surname>
                    <given-names>PF</given-names>
                  </name>
                  <name>
                    <surname>von Lilienfeld</surname>
                    <given-names>OA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Prediction errors of molecular machine learning models lower than hybrid DFT error</article-title>
                <source>J Chem Theory Comput</source>
                <year>2017</year>
                <volume>13</volume>
                <issue>11</issue>
                <fpage>5255</fpage>
                <lpage>5264</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2sXhsFWhu7vL</pub-id>
                <pub-id pub-id-type="pmid">28926232</pub-id>
                <pub-id pub-id-type="doi">10.1021/acs.jctc.7b00577</pub-id>
                <pub-id pub-id-type="pmcid">28926232</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR18">
              <label>18.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Collins</surname>
                    <given-names>CR</given-names>
                  </name>
                  <name>
                    <surname>Gordon</surname>
                    <given-names>GJ</given-names>
                  </name>
                  <name>
                    <surname>von Lilienfeld</surname>
                    <given-names>OA</given-names>
                  </name>
                  <name>
                    <surname>Yaron</surname>
                    <given-names>DJ</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Constant size descriptors for accurate machine learning models of molecular properties</article-title>
                <source>J Chem Phys</source>
                <year>2018</year>
                <volume>148</volume>
                <issue>24</issue>
                <fpage>241718</fpage>
                <pub-id pub-id-type="pmid">29960361</pub-id>
                <pub-id pub-id-type="doi">10.1063/1.5020441</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXmsVaks7k%3D</pub-id>
                <pub-id pub-id-type="pmcid">29960361</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR19">
              <label>19.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Bartók</surname>
                    <given-names>AP</given-names>
                  </name>
                  <name>
                    <surname>De</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Poelking</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Bernstein</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Kermode</surname>
                    <given-names>JR</given-names>
                  </name>
                  <name>
                    <surname>Csányi</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Ceriotti</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Machine learning unifies the modeling of materials and molecules</article-title>
                <source>Sci Adv</source>
                <year>2017</year>
                <volume>3</volume>
                <issue>12</issue>
                <fpage>1701816</fpage>
                <pub-id pub-id-type="doi">10.1126/sciadv.1701816</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR20">
              <label>20.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Pereira</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Xiao</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Latino</surname>
                    <given-names>DARS</given-names>
                  </name>
                  <name>
                    <surname>Wu</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Zhang</surname>
                    <given-names>Q</given-names>
                  </name>
                  <name>
                    <surname>Aires-de-Sousa</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Machine learning methods to predict density functional theory B3lyp energies of HOMO and LUMO orbitals</article-title>
                <source>J Chem Inform Model</source>
                <year>2017</year>
                <volume>57</volume>
                <issue>1</issue>
                <fpage>11</fpage>
                <lpage>21</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC28XitFKqtr%2FN</pub-id>
                <pub-id pub-id-type="doi">10.1021/acs.jcim.6b00340</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR21">
              <label>21.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Montavon</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Rupp</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Gobre</surname>
                    <given-names>V</given-names>
                  </name>
                  <name>
                    <surname>Vazquez-Mayagoitia</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Hansen</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Tkatchenko</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Müller</surname>
                    <given-names>K-R</given-names>
                  </name>
                  <name>
                    <surname>Anatole von Lilienfeld</surname>
                    <given-names>O</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Machine learning of molecular electronic properties in chemical compound space</article-title>
                <source>New J Phys</source>
                <year>2013</year>
                <volume>15</volume>
                <issue>9</issue>
                <fpage>095003</fpage>
                <pub-id pub-id-type="doi">10.1088/1367-2630/15/9/095003</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2cXltlKgs74%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR22">
              <label>22.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Smith</surname>
                    <given-names>JS</given-names>
                  </name>
                  <name>
                    <surname>Isayev</surname>
                    <given-names>O</given-names>
                  </name>
                  <name>
                    <surname>Roitberg</surname>
                    <given-names>AE</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">ANI-1: an extensible neural network potential with DFT accuracy at force field computational cost</article-title>
                <source>Chem Sci</source>
                <year>2017</year>
                <volume>8</volume>
                <issue>4</issue>
                <fpage>3192</fpage>
                <lpage>3203</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2sXitlGnsrs%3D</pub-id>
                <pub-id pub-id-type="pmid">28507695</pub-id>
                <pub-id pub-id-type="pmcid">5414547</pub-id>
                <pub-id pub-id-type="doi">10.1039/C6SC05720A</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR23">
              <label>23.</label>
              <mixed-citation publication-type="other">Gilmer J, Schoenholz SS, Riley PF, Vinyals O, Dahl GE (2017) Neural message passing for quantum chemistry. <ext-link xlink:href="http://arxiv.org/abs/1704.01212" ext-link-type="uri">arXiv:1704.01212</ext-link> [cs]</mixed-citation>
            </ref>
            <ref id="CR24">
              <label>24.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Schütt</surname>
                    <given-names>KT</given-names>
                  </name>
                  <name>
                    <surname>Sauceda</surname>
                    <given-names>HE</given-names>
                  </name>
                  <name>
                    <surname>Kindermans</surname>
                    <given-names>P-J</given-names>
                  </name>
                  <name>
                    <surname>Tkatchenko</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Müller</surname>
                    <given-names>K-R</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">SchNet—a deep learning architecture for molecules and materials</article-title>
                <source>J Chem Phys</source>
                <year>2018</year>
                <volume>148</volume>
                <issue>24</issue>
                <fpage>241722</fpage>
                <pub-id pub-id-type="pmid">29960322</pub-id>
                <pub-id pub-id-type="doi">10.1063/1.5019779</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXms1Ggurs%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR25">
              <label>25.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Hy</surname>
                    <given-names>TS</given-names>
                  </name>
                  <name>
                    <surname>Trivedi</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Pan</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Anderson</surname>
                    <given-names>BM</given-names>
                  </name>
                  <name>
                    <surname>Kondor</surname>
                    <given-names>R</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Predicting molecular properties with covariant compositional networks</article-title>
                <source>J Chem Phys</source>
                <year>2018</year>
                <volume>148</volume>
                <issue>24</issue>
                <fpage>241745</fpage>
                <pub-id pub-id-type="pmid">29960355</pub-id>
                <pub-id pub-id-type="doi">10.1063/1.5024797</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXht1aksbvK</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR26">
              <label>26.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Hou</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Wu</surname>
                    <given-names>Z</given-names>
                  </name>
                  <name>
                    <surname>Hu</surname>
                    <given-names>Z</given-names>
                  </name>
                  <name>
                    <surname>Xiao</surname>
                    <given-names>Z</given-names>
                  </name>
                  <name>
                    <surname>Wang</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Zhang</surname>
                    <given-names>X</given-names>
                  </name>
                  <name>
                    <surname>Li</surname>
                    <given-names>G</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Comparison study on the prediction of multiple molecular properties by various neural networks</article-title>
                <source>J Phys Chem A</source>
                <year>2018</year>
                <volume>122</volume>
                <issue>46</issue>
                <fpage>9128</fpage>
                <lpage>9134</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXhvVKltL7E</pub-id>
                <pub-id pub-id-type="pmid">30285444</pub-id>
                <pub-id pub-id-type="doi">10.1021/acs.jpca.8b09376</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR27">
              <label>27.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Lubbers</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Smith</surname>
                    <given-names>JS</given-names>
                  </name>
                  <name>
                    <surname>Barros</surname>
                    <given-names>K</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Hierarchical modeling of molecular energies using a deep neural network</article-title>
                <source>J Chem Phys</source>
                <year>2018</year>
                <volume>148</volume>
                <issue>24</issue>
                <fpage>241715</fpage>
                <pub-id pub-id-type="pmid">29960311</pub-id>
                <pub-id pub-id-type="doi">10.1063/1.5011181</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXltFWnur0%3D</pub-id>
                <comment>Accessed 2018-06-13</comment>
              </mixed-citation>
            </ref>
            <ref id="CR28">
              <label>28.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Unke</surname>
                    <given-names>OT</given-names>
                  </name>
                  <name>
                    <surname>Meuwly</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">A reactive, scalable, and transferable model for molecular energies from a neural network approach based on local information</article-title>
                <source>J Chem Phys</source>
                <year>2018</year>
                <volume>148</volume>
                <issue>24</issue>
                <fpage>241708</fpage>
                <pub-id pub-id-type="pmid">29960298</pub-id>
                <pub-id pub-id-type="doi">10.1063/1.5017898</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXkslahsL4%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR29">
              <label>29.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Bartók</surname>
                    <given-names>AP</given-names>
                  </name>
                  <name>
                    <surname>Kondor</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Csányi</surname>
                    <given-names>G</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">On representing chemical environments</article-title>
                <source>Phys Rev B</source>
                <year>2013</year>
                <volume>87</volume>
                <issue>18</issue>
                <fpage>184115</fpage>
                <pub-id pub-id-type="doi">10.1103/PhysRevB.87.184115</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3sXpvFClu7Y%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR30">
              <label>30.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Willatt</surname>
                    <given-names>MJ</given-names>
                  </name>
                  <name>
                    <surname>Musil</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Ceriotti</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Feature optimization for atomistic machine learning yields a data-driven construction of the periodic table of the elements</article-title>
                <source>Phys Chem Chem Phys</source>
                <year>2018</year>
                <volume>20</volume>
                <issue>47</issue>
                <fpage>29661</fpage>
                <lpage>29668</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXitFKmsbnL</pub-id>
                <pub-id pub-id-type="doi">10.1039/C8CP05921G</pub-id>
                <pub-id pub-id-type="pmid">30465679</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR31">
              <label>31.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Faber</surname>
                    <given-names>FA</given-names>
                  </name>
                  <name>
                    <surname>Christensen</surname>
                    <given-names>AS</given-names>
                  </name>
                  <name>
                    <surname>Huang</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>von Lilienfeld</surname>
                    <given-names>OA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Alchemical and structural distribution based representation for universal quantum machine learning</article-title>
                <source>J Chem Phys</source>
                <year>2018</year>
                <volume>148</volume>
                <issue>24</issue>
                <fpage>241717</fpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXltFyitrs%3D</pub-id>
                <pub-id pub-id-type="doi">10.1063/1.5020710</pub-id>
                <pub-id pub-id-type="pmid">29960351</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR32">
              <label>32.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Ramakrishnan</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Dral</surname>
                    <given-names>PO</given-names>
                  </name>
                  <name>
                    <surname>Rupp</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>von Lilienfeld</surname>
                    <given-names>OA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Quantum chemistry structures and properties of 134 kilo molecules</article-title>
                <source>Sci Data</source>
                <year>2014</year>
                <volume>1</volume>
                <fpage>140022</fpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2MXks1aisLo%3D</pub-id>
                <pub-id pub-id-type="pmid">25977779</pub-id>
                <pub-id pub-id-type="pmcid">4322582</pub-id>
                <pub-id pub-id-type="doi">10.1038/sdata.2014.22</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR33">
              <label>33.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Ruddigkeit</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>van Deursen</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Blum</surname>
                    <given-names>LC</given-names>
                  </name>
                  <name>
                    <surname>Reymond</surname>
                    <given-names>J-L</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Enumeration of 166 billion organic small molecules in the chemical universe database GDB-17</article-title>
                <source>J Chem Inform Model</source>
                <year>2012</year>
                <volume>52</volume>
                <issue>11</issue>
                <fpage>2864</fpage>
                <lpage>2875</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC38XhsFClsL3J</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci300415d</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR34">
              <label>34.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Schütt</surname>
                    <given-names>KT</given-names>
                  </name>
                  <name>
                    <surname>Arbabzadah</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Chmiela</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Müller</surname>
                    <given-names>KR</given-names>
                  </name>
                  <name>
                    <surname>Tkatchenko</surname>
                    <given-names>A</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Quantum-chemical insights from deep tensor neural networks</article-title>
                <source>Nat Commun</source>
                <year>2017</year>
                <volume>8</volume>
                <fpage>13890</fpage>
                <pub-id pub-id-type="pmid">28067221</pub-id>
                <pub-id pub-id-type="pmcid">5228054</pub-id>
                <pub-id pub-id-type="doi">10.1038/ncomms13890</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2sXpsVOnsg%3D%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR35">
              <label>35.</label>
              <mixed-citation publication-type="other">Schütt KT, Kindermans P-J, Sauceda HE, Chmiela S, Tkatchenko A, Müller K-R (2017) SchNet: A continuous-filter convolutional neural network for modeling quantum interactions. <ext-link xlink:href="http://arxiv.org/abs/1706.08566" ext-link-type="uri">arXiv:1706.08566</ext-link> [physics, stat]</mixed-citation>
            </ref>
            <ref id="CR36">
              <label>36.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Wang</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Xiao</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Suzek</surname>
                    <given-names>TO</given-names>
                  </name>
                  <name>
                    <surname>Zhang</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Wang</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Bryant</surname>
                    <given-names>SH</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">PubChem: a public information system for analyzing bioactivities of small molecules</article-title>
                <source>Nucleic Acids Res</source>
                <year>2009</year>
                <volume>37</volume>
                <issue>Web Server</issue>
                <fpage>623</fpage>
                <lpage>633</lpage>
                <pub-id pub-id-type="doi">10.1093/nar/gkp456</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXosFSktL8%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR37">
              <label>37.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Kim</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Chen</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Cheng</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Gindulyte</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>He</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>He</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Li</surname>
                    <given-names>Q</given-names>
                  </name>
                  <name>
                    <surname>Shoemaker</surname>
                    <given-names>BA</given-names>
                  </name>
                  <name>
                    <surname>Thiessen</surname>
                    <given-names>PA</given-names>
                  </name>
                  <name>
                    <surname>Yu</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>Zaslavsky</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Zhang</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Bolton</surname>
                    <given-names>EE</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">PubChem 2019 update: improved access to chemical data</article-title>
                <source>Nucleic Acids Res</source>
                <year>2019</year>
                <volume>47</volume>
                <issue>D1</issue>
                <fpage>1102</fpage>
                <lpage>1109</lpage>
                <pub-id pub-id-type="doi">10.1093/nar/gky1033</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR38">
              <label>38.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Nakata</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Shimazaki</surname>
                    <given-names>T</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">PubChemQC project: a large-scale first-principles electronic structure database for data-driven chemistry</article-title>
                <source>J Chem Inform Model</source>
                <year>2017</year>
                <volume>57</volume>
                <issue>6</issue>
                <fpage>1300</fpage>
                <lpage>1308</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2sXntFKnt7g%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/acs.jcim.7b00083</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR39">
              <label>39.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Heller</surname>
                    <given-names>SR</given-names>
                  </name>
                  <name>
                    <surname>McNaught</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Pletnev</surname>
                    <given-names>I</given-names>
                  </name>
                  <name>
                    <surname>Stein</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Tchekhovskoi</surname>
                    <given-names>D</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">InChI, the IUPAC international chemical identifier</article-title>
                <source>J Cheminform</source>
                <year>2015</year>
                <volume>7</volume>
                <issue>1</issue>
                <fpage>23</fpage>
                <pub-id pub-id-type="pmid">26136848</pub-id>
                <pub-id pub-id-type="pmcid">4486400</pub-id>
                <pub-id pub-id-type="doi">10.1186/s13321-015-0068-4</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2MXht1ehs7bK</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR40">
              <label>40.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>O’Boyle</surname>
                    <given-names>NM</given-names>
                  </name>
                  <name>
                    <surname>Banck</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>James</surname>
                    <given-names>CA</given-names>
                  </name>
                  <name>
                    <surname>Morley</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Vandermeersch</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Hutchison</surname>
                    <given-names>GR</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Open babel: an open chemical toolbox</article-title>
                <source>J Cheminform</source>
                <year>2011</year>
                <volume>3</volume>
                <fpage>33</fpage>
                <pub-id pub-id-type="pmid">21982300</pub-id>
                <pub-id pub-id-type="pmcid">21982300</pub-id>
                <pub-id pub-id-type="doi">10.1186/1758-2946-3-33</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXhsVWjurbF</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR41">
              <label>41.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Pedregosa</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Varoquaux</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Gramfort</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Michel</surname>
                    <given-names>V</given-names>
                  </name>
                  <name>
                    <surname>Thirion</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>Grisel</surname>
                    <given-names>O</given-names>
                  </name>
                  <name>
                    <surname>Blondel</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Prettenhofer</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Weiss</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Dubourg</surname>
                    <given-names>V</given-names>
                  </name>
                  <name>
                    <surname>Vanderplas</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Passos</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Cournapeau</surname>
                    <given-names>D</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Scikit-learn: machine learning in Python</article-title>
                <source>J Mach Learn Res</source>
                <year>2005</year>
                <volume>12</volume>
                <fpage>2825</fpage>
                <lpage>2830</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR42">
              <label>42.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Zou</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Hastie</surname>
                    <given-names>T</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Regularization and variable selection via the elastic net</article-title>
                <source>J R Stat Soc</source>
                <year>2005</year>
                <volume>67</volume>
                <issue>2</issue>
                <fpage>301</fpage>
                <lpage>320</lpage>
                <pub-id pub-id-type="doi">10.1111/j.1467-9868.2005.00503.x</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR43">
              <label>43.</label>
              <mixed-citation publication-type="other">Li F, Yang Y, Xing EP (2005) From lasso regression to feature vector machine. In: Proceedings of the 18th international conference on neural information processing systems. NIPS’05, pp. 779–786. MIT Press, Cambridge, MA. <ext-link xlink:href="http://dl.acm.org/citation.cfm?id=2976248.2976346" ext-link-type="uri">http://dl.acm.org/citation.cfm?id=2976248.2976346</ext-link></mixed-citation>
            </ref>
            <ref id="CR44">
              <label>44.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Hoerl</surname>
                    <given-names>AE</given-names>
                  </name>
                  <name>
                    <surname>Kannard</surname>
                    <given-names>RW</given-names>
                  </name>
                  <name>
                    <surname>Baldwin</surname>
                    <given-names>KF</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Ridge regression: some simulations</article-title>
                <source>Commun Stat</source>
                <year>1975</year>
                <volume>4</volume>
                <issue>2</issue>
                <fpage>105</fpage>
                <lpage>123</lpage>
                <pub-id pub-id-type="doi">10.1080/03610927508827232</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR45">
              <label>45.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Haykin</surname>
                    <given-names>SS</given-names>
                  </name>
                </person-group>
                <source>Neural networks and learning machines</source>
                <year>2009</year>
                <edition>3</edition>
                <publisher-loc>New York</publisher-loc>
                <publisher-name>Prentice Hall</publisher-name>
              </mixed-citation>
            </ref>
            <ref id="CR46">
              <label>46.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Mallat</surname>
                    <given-names>S</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Understanding deep convolutional networks</article-title>
                <source>Philos Trans R Soc A</source>
                <year>2016</year>
                <volume>374</volume>
                <issue>2065</issue>
                <fpage>20150203</fpage>
                <pub-id pub-id-type="doi">10.1098/rsta.2015.0203</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2sXptVGguw%3D%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR47">
              <label>47.</label>
              <mixed-citation publication-type="other">Glorot X, Bengio Y (2010) Understanding the difficulty of training deep feedforward neural networks. In: Teh YW, Titterington M (eds) Proceedings of the thirteenth international conference on artificial intelligence and statistics. Proceedings of machine learning research, vol 9, pp 249–256. PMLR, Chia Laguna Resort, Sardinia. <ext-link xlink:href="http://proceedings.mlr.press/v9/glorot10a.html" ext-link-type="uri">http://proceedings.mlr.press/v9/glorot10a.html</ext-link></mixed-citation>
            </ref>
            <ref id="CR48">
              <label>48.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Schmidhuber</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Deep learning in neural networks: an overview</article-title>
                <source>Neural Netw</source>
                <year>2015</year>
                <volume>61</volume>
                <fpage>85</fpage>
                <lpage>117</lpage>
                <pub-id pub-id-type="doi">10.1016/j.neunet.2014.09.003</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR49">
              <label>49.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Schütt</surname>
                    <given-names>KT</given-names>
                  </name>
                  <name>
                    <surname>Kessel</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Gastegger</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Nicoli</surname>
                    <given-names>KA</given-names>
                  </name>
                  <name>
                    <surname>Tkatchenko</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Müller</surname>
                    <given-names>K-R</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">SchNetPack: a deep learning toolbox for atomistic systems</article-title>
                <source>J Chem Theory Comput</source>
                <year>2019</year>
                <volume>15</volume>
                <issue>1</issue>
                <fpage>448</fpage>
                <lpage>455</lpage>
                <pub-id pub-id-type="pmid">30481453</pub-id>
                <pub-id pub-id-type="doi">10.1021/acs.jctc.8b00908</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXitlalsLvN</pub-id>
                <pub-id pub-id-type="pmcid">30481453</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR50">
              <label>50.</label>
              <mixed-citation publication-type="other">Huber regression parameters of QM9 model on PC9. For E and subset A: Orig = 0.9999315933 * fit -0.0000040081, For E and subset B: Orig = 0.9999188417 * fit -0.0000040914</mixed-citation>
            </ref>
            <ref id="CR51">
              <label>51.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Haider</surname>
                    <given-names>N</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Functionality Pattern Matching as an Efficient Complementary Structure/Reaction Search Tool: an Open-Source Approach</article-title>
                <source>Molecules</source>
                <year>2010</year>
                <volume>15</volume>
                <issue>8</issue>
                <fpage>5079</fpage>
                <lpage>5092</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3cXpvV2qtro%3D</pub-id>
                <pub-id pub-id-type="pmid">20714286</pub-id>
                <pub-id pub-id-type="pmcid">6257694</pub-id>
                <pub-id pub-id-type="doi">10.3390/molecules15085079</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR52">
              <label>52.</label>
              <mixed-citation publication-type="other">Huber regression parameters of PC9 model on QM9. For E and subset A: Orig = 23.0616524941 * fit -0.1115732596, For E and subset B: Orig = 23.0616907882 * fit -0.1735192942</mixed-citation>
            </ref>
            <ref id="CR53">
              <label>53.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Lipkus</surname>
                    <given-names>AH</given-names>
                  </name>
                  <name>
                    <surname>Yuan</surname>
                    <given-names>Q</given-names>
                  </name>
                  <name>
                    <surname>Lucas</surname>
                    <given-names>KA</given-names>
                  </name>
                  <name>
                    <surname>Funk</surname>
                    <given-names>SA</given-names>
                  </name>
                  <name>
                    <surname>Bartelt</surname>
                    <given-names>WF</given-names>
                  </name>
                  <name>
                    <surname>Schenck</surname>
                    <given-names>RJ</given-names>
                  </name>
                  <name>
                    <surname>Trippe</surname>
                    <given-names>AJ</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Structural diversity of organic chemistry. A scaffold analysis of the CAS registry</article-title>
                <source>J Org Chem</source>
                <year>2008</year>
                <volume>73</volume>
                <issue>12</issue>
                <fpage>4443</fpage>
                <lpage>4451</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1cXmtlylu7c%3D</pub-id>
                <pub-id pub-id-type="pmid">18505297</pub-id>
                <pub-id pub-id-type="doi">10.1021/jo8001276</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR54">
              <label>54.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Wetzel</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Klein</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Renner</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Rauh</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Oprea</surname>
                    <given-names>TI</given-names>
                  </name>
                  <name>
                    <surname>Mutzel</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Waldmann</surname>
                    <given-names>H</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Interactive exploration of chemical space with Scaffold Hunter</article-title>
                <source>Nat Chem Biol</source>
                <year>2009</year>
                <volume>5</volume>
                <issue>8</issue>
                <fpage>581</fpage>
                <lpage>583</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXnslOjtLk%3D</pub-id>
                <pub-id pub-id-type="pmid">19561620</pub-id>
                <pub-id pub-id-type="doi">10.1038/nchembio.187</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR55">
              <label>55.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Hu</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Stumpfe</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Bajorath</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Lessons learned from molecular scaffold analysis</article-title>
                <source>J Chem Inform Model</source>
                <year>2011</year>
                <volume>51</volume>
                <issue>8</issue>
                <fpage>1742</fpage>
                <lpage>1753</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXptlOrtrc%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci200179y</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR56">
              <label>56.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Matlock</surname>
                    <given-names>MK</given-names>
                  </name>
                  <name>
                    <surname>Zaretzki</surname>
                    <given-names>JM</given-names>
                  </name>
                  <name>
                    <surname>Swamidass</surname>
                    <given-names>SJ</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Scaffold network generator: a tool for mining molecular structures</article-title>
                <source>Bioinformatics</source>
                <year>2013</year>
                <volume>29</volume>
                <issue>20</issue>
                <fpage>2655</fpage>
                <lpage>2656</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3sXhsFOmsbnK</pub-id>
                <pub-id pub-id-type="pmid">23918250</pub-id>
                <pub-id pub-id-type="doi">10.1093/bioinformatics/btt448</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR57">
              <label>57.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>González-Medina</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Prieto-Martínez</surname>
                    <given-names>FD</given-names>
                  </name>
                  <name>
                    <surname>Owen</surname>
                    <given-names>JR</given-names>
                  </name>
                  <name>
                    <surname>Medina-Franco</surname>
                    <given-names>JL</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Consensus diversity plots: a global diversity analysis of chemical libraries</article-title>
                <source>J Cheminform</source>
                <year>2016</year>
                <volume>8</volume>
                <issue>1</issue>
                <fpage>63</fpage>
                <pub-id pub-id-type="pmid">27895718</pub-id>
                <pub-id pub-id-type="pmcid">5105260</pub-id>
                <pub-id pub-id-type="doi">10.1186/s13321-016-0176-9</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR58">
              <label>58.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Velkoborsky</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Hoksza</surname>
                    <given-names>D</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Scaffold analysis of PubChem database as background for hierarchical scaffold-based visualization</article-title>
                <source>J Cheminform</source>
                <year>2016</year>
                <volume>8</volume>
                <issue>1</issue>
                <fpage>74</fpage>
                <pub-id pub-id-type="pmid">28090217</pub-id>
                <pub-id pub-id-type="pmcid">5199768</pub-id>
                <pub-id pub-id-type="doi">10.1186/s13321-016-0186-7</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXmtVyrtrk%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR59">
              <label>59.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Shang</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Sun</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Liu</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Chen</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Tian</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Pan</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Li</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Kong</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Hou</surname>
                    <given-names>T</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Comparative analyses of structural features and scaffold diversity for purchasable compound libraries</article-title>
                <source>J Cheminform</source>
                <year>2017</year>
                <volume>9</volume>
                <issue>1</issue>
                <fpage>25</fpage>
                <pub-id pub-id-type="pmid">29086044</pub-id>
                <pub-id pub-id-type="pmcid">5400773</pub-id>
                <pub-id pub-id-type="doi">10.1186/s13321-017-0212-4</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXkvVGqt7k%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR60">
              <label>60.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Wehrens</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Kruisselbrink</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Flexible self-organizing maps in kohonen 3.0</article-title>
                <source>J Stat Softw</source>
                <year>2018</year>
                <volume>87</volume>
                <issue>7</issue>
                <fpage>1</fpage>
                <lpage>18</lpage>
                <pub-id pub-id-type="doi">10.18637/jss.v087.i07</pub-id>
              </mixed-citation>
            </ref>
          </ref-list>
        </ref-list>
        <app-group>
          <app id="App1">
            <sec id="Sec23">
              <title>Supplementary information</title>
              <p>
                <supplementary-material content-type="local-data" id="MOESM1" xlink:title="Supplementary information">
                  <media mimetype="text" mime-subtype="plain" xlink:href="MediaObjects/13321_2019_391_MOESM1_ESM.txt" position="anchor">
                    <caption xml:lang="en">
                      <p><bold>Additional file 1.</bold> AML building example. Source code for the ML results.</p>
                    </caption>
                  </media>
                </supplementary-material>
                <supplementary-material content-type="local-data" id="MOESM2" xlink:title="Supplementary information">
                  <media mimetype="text" mime-subtype="plain" xlink:href="MediaObjects/13321_2019_391_MOESM2_ESM.csv" position="anchor">
                    <caption xml:lang="en">
                      <p><bold>Additional file 2.</bold> Functional groups analysis. Complete table of all encountered functional groups in PC9 and QM9.</p>
                    </caption>
                  </media>
                </supplementary-material>
                <supplementary-material content-type="local-data" id="MOESM3" xlink:title="Supplementary information">
                  <media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/13321_2019_391_MOESM3_ESM.pdf" position="anchor">
                    <caption xml:lang="en">
                      <p><bold>Additional file 3.</bold> Affinity index. Details on the SOM affinity analysis.</p>
                    </caption>
                  </media>
                </supplementary-material>
              </p>
            </sec>
          </app>
        </app-group>
        <notes notes-type="ESMHint">
          <title>Supplementary information</title>
          <p><bold>Supplementary information</bold> accompanies this paper at <ext-link xlink:href="10.1186/s13321-019-0391-2" ext-link-type="doi">https://doi.org/10.1186/s13321-019-0391-2</ext-link>.</p>
        </notes>
        <notes notes-type="Misc">
          <title>Publisher's Note</title>
          <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
        </notes>
      </back>
    </article>
