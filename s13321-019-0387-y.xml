<?xml version="1.0"?>
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="letter" xml:lang="en">
      <front>
        <journal-meta>
          <journal-id journal-id-type="publisher-id">13321</journal-id>
          <journal-title-group>
            <journal-title>Journal of Cheminformatics</journal-title>
            <abbrev-journal-title abbrev-type="publisher">J Cheminform</abbrev-journal-title>
          </journal-title-group>
          <issn pub-type="epub">1758-2946</issn>
          <publisher>
            <publisher-name>Springer International Publishing</publisher-name>
            <publisher-loc>Cham</publisher-loc>
          </publisher>
        </journal-meta>
        <article-meta>
          <article-id pub-id-type="publisher-id">s13321-019-0387-y</article-id>
          <article-id pub-id-type="manuscript">387</article-id>
          <article-id pub-id-type="doi">10.1186/s13321-019-0387-y</article-id>
          <article-categories>
            <subj-group subj-group-type="heading">
              <subject>Letter to the Editor</subject>
            </subj-group>
          </article-categories>
          <title-group>
            <article-title xml:lang="en">Missed opportunities in large scale comparison of QSAR and conformal prediction methods and their applications in drug discovery</article-title>
          </title-group>
          <contrib-group>
            <contrib contrib-type="author" corresp="yes" id="Au1">
              <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7381-8570</contrib-id>
              <name>
                <surname>Krstajic</surname>
                <given-names>Damjan</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="corresp" rid="IDs133210190387y_cor1">a</xref>
            </contrib>
            <aff id="Aff1">
              <label>1</label>
              <institution-wrap>
                <institution content-type="org-name">Research Centre for Cheminformatics</institution>
              </institution-wrap>
              <addr-line content-type="street">Jasenova 7</addr-line>
              <addr-line content-type="postcode">11030</addr-line>
              <addr-line content-type="city">Belgrade</addr-line>
              <country country="RS">Serbia</country>
            </aff>
          </contrib-group>
          <author-notes>
            <corresp id="IDs133210190387y_cor1">
              <label>a</label>
              <email>HIDDEN</email>
            </corresp>
          </author-notes>
          <pub-date date-type="pub" publication-format="electronic">
            <day>6</day>
            <month>11</month>
            <year>2019</year>
          </pub-date>
          <pub-date date-type="collection" publication-format="electronic">
            <month>12</month>
            <year>2019</year>
          </pub-date>
          <volume>11</volume>
          <issue seq="65">1</issue>
          <elocation-id>65</elocation-id>
          <history>
            <date date-type="registration">
              <day>14</day>
              <month>10</month>
              <year>2019</year>
            </date>
            <date date-type="received">
              <day>18</day>
              <month>6</month>
              <year>2019</year>
            </date>
            <date date-type="accepted">
              <day>14</day>
              <month>10</month>
              <year>2019</year>
            </date>
            <date date-type="online">
              <day>6</day>
              <month>11</month>
              <year>2019</year>
            </date>
          </history>
          <permissions>
            <copyright-statement content-type="compact">© The Author(s) 2019</copyright-statement>
            <copyright-year>2019</copyright-year>
            <copyright-holder>The Author(s)</copyright-holder>
            <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
              <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (http://creativecommons.org/publicdomain/zero/1.0/) applies to the data made available in this article, unless otherwise stated.</license-p>
            </license>
          </permissions>
          <related-article related-article-type="letter-reply" ext-link-type="doi" xlink:href="10.1186/s13321-019-0388-x" />
          <related-article related-article-type="commentary-article" ext-link-type="doi" xlink:href="10.1186/s13321-018-0325-4" />
          <abstract xml:lang="en" id="Abs1">
            <title>Abstract</title>
            <p id="Par1">Recently Bosc et al. (J Cheminform 11(1): 4, 2019), published an article describing a case study that directly compares conformal predictions with traditional QSAR methods for large-scale predictions of target-ligand binding. We consider this study to be very important. Unfortunately, we have found several issues in the authors’ approach as well as in the presentation of their findings.</p>
          </abstract>
          <custom-meta-group>
            <custom-meta>
              <meta-name>publisher-imprint-name</meta-name>
              <meta-value>Springer</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-issue-count</meta-name>
              <meta-value>1</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-article-count</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-pricelist-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-holder</meta-name>
              <meta-value>The Author(s)</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-contains-esm</meta-name>
              <meta-value>No</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-month</meta-name>
              <meta-value>10</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-day</meta-name>
              <meta-value>14</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-product</meta-name>
              <meta-value>ArchiveJournal</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-grants-type</meta-name>
              <meta-value>OpenChoice</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>metadata-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>abstract-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodypdf-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodyhtml-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bibliography-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>esm-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>online-first</meta-name>
              <meta-value>false</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-file-reference</meta-name>
              <meta-value>BodyRef/PDF/13321_2019_Article_387.pdf</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>target-type</meta-name>
              <meta-value>OnlinePDF</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-type</meta-name>
              <meta-value>Letter</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-primary</meta-name>
              <meta-value>Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computer Applications in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Documentation and Information in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Theoretical and Computational Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computational Biology/Bioinformatics</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-collection</meta-name>
              <meta-value>Chemistry and Materials Science</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>open-access</meta-name>
              <meta-value>true</meta-value>
            </custom-meta>
          </custom-meta-group>
        </article-meta>
        <notes notes-type="CrossLinking">
          <sec>
            <p>An author's reply to this comment is available online at <ext-link xlink:href="https://doi.org/10.1186/s13321-019-0388-x" ext-link-type="uri">https://doi.org/10.1186/s13321-019-0388-x</ext-link>.</p>
          </sec>
        </notes>
      </front>
      <body>
        <sec id="Sec1">
          <title>Introduction</title>
          <p id="Par2">Recently Bosc et al. [<xref ref-type="bibr" rid="CR1">1</xref>] published an article in the <italic>Journal of Cheminformatics</italic>, describing a case study that directly compares conformal predictions with traditional QSAR methods for large-scale predictions of target-ligand binding. We consider this study to be very important. Unfortunately, we have found several issues in the authors’ approach as well as in the presentation of their findings. We shall start with more general issues and then go on to more specific ones.</p>
        </sec>
        <sec id="Sec2">
          <title>Generalisation of QSAR vs MCP</title>
          <p id="Par3">The authors’ aim was to compare QSAR and Mondrian conformal prediction (MCP) as objectively as possible, making full use of all the data, subject to the constraints inherent in each method. QSAR classification models were built using the Random Forest (RF) with the number of trees and the maximum depth of the tree set to 300 and 20 respectively. All other RF parameters were set to their default values. The authors inform us that their internal tuning experiments using grid search demonstrated that these values generally enabled them to obtain the most accurate models (data not shown). Similarly, the same RF algorithm and associated parameters were used in the MCP framework. This means that whenever the authors refer to QSAR and MCP models they are de facto discussing RF with predefined fixed parameters as a QSAR model and its implementation in the MCP framework.</p>
          <p id="Par4">After a brief description of how RF was used in the paper, the authors then continue to present and discuss the results throughout the paper as comparisons between QSAR and MCP models, without ever mentioning again that they are really analysing the results of an RF model with fixed parameters in QSAR and MCP settings.</p>
          <p id="Par5">We understand that in order to analyse datasets on a such large scale the process needs to be simplified. Therefore it might not be feasible to apply other model building techniques as well as model selection processes [<xref ref-type="bibr" rid="CR2">2</xref>] for each dataset separately. However, in our opinion that cannot be the reason, nor do the authors provide any explanation, for generalising their findings in the paper (most importantly in the title, abstract, graphs, tables and conclusion) as QSAR vs MCP models. Consequently, we do not consider such extrapolations as beneficial to research regarding the comparison of QSAR and MCP models.</p>
        </sec>
        <sec id="Sec3">
          <title>Variability</title>
          <p id="Par6">When performing a comparison between two methods, in our view, it is very important to address the issue of the variability of generated results. The paper does not tell us whether the authors have addressed the following causes of variability, and if so how. There is also some information missing in their presentation of variability in the paper (details in the subsection Presentation of variability).</p>
          <sec id="Sec4">
            <title>Random forest variability</title>
            <p id="Par7">If we repeat the process of building a logistic regression model (linear model) and applying it on a dataset, we shall obtain identical predicted probabilities and predicted labels. However, this is not guaranteed with RF models. As its name suggests there is randomness inherent in RF models. Therefore, unless we fix a random seed number, if we re-build and re-apply the RF model we will obtain somewhat different predicted probabilities. The predicted labels may or may not be identical. It depends on samples with predicted probabilities close to 0.5. The randomness may affect their predicted probabilities to flip-flop around 0.5 and thus change their predicted labels. We could not find that the issue of variability caused by RF in QSAR and MCP settings is either considered or addressed in the paper.</p>
          </sec>
          <sec id="Sec5">
            <title>MCP variability</title>
            <p id="Par8">In the Model validation section of the paper (page 5), the authors explain how for each target they split the dataset into a training (80%) and a test set (20%). For MCP they further randomly divided the training dataset into a proper training set (70%) and a calibration set (30%). Therefore for QSAR we would have the training set (80%) and the test set (20%), while for MCP we would have the proper training set (56%), the calibration set (24%) and the same test set (20%). Our understanding from the paper is that the authors have repeated 100 times the procedure of splitting the dataset into training (80%) and test (20%), and we agree with that. However, it is not mentioned in the paper, and therefore we are left to presume, that the splitting of each training set into the proper training and the calibration set was done only once. That is understandable because that is how MCP works. Nevertheless, if our aim is to compare QSAR with MCP models then we would have liked to see the variability of the MCP results caused by different splitting of the training set into the proper training set and calibration set, if not analysed, then at least mentioned in the paper.</p>
          </sec>
          <sec id="Sec6">
            <title>Presentation of variability</title>
            <p id="Par9">Throughout the paper the values of various statistics are presented with ± another value next to it. We presume that the other value is the standard error but we are not informed about it. Furthermore, we are not informed regarding the sample size from which the standard error was calculated. Our understanding is that the average values presented in the paper are not all calculated from samples with equal sample size. In Fig. 3 and Fig. 4 the variabilities of results are visually presented without the information they represent. Similarly in Table 2 and Table 4 next to each statistic there is ± of a value in the brackets without an explanation as to what they represent. It would have been nice if the authors had explained the variabilities presented in the paper and especially in tables and graphs, which we believe is common practice.</p>
          </sec>
        </sec>
        <sec id="Sec7">
          <title>Model validation</title>
          <p id="Par10">There is an important section of the paper which we have trouble understanding. In the first paragraph of the Model validation section (page 5), after a very understandable explanation of how the dataset was split into a training and a test set, and how then for MCP the training dataset was further split into a proper training and calibration set, we have the following sentence:<disp-quote><p id="Par11"><italic>“The splitting procedure was repeated 100 times using the different random splits and the result for each compound was obtained by calculating the median probabilities for QSAR or p values for MCP, over the 100 predictions.”</italic></p></disp-quote></p>
          <p id="Par12">The second part of the above sentence is confusing. We would like to remind that the authors at the start of the Model building section of the paper (page 4) state “<italic>We chose to build simple active/inactive classification models.</italic>”. Therefore, we have so far been dealing with binary classifications. Our understanding is that the splitting into training (80%) and test set (20%) was done 100 times, which means that we would have 100 times 20% of compounds with binary predictions. So, where do “<italic>the median probabilities for QSAR</italic>” come from? Also “<italic>the result for each compound was obtained …, over the 100 predictions</italic>” as if each compound had 100 predictions!? The entire second part of the sentence in question does not make any sense to us. We would like to point out that this is in our opinion the crucial section for understanding the process of how the authors generated results for comparing QSAR and MCP models. We apologise in advance if this section is clear to others, and not to us.</p>
        </sec>
        <sec id="Sec8">
          <title>Explanation of _excl and _incl statistics</title>
          <p id="Par13">In order for us to explain other issues that follow, it is vital to understand the six new metrics introduced by the authors. In CP, binary classifiers may return the following four predictions: {positive}, {negative}, {positive and negative} and {null}. Authors referred to the last two predictions as ‘both’ and ‘empty’. They introduced three metrics (sensitivity_incl, specificity_incl and CCR_incl) when compounds assigned to the ‘both’ class are considered correctly classified, and three further metrics (sensitivity_excl, specificity_excl and CCR_excl) where compounds in the ‘both’ class are ignored.</p>
          <p id="Par14">In our opinion it is worth examining the six new metrics in detail and we provide below additional detailed explanations for them in our own words. In the Table <xref rid="Tab1" ref-type="table">1</xref> we show the distribution of MCP predictions depending on their true value and the names we have ascribed to them.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>The distribution of MCP predictions depending on the actual value</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Actual\MCP prediction</p></th><th align="left"><p>Positive</p></th><th align="left"><p>Negative</p></th><th align="left"><p>Both</p></th><th align="left"><p>Empty</p></th></tr></thead><tbody><tr><td align="left"><p>Positive</p></td><td align="left"><p>TP</p></td><td align="left"><p>FN</p></td><td align="left"><p>BP</p></td><td align="left"><p>EP</p></td></tr><tr><td align="left"><p>Negative</p></td><td align="left"><p>FP</p></td><td align="left"><p>TN</p></td><td align="left"><p>BN</p></td><td align="left"><p>EN</p></td></tr></tbody></table><table-wrap-foot><p><italic>TP</italic> number of true positives, <italic>FP</italic> number of false positives, <italic>TN</italic> number of true negatives, <italic>FN</italic> number of false negatives, <italic>BP</italic> number of positives predicted as ‘both’, <italic>EP</italic> number of positives predicted as ‘empty’, <italic>BN</italic> number of negatives predicted as ‘both’, <italic>EN</italic> number of negatives predicted as ‘empty’</p></table-wrap-foot></table-wrap></p>
          <p id="Par15"><disp-formula id="Equa"><alternatives><mml:math display="block" id="Equa_Math"><mml:mrow><mml:mtext>TOTAL</mml:mtext><mml:mi>_</mml:mi><mml:mtext>P</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>=</mml:mo><mml:mspace width="0.166667em" /><mml:mtext>TP</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>+</mml:mo><mml:mspace width="0.166667em" /><mml:mtext>FN</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>+</mml:mo><mml:mspace width="0.166667em" /><mml:mtext>BP</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>+</mml:mo><mml:mspace width="0.166667em" /><mml:mtext>EP</mml:mtext><mml:mo>-</mml:mo><mml:mrow><mml:mtext>total number of positives</mml:mtext></mml:mrow></mml:mrow></mml:math><tex-math id="Equa_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{TOTAL}}\_{\text{P}}\, = \,{\text{TP}}\, + \,{\text{FN}}\, + \,{\text{BP}}\, + \,{\text{EP}}{-}{\text{total number of positives}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_387_Article_Equa.gif" /></alternatives></disp-formula><disp-formula id="Equb"><alternatives><mml:math display="block" id="Equb_Math"><mml:mrow><mml:mtext>TOTAL</mml:mtext><mml:mi>_</mml:mi><mml:mtext>N</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>=</mml:mo><mml:mspace width="0.166667em" /><mml:mtext>TN</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>+</mml:mo><mml:mspace width="0.166667em" /><mml:mtext>FP</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>+</mml:mo><mml:mspace width="0.166667em" /><mml:mtext>BN</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>+</mml:mo><mml:mspace width="0.166667em" /><mml:mtext>EN</mml:mtext><mml:mo>-</mml:mo><mml:mrow><mml:mtext>total number of negatives</mml:mtext></mml:mrow></mml:mrow></mml:math><tex-math id="Equb_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{TOTAL}}\_{\text{N}}\, = \,{\text{TN}}\, + \,{\text{FP}}\, + \,{\text{BN}}\, + \,{\text{EN}}{-}{\text{total number of negatives}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_387_Article_Equb.gif" /></alternatives></disp-formula>It was clarified to us that equations for 6 new metrics are then as follows:<disp-formula id="Equc"><alternatives><mml:math display="block" id="Equc_Math"><mml:mrow><mml:mtext>Specificity</mml:mtext><mml:mi>_</mml:mi><mml:mtext>excl</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>=</mml:mo><mml:mspace width="0.166667em" /><mml:mtext>TN</mml:mtext><mml:mo stretchy="false">/</mml:mo><mml:mtext>TOTAL</mml:mtext><mml:mi>_</mml:mi><mml:mtext>N</mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:math><tex-math id="Equc_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{Specificity}}\_{\text{excl}}\, = \,{\text{TN}}/{\text{TOTAL}}\_{\text{N}},$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_387_Article_Equc.gif" /></alternatives></disp-formula><disp-formula id="Equd"><alternatives><mml:math display="block" id="Equd_Math"><mml:mrow><mml:mtext>Sensitivity</mml:mtext><mml:mi>_</mml:mi><mml:mtext>excl</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>=</mml:mo><mml:mspace width="0.166667em" /><mml:mtext>TP</mml:mtext><mml:mo stretchy="false">/</mml:mo><mml:mtext>TOTAL</mml:mtext><mml:mi>_</mml:mi><mml:mtext>P</mml:mtext></mml:mrow></mml:math><tex-math id="Equd_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{Sensitivity}}\_{\text{excl}}\, = \,{\text{TP}}/{\text{TOTAL}}\_{\text{P}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_387_Article_Equd.gif" /></alternatives></disp-formula><disp-formula id="Eque"><alternatives><mml:math display="block" id="Eque_Math"><mml:mrow><mml:mtext>CCR</mml:mtext><mml:mi>_</mml:mi><mml:mtext>excl</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>=</mml:mo><mml:mspace width="0.166667em" /><mml:mo stretchy="false">(</mml:mo><mml:mtext>specificity</mml:mtext><mml:mi>_</mml:mi><mml:mtext>excl</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>+</mml:mo><mml:mspace width="0.166667em" /><mml:mtext>sensitivity</mml:mtext><mml:mi>_</mml:mi><mml:mtext>excl</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><tex-math id="Eque_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{CCR}}\_{\text{excl}}\, = \,({\text{specificity}}\_{\text{excl}}\, + \,{\text{sensitivity}}\_{\text{excl}})/ 2$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_387_Article_Eque.gif" /></alternatives></disp-formula><disp-formula id="Equf"><alternatives><mml:math display="block" id="Equf_Math"><mml:mrow><mml:mtext>Specificity</mml:mtext><mml:mi>_</mml:mi><mml:mtext>incl</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>=</mml:mo><mml:mspace width="0.166667em" /><mml:mo stretchy="false">(</mml:mo><mml:mtext>TN</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>+</mml:mo><mml:mspace width="0.166667em" /><mml:mtext>BN</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mtext>TOTAL</mml:mtext><mml:mi>_</mml:mi><mml:mtext>N</mml:mtext></mml:mrow></mml:math><tex-math id="Equf_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{Specificity}}\_{\text{incl}}\, = \,({\text{TN}}\, + \,{\text{BN}})/{\text{TOTAL}}\_{\text{N}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_387_Article_Equf.gif" /></alternatives></disp-formula><disp-formula id="Equg"><alternatives><mml:math display="block" id="Equg_Math"><mml:mrow><mml:mtext>Sensitivity</mml:mtext><mml:mi>_</mml:mi><mml:mtext>incl</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>=</mml:mo><mml:mspace width="0.166667em" /><mml:mo stretchy="false">(</mml:mo><mml:mtext>TP</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>+</mml:mo><mml:mspace width="0.166667em" /><mml:mtext>BP</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mtext>TOTAL</mml:mtext><mml:mi>_</mml:mi><mml:mtext>P</mml:mtext></mml:mrow></mml:math><tex-math id="Equg_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{Sensitivity}}\_{\text{incl}}\, = \,({\text{TP}}\, + \,{\text{BP}})/{\text{TOTAL}}\_{\text{P}}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_387_Article_Equg.gif" /></alternatives></disp-formula><disp-formula id="Equh"><alternatives><mml:math display="block" id="Equh_Math"><mml:mrow><mml:mtext>CCR</mml:mtext><mml:mi>_</mml:mi><mml:mtext>incl</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>=</mml:mo><mml:mspace width="0.166667em" /><mml:mo stretchy="false">(</mml:mo><mml:mtext>specificity</mml:mtext><mml:mi>_</mml:mi><mml:mtext>incl</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>+</mml:mo><mml:mspace width="0.166667em" /><mml:mtext>sensitivity</mml:mtext><mml:mi>_</mml:mi><mml:mtext>incl</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><tex-math id="Equh_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{CCR}}\_{\text{incl}}\, = \,({\text{specificity}}\_{\text{incl}}\, + \,{\text{sensitivity}}\_{\text{incl}})/ 2$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_387_Article_Equh.gif" /></alternatives></disp-formula></p>
          <sec id="Sec9">
            <title>‘Both’ predictions</title>
            <p id="Par16">We question the authors’ analysis of ‘both’ predictions. What is the point of analysing the situation “<italic>when compounds assigned to the ‘both’ class are considered correctly classified</italic>”? If in practice we apply MCP and we get X % of “both” predictions in our test set, what will happen if they are considered correctly classified? First, as we are dealing with predictions we cannot know in advance their correct classification. Second, an obvious answer is that we would get X % more correct classifications! The improvements to specificity and sensitivity would depend on the proportion of positives and negatives in the test set, and that would then reflect the improvement of the CCR. Maybe there is a rationale or a practical benefit when analysing the situation “<italic>when compounds assigned to the ‘both’ class are considered correctly classified</italic>”, but we do not see them nor have the authors provided an explanation for them.</p>
          </sec>
          <sec id="Sec10">
            <title>‘Empty’ predictions</title>
            <p id="Par17">Our understanding is that the ‘empty’ predictions are treated as false predictions in the six metrics introduced by the authors. We totally agree with the authors’ statement on page 7 that “<italic>it is reasonable to argue that a compound assigned to the ‘empty’ class is too dissimilar from the molecules in the model and so cannot be part of the AD.</italic>” Therefore, we are puzzled as to why they have not examined the option of removing ‘empty’ predictions from the denominator in their metrics. As ‘empty’ predictions are a fundamental part of CP we are also surprised to see that they are not even mentioned in the conclusion of the paper.</p>
          </sec>
        </sec>
        <sec id="Sec11">
          <title>Missed opportunities in the data analysis</title>
          <p id="Par18">Our main impression of the paper is a genuine regret for missed opportunities. Some of the issues discussed above we see as opportunities which, due to possible time or computer power constraints, might not have been feasible for the authors to execute. However, in our opinion there were options in the data analysis which would have brought additional value to the study with little extra effort. As mentioned before, the authors have treated ‘both’ predictions as either all being true (_incl metrics) or all false (_excl metrics), while ‘empty’ predictions have been treated as all being false. We regret not seeing the following options analysed in the paper.</p>
          <sec id="Sec12">
            <title>Removing uncertain predictions from the analysis</title>
            <p id="Par19">Near the end of the Temporal validation section of the paper (page 13) the authors have discussed grouping ‘both’ and ‘empty’ into a single category called uncertain and they illustrated this in Table 5. They even mention that “<italic>Ignoring these predictions allows one to improve the overall predictivity</italic>” (last paragraph page 13). There are indications (not generalisations) that by using a simplistic method of defining Uncertain predictions [<xref ref-type="bibr" rid="CR3">3</xref>], different from the CP, the overall accuracy of binary predictions may be improved on samples which are not Uncertain. We regret not seeing that option analysed in the paper. To be more precise, we would have liked to see the results for following three statistics, and we believe that it would have improved the quality of the paper:<disp-formula id="Equi"><alternatives><mml:math display="block" id="Equi_Math"><mml:mrow><mml:mtext>Specificity</mml:mtext><mml:mi>_</mml:mi><mml:mtext>uncertain</mml:mtext><mml:mi>_</mml:mi><mml:mtext>out</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>=</mml:mo><mml:mspace width="0.166667em" /><mml:mtext>TN</mml:mtext><mml:mo stretchy="false">/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext>TN</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>+</mml:mo><mml:mspace width="0.166667em" /><mml:mtext>FP</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="Equi_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{Specificity}}\_{\text{uncertain}}\_{\text{out}}\, = \,{\text{TN}}/({\text{TN}}\, + \,{\text{FP}})$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_387_Article_Equi.gif" /></alternatives></disp-formula><disp-formula id="Equj"><alternatives><mml:math display="block" id="Equj_Math"><mml:mrow><mml:mtext>Sensitivity</mml:mtext><mml:mi>_</mml:mi><mml:mtext>uncertain</mml:mtext><mml:mi>_</mml:mi><mml:mtext>out</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>=</mml:mo><mml:mspace width="0.166667em" /><mml:mtext>TP</mml:mtext><mml:mo stretchy="false">/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext>TP</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>+</mml:mo><mml:mspace width="0.166667em" /><mml:mtext>FN</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="Equj_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{Sensitivity}}\_{\text{uncertain}}\_{\text{out}}\, = \,{\text{TP}}/({\text{TP}}\, + \,{\text{FN}})$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_387_Article_Equj.gif" /></alternatives></disp-formula><disp-formula id="Equk"><alternatives><mml:math display="block" id="Equk_Math"><mml:mrow><mml:mtext>CCR</mml:mtext><mml:mi>_</mml:mi><mml:mtext>uncertain</mml:mtext><mml:mi>_</mml:mi><mml:mtext>out</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>=</mml:mo><mml:mspace width="0.166667em" /><mml:mo stretchy="false">(</mml:mo><mml:mtext>specificity</mml:mtext><mml:mi>_</mml:mi><mml:mtext>uncertain</mml:mtext><mml:mi>_</mml:mi><mml:mtext>out</mml:mtext><mml:mspace width="0.166667em" /><mml:mo>+</mml:mo><mml:mspace width="0.166667em" /><mml:mtext>sensitivity</mml:mtext><mml:mi>_</mml:mi><mml:mtext>uncertain</mml:mtext><mml:mi>_</mml:mi><mml:mtext>out</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><tex-math id="Equk_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{CCR}}\_{\text{uncertain}}\_{\text{out}}\, = \,({\text{specificity}}\_{\text{uncertain}}\_{\text{out}}\, + \,{\text{sensitivity}}\_{\text{uncertain}}\_{\text{out}})/ 2$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_387_Article_Equk.gif" /></alternatives></disp-formula>Note: TN, TP, FN and FP values are as specified in our Table <xref rid="Tab1" ref-type="table">1</xref>.</p>
            <p id="Par20">We would then be able to see if and to what extent statistics have improved at each confidence level (70%, 80%, 90%) and to compare that to the proportion of uncertain predictions (available from Table 2 in the paper). As such an analysis was not performed, we do not know the results. However, it would have been interesting, at least for us, to see if and to what extent the predictivity was improved on the subset of compounds predicted as positive and negative (not uncertain).</p>
          </sec>
          <sec id="Sec13">
            <title>Removing ‘empty’ predictions from the analysis with various scenarios for ‘both’</title>
            <p id="Par21">In our view it might have been worthwhile investigating scenarios where ‘empty’ predictions are removed from the analysis and various options for ‘both’ predictions are examined. For example, ‘both’ classes may be considered as all active, or as all inactive, or as all equal to the dominant class in the training dataset. In short, we are of the opinion that there were more options for analysing ‘empty’ and ‘both’ predictions than those that the authors have presented us with.</p>
          </sec>
        </sec>
        <sec id="Sec14">
          <title>Comparison of the QSAR and MCP models</title>
          <p id="Par22">In the section Comparison of QSAR and Mondrian CP models of the paper (pages 10–11), as well as in the section Temporal validation (pages 12–13), approximately half of the MCP model performances are presented with the _incl statistics, i.e. “<italic>when compounds assigned to the ‘both’ class are considered correctly classified</italic>”. As we have mentioned before, we do not understand the rationale for its use, because we cannot know in advance their correct classification. Furthermore, adding correct classifications cannot worsen the statistics, and the extent of improvement depends on the quality of the remaining predictions (_excl statistics). Unfortunately, the analyses of such situations lead to statements of the obvious. Here is just one example from the end of page 12.<disp-quote><p id="Par23"><italic>“The CCR is also affected whether or not the ‘both’ class predictions are considered when a confidence level of 90% is used. At this level, the CCR for the models including the ‘both’ prediction class reaches 0.86 compared with 0.43 when it is excluded. The greater number of compounds assigned to the ‘both’ prediction class at this confidence level results in globally better predictivity of the models (Table</italic> <italic>4).”</italic></p></disp-quote></p>
          <p id="Par24">We are not stating that the authors are wrong here. The more correct classifications we have in our prediction sample the better its predictivity will be. However, is this not self evident?</p>
        </sec>
        <sec id="Sec15" sec-type="conclusions">
          <title>Conclusion</title>
          <p id="Par25">We disagree with the generalisation of findings as comparisons of QSAR and MCP models that is prevalent throughout the paper. Results presented are related to RF model with fixed parameters. We do not think that the design of the experiment in the paper is wrong as such, but the authors have not informed readers of its weaknesses. If the issues of variabilities could not have been addressed in the design of the study, due to possible time or computer power constraints, we would have liked to see them at least acknowledged in the paper. An important section of the paper related to model validation is not clear to us at all, therefore we are not able to repeat it. We again apologise in advance if the problematic section is clear to other people. We question the practical value of the way the authors have analysed ‘both’ and ‘empty’ predictions, and we provide cases for missed opportunities in their data analysis. We question the rationale behind half of comparisons between MCP and QSAR presented in the paper, because they examine the situations “<italic>when compounds assigned to the ‘both’ class are considered correctly classified</italic>”. How can someone in practice transform ‘both’ predictions into correct classifications? How can it be useful in science to examine situations in which we assume that we know something which we cannot know?</p>
          <p id="Par26">As we see it, every research analysis (ours included) is bound to have weaknesses, and discussions regarding generalisation of results are common throughout science. We can imagine that Bosc et al. [<xref ref-type="bibr" rid="CR1">1</xref>] have put a lot of effort in producing the results, and with all its inevitable weaknesses there was an opportunity, in our view, to provide some valuable indications (not generalisations) regarding the comparison of QSAR and MCP models. We do not think that the opportunity was used to its fullest potential. Taking everything into consideration, we think the approach taken by Bosc et al. [<xref ref-type="bibr" rid="CR1">1</xref>] when comparing QSAR and MCP modelling methods is too narrow and methodologically unsound. Therefore, in our opinion, the scientific evidence presented by Bosc et al. [<xref ref-type="bibr" rid="CR1">1</xref>] is not adequate to reach any conclusion whatsoever.</p>
          <p id="Par27">We would like to point out that Dr Nicolas Bosc, the corresponding author of the paper, was very helpful in replying to our emails and without his further clarifications of the _excl and _incl statistics our opinion piece would not have been the same.
</p>
        </sec>
      </body>
      <back>
        <ack>
          <title>Acknowledgements</title>
          <p>The author would like to thank his mother, Linda Louise Woodall Krstajic, for correcting English typos and language improvements in the text.</p>
        </ack>
        <sec sec-type="author-contribution">
          <title>Authors’ contributions</title>
          <p>The author read and approved the final manuscript.</p>
        </sec>
        <sec>
          <title>Funding</title>
          <p>No funding received.</p>
        </sec>
        <sec sec-type="ethics-statement">
          <sec id="FPar1" sec-type="COI-statement">
            <title>Competing interests</title>
            <p id="Par28">The author declares no competing interests.</p>
          </sec>
        </sec>
        <ref-list id="Bib1">
          <title>References</title>
          <ref-list>
            <ref id="CR1">
              <label>1.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Bosc</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Atkinson</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Felix</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Gaulton</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Hersey</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Leach</surname>
                    <given-names>AR</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Large scale comparison of QSAR and conformal prediction methods and their applications in drug discovery</article-title>
                <source>J Cheminform</source>
                <year>2019</year>
                <volume>11</volume>
                <issue>1</issue>
                <fpage>4</fpage>
                <pub-id pub-id-type="doi">10.1186/s13321-018-0325-4</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR2">
              <label>2.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Krstajic</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Buturovic</surname>
                    <given-names>LJ</given-names>
                  </name>
                  <name>
                    <surname>Leahy</surname>
                    <given-names>DE</given-names>
                  </name>
                  <name>
                    <surname>Thomas</surname>
                    <given-names>S</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Cross-validation pitfalls when selecting and assessing regression and classification models</article-title>
                <source>J Cheminform.</source>
                <year>2014</year>
                <volume>6</volume>
                <issue>1</issue>
                <fpage>10</fpage>
                <pub-id pub-id-type="doi">10.1186/1758-2946-6-10</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR3">
              <label>3.</label>
              <mixed-citation publication-type="other">Krstajic D, Buturovic L, Thomas S, Leahy DE. Binary classification models with “Uncertain” predictions. arXiv preprint <ext-link xlink:href="http://arxiv.org/abs/1711.09677" ext-link-type="uri">arXiv:1711.09677</ext-link>. 2017</mixed-citation>
            </ref>
          </ref-list>
        </ref-list>
        <notes notes-type="Misc">
          <title>Publisher's Note</title>
          <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
        </notes>
      </back>
    </article>
