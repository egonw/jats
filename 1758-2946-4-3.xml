<?xml version="1.0"?>
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="research-article" xml:lang="en">
      <front>
        <journal-meta>
          <journal-id journal-id-type="publisher-id">13321</journal-id>
          <journal-title-group>
            <journal-title>Journal of Cheminformatics</journal-title>
            <abbrev-journal-title abbrev-type="publisher">J Cheminform</abbrev-journal-title>
          </journal-title-group>
          <issn pub-type="epub">1758-2946</issn>
          <publisher>
            <publisher-name>Springer International Publishing</publisher-name>
            <publisher-loc>Cham</publisher-loc>
          </publisher>
        </journal-meta>
        <article-meta>
          <article-id pub-id-type="publisher-id">BMC1758-2946-4-3</article-id>
          <article-id pub-id-type="manuscript">241</article-id>
          <article-id pub-id-type="doi">10.1186/1758-2946-4-3</article-id>
          <article-categories>
            <subj-group subj-group-type="heading">
              <subject>Software</subject>
            </subj-group>
          </article-categories>
          <title-group>
            <article-title xml:lang="en">LICSS - a chemical spreadsheet in microsoft excel</article-title>
          </title-group>
          <contrib-group>
            <contrib contrib-type="author" corresp="yes">
              <name>
                <surname>Lawson</surname>
                <given-names>Kevin R</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="corresp" rid="IDBMC1758294643_cor1">a</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Lawson</surname>
                <given-names>Jonty</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff2">2</xref>
            </contrib>
            <aff id="Aff1">
              <label>1</label>
              <institution-wrap>
                <institution-id institution-id-type="GRID">grid.426114.4</institution-id>
                <institution-id institution-id-type="ISNI">0000 0000 9974 7390</institution-id>
                <institution content-type="org-name">Syngenta Ltd. Jealotts Hill Research Centre</institution>
              </institution-wrap>
              <addr-line content-type="postcode">RG42 6EY</addr-line>
              <addr-line content-type="city">Bracknell</addr-line>
              <addr-line content-type="state">Berkshire</addr-line>
              <country country="GB">UK</country>
            </aff>
            <aff id="Aff2">
              <label>2</label>
              <institution-wrap>
                <institution content-type="org-name">DataLook Ltd. Highfield</institution>
              </institution-wrap>
              <addr-line content-type="postcode">PR25 5SD</addr-line>
              <addr-line content-type="city">Preston</addr-line>
              <country country="GB">UK</country>
            </aff>
          </contrib-group>
          <author-notes>
            <corresp id="IDBMC1758294643_cor1">
              <label>a</label>
              <email>HIDDEN</email>
            </corresp>
          </author-notes>
          <pub-date date-type="pub" publication-format="electronic">
            <day>2</day>
            <month>2</month>
            <year>2012</year>
          </pub-date>
          <pub-date date-type="collection" publication-format="electronic">
            <month>12</month>
            <year>2012</year>
          </pub-date>
          <volume>4</volume>
          <issue seq="4">1</issue>
          <elocation-id>3</elocation-id>
          <history>
            <date date-type="registration">
              <day>14</day>
              <month>12</month>
              <year>2011</year>
            </date>
            <date date-type="received">
              <day>14</day>
              <month>12</month>
              <year>2011</year>
            </date>
            <date date-type="accepted">
              <day>2</day>
              <month>2</month>
              <year>2012</year>
            </date>
            <date date-type="online">
              <day>2</day>
              <month>2</month>
              <year>2012</year>
            </date>
          </history>
          <permissions>
            <copyright-statement content-type="compact">© Lawson and Lawson; licensee Chemistry Central Ltd. 2012</copyright-statement>
            <copyright-statement content-type="comment">This article is published under license to BioMed Central Ltd. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link xlink:href="http://creativecommons.org/licenses/by/2.0" ext-link-type="uri">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</copyright-statement>
            <copyright-year>2012</copyright-year>
            <copyright-holder>Lawson and Lawson; licensee Chemistry Central Ltd.</copyright-holder>
            <license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/2.0">
              <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 2.0 International License (<ext-link xlink:href="https://creativecommons.org/licenses/by/2.0" ext-link-type="uri">https://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
            </license>
          </permissions>
          <abstract xml:lang="en" id="Abs1">
            <title>Abstract</title>
            <sec id="ASec1">
              <title>Background</title>
              <p>Representations of chemical datasets in spreadsheet format are important for ready data assimilation and manipulation. In addition to the normal spreadsheet facilities, chemical spreadsheets need to have visualisable chemical structures and data searchable by chemical as well as textual queries. Many such chemical spreadsheet tools are available, some operating in the familiar Microsoft Excel environment. However, within this group, the performance of Excel is often compromised, particularly in terms of the number of compounds which can usefully be stored on a sheet.</p>
            </sec>
            <sec id="ASec2">
              <title>Summary</title>
              <p>LICSS is a lightweight chemical spreadsheet within Microsoft Excel for Windows. LICSS stores structures solely as Smiles strings. Chemical operations are carried out by calling Java code modules which use the CDK, JChemPaint and OPSIN libraries to provide cheminformatics functionality. Compounds in sheets or charts may be visualised (individually or <italic>en masse</italic>), and sheets may be searched by substructure or similarity. All the molecular descriptors available in CDK may be calculated for compounds (in batch or on-the-fly), and various cheminformatic operations such as fingerprint calculation, Sammon mapping, clustering and R group table creation may be carried out.</p>
              <p>We detail here the features of LICSS and how they are implemented. We also explain the design criteria, particularly in terms of potential corporate use, which led to this particular implementation.</p>
            </sec>
            <sec id="ASec3">
              <title>Conclusions</title>
              <p>LICSS is an Excel-based chemical spreadsheet with a difference:</p>
              <p>• It can usefully be used on sheets containing hundreds of thousands of compounds; it doesn't compromise the normal performance of Microsoft Excel</p>
              <p>• It is designed to be installed and run in environments in which users do not have admin privileges; installation involves merely file copying, and sharing of LICSS sheets invokes automatic installation</p>
              <p>• It is free and extensible</p>
              <p>LICSS is open source software and we hope sufficient detail is provided here to enable developers to add their own features and share with the community.</p>
            </sec>
          </abstract>
          <kwd-group xml:lang="en">
            <title>Keywords</title>
            <kwd>Molecular Descriptor</kwd>
            <kwd>Corporate Environment</kwd>
            <kwd>Sammon</kwd>
            <kwd>Smile String</kwd>
            <kwd>File Copying</kwd>
          </kwd-group>
          <custom-meta-group>
            <custom-meta>
              <meta-name>publisher-imprint-name</meta-name>
              <meta-value>Chemistry Central</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-issue-count</meta-name>
              <meta-value>1</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-article-count</meta-name>
              <meta-value>39</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-holder</meta-name>
              <meta-value>The Author(s)</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-year</meta-name>
              <meta-value>2012</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-contains-esm</meta-name>
              <meta-value>Yes</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-year</meta-name>
              <meta-value>2011</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-month</meta-name>
              <meta-value>12</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-day</meta-name>
              <meta-value>14</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-product</meta-name>
              <meta-value>ArchiveJournal</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-grants-type</meta-name>
              <meta-value>OpenChoice</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>metadata-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>abstract-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodypdf-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodyhtml-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bibliography-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>esm-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>online-first</meta-name>
              <meta-value>false</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-file-reference</meta-name>
              <meta-value>BodyRef/PDF/13321_2011_Article_241.pdf</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-type</meta-name>
              <meta-value>Typeset</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>target-type</meta-name>
              <meta-value>OnlinePDF</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-type</meta-name>
              <meta-value>OriginalPaper</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-primary</meta-name>
              <meta-value>Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computer Applications in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Documentation and Information in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Theoretical and Computational Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computational Biology/Bioinformatics</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-collection</meta-name>
              <meta-value>Chemistry and Materials Science</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>open-access</meta-name>
              <meta-value>true</meta-value>
            </custom-meta>
          </custom-meta-group>
        </article-meta>
        <notes notes-type="ESMHint">
          <title>Electronic supplementary material</title>
          <p>The online version of this article (doi:<ext-link xlink:href="10.1186/1758-2946-4-3" ext-link-type="doi">10.1186/1758-2946-4-3</ext-link>) contains supplementary material, which is available to authorized users.</p>
        </notes>
      </front>
      <body>
        <sec id="Sec1">
          <title>Introduction</title>
          <p>The familiar Chemical Spreadsheet paradigm is an extremely useful way of presenting structural information together with calculated or measured structural properties. Indeed, most software which handles or stores chemical data will make available a tabular view implementing at least some of the more common spreadsheet functionality such as sorting by columns. Many excellent chemical spreadsheet tools are commercially available and there are also notable freeware/open source examples [<xref ref-type="bibr" rid="CR1">1</xref>]. Most such software is self-contained which, of course, gives the developers maximum freedom of implementation. This approach has certain potential disadvantages however, particularly considered in the context of a corporate environment:</p>
          <p>
            <list list-type="bullet">
              <list-item>
                <p>An interested user needs to buy/download and install the software. This of course is trivial in the case of a 'home' or independent user but may pose almost insurmountable challenges in a 'locked-down' corporate environment</p>
              </list-item>
              <list-item>
                <p>The user must get to grips with an entirely new piece of software overcoming a potentially steep learning curve</p>
              </list-item>
              <list-item>
                <p>It is extremely difficult to provide spreadsheet features (powerful calculated columns, visualisation, macro language, etc) which begin to rival those of the industry standard, Microsoft Excel - a program already very familiar to target users.</p>
              </list-item>
            </list>
          </p>
          <p>The last point suggests a different approach in which the chemistry engine is build on top of Excel. This tactic appears extremely attractive partly because the potential developer can concentrate on implementing chemical functionality but also because of the ubiquity and power of Excel. Two well-known realisations of this approach are Isis for Excel [<xref ref-type="bibr" rid="CR2">2</xref>] and Accord for Excel [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
          <p>Solutions of this type are typically implemented as Excel AddIns, using Visual Basic for Applications (VBA) to interface with chemistry engines. Structures are usually stored on the spreadsheets as some kind of object (including structure-layout or image data) which may be interpreted by the chemistry engine for visualisation and calculation purposes. To ensure that structure objects display and sort properly, it is usually necessary to intercept several of Excel's fundamental calls (such as the main calculation routine). This necessity, together with the size of the stored objects, can lead to rapid degradation of performance for spreadsheets containing large numbers of structures.</p>
          <p>Bearing the foregoing in mind, LICSS was designed to appeal particularly to corporate users of Excel for Windows. Because of one of the authors' experience of corporate locked-down environments and because LICSS was to be a 'hobby' project, initially with just one spare-time developer, some rather specific design criteria were developed:</p>
          <p>
            <list list-type="bullet">
              <list-item>
                <p>LICSS should require no installation beyond file copying. Users should be able to share spreadsheets with fully automatic installation (if necessary)</p>
              </list-item>
              <list-item>
                <p>LICSS would implement chemistry functionality by interfacing with the excellent CDK Java library [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>] (and the corresponding rendering package, JChemPaint [<xref ref-type="bibr" rid="CR6">6</xref>])</p>
              </list-item>
              <list-item>
                <p>Structures should be stored purely as Smiles strings in cells; structure rendering would be on-the-fly</p>
              </list-item>
              <list-item>
                <p>LICSS spreadsheets would not intercept Excel's calculation calls</p>
              </list-item>
              <list-item>
                <p>An Excel add-in would not be used (they normally need user installation and can require admin privileges). Any necessary VBA would exist on each chemically-enabled spreadsheet.</p>
              </list-item>
            </list>
          </p>
          <sec id="Sec2">
            <title>User Implementation and Features</title>
            <p>From a user's point of view, LICSS is implemented as a single Excel for Windows workbook with just one routine which allows chemical enabling of any suitable spreadsheets (containing Smiles strings) and associated charts (Figure <xref rid="Fig1" ref-type="fig">1</xref>). Once enabled, the spreadsheets are entirely standalone, requiring no add-ins or any customisation of Excel [<xref ref-type="bibr" rid="CR7">7</xref>]. If shared with other users, or moved to a workstation without LICSS installation, the enabled sheets install LICSS seamlessly (if available in some shared area) or, if necessary, prompt the user to allow automatic file install from the LICSS project site on Google projects [<xref ref-type="bibr" rid="CR8">8</xref>].<fig id="Fig1"><label>Figure 1</label><caption xml:lang="en"><p><bold>EnableChemicalSpreadsheetV2.1.xls</bold>. Choosing the "Select Workbook for Structure Display and Substructure Searching" button will present user with a dropdown listing currently open workbooks together with their associated worksheets and charts which may be chemically-enabled.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2011_Article_241_Fig1_HTML.jpg" /></fig></p>
            <p>LICSS-enabled sheets use JChemPaint to render Smiles strings in a pop-up window (Figure <xref rid="Fig2" ref-type="fig">2</xref>). This is activated by clicking directly on the Smiles string, choosing a shortcut key to show the first structure on a row, or by mouse hover over scatter chart data points. If desired, users can also choose to display structures for all visible cells (Figure <xref rid="Fig3" ref-type="fig">3</xref>). The routine which achieves this calculates only which cells are currently visible to the user and renders the structures for them on-the-fly. This method ensures that even very large sheets (> 100,000 compounds) may be visualised without running out of memory.<fig id="Fig2"><label>Figure 2</label><caption xml:lang="en"><p><bold>LICSS display of single compounds upon selecting cells from the Smiles column</bold>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2011_Article_241_Fig2_HTML.jpg" /></fig><fig id="Fig3"><label>Figure 3</label><caption xml:lang="en"><p><bold>Display of multiple compounds in LICSS sheets</bold>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2011_Article_241_Fig3_HTML.jpg" /></fig></p>
            <p>Clicking on the 'LICSS Programs' worksheet tab gives access to a single menu making all other LICSS functionality available (Figure <xref rid="Fig4" ref-type="fig">4</xref>).<fig id="Fig4"><label>Figure 4</label><caption xml:lang="en"><p><bold>LICSS main programs menu</bold>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2011_Article_241_Fig4_HTML.jpg" /></fig></p>
            <p>Routines are currently available for substructure and similarity searching, fingerprint generation (for faster substructure searching), R Group table generation, Jarvis-Patrick clustering, Sammon map coordinate generation (see Figure <xref rid="Fig5" ref-type="fig">5</xref> for a scatter plot created from LICSS-generated Sammon map coordinates), diverse compound picking, molecular descriptor calculation and conversion of IUPAC names to Smiles (using the OPSIN Java library [<xref ref-type="bibr" rid="CR9">9</xref>]). New Excel formulas are also available - for calculating molecular descriptors, molecular weight or molecular formula and for determining whether one Smiles string is a substructure of, or is similar to, another Smiles string (within a defined threshold). Table <xref rid="Tab1" ref-type="table">1</xref> gives some indicative data for the performance a user can expect from LICSS functionality.<fig id="Fig5"><label>Figure 5</label><caption xml:lang="en"><p><bold>Sammon Projection of part of the Welcome Anti-Malarials data set calculated by LICSS</bold>. Single compound display on hovering over chart data points is also shown.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2011_Article_241_Fig5_HTML.jpg" /></fig></p>
            <table-wrap id="Tab1">
              <label>Table 1</label>
              <caption xml:lang="en">
                <p>Timings for common cheminformatics tasks using LICSS.</p>
              </caption>
              <table frame="hsides" rules="groups">
                <thead>
                  <tr>
                    <th align="left">
                      <p>Dataset</p>
                    </th>
                    <th align="left">
                      <p>Operation</p>
                    </th>
                    <th align="left">
                      <p>Timing (m:s)</p>
                    </th>
                    <th align="left">
                      <p>Hits</p>
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="left">
                      <p>[1]</p>
                    </td>
                    <td align="left">
                      <p>SSS (Sub Structure Search) with n1cnccc1 (Smarts matching)</p>
                    </td>
                    <td align="left">
                      <p>0:13</p>
                    </td>
                    <td align="left">
                      <p>76</p>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">
                      <p>[1]</p>
                    </td>
                    <td align="left">
                      <p>SSS with pyrimidine (sketcher)</p>
                    </td>
                    <td align="left">
                      <p>0:05</p>
                    </td>
                    <td align="left">
                      <p>76</p>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">
                      <p>[1]</p>
                    </td>
                    <td align="left">
                      <p>SSS with n1cnccc1 (Smarts matching/fingerprint pre-search)</p>
                    </td>
                    <td align="left">
                      <p>0:04</p>
                    </td>
                    <td align="left">
                      <p>76</p>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">
                      <p>[1]</p>
                    </td>
                    <td align="left">
                      <p>SSS with pyrimidine (sketcher/fingerprint pre-search)</p>
                    </td>
                    <td align="left">
                      <p>0:03</p>
                    </td>
                    <td align="left">
                      <p>76</p>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">
                      <p>[1]</p>
                    </td>
                    <td align="left">
                      <p>Fingerprint generation</p>
                    </td>
                    <td align="left">
                      <p>0:13</p>
                    </td>
                    <td />
                  </tr>
                  <tr>
                    <td align="left">
                      <p>[1]</p>
                    </td>
                    <td align="left">
                      <p>RGroupTable generation with Pyrimidine as core (sketcher)</p>
                    </td>
                    <td align="left">
                      <p>0:06 (batch)</p>
                      <p>0:05 (formula)</p>
                    </td>
                    <td />
                  </tr>
                  <tr>
                    <td align="left">
                      <p>[1]</p>
                    </td>
                    <td align="left">
                      <p>Jarvis Patrick clustering (generating 737 clusters)</p>
                    </td>
                    <td align="left">
                      <p>0:19</p>
                    </td>
                    <td />
                  </tr>
                  <tr>
                    <td align="left">
                      <p>[1]</p>
                    </td>
                    <td align="left">
                      <p>Sammon Map coordinate calculation</p>
                    </td>
                    <td align="left">
                      <p>0:28</p>
                    </td>
                    <td />
                  </tr>
                  <tr>
                    <td align="left">
                      <p>[1]</p>
                    </td>
                    <td align="left">
                      <p>Descriptor calculation (XLogP)</p>
                    </td>
                    <td align="left">
                      <p>0:08</p>
                    </td>
                    <td />
                  </tr>
                  <tr>
                    <td align="left">
                      <p>[2]</p>
                    </td>
                    <td align="left">
                      <p>SSS with Cc1cncnc1 (Smarts matching)</p>
                    </td>
                    <td align="left">
                      <p>5:32</p>
                    </td>
                    <td align="left">
                      <p>349</p>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">
                      <p>[2]</p>
                    </td>
                    <td align="left">
                      <p>SSS with 5-MePyrimidine (sketcher)</p>
                    </td>
                    <td align="left">
                      <p>1:55</p>
                    </td>
                    <td align="left">
                      <p>486 (includes cc1cncnc1 as well as Cc1cncnc1)</p>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">
                      <p>[2]</p>
                    </td>
                    <td align="left">
                      <p>SSS with Cc1cncnc1 (Smarts matching/fingerprint pre-search)</p>
                    </td>
                    <td align="left">
                      <p>0:21</p>
                    </td>
                    <td align="left">
                      <p>349</p>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">
                      <p>[2]</p>
                    </td>
                    <td align="left">
                      <p>SSS with 5-MePyrimidine (sketcher/fingerprint pre-search)</p>
                    </td>
                    <td align="left">
                      <p>0:13</p>
                    </td>
                    <td align="left">
                      <p>486</p>
                    </td>
                  </tr>
                  <tr>
                    <td align="left">
                      <p>[2]</p>
                    </td>
                    <td align="left">
                      <p>Fingerprint generation</p>
                    </td>
                    <td align="left">
                      <p>5:01</p>
                    </td>
                    <td />
                  </tr>
                  <tr>
                    <td align="left">
                      <p>[2]</p>
                    </td>
                    <td align="left">
                      <p>RGroupTable generation (on Pyrimidine subset with Pyrimidine as core; sketcher)</p>
                    </td>
                    <td align="left">
                      <p>0:28</p>
                    </td>
                    <td />
                  </tr>
                  <tr>
                    <td align="left">
                      <p>[2]</p>
                    </td>
                    <td align="left">
                      <p>Descriptor calculation (XLogP)</p>
                    </td>
                    <td align="left">
                      <p>4:37 (batch)</p>
                      <p>4:22 (formula)</p>
                    </td>
                    <td />
                  </tr>
                </tbody>
              </table>
              <table-wrap-foot>
                <p>Times refer to a 2.13 GHz laptop with 4 GB of memory running Vista/Microsoft Excel 2007.</p>
                <p>Two datasets were used: [<xref ref-type="bibr" rid="CR1">1</xref>]: a set containing ~1.6 k pesticidal compounds, [<xref ref-type="bibr" rid="CR2">2</xref>]: a set containing ~27 k anti-malarial compounds.</p>
              </table-wrap-foot>
            </table-wrap>
          </sec>
          <sec id="Sec3">
            <title>Technical Implementation</title>
            <p>The main enabling program is contained in an Excel for Windows workbook (Excel 97-2003 format), EnableChemicalSpreadsheetV2.1.xls. It is written in VBA using the VBA Extensibility library which allows the program to copy code to and create code in the workbook being enabled. Most code is simply copied from EnableChemicalspreadsheetV2.1.xls but some event handling routines are created specifically for the workbook being enabled; this makes possible features such as structure pop-up upon mouse hover over chart data points for example.</p>
            <p>The CDK and OPSIN Java libraries are accessed in one of two ways. For batch processes (such as Substructure and Similarity searching) the relevant compounds are first written to file in Smiles (SMI) file format (after an in-sheet fingerprint search if necessary). Then an executable JAR file, CDKSSWin.jar is synchronously executed. This contains a number of routines corresponding to each of the available LICSS programs and taking appropriate input/output file and other control parameters. Each of these routines creates an output file and terminates, whereupon the calling VBA processes the output file appropriately. The synchronous Jar file execution is done without a command line window through Javaw.exe and CDKSSWin.jar starts by creating a pop-up Swing progress window. In this way, the routines appear to run as part of Excel.</p>
            <p>CDK classes are widely used within CDKSSWin.jar to provide cheminformatics methods (fingerprint generation, substructure searching etc). Where available, existing open source code was adapted to use the CDK minimising the need to rewrite algorithms (eg for Jarvis Patrick clustering and Sammon projection; see acknowledgments). Algorithms for R-Group table generation, similarity searching and diverse compound picking were written in-house.</p>
            <p>Calls to JChemPaint, to display structure editing or structure display windows, are handled quite differently. Originally (version 1 x), the JChemPaint applet was used inside a WebBrowser control within VBA. However, this approach was not suitable for the rapid display of several structures (eg for displaying all worksheet structures). From version 2.0 onwards, a JVM is run within the Excel process space so calls to Java can be made directly, without per action initialisation or context switching overheads. Calls to Java of this type are made possible by creating C++ proxies for each Java method (contained within a single CDecl dll file, CDKInterfaceDll.dll) using JNI <italic>via</italic> the open-source Jace project technology [<xref ref-type="bibr" rid="CR10">10</xref>]. The C++ proxy functions may then be declared and called directly from VBA.</p>
            <p>In practice, after one-off Java initialisation, this approach enables extremely rapid access to Java routines directly from VBA in Excel. Thus, for example, a user can render a screen's worth of structures from Smiles in &lt; 1 second. The same method has been used for all the new Excel formulas - for example, on a 2.13 MHz laptop with 4 GB of memory running Vista, a formula entry such as: ' = GetCDKDescriptor(C2,"XLogP",1)' will calculate the XLogP descriptor for > 100 compounds per second when copied down for a column of Smiles strings (see also Table <xref rid="Tab1" ref-type="table">1</xref>).</p>
          </sec>
        </sec>
        <sec id="Sec4" sec-type="conclusions">
          <title>Conclusions</title>
          <p>LICSS is an open source chemical spreadsheet implemented in Microsoft Excel for Windows. It uses the CDK, JChemPaint and OPSIN open source libraries to provide cheminformatics functionality. LICSS-enabled worksheets and charts are self-installing, requiring no Add-Ins or anything that requires admin privileges. Enabled sheets contain only Smiles strings (with optional compact fingerprints) to represent chemistry and do not slow down Excel's calculation routines. Structures are visualised by clicking on cells containing Smiles strings or by hovering over enabled chart sheet data points. Structures for all currently visible compounds on a sheet may be simultaneously visualised 'on-the-fly'. These features mean that LICSS is suitable for worksheets containing very large (100s of 1000s) of compounds. In addition to basic visualisation and substructure/similarity searching functionality, routines for some more advanced analysis such as Sammon projection, R-Group table creation and Jarvis Patrick clustering are provided.</p>
        </sec>
        <sec id="Sec5">
          <title>Availability and Requirements</title>
          <p><bold>Project name:</bold> excel-cdk</p>
          <p>
            <bold>Project home page:</bold>
            <ext-link xlink:href="http://code.google.com/p/excel-cdk/" ext-link-type="uri">http://code.google.com/p/excel-cdk/</ext-link>
          </p>
          <p><bold>Operating system:</bold> Windows (XP, Vista or Windows 7); Microsoft Excel for Windows (97 - 2010)</p>
          <p><bold>Programming languages:</bold> VBA, Java, C++</p>
          <p><bold>Other requirements (if compiling):</bold> Jace tools</p>
          <p><bold>License:</bold> GNU GPL v2</p>
          <p><bold>Any restrictions to use by non-academics</bold>: none</p>
        </sec>
      </body>
      <back>
        <ack>
          <title>Acknowledgements</title>
          <p>The authors would like to acknowledge the authors/developers of the excellent Java libraries which LICSS makes extensive use of. In particular, the CDK [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>], JChemPaint [<xref ref-type="bibr" rid="CR6">6</xref>] and OPSIN [<xref ref-type="bibr" rid="CR9">9</xref>]. The latest version of LICSS also uses rendering/copying code originally written by Rajarshi Guha. The new rendering engine uses C++ proxying of Java classes and, for this, the JACE engine is used [<xref ref-type="bibr" rid="CR10">10</xref>]. Sammon mapping code was adapted from Java classes originally written by Jarkko Miettinen (for MZMine) [<xref ref-type="bibr" rid="CR11">11</xref>]. Clustering code was adapted from Java classes provided by NIH [<xref ref-type="bibr" rid="CR12">12</xref>]. R-Group Generation code was written together with Tom Sheldon (ex Syngenta). The VBA Code Module 'Chart Series' was written by John Walkenbach [<xref ref-type="bibr" rid="CR13">13</xref>].</p>
        </ack>
        <ref-list id="Bib1">
          <title>References</title>
          <ref-list>
            <ref id="CR1">
              <label>1.</label>
              <mixed-citation publication-type="other">Rich Apodaca: Your Favorite Chemical Spreadsheet. [<ext-link xlink:href="http://depth-first.com/articles/2008/09/12/your-favorite-chemical-spreadsheet/" ext-link-type="uri">http://depth-first.com/articles/2008/09/12/your-favorite-chemical-spreadsheet/</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR2">
              <label>2.</label>
              <mixed-citation publication-type="other">Links to Chemistry Spreadsheets. [<ext-link xlink:href="http://cds.dl.ac.uk/cds/other_info_and_links/info6.html" ext-link-type="uri">http://cds.dl.ac.uk/cds/other_info_and_links/info6.html</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR3">
              <label>3.</label>
              <mixed-citation publication-type="other">Desktop Cheminformatics Software. [<ext-link xlink:href="http://accelrys.com/products/informatics/desktop-software.html" ext-link-type="uri">http://accelrys.com/products/informatics/desktop-software.html</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR4">
              <label>4.</label>
              <mixed-citation publication-type="other">The Chemistry Development Kit. [<ext-link xlink:href="http://sourceforge.net/projects/cdk" ext-link-type="uri">http://sourceforge.net/projects/cdk</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR5">
              <label>5.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Steinbeck</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Han</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Kuhn</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Horlacher</surname>
                    <given-names>O</given-names>
                  </name>
                  <name>
                    <surname>Luttmann</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Willighagen</surname>
                    <given-names>E</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The Chemistry Development Kit (CDK): an open-source Java library for chemo-and bioinformatics</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>2003</year>
                <volume>43</volume>
                <fpage>493</fpage>
                <lpage>500</lpage>
                <pub-id pub-id-type="doi">10.1021/ci025584y</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR6">
              <label>6.</label>
              <mixed-citation publication-type="other">JChemPaint. [<ext-link xlink:href="http://sourceforge.net/apps/mediawiki/cdk/index.php?title=JChemPaint" ext-link-type="uri">http://sourceforge.net/apps/mediawiki/cdk/index.php?title=JChemPaint</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR7">
              <label>7.</label>
              <mixed-citation publication-type="other">LICSS system video. [<ext-link xlink:href="http://www.screencast.com/t/Oy1cwtO0ht" ext-link-type="uri">http://www.screencast.com/t/Oy1cwtO0ht</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR8">
              <label>8.</label>
              <mixed-citation publication-type="other">excel-cdk. [<ext-link xlink:href="http://code.google.com/p/excel-cdk/" ext-link-type="uri">http://code.google.com/p/excel-cdk/</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR9">
              <label>9.</label>
              <mixed-citation publication-type="other">OPSIN: Open Parser for Systematic IUPAC nomenclature. [<ext-link xlink:href="http://OPSIN.ch.cam.ac.uk/" ext-link-type="uri">http://OPSIN.ch.cam.ac.uk/</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR10">
              <label>10.</label>
              <mixed-citation publication-type="other">Jace. [<ext-link xlink:href="http://code.google.com/p/jace/" ext-link-type="uri">http://code.google.com/p/jace/</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR11">
              <label>11.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Katajamaa</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Miettinen</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Oresic</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">MZmine: toolbox for processing and visualization of mass spectrometry based molecular profile data</article-title>
                <source>Bioinformatics</source>
                <year>2006</year>
                <volume>22</volume>
                <fpage>634</fpage>
                <lpage>636</lpage>
                <pub-id pub-id-type="doi">10.1093/bioinformatics/btk039</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR12">
              <label>12.</label>
              <mixed-citation publication-type="other">Informatic Tools. [<ext-link xlink:href="http://nctt.nih.gov/page.cfm?pageID=27543665" ext-link-type="uri">http://nctt.nih.gov/page.cfm?pageID=27543665</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR13">
              <label>13.</label>
              <mixed-citation publication-type="other">Walkenbach J: A Class Module to Manipulate a Chart Series. [<ext-link xlink:href="http://spreadsheetpage.com/index.php/tip/a_class_module_to_manipulate_a_chart_series/" ext-link-type="uri">http://spreadsheetpage.com/index.php/tip/a_class_module_to_manipulate_a_chart_series/</ext-link>]</mixed-citation>
            </ref>
          </ref-list>
        </ref-list>
        <app-group>
          <app id="App1">
            <sec id="Sec6">
              <title>Authors’ original submitted files for images</title>
              <p>Below are the links to the authors’ original submitted files for images.<supplementary-material content-type="local-data" id="MOESM1" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="png" xlink:href="MediaObjects/13321_2011_241_MOESM1_ESM.png" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 1</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM2" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="png" xlink:href="MediaObjects/13321_2011_241_MOESM2_ESM.png" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 2</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM3" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="png" xlink:href="MediaObjects/13321_2011_241_MOESM3_ESM.png" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 3</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM4" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="png" xlink:href="MediaObjects/13321_2011_241_MOESM4_ESM.png" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 4</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM5" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="png" xlink:href="MediaObjects/13321_2011_241_MOESM5_ESM.png" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 5</p></caption></media></supplementary-material></p>
            </sec>
          </app>
        </app-group>
        <notes notes-type="Misc">
          <title>Competing interests</title>
          <p>The authors declare that they have no competing interests.</p>
        </notes>
        <notes notes-type="Misc">
          <title>Authors' contributions</title>
          <p>KRL is owner of the excel-cdk project and is the lead developer of LICSS. JL wrote the Java/C++/VBA interface code (CDKInterfaceDll). Both authors have read and approved the final manuscript.</p>
        </notes>
      </back>
    </article>
