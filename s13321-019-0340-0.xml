<?xml version="1.0"?>
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="research-article" xml:lang="en">
      <front>
        <journal-meta>
          <journal-id journal-id-type="publisher-id">13321</journal-id>
          <journal-title-group>
            <journal-title>Journal of Cheminformatics</journal-title>
            <abbrev-journal-title abbrev-type="publisher">J Cheminform</abbrev-journal-title>
          </journal-title-group>
          <issn pub-type="epub">1758-2946</issn>
          <publisher>
            <publisher-name>Springer International Publishing</publisher-name>
            <publisher-loc>Cham</publisher-loc>
          </publisher>
        </journal-meta>
        <article-meta>
          <article-id pub-id-type="publisher-id">s13321-019-0340-0</article-id>
          <article-id pub-id-type="manuscript">340</article-id>
          <article-id pub-id-type="doi">10.1186/s13321-019-0340-0</article-id>
          <article-categories>
            <subj-group subj-group-type="heading">
              <subject>Research Article</subject>
            </subj-group>
          </article-categories>
          <title-group>
            <article-title xml:lang="en">Automated simultaneous assignment of bond orders and formal charges</article-title>
          </title-group>
          <contrib-group>
            <contrib contrib-type="author" id="Au1">
              <name>
                <surname>Welsh</surname>
                <given-names>Ivan D.</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="aff" rid="Aff2">2</xref>
            </contrib>
            <contrib contrib-type="author" corresp="yes" id="Au2">
              <name>
                <surname>Allison</surname>
                <given-names>Jane R.</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="aff" rid="Aff2">2</xref>
              <xref ref-type="aff" rid="Aff3">3</xref>
              <xref ref-type="aff" rid="Aff4">4</xref>
              <xref ref-type="corresp" rid="IDs1332101903400_cor2">b</xref>
            </contrib>
            <aff id="Aff1">
              <label>1</label>
              <institution-wrap>
                <institution content-type="org-division">Centre for Theoretical Chemistry and Physics, Institute of Natural and Mathematical Sciences</institution>
                <institution content-type="org-name">Massey Unversity</institution>
              </institution-wrap>
              <addr-line content-type="postbox">Private Bag 102904</addr-line>
              <addr-line content-type="city">Auckland</addr-line>
              <country country="NZ">New Zealand</country>
            </aff>
            <aff id="Aff2">
              <label>2</label>
              <institution-wrap>
                <institution-id institution-id-type="ISNI">0000 0004 0372 3343</institution-id>
                <institution-id institution-id-type="GRID">grid.9654.e</institution-id>
                <institution content-type="org-division">School of Biological Sciences</institution>
                <institution content-type="org-name">University of Auckland</institution>
              </institution-wrap>
              <addr-line content-type="postbox">Private Bag 92019</addr-line>
              <addr-line content-type="city">Auckland</addr-line>
              <country country="NZ">New Zealand</country>
            </aff>
            <aff id="Aff3">
              <label>3</label>
              <institution-wrap>
                <institution-id institution-id-type="ISNI">0000 0001 2179 1970</institution-id>
                <institution-id institution-id-type="GRID">grid.21006.35</institution-id>
                <institution content-type="org-division">BiomolecularInteraction Centre</institution>
                <institution content-type="org-name">University of Canterbury</institution>
              </institution-wrap>
              <addr-line content-type="postbox">Private Bag 4800</addr-line>
              <addr-line content-type="city">Christchurch</addr-line>
              <country country="NZ">New Zealand</country>
            </aff>
            <aff id="Aff4">
              <label>4</label>
              <institution-wrap>
                <institution-id institution-id-type="ISNI">0000 0004 0372 3343</institution-id>
                <institution-id institution-id-type="GRID">grid.9654.e</institution-id>
                <institution content-type="org-division">Maurice Wilkins Centre for Molecular Biodiscovery</institution>
                <institution content-type="org-name">University of Auckland</institution>
              </institution-wrap>
              <addr-line content-type="postbox">Private Bag 92019</addr-line>
              <addr-line content-type="city">Auckland</addr-line>
              <country country="NZ">New Zealand</country>
            </aff>
          </contrib-group>
          <author-notes>
            <corresp id="IDs1332101903400_cor2">
              <label>b</label>
              <email>HIDDEN</email>
            </corresp>
          </author-notes>
          <pub-date date-type="pub" publication-format="electronic">
            <day>6</day>
            <month>3</month>
            <year>2019</year>
          </pub-date>
          <pub-date date-type="collection" publication-format="electronic">
            <month>12</month>
            <year>2019</year>
          </pub-date>
          <volume>11</volume>
          <issue seq="18">1</issue>
          <elocation-id>18</elocation-id>
          <history>
            <date date-type="registration">
              <day>26</day>
              <month>2</month>
              <year>2019</year>
            </date>
            <date date-type="received">
              <day>12</day>
              <month>8</month>
              <year>2018</year>
            </date>
            <date date-type="accepted">
              <day>26</day>
              <month>2</month>
              <year>2019</year>
            </date>
            <date date-type="online">
              <day>6</day>
              <month>3</month>
              <year>2019</year>
            </date>
          </history>
          <permissions>
            <copyright-statement content-type="compact">© The Author(s) 2019</copyright-statement>
            <copyright-year>2019</copyright-year>
            <copyright-holder>The Author(s)</copyright-holder>
            <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
              <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link xlink:href="http://creativecommons.org/publicdomain/zero/1.0/" ext-link-type="uri">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
            </license>
          </permissions>
          <abstract xml:lang="en" id="Abs1">
            <title>Abstract</title>
            <p>Bond orders and formal charges are fundamental chemical descriptors. In cheminformatic applications it is necessary to be able to assign these properties to a given molecular structure automatically, given minimal input information. Here we describe a method for determining the bond order and formal charge assignments from only the atom types and connectivity. Our method utilises a graph theoretical description of electron positions. Each electron position assignment is scored according to lookup tables of atomic and bond dissociation energies derived from quantum chemical calculations. We tested three different optimisation methods—local optimisation, an A* pathfinding method, and an FPT optimisation method utilising tree decompositions—for finding the best electron position assignment, from which the bond orders and formal charges are extracted. We show that our method can assign bond orders and formal charges at a high degree of accuracy across a wide range of molecules from two different databases, and that the FPT algorithm provides the best combination of speed and accuracy.</p>
          </abstract>
          <kwd-group xml:lang="en">
            <title>Keywords</title>
            <kwd>Bond order</kwd>
            <kwd>Formal charge</kwd>
            <kwd>Fixed parameter tractable</kwd>
            <kwd>Graph theory</kwd>
          </kwd-group>
          <funding-group>
            <award-group>
              <funding-source>
                <institution-wrap>
                  <institution>Marsden Fund</institution>
                  <institution-id institution-id-type="doi" vocab="open-funder-registry">http://dx.doi.org/10.13039/501100009193</institution-id>
                </institution-wrap>
              </funding-source>
              <award-id award-type="FundRef grant">13-MAU-039</award-id>
              <principal-award-recipient>
                <name>
                  <surname>Allison</surname>
                  <given-names>Jane R.</given-names>
                </name>
              </principal-award-recipient>
            </award-group>
            <award-group>
              <funding-source>
                <institution-wrap>
                  <institution>Rutherford Discovery Fellowship</institution>
                </institution-wrap>
              </funding-source>
              <award-id award-type="FundRef grant">15-MAU-001</award-id>
              <principal-award-recipient>
                <name>
                  <surname>Allison</surname>
                  <given-names>Jane R.</given-names>
                </name>
              </principal-award-recipient>
            </award-group>
          </funding-group>
          <custom-meta-group>
            <custom-meta>
              <meta-name>publisher-imprint-name</meta-name>
              <meta-value>Springer</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-issue-count</meta-name>
              <meta-value>1</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-article-count</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-pricelist-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-holder</meta-name>
              <meta-value>The Author(s)</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-contains-esm</meta-name>
              <meta-value>Yes</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-month</meta-name>
              <meta-value>2</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-day</meta-name>
              <meta-value>26</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-product</meta-name>
              <meta-value>ArchiveJournal</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-grants-type</meta-name>
              <meta-value>OpenChoice</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>metadata-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>abstract-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodypdf-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodyhtml-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bibliography-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>esm-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>online-first</meta-name>
              <meta-value>false</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-file-reference</meta-name>
              <meta-value>BodyRef/PDF/13321_2019_Article_340.pdf</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-type</meta-name>
              <meta-value>Typeset</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>target-type</meta-name>
              <meta-value>OnlinePDF</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-type</meta-name>
              <meta-value>OriginalPaper</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-primary</meta-name>
              <meta-value>Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computer Applications in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Documentation and Information in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Theoretical and Computational Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computational Biology/Bioinformatics</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>open-access</meta-name>
              <meta-value>true</meta-value>
            </custom-meta>
          </custom-meta-group>
        </article-meta>
        <notes notes-type="ESMHint">
          <title>Electronic supplementary material</title>
          <p>The online version of this article (<ext-link xlink:href="10.1186/s13321-019-0340-0" ext-link-type="doi">https://doi.org/10.1186/s13321-019-0340-0</ext-link>) contains supplementary material, which is available to authorized users.</p>
        </notes>
      </front>
      <body>
        <sec id="Sec1">
          <title>Introduction</title>
          <p>The ability to assign chemical characteristics such as bond orders and formal charges is crucial to many higher-order algorithms in computational chemistry and cheminformatics. The formal charge is the charge assigned to an atom in a molecule assuming that electrons in all chemical bonds are shared equally between atoms, and the bond order of a bond is the number of chemical bonds between a pair of atoms. Both properties can be easily deduced from the Lewis structure of a molecule, which shows how the valence electrons are arranged amongst the atoms and bonds of the molecule.</p>
          <p>The best way to determine the Lewis structure of a molecule is to calculate the actual electronic density distribution and then use the Natural Bond Orbital method [<xref ref-type="bibr" rid="CR1">1</xref>] to obtain bond orders and formal charges. However, this approach can be computationally expensive, and with the advent of large databases of organic molecules, such as the Protein Data Bank (PDB) and Cambridge Structural Database (CSD), the need for fast automated schemes became pertinent. As such, over the last few decades, a number of such schemes have been developed. The COBRA program of Leach et al. [<xref ref-type="bibr" rid="CR2">2</xref>] uses a backtracking search algorithm to automatically assign bond orders. IDATM from Meng and Lewis [<xref ref-type="bibr" rid="CR3">3</xref>] can be used to determine the connectivity and hybridisation state of atoms based on input three-dimensional (3D) coordinates. Baber and Hodgkin follow a similar scheme, but can also assign bond orders [<xref ref-type="bibr" rid="CR4">4</xref>]. Lang et al. assign bond orders based on characteristic bond lengths, bond angles and torsion angles, [<xref ref-type="bibr" rid="CR5">5</xref>] as do Hendlich et al., who also include small functional group identification to help avoid incorrect assignments due to erroneous or ambiguous geometrical data [<xref ref-type="bibr" rid="CR6">6</xref>]. All of these methods, however, require accurate 3D coordinate information. The methods of Froeyen and Herdewijn [<xref ref-type="bibr" rid="CR7">7</xref>] and Labute [<xref ref-type="bibr" rid="CR8">8</xref>] could theoretically be used on structures with only atom type and connectivity information, but they were developed primarily for use when 3D coordinate information, albeit for only the heavy atoms, is provided.</p>
          <p>Wang et al. developed a heuristic method to determine bond orders based on arbitrary penalty scores [<xref ref-type="bibr" rid="CR9">9</xref>]. The biochemical algorithms library (BALL) software from Dehof et al. is an extension of this work. Dehof et al. used the same penalty scores as Wang et al., and developed three exact solvers guaranteed to find a bond order assignment with minimum total penalty score, as well as allowing enumeration of all possible bond order assignments with minimum total penalty score [<xref ref-type="bibr" rid="CR10">10</xref>]. Both of these methods only require element type and atom connectivity information when all hydrogen atoms are included. As formal charges and bond orders are somewhat co-dependent, the absence of formal charges in the input molecule could result in incorrect atom types being perceived, leading to incorrect bond order assignments. Theoretically, formal charges can be back calculated from bond order assignments (if they are correct), however there can be situations where ambiguous formal charge assignments are possible, and there is no guarantee that the calculated formal charges will match the required total molecular charge.</p>
          <p>As part of a broader molecular dynamics automated parameterisation scheme, we have developed a new method for the simultaneous assignment of formal charges and bond orders. In order to allow both of these properties to be assigned in situations where the available coordinates are not energetically favourable, our method requires only chemically plausible atomic coordinates, along with element type, atom connectivity, and the total charge of the molecule. The combination of atom connectivity and total molecular charge fixes the protonation state of the molecule. We take advantage of the fact that in essence, formal charges and bond orders are descriptions of the positions of valence electrons within a molecule. Minimising some function of the electron positions thus results in an optimal formal charge and bond order assignment. Given that electron positions are involved, the obvious choice of function is one derived from high-level quantum chemical calculations.</p>
          <p>We describe here the function that is minimised and three different optimisation methods: local optimisation, the A* pathfinding method, and an FPT optimisation method utilising tree decompositions. We first check the self-consistency of the algorithms, then compare the performance of the A* method in our software and in the BALL software of Dehof et al., and lastly compare to the bond order and formal charge assignments from two molecular databases in terms of both the speed and the accuracy with which these reference data are reproduced, as well as the level of theory required for the quantum chemical calculations such that the scoring function identifies the correct assignments. We find that the FPT algorithm provides the best balance between efficiency and accuracy. Using FPT, our method attains similar accuracy to that of Dehof et al., but without the need to provide the formal charge.</p>
          <p>The code described here is available on Github at <ext-link xlink:href="https://github.com/allison-group/indigo-bondorder" ext-link-type="uri">https://github.com/allison-group/indigo-bondorder</ext-link>. It is written in C++, utilising the Boost graph library, [<xref ref-type="bibr" rid="CR11">11</xref>] and requires a C++-14 compliant compiler. For ease of use, Python bindings are provided for using version 2.2.2 of the pybind11 library [<xref ref-type="bibr" rid="CR12">12</xref>].</p>
        </sec>
        <sec id="Sec2" sec-type="methods">
          <title>Methods</title>
          <p>Our bond order and formal charge assignment scheme determines an optimal assignment of electron positions for a molecule by minimising a score that is a function of the electron assignment. We first describe how the chemical features of the molecule are represented and the initialisation of the electron position assignments. We then outline the electron assignment scoring function, which depends upon scores associated with the formal charge state of each atom and the order of each bond. Lastly, we describe the three different methods used to optimise the electron position assignments, giving rise to the formal charge and bond order assignments for the molecule.</p>
          <sec id="Sec3">
            <title>Initialisation</title>
            <p>A query molecule can be submitted in any of the standard chemical formats able to be parsed by Open Babel, so long as the number and type of each atom, including hydrogen atoms, their connectivity, and the total molecular charge are provided explicitly. Some file formats allow for implicit hydrogen atoms through the use of atom typing. This information is encoded internally as a molecular graph, so that a graph theoretic approach can be used to optimise the electron position assignment.</p>
            <p>The total number of electrons whose position must be optimised is calculated from the number of valence electrons according to<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:munderover><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} e_T = -q_T - 2N_B + \sum _{i = 1}^{N_A} \nu _i, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_Equ1.gif" /></alternatives></disp-formula>where <inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:msub><mml:mi>e</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq1.gif" /></alternatives></inline-formula> is the total number of electrons to place, <inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:msub><mml:mi>q</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq2.gif" /></alternatives></inline-formula> is the total molecular charge, <inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:msub><mml:mi>N</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_A$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq3.gif" /></alternatives></inline-formula> and <inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:msub><mml:mi>N</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_B$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq4.gif" /></alternatives></inline-formula> are the numbers of atoms and bonds in the molecule, respectively, and <inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:msub><mml:mi>ν</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu _i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq5.gif" /></alternatives></inline-formula> is number of valence electrons of atom <italic>i</italic>, which is known from its elemental type. The <inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-2N_B$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq6.gif" /></alternatives></inline-formula> component accounts for each bond in the molecule requiring two electrons in order to have a bond order of at least one.</p>
            <p>The positions that electrons can occupy in a molecule, encoded as a multiset of graph vertices and edges, <inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:mi mathvariant="script">P</mml:mi></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{P}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq7.gif" /></alternatives></inline-formula>, are determined as follows. Each element has a target valency, set to eight for all elements other than hydrogen, for which it is two, and phosphorous and sulfur atoms involved in at least three bonds, for which it is set to ten and twelve respectively. In this way, we allow for hypervalent representations of functional groups such as phosphates and sulfates, while representing all other groups, such as nitros, in charge separated form. The multiplicity of a given vertex <italic>v</italic> in <inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:mi mathvariant="script">P</mml:mi></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{P}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq8.gif" /></alternatives></inline-formula> is given by <inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:mrow><mml:mi>v</mml:mi><mml:msup><mml:mo>∈</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:msup><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v \in ^{m_v} {\mathcal{P}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq9.gif" /></alternatives></inline-formula> where<disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>δ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} m_v = \tau _v - 2\delta (v) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_Equ2.gif" /></alternatives></disp-formula>with <inline-formula id="IEq10"><alternatives><mml:math id="IEq10_Math"><mml:msub><mml:mi>τ</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _v$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq10.gif" /></alternatives></inline-formula> being the target valency of the element associated with <italic>v</italic> and <inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:mrow><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta (v)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq11.gif" /></alternatives></inline-formula> the degree of <italic>v</italic>. The multiplicity of a given edge <inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e = (u,v)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq12.gif" /></alternatives></inline-formula> in <inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:mi mathvariant="script">P</mml:mi></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{P}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq13.gif" /></alternatives></inline-formula> is given by <inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:mrow><mml:mi>e</mml:mi><mml:msup><mml:mo>∈</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:msup><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e \in ^{m_e} {\mathcal{P}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq14.gif" /></alternatives></inline-formula> where<disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo movablelimits="true">min</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>τ</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>δ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>δ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} m_e = \min \left( \tau _u - 2\delta (u), \tau _v - 2\delta (v)\right) . \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_Equ3.gif" /></alternatives></disp-formula></p>
          </sec>
          <sec id="Sec4">
            <title>Electron assignment scoring</title>
            <p>Let <inline-formula id="IEq15"><alternatives><mml:math id="IEq15_Math"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G=(V,E)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq15.gif" /></alternatives></inline-formula> be a molecular graph. An <italic>electron assignment</italic> is a map <inline-formula id="IEq16"><alternatives><mml:math id="IEq16_Math"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mi>V</mml:mi><mml:mo>∪</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_p:V\cup E \rightarrow {\mathbb Z}_{\ge 0}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq16.gif" /></alternatives></inline-formula> where <inline-formula id="IEq17"><alternatives><mml:math id="IEq17_Math"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_p[x]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq17.gif" /></alternatives></inline-formula> is the total number of electrons placed on member <inline-formula id="IEq18"><alternatives><mml:math id="IEq18_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi><mml:mo>∪</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math><tex-math id="IEq18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in V \cup E$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq18.gif" /></alternatives></inline-formula>. The <italic>score</italic> of the electron assignment is then given as the sum of scores for each vertex and edge.<disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi><mml:mo>∪</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} S = \sum _{x \in V\cup E} \Gamma [k_x] \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_Equ4.gif" /></alternatives></disp-formula>These scores are stored in a lookup table, <inline-formula id="IEq19"><alternatives><mml:math id="IEq19_Math"><mml:mi mathvariant="normal">Γ</mml:mi></mml:math><tex-math id="IEq19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq19.gif" /></alternatives></inline-formula>, using bit shifting to generate a unique 32-bit unsigned integer key, <inline-formula id="IEq20"><alternatives><mml:math id="IEq20_Math"><mml:msub><mml:mi>k</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><tex-math id="IEq20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_x$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq20.gif" /></alternatives></inline-formula>. If a given key is not found in the lookup table, a default score of <inline-formula id="IEq21"><alternatives><mml:math id="IEq21_Math"><mml:mi>∞</mml:mi></mml:math><tex-math id="IEq21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\infty$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq21.gif" /></alternatives></inline-formula> is given.</p>
            <p>For a vertex <italic>v</italic>, the lookup table key depends on the element of the corresponding atom and its formal charge, calculated as<disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} F(v) = \nu _v - c_p[v] - \sum _{u \in N(v)} \frac{c_p[(u,v)]}{2} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_Equ5.gif" /></alternatives></disp-formula>where <italic>N</italic>(<italic>v</italic>) is the set of neighbouring vertices of <italic>v</italic>. The first seven bits of the key are set as per the binary value of the atomic number. The next four bits are set to the binary value of the magnitude of the calculated formal charge. Finally, the twelfth bit is set if the formal charge is negative, and left unset if it is positive. If the valence state of an atom exceeds its target valence, the score of that atom is set to <inline-formula id="IEq22"><alternatives><mml:math id="IEq22_Math"><mml:mi>∞</mml:mi></mml:math><tex-math id="IEq22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\infty$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq22.gif" /></alternatives></inline-formula>, and no key is calculated.</p>
            <p>For an edge <italic>e</italic>, the lookup table key depends on the elements of the two vertices the edge is between, and the number of electrons assigned to the edge, <inline-formula id="IEq23"><alternatives><mml:math id="IEq23_Math"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_p[e]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq23.gif" /></alternatives></inline-formula>. In the same manner as the vertex key, the first seven bits of the key are set to the binary value of the atomic number of one of the vertices. The next seven are set to the binary value of the other vertex. Finally, bits fifteen through eighteen inclusive are set as per the binary value of the number of electrons assigned to the edge. As each edge will always have at least two electrons assigned, there is no overlap between the set of possible keys for the vertices and edges.</p>
            <p>These simple methods for key determination were chosen as the corresponding scores can be easily determined from quantum chemical calculations. We note that there is sufficient flexibility in using 32-bit unsigned integer keys for more complex key generation methods to be used, incorporating optimised key–score pairs.</p>
            <p>At present, scores have only been calculated for the elements—hydrogen, carbon, nitrogen, oxygen, fluorine, phosphorus, sulfur, chlorine, and bromine—and bonds—single, double, and triple—that most commonly occur in bio-organic molecules, but as these scores are derived from quantum chemical calculations, they can easily be supplemented as required.</p>
            <sec id="Sec5">
              <title>Formal charge score</title>
              <p>In a crude sense, atoms with formal charges can be described as ions with a charge equal to the formal charge. Therefore, formal charge scores were determined from quantum chemical calculations of atomic/ionic energies. For each element, scores for all possible formal charge states were calculated. For example, carbon can have formal charge states ranging from <inline-formula id="IEq24"><alternatives><mml:math id="IEq24_Math"><mml:mrow><mml:mo>+</mml:mo><mml:mspace width="0.166667em" /><mml:mn>4</mml:mn></mml:mrow></mml:math><tex-math id="IEq24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+\,4$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq24.gif" /></alternatives></inline-formula> (all valence electrons removed) to <inline-formula id="IEq25"><alternatives><mml:math id="IEq25_Math"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em" /><mml:mn>4</mml:mn></mml:mrow></mml:math><tex-math id="IEq25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,4$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq25.gif" /></alternatives></inline-formula> (electrons added until valence shell is an octet), thus we consider <inline-formula id="IEq26"><alternatives><mml:math id="IEq26_Math"><mml:msup><mml:mtext>C</mml:mtext><mml:mrow><mml:mn>4</mml:mn><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="IEq26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {C}^{4+}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq26.gif" /></alternatives></inline-formula>, <inline-formula id="IEq27"><alternatives><mml:math id="IEq27_Math"><mml:msup><mml:mtext>C</mml:mtext><mml:mrow><mml:mn>3</mml:mn><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="IEq27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {C}^{3+}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq27.gif" /></alternatives></inline-formula>, <inline-formula id="IEq28"><alternatives><mml:math id="IEq28_Math"><mml:msup><mml:mtext>C</mml:mtext><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="IEq28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {C}^{2+}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq28.gif" /></alternatives></inline-formula>, <inline-formula id="IEq29"><alternatives><mml:math id="IEq29_Math"><mml:msup><mml:mtext>C</mml:mtext><mml:mo>+</mml:mo></mml:msup></mml:math><tex-math id="IEq29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {C}^+$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq29.gif" /></alternatives></inline-formula>, <inline-formula id="IEq30"><alternatives><mml:math id="IEq30_Math"><mml:msup><mml:mtext>C</mml:mtext><mml:mn>0</mml:mn></mml:msup></mml:math><tex-math id="IEq30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {C}^0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq30.gif" /></alternatives></inline-formula>, <inline-formula id="IEq31"><alternatives><mml:math id="IEq31_Math"><mml:msup><mml:mtext>C</mml:mtext><mml:mo>-</mml:mo></mml:msup></mml:math><tex-math id="IEq31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {C}^-$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq31.gif" /></alternatives></inline-formula>, <inline-formula id="IEq32"><alternatives><mml:math id="IEq32_Math"><mml:msup><mml:mtext>C</mml:mtext><mml:mrow><mml:mn>2</mml:mn><mml:mo>-</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="IEq32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {C}^{2-}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq32.gif" /></alternatives></inline-formula>, <inline-formula id="IEq33"><alternatives><mml:math id="IEq33_Math"><mml:msup><mml:mtext>C</mml:mtext><mml:mrow><mml:mn>3</mml:mn><mml:mo>-</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="IEq33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {C}^{3-}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq33.gif" /></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><mml:math id="IEq34_Math"><mml:msup><mml:mtext>C</mml:mtext><mml:mrow><mml:mn>4</mml:mn><mml:mo>-</mml:mo></mml:mrow></mml:msup></mml:math><tex-math id="IEq34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {C}^{4-}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq34.gif" /></alternatives></inline-formula>. While in normal molecules, it is highly unlikely that the majority of these formal charges are viable, they are included for completeness and to help guide the optimisation methods away from unrealistic electron assignments.</p>
              <p>The atomic energy depends on the spin state of the atom or ion. Looking at carbon again, there are four valence electrons in an electron configuration of <inline-formula id="IEq35"><alternatives><mml:math id="IEq35_Math"><mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mtext>s</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mn>2</mml:mn><mml:msup><mml:mtext>s</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mn>2</mml:mn><mml:msup><mml:mtext>p</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><tex-math id="IEq35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\hbox {s}^{2}2\hbox {s}^{2}2\hbox {p}^{2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq35.gif" /></alternatives></inline-formula>. The lowest energy spin state is the triplet state, with the two electrons in the 2p shell unpaired in degenerate orbitals. Both singlet and quintet states are conceivable, but they are higher energy states. We therefore consider only the lowest energy spin state for a given formal charge of each element. The scores were then determined as being the difference between the lowest energy spin state, and a reference energy of the neutral atom in either the singlet or doublet state, depending on its number of electrons. All calculations of atomic/ionic energies were calculated with the CR-CCL method, [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>] utilising the def2-SVPD and def2-TZVPPD basis sets [<xref ref-type="bibr" rid="CR15">15</xref>]. Calculations were performed using the GAMESS-US version 18AUG 2016(R1) software [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. The scores are given in Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>: Tables S1 and S2.</p>
            </sec>
            <sec id="Sec6">
              <title>Bond order score</title>
              <p>Bond dissociation energies are a natural basis for the bond order scores. The bond dissociation energy is defined as the change in enthalpy when a bond is homolytically cleaved. For example, the bond dissociation energy of the <inline-formula id="IEq36"><alternatives><mml:math id="IEq36_Math"><mml:mrow><mml:mtext>C</mml:mtext><mml:mo>-</mml:mo><mml:mtext>O</mml:mtext></mml:mrow></mml:math><tex-math id="IEq36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {C}{-}\hbox {O}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq36.gif" /></alternatives></inline-formula> bond in methanol is given by the enthalpy change associated with the reaction<disp-formula id="Equ20"><alternatives><mml:math display="block" id="Equ20_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>H</mml:mtext><mml:mn>3</mml:mn></mml:msub><mml:mtext>C</mml:mtext><mml:mo>-</mml:mo><mml:mtext>OH</mml:mtext><mml:mover><mml:mo stretchy="false">⟶</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow /><mml:mi>H</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mover><mml:msub><mml:mtext>H</mml:mtext><mml:mn>3</mml:mn></mml:msub><mml:msup><mml:mtext>C</mml:mtext><mml:mo>.</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mtext>HO</mml:mtext><mml:mo>.</mml:mo></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \hbox {H}_{3}\hbox {C}{-}\hbox {OH}{\mathop{\longrightarrow}\limits^{[\Delta {}H]}} \hbox {H}_{3}\hbox {C}^{.} + \hbox {HO}^{.}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_Equ20.gif" /></alternatives></disp-formula>The bond dissociation energy is computed by calculating the energy difference between a molecule containing the bond of interest and the two fragments produced by homolytic cleavage of the bond. We create the simplest possible molecule containing each bond type as determined by a stick drawing. This is just the two atoms involved, with hydrogen atoms added to fill the valence positions of non-hydrogen atoms. For example, to determine the score to use for a <inline-formula id="IEq37"><alternatives><mml:math id="IEq37_Math"><mml:mrow><mml:mtext>C</mml:mtext><mml:mo>≡</mml:mo><mml:mtext>C</mml:mtext></mml:mrow></mml:math><tex-math id="IEq37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {C}{\equiv }\hbox {C}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq37.gif" /></alternatives></inline-formula> bond, the bond dissociation energy of ethyne is calculated. The score for each bond is determined as being the difference between the bond dissociation energy and the bond dissociation energy of the highest order bond considered between the two elements involved.</p>
              <p>The structure of each molecule and the fragments produced by homolytic cleavage are geometry-optimised at the MP2 [<xref ref-type="bibr" rid="CR18">18</xref>] level of theory, followed by a single point energy calculation with the CR-CCL method, [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>] utilising the def2-SVPD and def2-TZVPPD basis sets [<xref ref-type="bibr" rid="CR15">15</xref>]. Where appropriate, calculations were performed both with and without accounting for the basis set superposition error [<xref ref-type="bibr" rid="CR19">19</xref>]. Calculations were performed using the GAMESS-US version 18AUG 2016(R1) software [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. The scores are given in Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>: Tables S3–S6.</p>
            </sec>
          </sec>
          <sec id="Sec7">
            <title>Formal charge and bond order determination</title>
            <p>Once an optimised electron assignment has been calculated, determining the formal charge on each of the atoms and the bond order of all of the bonds is simple. For each atom, its formal charge is calculated as shown in Eq. (<xref rid="Equ5" ref-type="disp-formula">5</xref>). For each edge, <italic>e</italic>, the bond order is calculated as<disp-formula id="Equ6"><label>6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} O(e) = \frac{c_p[e]}{2}. \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_Equ6.gif" /></alternatives></disp-formula></p>
          </sec>
          <sec id="Sec8">
            <title>Optimisation methods</title>
            <p>Finding the formal charge and bond order of a molecule requires minimising the value of <italic>S</italic> given in Eq. (<xref rid="Equ4" ref-type="disp-formula">4</xref>). Three different optimisation techniques for finding the lowest scoring electron assignment were tested: a steepest descent local optimisation method (“<xref rid="Sec9" ref-type="sec">Local optimisation</xref>” section), an A* pathfinding based method (“<xref rid="Sec10" ref-type="sec">A*</xref>” section) and an FPT optimisation method utilising tree decompositions (“<xref rid="Sec11" ref-type="sec">Fixed parameter tractable (FPT)</xref>” section).</p>
            <sec id="Sec9">
              <title>Local optimisation</title>
              <p>Local optimisation acts similarly to a steepest decent gradient optimisation method. It is a greedy method that searches for an optimal electron assignment by finding the lowest scoring neighbour of a given electron assignment and iteratively applying this neighbour search until there are no lower scoring neighbours. Computationally, it is a relatively cheap optimisation method, and will always converge, but not necessarily to the global minimum.</p>
              <p><italic>Setup</italic> An initial electron assignment is generated as follows. For each possible electron assignment position <inline-formula id="IEq38"><alternatives><mml:math id="IEq38_Math"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:math><tex-math id="IEq38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p \in {\mathcal{P}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq38.gif" /></alternatives></inline-formula>, a score is calculated and then an electron is assigned to the position which has the lowest score. This is iteratively applied, assigning a single electron at a time, until <inline-formula id="IEq39"><alternatives><mml:math id="IEq39_Math"><mml:msub><mml:mi>e</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><tex-math id="IEq39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq39.gif" /></alternatives></inline-formula> electrons have been assigned, giving the initial electron assignment.</p>
              <p><italic>Neighbour searching</italic> Local optimisation determines the score change that would result when going from one electron assignment to each neighbouring electron assignment, which are determined as follows. The multiset of possible positions for electrons to be assigned, <inline-formula id="IEq40"><alternatives><mml:math id="IEq40_Math"><mml:mi mathvariant="script">P</mml:mi></mml:math><tex-math id="IEq40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{P}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq40.gif" /></alternatives></inline-formula>, is converted to a set <italic>P</italic>, i.e. duplicate members are removed. Every member <inline-formula id="IEq41"><alternatives><mml:math id="IEq41_Math"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math><tex-math id="IEq41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p \in P$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq41.gif" /></alternatives></inline-formula> is checked to determine if it contains electrons in the current electron assignment, i.e. <inline-formula id="IEq42"><alternatives><mml:math id="IEq42_Math"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_p[p] \ne 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq42.gif" /></alternatives></inline-formula>, meaning that it can be used as an electron source. If it can, all other members <inline-formula id="IEq43"><alternatives><mml:math id="IEq43_Math"><mml:mrow><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:mi>P</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math><tex-math id="IEq43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q \in P \setminus p$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq43.gif" /></alternatives></inline-formula> are checked to determine if they can hold another electron, i.e. <inline-formula id="IEq44"><alternatives><mml:math id="IEq44_Math"><mml:mrow><mml:mtext>mult</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>></mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {mult}({\mathcal{P}},q) - c_p[q] > 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq44.gif" /></alternatives></inline-formula>, meaning that <italic>q</italic> can act as a target electron position. A neighbour of the current electron assignment is produced by moving an electron from a source position to a target position. Thus, all the neighbours of an electron assignment are given by the set of electron assignments produced from all possible source–target pairs. If multiple electron assignments with the same score exist, the neighbour searching can search the neighbours of all of the assignments, instead of just one of the assignments.</p>
              <p><italic>Score minimisation</italic> Determining an optimal electron assignment using the local optimisation method is straightforward. The score of each neighbour assignment is determined. If at least one of the neighbour(s) has a lower score, the neighbour search is repeated using the lowest scoring neighbour(s) as the initial electron assignments. This iterative update of the electron assignment proceeds until there are no neighbours with a lower score, in which case the optimisation process has converged to a local minimum.</p>
            </sec>
            <sec id="Sec10">
              <title>A*</title>
              <p>An A* approach was one of the three optimisation methods utilised by Dehof et al. for bond order assignment [<xref ref-type="bibr" rid="CR10">10</xref>]. Such an approach is taken here for comparison purposes.</p>
              <p>A* is a path-finding algorithm for determining a minimum cost path between a start, <italic>s</italic>, and end, <italic>t</italic>, location [<xref ref-type="bibr" rid="CR20">20</xref>]. It employs a search heuristic as a means to guide the path finding process towards more promising paths. The list of vertices to search from is stored in a priority queue, meaning the most promising vertices are searched first. The priority is determined by assigning a cost, <inline-formula id="IEq45"><alternatives><mml:math id="IEq45_Math"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(r) = g(r) + h(r)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq45.gif" /></alternatives></inline-formula>, where <italic>g</italic>(<italic>r</italic>) is the real cost of the path <inline-formula id="IEq46"><alternatives><mml:math id="IEq46_Math"><mml:mrow><mml:mi>s</mml:mi><mml:mo>⋯</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math><tex-math id="IEq46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s\dots r$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq46.gif" /></alternatives></inline-formula> and <italic>h</italic>(<italic>r</italic>) is an heuristic estimate of the cost of the path <inline-formula id="IEq47"><alternatives><mml:math id="IEq47_Math"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⋯</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="IEq47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r\dots t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq47.gif" /></alternatives></inline-formula>, to each visited vertex <italic>r</italic>. If the cost of a vertex <italic>r</italic> exceeds some upper limit value, that vertex will not be added to the priority queue. Here, this upper limit is calculated as the score of the initial local optimisation electron assignment (see “<xref rid="Sec9" ref-type="sec">Local optimisation</xref>” section) plus one. Obviously, the nature of the heuristic function will influence the efficiency of the search algorithm. To be guaranteed to obtain a minimum cost path, the heuristic must be <italic>admissible</italic>, meaning ‘optimistic’. That is, the true cost of the path <inline-formula id="IEq48"><alternatives><mml:math id="IEq48_Math"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⋯</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="IEq48_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r\dots t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq48.gif" /></alternatives></inline-formula> cannot be lower than <italic>h</italic>(<italic>r</italic>).</p>
              <p>Let <inline-formula id="IEq49"><alternatives><mml:math id="IEq49_Math"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⊂</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:math><tex-math id="IEq49_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P \subset {\mathcal{P}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq49.gif" /></alternatives></inline-formula> be the set of unique possible positions to assign electrons. The score minimisation problem given the molecular graph <inline-formula id="IEq50"><alternatives><mml:math id="IEq50_Math"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq50_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G = (V,E)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq50.gif" /></alternatives></inline-formula> can be formulated into a |<italic>P</italic>|-level tree <italic>T</italic>, i.e. the path from the root vertex to a leaf will be of length |<italic>P</italic>|. Each level of the tree represents a possible position for electrons to be assigned. A vertex at level <italic>k</italic> has <inline-formula id="IEq51"><alternatives><mml:math id="IEq51_Math"><mml:mrow><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq51_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m + 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq51.gif" /></alternatives></inline-formula> neighbours, where <inline-formula id="IEq52"><alternatives><mml:math id="IEq52_Math"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mtext>mult</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq52_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m = \text {mult}({\mathcal{P}},w)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq52.gif" /></alternatives></inline-formula> and <inline-formula id="IEq53"><alternatives><mml:math id="IEq53_Math"><mml:mrow><mml:mi>w</mml:mi><mml:mo>∈</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math><tex-math id="IEq53_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w \in P$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq53.gif" /></alternatives></inline-formula> is the position associated with level <inline-formula id="IEq54"><alternatives><mml:math id="IEq54_Math"><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq54_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k+1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq54.gif" /></alternatives></inline-formula>, to allow for all possible electron counts placed in <italic>w</italic>, from 0 to <italic>m</italic>.</p>
              <p>To formulate the scoring functions <italic>g</italic>(<italic>r</italic>) and <italic>h</italic>(<italic>r</italic>), some additional definitions must be made. A partial electron assignment, <italic>R</italic>(<italic>r</italic>), is denoted as the set of pairs (<italic>j</italic>, <italic>n</italic>) where <italic>j</italic> is a member of the path <inline-formula id="IEq55"><alternatives><mml:math id="IEq55_Math"><mml:mrow><mml:mi>s</mml:mi><mml:mo>⋯</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math><tex-math id="IEq55_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s\dots r$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq55.gif" /></alternatives></inline-formula> and <inline-formula id="IEq56"><alternatives><mml:math id="IEq56_Math"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mtext>mult</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><tex-math id="IEq56_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n \in \{0,\dots ,\text {mult}({\mathcal{P}},j)\}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq56.gif" /></alternatives></inline-formula> is the number of electrons assigned there. <italic>R</italic>(<italic>r</italic>) also contains pairs (<italic>x</italic>, 0) for all elements <inline-formula id="IEq57"><alternatives><mml:math id="IEq57_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi><mml:mo>∪</mml:mo><mml:mi>E</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math><tex-math id="IEq57_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in V \cup E \setminus P$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq57.gif" /></alternatives></inline-formula>.</p>
              <p><italic>Q</italic>(<italic>r</italic>) is the set of <italic>calculable</italic> members <inline-formula id="IEq58"><alternatives><mml:math id="IEq58_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi><mml:mo>∪</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math><tex-math id="IEq58_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in V \cup E$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq58.gif" /></alternatives></inline-formula> at vertex <italic>r</italic>. <italic>x</italic> is deemed <italic>calculable</italic> at vertex <inline-formula id="IEq59"><alternatives><mml:math id="IEq59_Math"><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><tex-math id="IEq59_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r \in T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq59.gif" /></alternatives></inline-formula> if the following conditions are met:<list list-type="order"><list-item><p><inline-formula id="IEq60"><alternatives><mml:math id="IEq60_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∉</mml:mo><mml:mi>P</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq60_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \notin P \setminus R_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq60.gif" /></alternatives></inline-formula>, where <inline-formula id="IEq61"><alternatives><mml:math id="IEq61_Math"><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq61_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq61.gif" /></alternatives></inline-formula> is the set of first members of <italic>R</italic>(<italic>r</italic>);</p></list-item><list-item><p>If <inline-formula id="IEq62"><alternatives><mml:math id="IEq62_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math><tex-math id="IEq62_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq62.gif" /></alternatives></inline-formula>, condition 1 holds for all neighbours of <italic>x</italic>;</p></list-item><list-item><p>If <inline-formula id="IEq63"><alternatives><mml:math id="IEq63_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math><tex-math id="IEq63_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in E$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq63.gif" /></alternatives></inline-formula>, the pair <inline-formula id="IEq64"><alternatives><mml:math id="IEq64_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>⊆</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq64_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x = {y,z} \subseteq Q(r)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq64.gif" /></alternatives></inline-formula>.</p></list-item></list>As condition 3 is a requirement for determining the calculability of bonds, the calculability of all atoms is determined first.</p>
              <p><italic>Cost Functions</italic> Each vertex that is visited through the A* search is assigned a cost, <inline-formula id="IEq65"><alternatives><mml:math id="IEq65_Math"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq65_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(r) = g(r) + h(r)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq65.gif" /></alternatives></inline-formula>. The exact cost of the path <inline-formula id="IEq66"><alternatives><mml:math id="IEq66_Math"><mml:mrow><mml:mi>s</mml:mi><mml:mo>⋯</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math><tex-math id="IEq66_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s\dots r$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq66.gif" /></alternatives></inline-formula>, <italic>g</italic>(<italic>r</italic>), is defined as<disp-formula id="Equ7"><label>7</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} g(r) = \sum _{x \in Q(r)} \Gamma [k_x] \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_Equ7.gif" /></alternatives></disp-formula>where <inline-formula id="IEq67"><alternatives><mml:math id="IEq67_Math"><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><tex-math id="IEq67_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Gamma [k_x]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq67.gif" /></alternatives></inline-formula> is the score of member <inline-formula id="IEq68"><alternatives><mml:math id="IEq68_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi><mml:mo>∪</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math><tex-math id="IEq68_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in V \cup E$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq68.gif" /></alternatives></inline-formula> with partial electron assignment <italic>R</italic>(<italic>r</italic>), as defined in “<xref rid="Sec4" ref-type="sec">Electron assignment scoring</xref>” section. If the number of electrons assigned in <italic>R</italic>(<italic>r</italic>) is greater than <inline-formula id="IEq69"><alternatives><mml:math id="IEq69_Math"><mml:msub><mml:mi>e</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><tex-math id="IEq69_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq69.gif" /></alternatives></inline-formula>, <inline-formula id="IEq70"><alternatives><mml:math id="IEq70_Math"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math><tex-math id="IEq70_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g(r) = \infty$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq70.gif" /></alternatives></inline-formula>.</p>
              <p>The heuristic cost of the path <inline-formula id="IEq71"><alternatives><mml:math id="IEq71_Math"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⋯</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math><tex-math id="IEq71_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r\dots t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq71.gif" /></alternatives></inline-formula>, <italic>h</italic>(<italic>r</italic>) is defined as<disp-formula id="Equ8"><label>8</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>Q</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>∁</mml:mi></mml:msup></mml:mrow></mml:munder><mml:mo movablelimits="true">min</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mi>B</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} h(r) = \sum _{x \in Q(r)^\complement } \min \left\{ a \in B(x) : \Gamma [k_{x,a}]\right\} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_Equ8.gif" /></alternatives></disp-formula>where <inline-formula id="IEq72"><alternatives><mml:math id="IEq72_Math"><mml:mrow><mml:mi>Q</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>∁</mml:mi></mml:msup></mml:mrow></mml:math><tex-math id="IEq72_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q(r)^\complement$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq72.gif" /></alternatives></inline-formula> is the complement of <italic>Q</italic>(<italic>r</italic>).</p>
              <p>If <inline-formula id="IEq73"><alternatives><mml:math id="IEq73_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math><tex-math id="IEq73_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in E$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq73.gif" /></alternatives></inline-formula>, such that <inline-formula id="IEq74"><alternatives><mml:math id="IEq74_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><tex-math id="IEq74_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x = \{y,z\}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq74.gif" /></alternatives></inline-formula> then <italic>B</italic>(<italic>x</italic>) is the set of possible numbers of electrons to assign to <italic>x</italic> and <inline-formula id="IEq75"><alternatives><mml:math id="IEq75_Math"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq75_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{x,a}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq75.gif" /></alternatives></inline-formula> determines the key for <italic>x</italic> given <italic>R</italic>(<italic>r</italic>) with an additional <italic>a</italic> electrons assigned to <italic>x</italic>. <italic>B</italic>(<italic>x</italic>) is given by<disp-formula id="Equ9"><label>9</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>B</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mtext>mult</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mfenced><mml:mo>:</mml:mo><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>∧</mml:mo><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} B(x) = \left\{ b \in \left\{ 0,\dots ,\text {mult}({\mathcal{P}},x)\right\} : V(y) + b \le \tau _y \wedge V(z) + b \le \tau _z \right\} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_Equ9.gif" /></alternatives></disp-formula>where <italic>V</italic>(<italic>y</italic>) is the valence of <italic>y</italic> in the partial electron assignment <italic>R</italic>(<italic>r</italic>).</p>
              <p>If <inline-formula id="IEq76"><alternatives><mml:math id="IEq76_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math><tex-math id="IEq76_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq76.gif" /></alternatives></inline-formula>, then <italic>B</italic>(<italic>x</italic>) is the set of formal charge values <italic>x</italic> can attain given <italic>R</italic>(<italic>r</italic>), and <inline-formula id="IEq77"><alternatives><mml:math id="IEq77_Math"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math><tex-math id="IEq77_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{x,a}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq77.gif" /></alternatives></inline-formula> determines the key for <italic>x</italic> assuming it has a formal charge of <italic>a</italic>. In this case, <italic>B</italic>(<italic>x</italic>) is given by<disp-formula id="Equ10"><label>10</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>B</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} B(x) = \left\{ F(x) + b \in \{0, \dots , \tau _x - V(x) \} \right\} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_Equ10.gif" /></alternatives></disp-formula>where <italic>F</italic>(<italic>x</italic>) is the formal charge of <italic>x</italic> given <italic>R</italic>(<italic>r</italic>) calculated as per Eq. (<xref rid="Equ5" ref-type="disp-formula">5</xref>).</p>
            </sec>
            <sec id="Sec11">
              <title>Fixed parameter tractable (FPT)</title>
              <p>In a similar vein to Dehof et al. [<xref ref-type="bibr" rid="CR10">10</xref>], we also implement an FPT based approach. Given a molecular graph <inline-formula id="IEq78"><alternatives><mml:math id="IEq78_Math"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq78_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G = (V,E)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq78.gif" /></alternatives></inline-formula>, which is a tree, the electron assignment problem can be easily solved using dynamic programming, i.e. recursively splitting the problem into smaller sub problems and solving the sub problems. Not all molecular graphs are trees, but their generally sparse nature means that they are ‘tree-like’.</p>
              <p>Given a graph <inline-formula id="IEq79"><alternatives><mml:math id="IEq79_Math"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq79_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G = (V, E)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq79.gif" /></alternatives></inline-formula>, the <italic>tree-decomposition</italic> of <italic>G</italic>, <inline-formula id="IEq80"><alternatives><mml:math id="IEq80_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">V</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq80_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(T, {\mathcal{V}})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq80.gif" /></alternatives></inline-formula>, where <italic>T</italic> is a tree and <inline-formula id="IEq81"><alternatives><mml:math id="IEq81_Math"><mml:mrow><mml:mi mathvariant="script">V</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><tex-math id="IEq81_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{V}} = (V_t)_{t \in T}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq81.gif" /></alternatives></inline-formula> is a family of vertex bags <inline-formula id="IEq82"><alternatives><mml:math id="IEq82_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⊆</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math><tex-math id="IEq82_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_t \subseteq V$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq82.gif" /></alternatives></inline-formula> indexed by the nodes <italic>t</italic> of <italic>T</italic>. <inline-formula id="IEq83"><alternatives><mml:math id="IEq83_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">V</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq83_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(T, {\mathcal{V}})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq83.gif" /></alternatives></inline-formula> satisfies the following three conditions:<list list-type="order"><list-item><p><inline-formula id="IEq84"><alternatives><mml:math id="IEq84_Math"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mo>⋃</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq84_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V = \bigcup _{t\in T}V_t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq84.gif" /></alternatives></inline-formula>;</p></list-item><list-item><p>for every edge <inline-formula id="IEq85"><alternatives><mml:math id="IEq85_Math"><mml:mrow><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math><tex-math id="IEq85_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e \in E$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq85.gif" /></alternatives></inline-formula> where <inline-formula id="IEq86"><alternatives><mml:math id="IEq86_Math"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><tex-math id="IEq86_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e = \{u,v\}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq86.gif" /></alternatives></inline-formula> there exists a <inline-formula id="IEq87"><alternatives><mml:math id="IEq87_Math"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><tex-math id="IEq87_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \in T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq87.gif" /></alternatives></inline-formula> such that <inline-formula id="IEq88"><alternatives><mml:math id="IEq88_Math"><mml:mrow><mml:mi>e</mml:mi><mml:mo>⊆</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq88_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e \subseteq V_t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq88.gif" /></alternatives></inline-formula>;</p></list-item><list-item><p><inline-formula id="IEq89"><alternatives><mml:math id="IEq89_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:msub><mml:mo>⊆</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math><tex-math id="IEq89_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{t_1} \cap V_{t_3} \subseteq V_{t_2}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq89.gif" /></alternatives></inline-formula> whenever <inline-formula id="IEq90"><alternatives><mml:math id="IEq90_Math"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><tex-math id="IEq90_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_1,t_2,t_3 \in T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq90.gif" /></alternatives></inline-formula> satisfy <inline-formula id="IEq91"><alternatives><mml:math id="IEq91_Math"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>T</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math><tex-math id="IEq91_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_2 \in t_1Tt_3$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq91.gif" /></alternatives></inline-formula>.</p></list-item></list>The <italic>width</italic> of <inline-formula id="IEq92"><alternatives><mml:math id="IEq92_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">V</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq92_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(T,{\mathcal{V}})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq92.gif" /></alternatives></inline-formula> is the number <inline-formula id="IEq93"><alternatives><mml:math id="IEq93_Math"><mml:mrow><mml:mrow><mml:mo movablelimits="true">max</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">{</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math><tex-math id="IEq93_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\max \big \{|V_t| - 1 : t \in T\big \}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq93.gif" /></alternatives></inline-formula>. This width gives the fixed parameter. Figure <xref rid="Fig1" ref-type="fig">1</xref>b shows a tree-decomposition of the graph in Fig. <xref rid="Fig1" ref-type="fig">1</xref>a. It has a width of two.<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>A graph <bold>a</bold><inline-formula id="IEq94"><alternatives><mml:math id="IEq94_Math"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq94_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G = (V,E)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq94.gif" /></alternatives></inline-formula> with <inline-formula id="IEq95"><alternatives><mml:math id="IEq95_Math"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mtext>A,B,C,D,E,F,G,H</mml:mtext><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><tex-math id="IEq95_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V = \{\text {A,B,C,D,E,F,G,H}\}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq95.gif" /></alternatives></inline-formula> and <inline-formula id="IEq96"><alternatives><mml:math id="IEq96_Math"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mtext>(A,B),(A,C),(A,E),(B,D),(B,H),(C,D),(C,F),(D,G)</mml:mtext><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><tex-math id="IEq96_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E = \{\text {(A,B),(A,C),(A,E),(B,D),(B,H),(C,D),(C,F),(D,G)}\}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq96.gif" /></alternatives></inline-formula>, a tree-decomposition <bold>b</bold><inline-formula id="IEq97"><alternatives><mml:math id="IEq97_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">V</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq97_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(T,{\mathcal{V}})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq97.gif" /></alternatives></inline-formula> of <italic>G</italic> and <bold>c</bold> a nice tree-decomposition. The nodes of the nice tree-decomposition are coloured red for the root node, green for leaf nodes, white for introduce nodes, blue for forget nodes and orange for join nodes</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_340_Fig1_HTML.png" id="MO12" /></fig></p>
              <p>In order to simplify the algorithm, the concept of a <italic>nice</italic> tree-decomposition is used. A tree-decomposition <inline-formula id="IEq98"><alternatives><mml:math id="IEq98_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">V</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq98_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(T, {\mathcal{V}})$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq98.gif" /></alternatives></inline-formula> is called nice if it satisfies the following conditions:<list list-type="order"><list-item><p><italic>T</italic> is rooted at a leaf node <italic>r</italic> and <inline-formula id="IEq99"><alternatives><mml:math id="IEq99_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∅</mml:mi></mml:mrow></mml:math><tex-math id="IEq99_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_r = \emptyset$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq99.gif" /></alternatives></inline-formula>;</p></list-item><list-item><p>For every leaf <inline-formula id="IEq100"><alternatives><mml:math id="IEq100_Math"><mml:mrow><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><tex-math id="IEq100_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l \in T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq100.gif" /></alternatives></inline-formula>, <inline-formula id="IEq101"><alternatives><mml:math id="IEq101_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∅</mml:mi></mml:mrow></mml:math><tex-math id="IEq101_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_l = \emptyset$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq101.gif" /></alternatives></inline-formula>;</p></list-item><list-item><p>Every node <inline-formula id="IEq102"><alternatives><mml:math id="IEq102_Math"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><tex-math id="IEq102_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \in T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq102.gif" /></alternatives></inline-formula> has at most two children;</p></list-item><list-item><p>If <inline-formula id="IEq103"><alternatives><mml:math id="IEq103_Math"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><tex-math id="IEq103_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \in T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq103.gif" /></alternatives></inline-formula> has two children, <italic>c</italic> and <italic>d</italic>, then <inline-formula id="IEq104"><alternatives><mml:math id="IEq104_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq104_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_t = V_c = V_d$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq104.gif" /></alternatives></inline-formula> and <italic>t</italic> is known as a join node;</p></list-item><list-item><p>If <inline-formula id="IEq105"><alternatives><mml:math id="IEq105_Math"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><tex-math id="IEq105_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \in T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq105.gif" /></alternatives></inline-formula> has one child, <italic>c</italic>, then one of the following conditions is true:<list list-type="order"><list-item><p><inline-formula id="IEq106"><alternatives><mml:math id="IEq106_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⊂</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq106_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_t \subset V_c$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq106.gif" /></alternatives></inline-formula> and <inline-formula id="IEq107"><alternatives><mml:math id="IEq107_Math"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math><tex-math id="IEq107_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|V_t| = |V_c| - 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq107.gif" /></alternatives></inline-formula> and <italic>t</italic> is known as a forget node with forgotten vertex <inline-formula id="IEq108"><alternatives><mml:math id="IEq108_Math"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq108_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{t_f} {:}{=} V_c \setminus V_t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq108.gif" /></alternatives></inline-formula>.</p></list-item><list-item><p><inline-formula id="IEq109"><alternatives><mml:math id="IEq109_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⊃</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq109_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_t \supset V_c$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq109.gif" /></alternatives></inline-formula> and <inline-formula id="IEq110"><alternatives><mml:math id="IEq110_Math"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math><tex-math id="IEq110_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|V_t| = |V_c| + 1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq110.gif" /></alternatives></inline-formula> and <italic>t</italic> is known as an introduce node with introduced vertex <inline-formula id="IEq111"><alternatives><mml:math id="IEq111_Math"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq111_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{t_i} {:}{=} V_t \setminus V_c$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq111.gif" /></alternatives></inline-formula>.</p></list-item></list></p></list-item></list>Forget and introduce nodes are defined in relation to the path from a leaf node to the root node. Figure <xref rid="Fig1" ref-type="fig">1</xref>c shows a nice tree decomposition produced from the tree decomposition in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b.</p>
              <p>The electron assignment optimisation process requires scores to be determined for both atoms and bonds. As a nice tree-decomposition introduces and forgets vertices, the edges of <italic>G</italic> must be treated as vertices. To do this, the edges are explicitly added into the bags of the tree-decomposition of <italic>G</italic>, at the expense of a larger width. An edge is introduced at the same time the first of its vertices is introduced, and forgotten once the second vertex is forgotten.</p>
              <p><italic>Algorithm</italic> A tree-decomposition of a molecular graph is obtained using the GreedyFillIn upper-bound heuristic described by Bodlaender and Koster, [<xref ref-type="bibr" rid="CR21">21</xref>] and converted to a nice tree decomposition. Optimisation of electron assignment then proceeds as follows. Let <inline-formula id="IEq112"><alternatives><mml:math id="IEq112_Math"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><tex-math id="IEq112_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \in T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq112.gif" /></alternatives></inline-formula> be a node of the nice tree-decomposition of a graph. Then <inline-formula id="IEq113"><alternatives><mml:math id="IEq113_Math"><mml:msub><mml:mi mathvariant="script">X</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><tex-math id="IEq113_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{X}}_t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq113.gif" /></alternatives></inline-formula> is the set of forgotten vertices <inline-formula id="IEq114"><alternatives><mml:math id="IEq114_Math"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq114_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{s_f} \in V_s$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq114.gif" /></alternatives></inline-formula> associated with the forget nodes of the subtree <inline-formula id="IEq115"><alternatives><mml:math id="IEq115_Math"><mml:msub><mml:mi>T</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><tex-math id="IEq115_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_s$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq115.gif" /></alternatives></inline-formula> induced on <italic>T</italic> below (and including) the node <italic>t</italic>. The total number of electrons to assign <inline-formula id="IEq116"><alternatives><mml:math id="IEq116_Math"><mml:msub><mml:mi>e</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math><tex-math id="IEq116_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq116.gif" /></alternatives></inline-formula> and the multiset <inline-formula id="IEq117"><alternatives><mml:math id="IEq117_Math"><mml:mi mathvariant="script">P</mml:mi></mml:math><tex-math id="IEq117_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{P}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq117.gif" /></alternatives></inline-formula> of positions at which the electrons can be assigned are determined as per “<xref rid="Sec3" ref-type="sec">Initialisation</xref>” section. Each node <italic>t</italic> is given a score table <inline-formula id="IEq118"><alternatives><mml:math id="IEq118_Math"><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><tex-math id="IEq118_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq118.gif" /></alternatives></inline-formula> indexed by the ordered pair <inline-formula id="IEq119"><alternatives><mml:math id="IEq119_Math"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq119_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(l,k) \in L_t \times K_t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq119.gif" /></alternatives></inline-formula> where<disp-formula id="Equ11"><label>11</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>L</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mtext>min</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} L_t&amp;= \{n_\text {min},\dots ,n_\text {max}\}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_Equ11.gif" /></alternatives></disp-formula><disp-formula id="Equ12"><label>12</label><alternatives><mml:math display="block" id="Equ12_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>n</mml:mi><mml:mtext>min</mml:mtext></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo movablelimits="true">max</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>∩</mml:mo><mml:msub><mml:mi mathvariant="script">X</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} n_\text {min}&amp;= \max \{0, e_T - |{\mathcal{P}}| + |{\mathcal{P}} \cap {\mathcal{X}}_t|\}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_Equ12.gif" /></alternatives></disp-formula><disp-formula id="Equ13"><label>13</label><alternatives><mml:math display="block" id="Equ13_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>n</mml:mi><mml:mtext>max</mml:mtext></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo movablelimits="true">min</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>∩</mml:mo><mml:msub><mml:mi mathvariant="script">X</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} n_\text {max}&amp;= \min \{e_T, |{\mathcal{P}} \cap {\mathcal{X}}_t|\}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_Equ13.gif" /></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><mml:math display="block" id="Equ14_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mo>⋯</mml:mo><mml:mo>×</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} K_t&amp;= X_1 \times \cdots \times X_j, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_Equ14.gif" /></alternatives></disp-formula><disp-formula id="Equ15"><label>15</label><alternatives><mml:math display="block" id="Equ15_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mtext>mult</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} X_j&amp;= \{(j,k):j\in V_t, 0 \le k \le \text {mult}({\mathcal{P}}, j)\}, \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_Equ15.gif" /></alternatives></disp-formula>with <inline-formula id="IEq120"><alternatives><mml:math id="IEq120_Math"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq120_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_t[l,k]$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq120.gif" /></alternatives></inline-formula> being the minimum score of forgotten vertices <inline-formula id="IEq121"><alternatives><mml:math id="IEq121_Math"><mml:msub><mml:mi mathvariant="script">X</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><tex-math id="IEq121_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal{X}}_t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq121.gif" /></alternatives></inline-formula> with <inline-formula id="IEq122"><alternatives><mml:math id="IEq122_Math"><mml:mrow><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq122_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l \in L_t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq122.gif" /></alternatives></inline-formula> forgotten electrons and the additional constraint of further partial electron distribution <inline-formula id="IEq123"><alternatives><mml:math id="IEq123_Math"><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq123_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \in K_t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq123.gif" /></alternatives></inline-formula>. Beginning from the leaves of the nice tree-decomposition, and scoring only when all children of a node have been scored, the algorithm distinguishes the kind of each node and determines the score matrix as follows:</p>
              <p><italic>Leaf node</italic> Leaf nodes are empty sets, so the score table of a leaf node is also empty.</p>
              <p><italic>Introduce nodes </italic>Let <inline-formula id="IEq124"><alternatives><mml:math id="IEq124_Math"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><tex-math id="IEq124_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \in T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq124.gif" /></alternatives></inline-formula> be the introduce node with child <italic>c</italic>, and <inline-formula id="IEq125"><alternatives><mml:math id="IEq125_Math"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="script">X</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msub><mml:mi mathvariant="script">X</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq125_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_t = {\mathcal{X}}_t \setminus {\mathcal{X}}_c$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq125.gif" /></alternatives></inline-formula>. Then<disp-formula id="Equ16"><label>16</label><alternatives><mml:math display="block" id="Equ16_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow /><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em" /><mml:mi>k</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mi mathvariant="normal">∅</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow /><mml:mi>∞</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow /><mml:mtext>otherwise</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} S_t[l,k] = {\left\{ \begin{array}{ll} S_c[l,k\setminus x_t] &amp; {} \text {if } k\setminus x_t \ne \emptyset , \\ \infty &amp; {} \text {otherwise}. \end{array}\right. } \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_Equ16.gif" /></alternatives></disp-formula></p>
              <p><italic>Forget nodes</italic> Let <inline-formula id="IEq126"><alternatives><mml:math id="IEq126_Math"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><tex-math id="IEq126_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \in T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq126.gif" /></alternatives></inline-formula> be the forget node with child <italic>c</italic>, and <inline-formula id="IEq127"><alternatives><mml:math id="IEq127_Math"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="script">X</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msub><mml:mi mathvariant="script">X</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq127_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_t = {\mathcal{X}}_c \setminus {\mathcal{X}}_t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq127.gif" /></alternatives></inline-formula>. Then<disp-formula id="Equ17"><label>17</label><alternatives><mml:math display="block" id="Equ17_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="true">min</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mtext>mult</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow /><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">{</mml:mo></mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∪</mml:mo><mml:msub><mml:mi mathvariant="script">X</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∪</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} S_t[l,k] = \min _{\begin{array}{c} n \in \{0, \dots , \text {mult}({\mathcal{P}}, x_t)\} \\ p \in L_c : p + n = l \end{array}} \Big \{E(x_t,k \cup {\mathcal{X}}_t,n) + S_c[p, k \cup x_t]\Big \} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_Equ17.gif" /></alternatives></disp-formula>where <inline-formula id="IEq128"><alternatives><mml:math id="IEq128_Math"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∪</mml:mo><mml:msub><mml:mi mathvariant="script">X</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq128_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E(x_t,k \cup {\mathcal{X}}_t,n)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq128.gif" /></alternatives></inline-formula> is the score of <inline-formula id="IEq129"><alternatives><mml:math id="IEq129_Math"><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><tex-math id="IEq129_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq129.gif" /></alternatives></inline-formula> with <italic>n</italic> electrons positioned and the partial electron distribution <inline-formula id="IEq130"><alternatives><mml:math id="IEq130_Math"><mml:mrow><mml:mi>k</mml:mi><mml:mo>∪</mml:mo><mml:msub><mml:mi mathvariant="script">X</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq130_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \cup {\mathcal{X}}_t$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq130.gif" /></alternatives></inline-formula>.</p>
              <p><italic>Join nodes</italic> Let <inline-formula id="IEq131"><alternatives><mml:math id="IEq131_Math"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><tex-math id="IEq131_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \in T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq131.gif" /></alternatives></inline-formula> be the parent of <italic>c</italic> and <italic>d</italic> with <inline-formula id="IEq132"><alternatives><mml:math id="IEq132_Math"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq132_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_t = V_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq132.gif" /></alternatives></inline-formula> for <inline-formula id="IEq133"><alternatives><mml:math id="IEq133_Math"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:math><tex-math id="IEq133_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in {c,d}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq133.gif" /></alternatives></inline-formula>. Then<disp-formula id="Equ18"><label>18</label><alternatives><mml:math display="block" id="Equ18_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="true">min</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">{</mml:mo></mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} S_t[l,k] = \min _{(p,q) \in L_{c} \times L_{d} : p+q = l} \Big \{S_{c}[p,k] + S_{d}[q,k]\Big \} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_Equ18.gif" /></alternatives></disp-formula></p>
              <p><italic>Root node</italic> Each nice tree decomposition has only one root node <inline-formula id="IEq134"><alternatives><mml:math id="IEq134_Math"><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><tex-math id="IEq134_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r \in T$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq134.gif" /></alternatives></inline-formula> which is formally a forget node. However the score table of the root node is unpopulated as <inline-formula id="IEq135"><alternatives><mml:math id="IEq135_Math"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∅</mml:mi></mml:mrow></mml:math><tex-math id="IEq135_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_r = \emptyset$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq135.gif" /></alternatives></inline-formula>. Rather than fill a score table, the minimised electron assignment score is determined. Let <italic>c</italic> be the child of <italic>r</italic> with <inline-formula id="IEq136"><alternatives><mml:math id="IEq136_Math"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="script">X</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq136_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_r = {\mathcal{X}}_c$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq136.gif" /></alternatives></inline-formula>. Then the minimum score is given by<disp-formula id="Equ19"><label>19</label><alternatives><mml:math display="block" id="Equ19_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mtext>min</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="true">min</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mtext>mult</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow /><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">{</mml:mo></mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">X</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} S_\text {min} = \min _{\begin{array}{c} n \in \{0, \dots , \text {mult}({\mathcal{P}}, x_r)\} \\ p \in L_c : p + n = e_T \end{array}} \Big \{S(x_r,{\mathcal{X}}_r,n) + S_r[p, x_r]\Big \} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_Equ19.gif" /></alternatives></disp-formula></p>
            </sec>
          </sec>
          <sec id="Sec12">
            <title>Practical optimisation</title>
            <p>There are a number of techniques which can be used to optimise the electron assignment algorithms described above. As opposed to implementation optimisation techniques which do not affect the outcome of the algorithms, only the computational cost of performing them, these are considered practical optimisations as they could influence the results obtained, but generally would not be expected to do so.</p>
            <p><italic>Electron pairs</italic> A simple means to optimise the algorithms is to utilise electron pairs instead of single electrons. Generally, one would expect electrons to be found in pairs anyway: two electrons per bond order and lone pairs of electrons on atoms. By explicitly assigning pairs, the search space can be massively reduced, leading to an increase in performance. This optimisation is recommended, is the default setting, and is used for all results presented here.</p>
            <p><italic>Pre-placing electrons</italic> In the majority of molecules, there are a number of elements to which a minimum number, larger than zero, of electrons are expected to be assigned. For example, the halogens would be expected to have three lone pairs of electrons assigned when they are bonded to only one other atom. By placing an expected minimum number of electrons on various atoms of the molecule before undertaking the optimisation, the search space of the algorithms is reduced, and so the optimisation cost is reduced.</p>
          </sec>
          <sec id="Sec13">
            <title>Reference formal charge and bond order assignments</title>
            <p>Validation of the accuracy of our method requires reference data, i.e. a set of molecules for which both formal charge and bond order properties are already known. The reference data must also represent aromatic bonds in kekulised form, i.e. alternating single and double bonds, and hydrogen atoms must be explicitly present or able to be added automatically. Two molecular databases that fit these requirements were chosen as reference data sets: the MMFF94 validation suite [<xref ref-type="bibr" rid="CR22">22</xref>] and the KEGG Drug Database [<xref ref-type="bibr" rid="CR23">23</xref>]. These databases were previously used to validate the bond order assignment methods developed by Dehof et al. [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
            <p>All molecules in each reference data set were parsed to extract the element and connectivity information required for our internal graph theoretic representation (see “<xref rid="Sec3" ref-type="sec">Initailisation</xref>” section). In cases where one structure file contained multiple molecules, the molecules were treated separately. Molecules were discarded if they contained dangling bonds due to being monomer units, if they contained three or fewer non hydrogen atoms, if they contained elements not included in the score tables, if they contained an odd number of valence electrons, or if they were identical to a previously parsed molecule.</p>
            <p>The MMFF94 validation suite contains 761 structures for small molecules and ions, 698 of which are derived from the CSD. The native CSD structures were manually modified by the authors, by assigning bond orders and formal charges and, where appropriate, adding missing hydrogen atoms to complete the valence [<xref ref-type="bibr" rid="CR22">22</xref>]. Formal charges and bond orders are available in either hypervalent or dative representation, with the hypervalent representation used here. After filtering using the rules described above, 691 unique molecules were identified. Canonical SMILES strings for these structures are given in Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>: Table S7.</p>
            <p>The KEGG Drug Database contains a large number of drug like molecules [<xref ref-type="bibr" rid="CR23">23</xref>]. Its structure files contain only 2D coordinate information, meaning that they are a perfect test set for connectivity-only bond order and formal charge assignment. Hydrogen atoms are not explicitly present in the structure files. Rather, they are implicitly given through providing types to the heavy atoms. Accordingly, explicit hydrogen atoms were added to the molecules using this atom type information [<xref ref-type="bibr" rid="CR24">24</xref>]. After filtering using the rules described above, 5676 unique molecules were identified. Canonical SMILES strings for these molecules are given in Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>: Table S8.</p>
          </sec>
        </sec>
        <sec id="Sec14">
          <title>Results and discussion</title>
          <p>We first discuss the consistency of the three optimisation algorithms described above by comparing the optimised electron assignment scores that they provide. Then we discuss the accuracy of the FPT algorithm in regards to its ability to reproduce the formal charge and bond order assignments provided by the two reference databases.</p>
          <sec id="Sec15">
            <title>Algorithm consistency</title>
            <p>For the consistency tests described here, the scores used were derived from calculations performed using the def2-SVPD basis set, without accounting for the basis set superposition error. This set of scores was chosen as for self-consistency tests it does not matter whether the optimised score corresponds to the true formal charge and bond order state, rather only that the algorithms are correctly determining the lowest-scoring state. Electron pairs were utilised for maximum performance. Electrons were not pre-placed.</p>
            <p>As expected, we find that the A* and FPT algorithms have 100% agreement in regards to the optimised score, with both molecular databases. This is reassuring as it indicates correct implementation of the two algorithms. In relation to these, the local optimisation algorithm performs remarkably well. For the MMFF94 database, there is 81% agreement with the A* and FPT algorithms, and for the KEGG drug database, there is 91% agreement with the A* and FPT algorithms. Such high percentage accuracies indicate that using the highly efficient local optimisation algorithm could potentially be acceptable in extremely high throughput applications where overall speed is more important than accuracy.</p>
          </sec>
          <sec id="Sec16">
            <title>Algorithm efficiency</title>
            <p>We next consider the efficiency of each algorithm, defined as the average time required to find the lowest score for a single molecule. The distributions of calculation times for each algorithm and each dataset are shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.<fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>Histograms of algorithm execution time for the three optimisation algorithms and two data sets. For all plots, the horizontal axis shows the execution time of the algorithm in seconds and the vertical axis shows the base-ten logarithm of the count for each bin. Fifty bins of even width were used. Mean (<inline-formula id="IEq137"><alternatives><mml:math id="IEq137_Math"><mml:mi>μ</mml:mi></mml:math><tex-math id="IEq137_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq137.gif" /></alternatives></inline-formula>) and median (<inline-formula id="IEq138"><alternatives><mml:math id="IEq138_Math"><mml:mi>η</mml:mi></mml:math><tex-math id="IEq138_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\eta$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq138.gif" /></alternatives></inline-formula>) values for the distributions in blue are provided. <bold>a</bold>, <bold>b</bold> Show the time distributions for the MMFF94 and KEGG databases when optimised with the Local Optimisation algorithm. In both cases, a single outlier with an execution time in excess of 200 s is excluded from the plots. <bold>c</bold>, <bold>d</bold> Show the time distributions for the MMFF94 and KEGG databases when optimised with the A* algorithm. The orange bins indicate molecules that failed to complete optimisation due to a 1024 MB memory limit imposed on the A* search queue. <bold>e</bold>, <bold>f</bold> Show the time distributions for the MMFF94 and KEGG databases when optimised with the FPT algorithm</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_340_Fig2_HTML.png" id="MO22" /></fig></p>
            <p>From the distributions, we can tell that the local optimisation algorithm is the most efficient with a maximum 90-th percentile execution time of only 0.015 s, followed by the FPT algorithm with a maximum 90-th percentile execution time of 0.656 s and finally the A* algorithm with a maximum 90-th percentile execution time of 212 s when molecules that failed to complete optimisation due to a 1024 MB memory limit imposed on the A* search queue are excluded. All algorithms show exponential decay in the execution time, showing that in the majority of cases, one would expect any of the algorithms to give a result in a reasonable time period. This is further reinforced by the low median execution times.</p>
            <p>Local optimisation, Fig. <xref rid="Fig2" ref-type="fig">2</xref>a and b, was the stand-out efficiency algorithm, though both databases had a single outlier molecule which took longer than 200 seconds to optimise. In these two cases, the initial electron assignment required a large number of neighbour search steps before a distribution with non-infinite score was discovered, which could then be minimised. Due to the extremely long computational time required for these two molecules, an upper limit on the execution time of 5 s was implemented for the local optimisation algorithm.</p>
            <p>The A* algorithm, Fig. <xref rid="Fig2" ref-type="fig">2</xref>c and d, is the least efficient of the three algorithms. A desirable A* search would be narrow throughout the search tree. The breadth of the search is primarily controlled by the heuristic function, where a better heuristic would result in a narrower search. However, even with a near-optimal heuristic, there can be cases where the leaves of the search tree have final scores with fractions of a percent difference between them. In these cases, the path through the search tree becomes broad, and so the overall algorithm efficiency decreases. Due to this, a memory limit of 1024 MB was imposed on the A* algorithm. This limit means that when the memory allocated for the queue exceeds the given amount, the algorithm halts without returning a solution. Molecules which triggered this limit are shown in the orange distributions in Fig. <xref rid="Fig2" ref-type="fig">2</xref>c and d, where the execution time is the time taken before the limit was triggered. We note that there are molecules which did not trigger the memory limit but took longer to complete than the triggering time of any triggered molecules. This can be attributed to larger molecules requiring deep searches that are not necessarily as broad as other smaller molecules, so they can complete without triggering the memory limit.</p>
            <p>Finally, the FPT algorithm, Fig. <xref rid="Fig2" ref-type="fig">2</xref>e and f is a highly efficient algorithm that is also guaranteed to locate the global minimum score value. Though the vast majority of molecules take less than a second to determine an optimal score using the FPT algorithm, there are a small number of molecules which take in excess of ten seconds to complete. The execution times of these molecules are so long as their tree-decomposition contains wide join nodes that have a large number of potentially forgotton electrons. These large join nodes come about primarily due to areas within the molecule which can contain a broad range of electron counts, especially when the width of the tree-decomposition is high, such as highly conjugated aromatic systems or high electron density areas like sulfate or phosphate groups.</p>
          </sec>
          <sec id="Sec17">
            <title>Comparison to reference assignments</title>
            <p>The true measure of the accuracy of each algorithm is its ability to reproduce the formal charges and bond orders of the molecules in the reference data sets. Here we only consider the FPT algorithm as “<xref rid="Sec15" ref-type="sec">Algorithm consistency</xref>” section showed that it is far more efficient than the A* algorithm whilst still providing a global minimum score.</p>
            <p>Additionally, we compare our results to the A* method described by Dehof et al. [<xref ref-type="bibr" rid="CR10">10</xref>] as implemented in BALL [<xref ref-type="bibr" rid="CR25">25</xref>]. The A* method is utilised as the FPT method is not accessible through the provided Python bindings.</p>
            <p>We note that the score of two resonance structures will be identical, whereas the formal charges and bond orders will not, even though each resonance state is a valid, and minimum score, formal charge and bond order assignment. As the reference data only contains formal charge and bond order assignments for a single resonance structure, the FPT algorithm was modified to be capable of producing all possible resonance structures for a given molecule. However, due to the combinatorial explosion possible when there are multiple, disjoint resonance substructures within a molecule, and the resulting increase in intermediate computational load such an explosion would have on the algorithm, an upper limit to the number of resonance structures obtained of 32 was implemented.</p>
            <p>For the comparisons to the reference data sets, a calculated formal charge and bond order assignment, from either the FPT algorithm described here or the A* algorithm described by Dehof et al., is deemed correct if one of the up to 32 assignments returned by the algorithm exactly matches that of the reference data. In some cases, there will be more than 32 potential resonance structures. If the reference assignment is not matched within these first 32 results returned, that molecule is regarded as failing for the algorithm, regardless of whether or not the returned assignments are correct resonance structures for the reference assignment. The results of these comparisons are given in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Percentage of optimised electron assignment scores for which the corresponding formal charge and bond order state matches the reference state</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Database</p></th><th align="left"><p>FPT algorithm</p></th><th align="left"><p>BALL</p></th></tr></thead><tbody><tr><td align="left"><p>MMFF94 (691)</p></td><td align="left"><p>93.49% (646)</p></td><td align="left"><p>84.80% (586)</p></td></tr><tr><td align="left"><p>KEGG (5676)</p></td><td align="left"><p>98.13% (5570)</p></td><td align="left"><p>93.59% (5312)</p></td></tr><tr><td align="left"><p>Overall (6367)</p></td><td align="left"><p>97.63% (6216)</p></td><td align="left"><p>92.63% (5898)</p></td></tr></tbody></table><table-wrap-foot><p>Counts are given in brackets. The BALL column gives the accuracy results obtained when only checking if the bond orders obtained match the reference data</p></table-wrap-foot></table-wrap></p>
            <p>Scores for our FPT algorithm were derived from quantum chemical calculations using the def2-SVPD or def2-TZVPPD basis set, with or without correction for basis set superposition error. All four sources of scores performed identically and as such, the cheapest level of theory is recommended, and used for the results presented here. Additionally, the scores associated with a <inline-formula id="IEq139"><alternatives><mml:math id="IEq139_Math"><mml:msup><mml:mtext>C</mml:mtext><mml:mn>0</mml:mn></mml:msup></mml:math><tex-math id="IEq139_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {C}^0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq139.gif" /></alternatives></inline-formula> atom and a <inline-formula id="IEq140"><alternatives><mml:math id="IEq140_Math"><mml:msup><mml:mtext>C</mml:mtext><mml:mo>-</mml:mo></mml:msup></mml:math><tex-math id="IEq140_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {C}^{-}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq140.gif" /></alternatives></inline-formula> atom were swapped so as to make a neutral carbon always be more favourable than a charged carbon. This increased the overall accuracy from 95.63 to 97.63%.</p>
            <p>These results show that our method has better accuracy than that of Dehof et al. across both databases. Our accuracy is similar accuracy to that of other state of the art bond order assignment methodologies, [<xref ref-type="bibr" rid="CR26">26</xref>–<xref ref-type="bibr" rid="CR29">29</xref>] while additionally assigning formal charges. We note that because Dehof et al.’s method is not designed for determining formal charges as well as bond orders, the accuracy values that we report for their algorithm should be taken as an upper limit of accuracy, as only correct assignment of bond orders are checked. Any check of formal charge correctness, for example through back calculation from the bond orders, will not be able to exceed these accuracy levels, as the bond order checking is a subset of the combined bond order and formal charge checking.</p>
            <p>The method presented by Dehof et al. makes use of arbitrary, but empirically optimised, penalty scores for their bond order assignment, whereas the method presented here utilises scores derived directly from high-level quantum chemical calculations, other than the single swap of the <inline-formula id="IEq141"><alternatives><mml:math id="IEq141_Math"><mml:msup><mml:mtext>C</mml:mtext><mml:mn>0</mml:mn></mml:msup></mml:math><tex-math id="IEq141_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {C}^0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq141.gif" /></alternatives></inline-formula> and <inline-formula id="IEq142"><alternatives><mml:math id="IEq142_Math"><mml:msup><mml:mtext>C</mml:mtext><mml:mo>-</mml:mo></mml:msup></mml:math><tex-math id="IEq142_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {C}^{-}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq142.gif" /></alternatives></inline-formula> scores. This direct derivation makes our scoring function easily extensible to other atom and bond types. Empirical optimisation of the scores used here could increase the accuracy of our algorithm, but at the expense of ease of extensibility.</p>
            <p>The 151 molecules for which the FPT algorithm failed to generate a correct assignment include two major groups of chemically similar molecules. The first group consists of 103 molecules containing at least one nitrogen atom assigned a formal charge of <inline-formula id="IEq143"><alternatives><mml:math id="IEq143_Math"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em" /><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq143_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq143.gif" /></alternatives></inline-formula> in the reference data. Overall, 106 such molecules are found in the reference data, showing that only three were correctly assigned by our algorithm. The formal charges and bond orders of nearly all of these molecules were not correctly assigned, indicating that the relative scores for neutral and negatively-charged nitrogen atoms, combined with the scores for single and double bonds involving nitrogen, are unable to produce correct assignments. These nitrogen atoms are generally located in groups such azides or diazos. These groups are generally presented as containing nitrogen atoms with positive and a negative charge adjacent to one another, whereas our algorithm assigns them both neutral charges. Additionally, they are joined by a double bond in the reference data but by a single bond in our results. This illustrates how our scoring system leads to a preference for fewer formal charges.</p>
            <p>The second group comprise molecules where some of our underlying assumptions do not hold. For example, for protonated acetone, the MMFF94 database assigns the oxygen atom a formal charge of <inline-formula id="IEq144"><alternatives><mml:math id="IEq144_Math"><mml:mrow><mml:mo>+</mml:mo><mml:mspace width="0.166667em" /><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq144_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+\,1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq144.gif" /></alternatives></inline-formula> and places a double bond between the oxygen and central carbon atom, whereas our algorithm assigns a formal charge of <inline-formula id="IEq145"><alternatives><mml:math id="IEq145_Math"><mml:mrow><mml:mo>+</mml:mo><mml:mspace width="0.166667em" /><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq145_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+\,1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2019_340_IEq145.gif" /></alternatives></inline-formula> to the central carbon atom and assumes that an oxygen atom bonded to two other atoms will have two lone pairs of electrons. Along with the backbone sigma bond electron pairs, this means that there are no missing electron pairs to assign, thus leading to the positive formal charge on the central carbon and concomitant single rather than double bond.</p>
          </sec>
        </sec>
        <sec id="Sec18" sec-type="conclusions">
          <title>Conclusion</title>
          <p>We have developed a method for determining optimal bond order and formal charge assignments utilising electron assignment scores derived from atom/ion and bond dissociation energies calculated with high-level quantum chemical methods, and tested their performance using three different optimisation methods—local optimisation, an A* pathfinding algorithm, and an FPT algorithm.</p>
          <p>While the FPT algorithm is less efficient than local optimisation, its greater accuracy was considered the more important feature. We found no difference in the accuracy of the FPT algorithm when the electron assignment scores were derived from calculations at difference quantum chemical levels of theory, indicating that extension of the scoring function to additional element and bond types need only consider performing quantum chemical calculations at the lowest level of theory used here.</p>
          <p>In comparison with the state of the art method of Dehof et al., the FPT algorithm developed here performs remarkably well, attaining relatively similar accuracy levels. We also show that the scores provided here can be easily optimised in order to increase the accuracy, though doing so will remove the extensibility of scores derived from quantum chemical calculations. Our method is well suited to use in computational chemistry and cheminformatic applications where the user supplies only minimal information, as it requires only atom types and connectivity.</p>
        </sec>
      </body>
      <back>
        <ack>
          <title>Authors' contributions</title>
          <sec>
            <p>IDW designed and implemented the algorithms, and analysed the results. JRA aided in analysis of the results and preparation of the manuscript. All authors read and approved the final manuscript.</p>
          </sec>
          <sec id="FPar1">
            <title>Acknowledgements</title>
            <p>Not applicable.</p>
          </sec>
          <sec id="FPar3">
            <title>Competing interests</title>
            <p>The authors declare that they have no competing interests.</p>
          </sec>
          <sec id="FPar2">
            <title>Availability of data and materials</title>
            <p>All data generated or analysed during this study are included in this published article and its supplementary information files. Data in a computer readable format is available from the Github repository at <ext-link xlink:href="https://git.io/vH7hz" ext-link-type="uri">https://git.io/vH7hz</ext-link>.</p>
          </sec>
          <sec id="FPar4">
            <title>Funding</title>
            <p>This work was supported by a Marsden Fast Start Grant (13-MAU-039) and a Rutherford Discovery Fellowship (15-MAU-001) awarded to JRA.</p>
          </sec>
          <sec id="FPar5">
            <title>Publisher’s Note</title>
            <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
          </sec>
        </ack>
        <ref-list id="Bib1">
          <title>References</title>
          <ref-list>
            <ref id="CR1">
              <label>1.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Reed</surname>
                    <given-names>AE</given-names>
                  </name>
                  <name>
                    <surname>Curtiss</surname>
                    <given-names>LA</given-names>
                  </name>
                  <name>
                    <surname>Weinhold</surname>
                    <given-names>F</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Intermolecular interactions from a natural bond orbital, donor-acceptor viewpoint</article-title>
                <source>Chem Rev</source>
                <year>1988</year>
                <volume>88</volume>
                <issue>6</issue>
                <fpage>899</fpage>
                <lpage>926</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaL1cXmtlOitbw%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/cr00088a005</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR2">
              <label>2.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Leach</surname>
                    <given-names>AR</given-names>
                  </name>
                  <name>
                    <surname>Dolata</surname>
                    <given-names>DP</given-names>
                  </name>
                  <name>
                    <surname>Prout</surname>
                    <given-names>K</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Automated conformational analysis and structure generation: algorithms for molecular perception</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>1990</year>
                <volume>30</volume>
                <issue>3</issue>
                <fpage>316</fpage>
                <lpage>324</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK3cXkvFKltrY%3D</pub-id>
                <pub-id pub-id-type="pmid">2211887</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci00067a017</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR3">
              <label>3.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Meng</surname>
                    <given-names>EC</given-names>
                  </name>
                  <name>
                    <surname>Lewis</surname>
                    <given-names>RA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Determination of molecular topology and atomic hybridization states from heavy atom coordinates</article-title>
                <source>J Comput Chem</source>
                <year>1991</year>
                <volume>12</volume>
                <issue>7</issue>
                <fpage>891</fpage>
                <lpage>898</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK3MXlvVahur4%3D</pub-id>
                <pub-id pub-id-type="doi">10.1002/jcc.540120716</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR4">
              <label>4.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Baber</surname>
                    <given-names>JC</given-names>
                  </name>
                  <name>
                    <surname>Hodgkin</surname>
                    <given-names>EE</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Automatic assignment of chemical connectivity to organic molecules in the cambridge structural database</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>1992</year>
                <volume>32</volume>
                <issue>5</issue>
                <fpage>401</fpage>
                <lpage>406</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK38XlsFShu7g%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci00009a001</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR5">
              <label>5.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Lang</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>von der Lieth</surname>
                    <given-names>C-W</given-names>
                  </name>
                  <name>
                    <surname>Förster</surname>
                    <given-names>T</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Automatic assignment of bond orders based on the analysis of the internal coordinates of molecular structures</article-title>
                <source>Anal Chim Acta</source>
                <year>1992</year>
                <volume>265</volume>
                <issue>2</issue>
                <fpage>283</fpage>
                <lpage>289</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK38XlslSmsbo%3D</pub-id>
                <pub-id pub-id-type="doi">10.1016/0003-2670(92)85034-4</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR6">
              <label>6.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Hendlich</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Rippmann</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Barnickel</surname>
                    <given-names>G</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Bali: automatic assignment of bond and atom types for protein ligands in the brookhaven protein databank</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>1997</year>
                <volume>37</volume>
                <issue>4</issue>
                <fpage>774</fpage>
                <lpage>778</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK2sXktl2rsLs%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci9603487</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR7">
              <label>7.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Froeyen</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Herdewijn</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Correct bond order assignment in a molecular framework using integer linear programming with application to molecules where only non-hydrogen atom coordinates are available</article-title>
                <source>J Chem Inf Model</source>
                <year>2005</year>
                <volume>45</volume>
                <issue>5</issue>
                <fpage>1267</fpage>
                <lpage>1274</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2MXlt1Shsrc%3D</pub-id>
                <pub-id pub-id-type="pmid">16180903</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci049645z</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR8">
              <label>8.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Labute</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">On the perception of molecules from 3D atomic coordinates</article-title>
                <source>J Chem Inf Model</source>
                <year>2005</year>
                <volume>45</volume>
                <issue>2</issue>
                <fpage>215</fpage>
                <lpage>221</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2MXksFSnsg%3D%3D</pub-id>
                <pub-id pub-id-type="pmid">15807481</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci049915d</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR9">
              <label>9.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Wang</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Wang</surname>
                    <given-names>W</given-names>
                  </name>
                  <name>
                    <surname>Kollman</surname>
                    <given-names>PA</given-names>
                  </name>
                  <name>
                    <surname>Case</surname>
                    <given-names>DA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Automatic atom type and bond type perception in molecular mechanical calculations</article-title>
                <source>J Mol Graph Model</source>
                <year>2006</year>
                <volume>25</volume>
                <issue>2</issue>
                <fpage>247</fpage>
                <lpage>260</lpage>
                <pub-id pub-id-type="pmid">16458552</pub-id>
                <pub-id pub-id-type="doi">10.1016/j.jmgm.2005.12.005</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR10">
              <label>10.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Dehof</surname>
                    <given-names>AK</given-names>
                  </name>
                  <name>
                    <surname>Rurainski</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Bui</surname>
                    <given-names>QBA</given-names>
                  </name>
                  <name>
                    <surname>Böcker</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Lenhof</surname>
                    <given-names>H-P</given-names>
                  </name>
                  <name>
                    <surname>Hildebrandt</surname>
                    <given-names>A</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Automated bond order assignment as an optimization problem</article-title>
                <source>Bioinformatics</source>
                <year>2011</year>
                <volume>27</volume>
                <issue>5</issue>
                <fpage>619</fpage>
                <lpage>625</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXis1ektbw%3D</pub-id>
                <pub-id pub-id-type="pmid">21245051</pub-id>
                <pub-id pub-id-type="doi">10.1093/bioinformatics/btq718</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR11">
              <label>11.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Library</surname>
                    <given-names>The Boost Graph</given-names>
                  </name>
                </person-group>
                <source>User guide and reference manual</source>
                <year>2002</year>
                <publisher-loc>Boston</publisher-loc>
                <publisher-name>Addison-Wesley Longman Publishing Co., Inc.</publisher-name>
              </mixed-citation>
            </ref>
            <ref id="CR12">
              <label>12.</label>
              <mixed-citation publication-type="other">Jakob W, Rhinelander J, Moldovan D (2017) pybind11—Seamless operability between C++11 and Python. <ext-link xlink:href="https://github.com/pybind/pybind11" ext-link-type="uri">https://github.com/pybind/pybind11</ext-link>. Accessed 5 Apr 2018</mixed-citation>
            </ref>
            <ref id="CR13">
              <label>13.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Piecuch</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Kucharski</surname>
                    <given-names>SA</given-names>
                  </name>
                  <name>
                    <surname>Kowalski</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Musiał</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Efficient computer implementation of the renormalized coupled-cluster methods: the r-ccsd[t], r-ccsd(t), cr-ccsd[t], and cr-ccsd(t) approaches</article-title>
                <source>Comput Phys Commun</source>
                <year>2002</year>
                <volume>149</volume>
                <issue>2</issue>
                <fpage>71</fpage>
                <lpage>96</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD38XnvFyltL8%3D</pub-id>
                <pub-id pub-id-type="doi">10.1016/S0010-4655(02)00598-2</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR14">
              <label>14.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Piecuch</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Włoch</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Renormalized coupled-cluster methods exploiting left eigenstates of the similarity-transformed hamiltonian</article-title>
                <source>J Chem Phys</source>
                <year>2005</year>
                <volume>123</volume>
                <issue>22</issue>
                <fpage>224105</fpage>
                <lpage>224110</lpage>
                <pub-id pub-id-type="pmid">16375468</pub-id>
                <pub-id pub-id-type="doi">10.1063/1.2137318</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR15">
              <label>15.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Weigend</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Ahlrichs</surname>
                    <given-names>R</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Balanced basis sets of split valence, triple zeta valence and quadruple zeta valence quality for H to RN: design and assessment of accuracy</article-title>
                <source>Phys Chem Chem Phys</source>
                <year>2005</year>
                <volume>7</volume>
                <fpage>3297</fpage>
                <lpage>3305</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2MXpsFWgu7o%3D</pub-id>
                <pub-id pub-id-type="pmid">16240044</pub-id>
                <pub-id pub-id-type="doi">10.1039/b508541a</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR16">
              <label>16.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Schmidt</surname>
                    <given-names>MW</given-names>
                  </name>
                  <name>
                    <surname>Baldridge</surname>
                    <given-names>KK</given-names>
                  </name>
                  <name>
                    <surname>Boatz</surname>
                    <given-names>JA</given-names>
                  </name>
                  <name>
                    <surname>Elbert</surname>
                    <given-names>ST</given-names>
                  </name>
                  <name>
                    <surname>Gordon</surname>
                    <given-names>MS</given-names>
                  </name>
                  <name>
                    <surname>Jensen</surname>
                    <given-names>JH</given-names>
                  </name>
                  <name>
                    <surname>Koseki</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Matsunaga</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Nguyen</surname>
                    <given-names>KA</given-names>
                  </name>
                  <name>
                    <surname>Su</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Windus</surname>
                    <given-names>TL</given-names>
                  </name>
                  <name>
                    <surname>Dupuis</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Montgomery</surname>
                    <given-names>JA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">General atomic and molecular electronic structure system</article-title>
                <source>J Comput Chem</source>
                <year>1993</year>
                <volume>14</volume>
                <issue>11</issue>
                <fpage>1347</fpage>
                <lpage>1363</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK2cXhsFaqtQ%3D%3D</pub-id>
                <pub-id pub-id-type="doi">10.1002/jcc.540141112</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR17">
              <label>17.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Gordon</surname>
                    <given-names>MS</given-names>
                  </name>
                  <name>
                    <surname>Schmidt</surname>
                    <given-names>MW</given-names>
                  </name>
                </person-group>
                <person-group person-group-type="editor">
                  <name>
                    <surname>Dykstra</surname>
                    <given-names>CE</given-names>
                  </name>
                  <name>
                    <surname>Frenking</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Kim</surname>
                    <given-names>KS</given-names>
                  </name>
                  <name>
                    <surname>Scuseria</surname>
                    <given-names>GE</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Advances in electronic structure theory: GAMESS a decade later</article-title>
                <source>Theory and applications of computational chemistry: the first forty years</source>
                <year>2005</year>
                <publisher-loc>Amsterdam</publisher-loc>
                <publisher-name>Elsevier</publisher-name>
                <fpage>1167</fpage>
                <lpage>1189</lpage>
                <pub-id pub-id-type="doi">10.1016/B978-044451719-7/50084-6</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR18">
              <label>18.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Møller</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Plesset</surname>
                    <given-names>MS</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Note on an approximation treatment for many-electron systems</article-title>
                <source>Phys Rev</source>
                <year>1934</year>
                <volume>46</volume>
                <issue>7</issue>
                <fpage>618</fpage>
                <lpage>622</lpage>
                <pub-id pub-id-type="doi">10.1103/PhysRev.46.618</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR19">
              <label>19.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Boys</surname>
                    <given-names>SF</given-names>
                  </name>
                  <name>
                    <surname>Bernardi</surname>
                    <given-names>F</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The calculation of small molecular interactions by the differences of separate total energies. Some procedures with reduced errors</article-title>
                <source>Mol Phys</source>
                <year>1970</year>
                <volume>19</volume>
                <issue>4</issue>
                <fpage>553</fpage>
                <lpage>566</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2sXht1alt7fM</pub-id>
                <pub-id pub-id-type="doi">10.1080/00268977000101561</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR20">
              <label>20.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Hart</surname>
                    <given-names>PE</given-names>
                  </name>
                  <name>
                    <surname>Nilsson</surname>
                    <given-names>NJ</given-names>
                  </name>
                  <name>
                    <surname>Raphael</surname>
                    <given-names>B</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">A formal basis for the heuristic determination of minimum cost paths</article-title>
                <source>IEEE Trans Syst Sci Cybern</source>
                <year>1968</year>
                <volume>4</volume>
                <issue>2</issue>
                <fpage>100</fpage>
                <lpage>107</lpage>
                <pub-id pub-id-type="doi">10.1109/TSSC.1968.300136</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR21">
              <label>21.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Bodlaender</surname>
                    <given-names>HL</given-names>
                  </name>
                  <name>
                    <surname>Koster</surname>
                    <given-names>AMCA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Treewidth computations i. Upper bounds</article-title>
                <source>Inf Comput</source>
                <year>2010</year>
                <volume>208</volume>
                <issue>3</issue>
                <fpage>259</fpage>
                <lpage>275</lpage>
                <pub-id pub-id-type="doi">10.1016/j.ic.2009.03.008</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR22">
              <label>22.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Halgren</surname>
                    <given-names>TA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Merck molecular force field. i. Basis, form, scope, parameterization, and performance of MMFF94</article-title>
                <source>J Comput Chem</source>
                <year>1996</year>
                <volume>17</volume>
                <issue>5–6</issue>
                <fpage>490</fpage>
                <lpage>519</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK28XhvVGmsbk%3D</pub-id>
                <pub-id pub-id-type="doi">10.1002/(SICI)1096-987X(199604)17:5/6&lt;490::AID-JCC1>3.0.CO;2-P</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR23">
              <label>23.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Goto</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Okuno</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Hattori</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Nishioka</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Kanehisa</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Ligand: database of chemical compounds and reactions in biological pathways</article-title>
                <source>Nucleic Acids Res</source>
                <year>2002</year>
                <volume>30</volume>
                <issue>1</issue>
                <fpage>402</fpage>
                <lpage>404</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD38Xht12rsbc%3D</pub-id>
                <pub-id pub-id-type="pmid">11752349</pub-id>
                <pub-id pub-id-type="pmcid">99090</pub-id>
                <pub-id pub-id-type="doi">10.1093/nar/30.1.402</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR24">
              <label>24.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Hattori</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Okuno</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Goto</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Kanehisa</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Development of a chemical structure comparison method for integrated analysis of chemical and genomic information in the metabolic pathways</article-title>
                <source>J Am Chem Soc</source>
                <year>2003</year>
                <volume>125</volume>
                <issue>39</issue>
                <fpage>11853</fpage>
                <lpage>11865</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3sXnt1Knuro%3D</pub-id>
                <pub-id pub-id-type="pmid">14505407</pub-id>
                <pub-id pub-id-type="doi">10.1021/ja036030u</pub-id>
                <comment>PMID: 14505407</comment>
              </mixed-citation>
            </ref>
            <ref id="CR25">
              <label>25.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Hildebrandt</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Dehof</surname>
                    <given-names>AK</given-names>
                  </name>
                  <name>
                    <surname>Rurainski</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Bertsch</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Schumann</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Toussaint</surname>
                    <given-names>NC</given-names>
                  </name>
                  <name>
                    <surname>Moll</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Stöckel</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Nickels</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Mueller</surname>
                    <given-names>SC</given-names>
                  </name>
                  <name>
                    <surname>Lenhof</surname>
                    <given-names>H-P</given-names>
                  </name>
                  <name>
                    <surname>Kohlbacher</surname>
                    <given-names>O</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Ball-biochemical algorithms library 1.3</article-title>
                <source>BMC Bioinf</source>
                <year>2010</year>
                <volume>11</volume>
                <issue>1</issue>
                <fpage>531</fpage>
                <pub-id pub-id-type="doi">10.1186/1471-2105-11-531</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR26">
              <label>26.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Zhang</surname>
                    <given-names>Q</given-names>
                  </name>
                  <name>
                    <surname>Zhang</surname>
                    <given-names>W</given-names>
                  </name>
                  <name>
                    <surname>Li</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Wang</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Zhang</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Hou</surname>
                    <given-names>T</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">A rule-based algorithm for automatic bond type perception</article-title>
                <source>J Cheminf</source>
                <year>2012</year>
                <volume>4</volume>
                <issue>1</issue>
                <fpage>26</fpage>
                <pub-id pub-id-type="doi">10.1186/1758-2946-4-26</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR27">
              <label>27.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Urbaczek</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Kolodzik</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Groth</surname>
                    <given-names>I</given-names>
                  </name>
                  <name>
                    <surname>Heuser</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Rarey</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Reading pdb: perception of molecules from 3D atomic coordinates</article-title>
                <source>J Chem Inf Model</source>
                <year>2013</year>
                <volume>53</volume>
                <issue>1</issue>
                <fpage>76</fpage>
                <lpage>87</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC38Xhslansr7K</pub-id>
                <pub-id pub-id-type="pmid">23176552</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci300358c</pub-id>
                <comment>PMID: 23176552</comment>
              </mixed-citation>
            </ref>
            <ref id="CR28">
              <label>28.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Zhao</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Cheng</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Wang</surname>
                    <given-names>R</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Automatic perception of organic molecules based on essential structural information</article-title>
                <source>J Chem Inf Model</source>
                <year>2007</year>
                <volume>47</volume>
                <issue>4</issue>
                <fpage>1379</fpage>
                <lpage>1385</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2sXlvVWjs7Y%3D</pub-id>
                <pub-id pub-id-type="pmid">17530839</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci700028w</pub-id>
                <comment>PMID: 17530839</comment>
              </mixed-citation>
            </ref>
            <ref id="CR29">
              <label>29.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Kadukova</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Grudinin</surname>
                    <given-names>S</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Knodle: a support vector machines-based automatic perception of organic molecules from 3D coordinates</article-title>
                <source>J Chem Inf Model</source>
                <year>2016</year>
                <volume>56</volume>
                <issue>8</issue>
                <fpage>1410</fpage>
                <lpage>1419</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC28XhtFGjs7jN</pub-id>
                <pub-id pub-id-type="pmid">27405533</pub-id>
                <pub-id pub-id-type="doi">10.1021/acs.jcim.5b00512</pub-id>
                <comment>PMID: 27405533</comment>
              </mixed-citation>
            </ref>
          </ref-list>
        </ref-list>
        <app-group>
          <app id="App1">
            <sec id="Sec19">
              <title>Additional file</title>
              <p>
                <supplementary-material content-type="local-data" id="MOESM1" xlink:title="Additional file">
                  <media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/13321_2019_340_MOESM1_ESM.pdf" position="anchor">
                    <caption xml:lang="en">
                      <p><bold>Additional file 1.</bold> Calculated atom and bond score tables, and canonical SMILES strings of the test molecules.</p>
                    </caption>
                  </media>
                </supplementary-material>
              </p>
            </sec>
          </app>
        </app-group>
      </back>
    </article>
