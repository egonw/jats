<?xml version="1.0"?>
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="research-article" xml:lang="en">
      <?properties open_access?>
      <front>
        <journal-meta>
          <journal-id journal-id-type="publisher-id">13321</journal-id>
          <journal-title-group>
            <journal-title>Journal of Cheminformatics</journal-title>
            <abbrev-journal-title abbrev-type="publisher">J Cheminform</abbrev-journal-title>
          </journal-title-group>
          <issn pub-type="epub">1758-2946</issn>
          <publisher>
            <publisher-name>Springer International Publishing</publisher-name>
            <publisher-loc>Cham</publisher-loc>
          </publisher>
        </journal-meta>
        <article-meta>
          <article-id pub-id-type="publisher-id">s13321-019-0389-9</article-id>
          <article-id pub-id-type="manuscript">389</article-id>
          <article-id pub-id-type="doi">10.1186/s13321-019-0389-9</article-id>
          <article-categories>
            <subj-group subj-group-type="heading">
              <subject>Research Article</subject>
            </subj-group>
          </article-categories>
          <title-group>
            <article-title xml:lang="en">A multiple classifier system identifies novel cannabinoid CB2 receptor ligands</article-title>
          </title-group>
          <contrib-group>
            <contrib contrib-type="author" id="Au1">
              <name>
                <surname>Ruano-Ordás</surname>
                <given-names>David</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="aff" rid="Aff2">2</xref>
              <xref ref-type="aff" rid="Aff3">3</xref>
              <xref ref-type="aff" rid="Aff4">4</xref>
              <xref ref-type="aff" rid="Aff5">5</xref>
            </contrib>
            <contrib contrib-type="author" id="Au2">
              <name>
                <surname>Burggraaff</surname>
                <given-names>Lindsey</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff6">6</xref>
            </contrib>
            <contrib contrib-type="author" id="Au3">
              <name>
                <surname>Liu</surname>
                <given-names>Rongfang</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff6">6</xref>
            </contrib>
            <contrib contrib-type="author" id="Au4">
              <name>
                <surname>van der Horst</surname>
                <given-names>Cas</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff6">6</xref>
            </contrib>
            <contrib contrib-type="author" id="Au5">
              <name>
                <surname>Heitman</surname>
                <given-names>Laura H.</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff6">6</xref>
            </contrib>
            <contrib contrib-type="author" id="Au6">
              <name>
                <surname>Emmerich</surname>
                <given-names>Michael T. M.</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff6">6</xref>
            </contrib>
            <contrib contrib-type="author" id="Au7">
              <name>
                <surname>Mendez</surname>
                <given-names>Jose R.</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="aff" rid="Aff2">2</xref>
              <xref ref-type="aff" rid="Aff4">4</xref>
            </contrib>
            <contrib contrib-type="author" id="Au8">
              <name>
                <surname>Yevseyeva</surname>
                <given-names>Iryna</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff5">5</xref>
            </contrib>
            <contrib contrib-type="author" corresp="yes" id="Au9">
              <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0717-1817</contrib-id>
              <name>
                <surname>van Westen</surname>
                <given-names>Gerard J. P.</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff6">6</xref>
              <xref ref-type="corresp" rid="IDs1332101903899_cor9">j</xref>
            </contrib>
            <aff id="Aff1">
              <label>1</label>
              <institution-wrap>
                <institution-id institution-id-type="ISNI">0000 0001 2097 6738</institution-id>
                <institution-id institution-id-type="GRID">grid.6312.6</institution-id>
                <institution content-type="org-division">Department of Computer Science</institution>
                <institution content-type="org-name">University of Vigo, ESEI - Escuela Superior de Ingeniería Informática</institution>
              </institution-wrap>
              <addr-line content-type="street">Edificio Politécnico, Campus Universitario As Lagoas s/n</addr-line>
              <addr-line content-type="postcode">32004</addr-line>
              <addr-line content-type="city">Ourense</addr-line>
              <country country="ES">Spain</country>
            </aff>
            <aff id="Aff2">
              <label>2</label>
              <institution-wrap>
                <institution-id institution-id-type="ISNI">0000 0001 2097 6738</institution-id>
                <institution-id institution-id-type="GRID">grid.6312.6</institution-id>
                <institution content-type="org-division">CINBIO - Biomedical Research Centre</institution>
                <institution content-type="org-name">University of Vigo</institution>
              </institution-wrap>
              <addr-line content-type="street">Campus Universitario Lagoas-Marcosende</addr-line>
              <addr-line content-type="postcode">36310</addr-line>
              <addr-line content-type="city">Vigo</addr-line>
              <country country="ES">Spain</country>
            </aff>
            <aff id="Aff3">
              <label>3</label>
              <institution-wrap>
                <institution-id institution-id-type="ISNI">0000 0001 2312 1970</institution-id>
                <institution-id institution-id-type="GRID">grid.5132.5</institution-id>
                <institution content-type="org-division">Multicriteria Optimization and Decision Analysis (MODA) Research Group, LIACS</institution>
                <institution content-type="org-name">Leiden University</institution>
              </institution-wrap>
              <addr-line content-type="street">Niels Bohrweg 1</addr-line>
              <addr-line content-type="postcode">2333-CA</addr-line>
              <addr-line content-type="city">Leiden</addr-line>
              <country country="NL">The Netherlands</country>
            </aff>
            <aff id="Aff4">
              <label>4</label>
              <institution-wrap>
                <institution content-type="org-division">SING Research Group</institution>
                <institution content-type="org-name">Galicia Sur Health Research Institute (IIS Galicia Sur), SERGAS-UVIGO</institution>
              </institution-wrap>
              <addr-line content-type="city">Vigo</addr-line>
              <country country="ES">Spain</country>
            </aff>
            <aff id="Aff5">
              <label>5</label>
              <institution-wrap>
                <institution-id institution-id-type="ISNI">0000 0001 2153 2936</institution-id>
                <institution-id institution-id-type="GRID">grid.48815.30</institution-id>
                <institution content-type="org-division">School of Computer Science and Informatics</institution>
                <institution content-type="org-name">De Montfort University</institution>
              </institution-wrap>
              <addr-line content-type="street">The Gateway</addr-line>
              <addr-line content-type="postcode">LE1 9BH</addr-line>
              <addr-line content-type="city">Leicester</addr-line>
              <country country="GB">UK</country>
            </aff>
            <aff id="Aff6">
              <label>6</label>
              <institution-wrap>
                <institution-id institution-id-type="ISNI">0000 0001 2312 1970</institution-id>
                <institution-id institution-id-type="GRID">grid.5132.5</institution-id>
                <institution content-type="org-division">Drug Discovery and Safety, LACDR</institution>
                <institution content-type="org-name">Leiden University</institution>
              </institution-wrap>
              <addr-line content-type="street">Einsteinweg 55</addr-line>
              <addr-line content-type="postcode">2333 CC</addr-line>
              <addr-line content-type="city">Leiden</addr-line>
              <country country="NL">The Netherlands</country>
            </aff>
          </contrib-group>
          <author-notes>
            <corresp id="IDs1332101903899_cor9">
              <label>j</label>
              <email>HIDDEN</email>
            </corresp>
          </author-notes>
          <pub-date date-type="pub" publication-format="electronic">
            <day>7</day>
            <month>11</month>
            <year>2019</year>
          </pub-date>
          <pub-date date-type="collection" publication-format="electronic">
            <month>12</month>
            <year>2019</year>
          </pub-date>
          <volume>11</volume>
          <issue seq="66">1</issue>
          <elocation-id>66</elocation-id>
          <history>
            <date date-type="registration">
              <day>23</day>
              <month>10</month>
              <year>2019</year>
            </date>
            <date date-type="received">
              <day>26</day>
              <month>4</month>
              <year>2019</year>
            </date>
            <date date-type="accepted">
              <day>23</day>
              <month>10</month>
              <year>2019</year>
            </date>
            <date date-type="online">
              <day>7</day>
              <month>11</month>
              <year>2019</year>
            </date>
          </history>
          <permissions>
            <copyright-statement content-type="compact">© The Author(s) 2019</copyright-statement>
            <copyright-year>2019</copyright-year>
            <copyright-holder>The Author(s)</copyright-holder>
            <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
              <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (http://creativecommons.org/publicdomain/zero/1.0/) applies to the data made available in this article, unless otherwise stated.</license-p>
            </license>
          </permissions>
          <abstract xml:lang="en" id="Abs1">
            <title>Abstract</title>
            <p id="Par1">Drugs have become an essential part of our lives due to their ability to improve people’s health and quality of life. However, for many diseases, approved drugs are not yet available or existing drugs have undesirable side effects, making the pharmaceutical industry strive to discover new drugs and active compounds. The development of drugs is an expensive process, which typically starts with the detection of candidate molecules (screening) after a protein target has been identified. To this end, the use of high-performance screening techniques has become a critical issue in order to palliate the high costs. Therefore, the popularity of computer-based screening (often called virtual screening or in silico screening) has rapidly increased during the last decade. A wide variety of Machine Learning (ML) techniques has been used in conjunction with chemical structure and physicochemical properties for screening purposes including (i) simple classifiers, (ii) ensemble methods, and more recently (iii) Multiple Classifier Systems (MCS). Here, we apply an MCS for virtual screening (D2-MCS) using circular fingerprints. We applied our technique to a dataset of cannabinoid CB2 ligands obtained from the ChEMBL database. The HTS collection of Enamine (1,834,362 compounds), was virtually screened to identify 48,232 potential active molecules using D2-MCS. Identified molecules were ranked to select 21 promising novel compounds for in vitro evaluation. Experimental validation confirmed six highly active hits (> 50% displacement at 10 µM and subsequent Ki determination) and an additional five medium active hits (> 25% displacement at 10 µM). Hence, D2-MCS provided a hit rate of 29% for highly active compounds and an overall hit rate of 52%.</p>
          </abstract>
          <kwd-group xml:lang="en">
            <title>Keywords</title>
            <kwd>Drug discovery</kwd>
            <kwd>Clustering methods</kwd>
            <kwd>Measure-guided methodology</kwd>
            <kwd>Multiple classifier systems</kwd>
          </kwd-group>
          <funding-group>
            <award-group>
              <funding-source>
                <institution-wrap>
                  <institution>Dutch Scientific Council (NWO)</institution>
                </institution-wrap>
              </funding-source>
              <award-id award-type="FundRef grant">VENI 14410</award-id>
              <principal-award-recipient>
                <name>
                  <surname>van Westen</surname>
                  <given-names>Gerard J. P.</given-names>
                </name>
              </principal-award-recipient>
            </award-group>
            <award-group>
              <funding-source>
                <institution-wrap>
                  <institution>Consellería de Educación, Universidades e Formación Profesional</institution>
                </institution-wrap>
              </funding-source>
              <award-id award-type="FundRef grant">ED431C2018/55-GRC</award-id>
            </award-group>
          </funding-group>
          <custom-meta-group>
            <custom-meta>
              <meta-name>publisher-imprint-name</meta-name>
              <meta-value>Springer</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-issue-count</meta-name>
              <meta-value>1</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-article-count</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-pricelist-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-holder</meta-name>
              <meta-value>The Author(s)</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-contains-esm</meta-name>
              <meta-value>Yes</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-month</meta-name>
              <meta-value>10</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-day</meta-name>
              <meta-value>23</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-product</meta-name>
              <meta-value>ArchiveJournal</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-grants-type</meta-name>
              <meta-value>OpenChoice</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>metadata-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>abstract-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodypdf-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodyhtml-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bibliography-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>esm-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>online-first</meta-name>
              <meta-value>false</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-file-reference</meta-name>
              <meta-value>BodyRef/PDF/13321_2019_Article_389.pdf</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>target-type</meta-name>
              <meta-value>OnlinePDF</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-type</meta-name>
              <meta-value>OriginalPaper</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-primary</meta-name>
              <meta-value>Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computer Applications in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Documentation and Information in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Theoretical and Computational Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computational Biology/Bioinformatics</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-collection</meta-name>
              <meta-value>Chemistry and Materials Science</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>open-access</meta-name>
              <meta-value>true</meta-value>
            </custom-meta>
          </custom-meta-group>
        </article-meta>
      </front>
      <body>
        <sec id="Sec1">
          <title>Introduction</title>
          <p id="Par13">In silico (or computational) drug discovery relies on different computer-based techniques to find a novel or improved bio-active compound, which should exhibit a strong affinity to a particular target. Although in silico screening is present in the drug development process since the beginning of 90s [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], its relevance has been progressively increasing until becoming an essential part of the drug-development process. This fact was mainly motivated by (i) a significant improvement in the performance of computer systems, (ii) the introduction of novel algorithms and more expressive molecular descriptors, and (iii) the advent of large-scale public bioactivity databases [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
          <p id="Par14">Limited processing capabilities of computer systems during the 90s led to in silico screening mainly focused on (i) building simple mathematical modelling approaches (often implemented as cellular automatons) for large-scale simulations of complex systems [<xref ref-type="bibr" rid="CR4">4</xref>], (ii) the development of large scale databases enabling researchers to easily store and access the information [<xref ref-type="bibr" rid="CR2">2</xref>], and (iii) the design of (affinity) fingerprints as novel descriptors for similarity searches in molecular databases and QSAR analyses [<xref ref-type="bibr" rid="CR5">5</xref>]. As computers’ performance increased, the use of simple Machine Learning (ML) classification schemes for screening purposes became popular. Concretely, the usage of support vector machines (SVM) [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>], Decision Trees (DT) [<xref ref-type="bibr" rid="CR8">8</xref>], Naïve Bayes [<xref ref-type="bibr" rid="CR9">9</xref>], K-Nearest Neighbors (KNN) [<xref ref-type="bibr" rid="CR10">10</xref>], Artificial Neural Networks [<xref ref-type="bibr" rid="CR11">11</xref>] and Self Organizing Maps (SOM) [<xref ref-type="bibr" rid="CR12">12</xref>] were widely applied in the domain.</p>
          <p id="Par15">However, during the last decade the amount of public information available for screening has increased rapidly with the introduction of resources such as ChEMBL or PubChem [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. This fact had a negative impact on the performance of simple ML approaches due to their trend to build unstable classification models when handling a high volume of information. In order to improve the predictive performance, ML models were equipped with multiple layers (stacking, deep learning) or identical ML algorithms were combined (ensemble of classifiers [<xref ref-type="bibr" rid="CR14">14</xref>]). Specifically, Lenselink et al. [<xref ref-type="bibr" rid="CR15">15</xref>] demonstrate the suitability of using of Deep Neural Networks (DNN) [<xref ref-type="bibr" rid="CR16">16</xref>] and Random Forests (RF) [<xref ref-type="bibr" rid="CR17">17</xref>] methods against single ML models (such as Naïve Bayes or SVM) to predict the bioactivity of molecules. Additionally, recent work [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>] applied several Boosting (such as AdaBoost or MultiBoost) and Fuzzy Forest approaches to predict (i) bioactivity of molecules and (ii) toxicity of non-congeneric industrial chemicals, respectively.</p>
          <p id="Par16">The usage of above-mentioned ensembling methods contributed to significant performance improvements in the virtual screening domain. However, their introduction also brought about some important shortcomings such as: (i) the random selection of the information often used to build each inner classifier, (ii) the common usage of weak classifiers such as C4.5 or Decision Stumps to build up the classifier ensemble (although any ML classifier can be used) and, (iii) the impossibility combining different inner classifiers and configurations for them with concrete subsets of training information. These limitations are implicit to the definition of ensemble classifiers and are the key features to distinguish them against a great number of methods included in the Multiple Classifier Systems (MCS) [<xref ref-type="bibr" rid="CR20">20</xref>] group. Wozniak et al. [<xref ref-type="bibr" rid="CR20">20</xref>] revealed interesting features of MCS, including (i) their good performance when working in extreme situations such as scarcity of samples or information overload, (ii) their ability to outperform inner individual classifiers, (iii) the increase of the probability of finding an optimal model, and (iv) the reduction of the information (and hence the increase in the performance and speed) used to build each inner classifier. Keeping into account the above-mentioned issues we apply an MCS toolkit (called D2-MCS [<xref ref-type="bibr" rid="CR21">21</xref>]) to increase the performance of virtual screening.</p>
        </sec>
        <sec id="Sec2" sec-type="methods">
          <title>Methods</title>
          <p id="Par17">This section evaluates the suitability of using D2-MCS and its application in drug discovery domain. It also introduces the dataset and measures used to perform the experimental protocol. Finally, the methodology performed to carry out the virtual screening process is explained in detail.</p>
          <sec id="Sec3">
            <title>Datasets</title>
            <sec id="Sec4">
              <title>CB2 dataset</title>
              <p id="Par18">The data was gathered from ChEMBL version 22 based on UniProt accession P34972 [<xref ref-type="bibr" rid="CR3">3</xref>]. The activity data were filtered for potential duplicates, no activity or data validity comments were allowed, and only data from binding assays with a pChEMBL value was kept. This led to 3925 compounds. Subsequently, compound fingerprints (FCFP_6) and physicochemical properties were calculated (see Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>) [<xref ref-type="bibr" rid="CR22">22</xref>]. No standardization was performed as the data was obtained from ChEMBL who include several curation steps before loading the molecules. The FCFP_6 fingerprints properties were computed using the fingerprints to properties component from Pipeline Pilot Version 2016.1.0 [<xref ref-type="bibr" rid="CR23">23</xref>]; 2048 substructures/bits were selected based on their occurrence frequency in the data set [<xref ref-type="bibr" rid="CR23">23</xref>]. A presence of 50% was the optimum frequency. Thereby, significant under- and over-representation were both avoided. In addition, Pipeline Pilot was also used to calculate the physicochemical properties [<xref ref-type="bibr" rid="CR23">23</xref>]. Finally, the set was made into a binary classification set where the activity cut-off was set at a pChEMBL value > 7 for active compounds and written to a tab-delimited text file using the InChiKey as unique identifier [<xref ref-type="bibr" rid="CR24">24</xref>]. The final set contained 1977 active compounds and 1948 inactive compounds (CB2Set, supporting information [<xref ref-type="bibr" rid="CR25">25</xref>]). The obtained dataset includes 2133 attributes (84 physicochemical properties, 2048 chemical-structure features and the activity class) to describe 3925 compounds (instances). Table <xref rid="Tab1" ref-type="table">1</xref> shows the codification of each feature grouped by type.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Feature characteristics and codification</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Feature type</p></th><th align="left"><p>Feature values</p></th><th align="left"><p>No of features</p></th></tr></thead><tbody><tr><td align="left"><p>Chemical substructure fingerprints</p></td><td align="left"><p>Binary</p></td><td char="." align="char"><p>2048</p></td></tr><tr><td align="left" rowspan="2"><p>Physicochemical descriptors</p></td><td align="left"><p>Discrete values</p></td><td char="." align="char"><p>50</p></td></tr><tr><td align="left"><p>Continuous values</p></td><td char="." align="char"><p>34</p></td></tr><tr><td align="left" colspan="2"><p>Total</p></td><td char="." align="char"><p>2132</p></td></tr></tbody></table></table-wrap></p>
              <p id="Par19">As can be observed from Table <xref rid="Tab1" ref-type="table">1</xref> each chemical substructure is codified using a binary representation to indicate its presence (1) or absence (0) for each chemical compound. Additionally, the physicochemical descriptors consist of continuous or discrete values depending on the descriptor type and metric representation.</p>
            </sec>
            <sec id="Sec5">
              <title>Validation dataset</title>
              <p id="Par20">The high-throughput screening (HTS) set was downloaded from the Enamine website (containing 1,834,362 compounds without class information). Molecules were standardized to make them compatible to ChEMBL data and encoded using the same feature representation as was used for the CB2 dataset (2048 chemical substructure fingerprints and 84 physicochemical descriptors). This set will be referred to as ValidationSet.</p>
            </sec>
          </sec>
          <sec id="Sec6">
            <title>Evaluation measures</title>
            <p id="Par21">Quite a few performance measures for assessing the accuracy and rank of different classification approaches exist in the drug discovery domain. Concretely, we select Matthews Correlation Coefficient (MCC) [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>] and the Positive Predictive Value (PPV) [<xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref>] measures due to their demonstrated ability to minimize false negatives (FN) and false positives (FP) errors respectively.</p>
            <p id="Par22">MCC is a performance measure designed for binary classifiers that can be used in the case of imbalanced datasets (the distribution of instances in the classes is uneven). MCC can be easily computed from the values of the confusion matrix results (true positives or TP, true negatives or TN, false positives or FP and false negatives or FN) by using Eq. <xref rid="Equ1" ref-type="disp-formula">1</xref>.<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:mi>M</mml:mi><mml:mi>C</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>×</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo>×</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:msqrt><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>F</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ MCC = \frac{TP \times TN - FP \times FN}{{\sqrt {\left( {TP + FP} \right) \times \left( {FN + TN} \right) \times \left( {FP + TN} \right) \times \left( {TP + FN} \right)} }} $$\end{document}</tex-math><graphic position="anchor" xlink:href="13321_2019_389_Article_Equ1.gif" /></alternatives></disp-formula></p>
            <p id="Par23">MCC is defined in the interval [− 1,1], where 1 stand for no classification errors, −1 means that all input instances were misclassified (inverse) and 0 reveals that the classification was absolutely uncorrelated with the real truth (random). As can be extrapolated from Eq. <xref rid="Equ1" ref-type="disp-formula">1</xref>, achieving a balanced number of positive and negative classification hits is mandatory to obtain higher MCC values. Additionally, the inclusion of the four quantiles (TP, TN, FP and FN) in the MCC formula allows giving a better summary of the performance of classification algorithms regarding other well-known metrics (such as Accuracy [<xref ref-type="bibr" rid="CR31">31</xref>] or F1-Score [<xref ref-type="bibr" rid="CR32">32</xref>]). The benefits of using MCC against other well-known measures commonly used to evaluate ML approaches in the health domain has been demonstrated by Chicco [<xref ref-type="bibr" rid="CR33">33</xref>].</p>
            <p id="Par24">From another perspective, PPV is a well-known measure in the drug discovery domain due to its ability to assess the probability of having a positive outcome given a positive classification (also called a posteriori probability). Thus, PPV is an interesting measure since testing an inactive molecule (due to an FP error) is expensive [<xref ref-type="bibr" rid="CR34">34</xref>]. The PPV can be computed by combining values included in the confusion matrix as defined by Eq. <xref rid="Equ2" ref-type="disp-formula">2</xref>.<disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:mi>P</mml:mi><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ PPV = \frac{TP}{TP + FP} $$\end{document}</tex-math><graphic position="anchor" xlink:href="13321_2019_389_Article_Equ2.gif" /></alternatives></disp-formula></p>
            <p id="Par25">As could be noted, PPV is not able to accurately handle most situations if used in isolation. In fact, a classifier could reach the maximum PPV score by identifying only one active molecule. With regard to this, over a balanced dataset where the probability of finding one active molecule is ½, a classifier could randomly select one instance to classify it as active and assign the inactive label to the remaining ones. This classifier could achieve a PPV score of one in half of the experiments (those which the instance classified as Active was really Active). Therefore, PPV needs to be accompanied by other performance indicators, such as MCC.</p>
          </sec>
          <sec id="Sec7">
            <title>Modelling</title>
            <p id="Par26">To build our classification software we use D2-MCS due to its ability to easily build high-performance in silico screening models [<xref ref-type="bibr" rid="CR21">21</xref>]. D2-MCS is an R-based toolkit that provides an efficient and flexible MCS mechanism that can be highly customized to ensure an adequate adaptation to the intrinsic characteristics of the target dataset. Particularly, D2-MCS is able to handle high dimensional datasets by grouping the features of molecules (dataset columns) into several groups (called feature-clusters) according to user-defined criteria (i.e. type of chemical compounds, molecular weight, etc.). Then, for each feature-cluster, the toolkit is able to automatically determine the most suitable classifier (simple or ensemble) together with its best configuration. According to this information, D2-MCS builds a set of classifiers (one per feature cluster) whose outputs will be combined to generate a single solution. The set of selected trained classifiers (one for each dataset part) together with a voting system comprises a whole D2-MCS instance. Figure <xref rid="Fig1" ref-type="fig">1</xref> shows a global overview of the D2-MCS operation.<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>Structure and functionality of the D2-MCS toolkit. D2-MCS builds a set of classifiers (one per feature cluster) whose outputs will be combined to generate a single solution. The set of selected trained classifiers (one for each dataset part) together with a voting system comprises a whole D2-MCS instance</p></caption><graphic specific-use="HTML" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_389_Fig1_HTML.png" /></fig></p>
            <p id="Par27">As shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, D2-MCS operation is divided into three different stages. The first stage (called FEATURE CLUSTERING in Fig. <xref rid="Fig1" ref-type="fig">1</xref>) comprises the partitioning of training information based on a specific feature-clustering algorithm. Although D2-MCS provides by default several clustering methods (Fisher, Information Gain, etc.), it also allows users to define customized feature clustering methods in order to increase its compatibility regardless of the way of representing or encoding the information.</p>
            <p id="Par28">During the MCS BUILDING stage, for each split of the original dataset, D2-MCS is able to detect the most effective classifier (and its best configuration) from a wide variety of ML techniques (up to 236 different classifiers from 47 families [<xref ref-type="bibr" rid="CR35">35</xref>]). The best classifiers for each knowledge partition together with their optimal configurations are compiled together to act as a set of individual experts whose outputs should be combined to generate a final result.</p>
            <p id="Par29">Then, the third stage (see SCREENING part in Fig. <xref rid="Fig1" ref-type="fig">1</xref>) is the screening of molecules by combining the outputs of the classifiers selected in the previous stage. To this end, D2-MCS implements two simple methods to combine the outputs of inner classifiers and provides an API to easily define new output aggregator methods [<xref ref-type="bibr" rid="CR21">21</xref>]. The implemented methods are: (i) a simple majority voting system where the final class is the one obtaining more than half of the votes and (ii) a weighted majority voting where the winner is the class achieving the highest overall value.</p>
          </sec>
          <sec id="Sec8">
            <title>Probabilistic-based ranking methodology</title>
            <p id="Par30">Due to the large number of molecules included in the validation dataset (1,834,362), the set of compounds classified as active by D2-MCS model will probably be large. A full in vitro evaluation of all these molecules is infeasible (costs, human resources, time). Hence, we designed a 3-stage probabilistic-based ranking method to select the most promising compounds from the ones receiving a positive classification. As can be seen in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, the first stage is responsible for compiling the class probability of each compound tagged as Active (48,232) from all inner individual classifiers included in the Minimize FP model (a D2-MCS model comprising 3 classifiers for optimizing PPV and another one with 3 inner models for MCC). As can be depicted from stage 1 in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, the achieved probabilities are always greater than 0.5 since only compounds previously labelled as Active (Active > 0.5, Inactive ≤ 0.5) were selected.<fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>Workflow of three-stage potential candidate ranker methodology. Our ranking methodology comprised three main stages: (i) class probability estimator, (ii) global relevance calculator and (iii) relevance sorter</p></caption><graphic specific-use="HTML" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_389_Fig2_HTML.png" /></fig></p>
            <p id="Par31">Once all probabilities are obtained, during the second stage we compute the global relevance (denoted as <inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:mi>Θ</mml:mi></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \varTheta $$\end{document}</tex-math><inline-graphic xlink:href="13321_2019_389_Article_IEq1.gif" /></alternatives></inline-formula> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>) of each candidate as a mathematical product of all its probabilities (see Eq. <xref rid="Equ3" ref-type="disp-formula">3</xref>).<disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:mi>Θ</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="italic">numcluster</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \varTheta = \prod\limits_{i = 1}^{numcluster} {C_{i} } $$\end{document}</tex-math><graphic position="anchor" xlink:href="13321_2019_389_Article_Equ3.gif" /></alternatives></disp-formula>where <italic>numcluster</italic> stands form the number of clusters comprising the used meta-model.</p>
            <p id="Par33">Combining these probabilities using the product operator allows achieving a wide variety of output values (and thereby improves compatibility) even when individual input values are very close. As an example, given two vectors of values [0.75, 0.75, 0.6], [0.6, 0.9, 0.6], the product operator (<inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:mi>Π</mml:mi></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \varPi $$\end{document}</tex-math><inline-graphic xlink:href="13321_2019_389_Article_IEq2.gif" /></alternatives></inline-formula>) is able to achieve 0.337 and 0.324 respectively, while the summation (<inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:mi>Σ</mml:mi></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \varSigma $$\end{document}</tex-math><inline-graphic xlink:href="13321_2019_389_Article_IEq3.gif" /></alternatives></inline-formula>) and the arithmetic mean (<inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \bar{\rm X} $$\end{document}</tex-math><inline-graphic xlink:href="13321_2019_389_Article_IEq4.gif" /></alternatives></inline-formula>) obtain the same values for both vectors (2.1 and 0.7 respectively). Finally, the third stage entails the arrangement of the chemical compounds by descendant according to its global relevance value (<inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:mi>Θ</mml:mi></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \varTheta $$\end{document}</tex-math><inline-graphic xlink:href="13321_2019_389_Article_IEq5.gif" /></alternatives></inline-formula>). This ensures that the best candidates are placed in the initial positions.</p>
          </sec>
          <sec id="Sec9">
            <title>Chemical clustering</title>
            <p id="Par34">After virtual screening a further reduction of hits is required to ensure a chemically diverse set of prospective ligands for in vitro testing. Compounds identified as active by D2-MCS classifier were clustered based on the same binary features (FCFP_6) that were used for model training using the cluster molecules component in Pipeline Pilot version 2016 [<xref ref-type="bibr" rid="CR23">23</xref>]. An average cluster population of 20 was selected and the maximum Tanimoto distance between the cluster center and members was set at 0.35 (forcing a similarity of > 0.65 within clusters). This additional requirement increases the number of clusters and thus leads to a lower number of compounds on average per cluster than the target average. However, the clusters resulting are chemically more conserved.</p>
          </sec>
          <sec id="Sec10">
            <title>In vitro experimental techniques</title>
            <sec id="Sec11">
              <title>Cell culture and membrane preparation</title>
              <p id="Par35">CHOK1hCB2_bgal cells (DiscoverRx, Fremont, CA, USA) were cultured in Dulbecco’s Modified Eagle’s Medium/Nutrient Mixture F-12 Ham supplemented with 10% fetal calf serum, 1 mM glutamine, 50 µg/mL penicillin, 50 µg/mL streptomycin, 300 mg/mL hygromycin and 800 µg/mL geneticin in a humidified atmosphere at 37 °C and 5% CO<sub>2</sub>. Cells were subcultured twice a week at a ratio of 1:20 on 10-cm diameter plates by trypsinization. For membrane preparation, the cells were subcultured with a ratio of 1:10 and transferred to 15-cm diameter plates. The cells were collected by scraping in 5 mL phosphate-buffered saline (PBS) and centrifuged at 1000 g for 5 min. Pellets derived from 30 plates were combined and resuspended in 20 mL cold Tris–HCl, MgCl<sub>2</sub> buffer (50 mM Tris–HCl (pH 7.4), 5 mM MgCl<sub>2</sub>). The cell suspension was homogenized using an UltraTurrax homogenizer (Heidolph Instruments Schwabach, Germany). Membranes and cytosolic fractions were separated by centrifugation in a Beckman Optima LE-80 K ultracentrifuge (Beckman Coulter Inc., Fullerton, CA, USA) at 100,000 g for 20 min at 4 °C. The supernatant was discarded. The pellet was resuspended in 10 mL cold Tris–HCl, MgCl<sub>2</sub> buffer and homogenization and centrifugation steps were repeated. The membranes were resuspended in 10 mL cold Tris–HCl, MgCl<sub>2</sub> buffer. Aliquots of 50 µL were stored at -80 °C until further use. The protein concentration was determined using the Pierce™ BCA Protein Assay Kit (ThermoFisher Scientific, Waltham, MA, USA).</p>
            </sec>
            <sec id="Sec12">
              <title>[<sup>3</sup>H]CP55940 Displacement assay</title>
              <p id="Par36">[<sup>3</sup>H]CP55940 displacement assays on 96-well plates were performed in 50 mM Tris–HCl (pH 7.4), 5 mM MgCl2, and 0.1% BSA assay buffer. Membrane aliquots of CHOK1CB2_bgal containing 1.5 µg membrane protein were incubated at 25 °C for 2 h in the presence of ~ 1.5 nM [3H]CP55940 (specific activity 149 Ci/mmol; PerkinElmer, Waltham, MA). At first, all compounds were tested at a final concentration of 10 µM. When radioligand displacement was greater than 50%, full curves were recorded to determine the affinity (pKi) values of the compounds. Six different concentrations of the compounds were added by an HP D300 digital dispenser (Tecan Group Ltd, Männedorf, Switzerland). In order to determine the total binding, a control without test compound was included. Nonspecific binding was determined in the presence of 10 µM AM630. The total assay volume was 100 µL. The final concentration of DMSO was ≤ 0.25%. The incubation was terminated by rapid vacuum filtration through GF/C 96-well filter plates (PerkinElmer, Waltham, MA), to separate the bound and free radioligand, using a PerkinElmer Filtermate-harvester (PerkinElmer, Groningen, The Netherlands). Filters were subsequently washed twenty times with ice-cold assay buffer. The filter-bound radioactivity was determined by scintillation spectrometry using a Microbeta2<sup>®</sup> 2450 microplate counter (PerkinElmer, Boston, MA), after addition of 25 μl MicroScint 20 (PerkinElmer, Groningen, The Netherlands) and 3 h incubation.</p>
            </sec>
            <sec id="Sec13">
              <title>Data analysis</title>
              <p id="Par37">All experimental data were analyzed using GraphPad Prism 7 [<xref ref-type="bibr" rid="CR36">36</xref>]. The data were normalized to percentage specific radioligand binding, where the total binding is 100% and nonspecific binding is 0%. Nonlinear regression for one-site was used to determine the IC<sub>50</sub> values from the full curve [<sup>3</sup>H]CP55940 displacement assays. The pKi values were obtained using Eq. <xref rid="Equ4" ref-type="disp-formula">4</xref> proposed by Cheng-Prusoff [<xref ref-type="bibr" rid="CR37">37</xref>].<disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>50</mml:mn></mml:msub></mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mfenced close="]" open="["><mml:mi>L</mml:mi></mml:mfenced><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ K_{i} = \frac{{IC_{50} }}{{\left( {1 + \left( {\frac{\left[ L \right]}{{K_{D} }}} \right)} \right)}} $$\end{document}</tex-math><graphic position="anchor" xlink:href="13321_2019_389_Article_Equ4.gif" /></alternatives></disp-formula>where [L] is the exact concentration [<sup>3</sup>H]CP55940 determined per experiment and the K<sub>D</sub> is the dissociation constant of [<sup>3</sup>H]CP55940, which is 1.24 nM as determined by Soethoudt et al. [<xref ref-type="bibr" rid="CR37">37</xref>]. All data were obtained from three separate experiments performed in duplicate.</p>
            </sec>
          </sec>
        </sec>
        <sec id="Sec14" sec-type="results">
          <title>Results</title>
          <p id="Par39">This section presents the performance achieved by our method. To this end, we describe the D2-MCS configuration parameters used to generate the models. Then potential screening candidates were identified by executing the previous models over the Validation set. Consecutively, the screening candidates were ranked by executing our probabilistic-based ranking methodology. Finally, in vitro analysis was performed over the selected candidates to determine their real activity.</p>
          <sec id="Sec15">
            <title>D2-MCS configuration</title>
            <p id="Par40">In order to execute our experimentation, the dataset instances (rows) were randomly divided into four homogeneous and evenly sized groups. Figure <xref rid="Fig3" ref-type="fig">3</xref> represents the configuration of groups and their usage for: (i) executing feature clustering, (ii) building, optimizing and evaluating inner classifiers and (iii) execute a screening task for benchmark the whole D2-MCS.<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>CB2 dataset partitioning. The CB2 dataset instances (rows) were randomly divided into four homogeneous and evenly sized groups</p></caption><graphic specific-use="HTML" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_389_Fig3_HTML.png" /></fig></p>
            <p id="Par41">As shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, the first two groups were used to select an appropriate number of feature-clusters for D2-MCS. Then, the second and third groups were used to build the D2-MCS model (select the most appropriate classifier for each dataset partition, build classifiers, and optimize their configurations). Finally, the fourth group has been reserved to assess the performance of the final model.</p>
            <p id="Par42">As previously stated, during the first stage of D2-MCS process (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>) the original dataset is divided into several groups of non-repeated features. Although the latest version D2-MCS provides several feature-clustering algorithms, we used the same clustering method as used in [<xref ref-type="bibr" rid="CR21">21</xref>] (called <italic>MultiTypeFisherClustering</italic>) due to the good results achieved in this domain. Concretely, the experimentation carried out in [<xref ref-type="bibr" rid="CR21">21</xref>] demonstrated the suitability of dividing the features into three clusters.</p>
            <p id="Par43">Once the best clustering configuration is obtained (three clusters), the D2-MCS building stage is executed. In detail, this stage is responsible for determining the best ML models (and parameter configuration) for each cluster. Additionally, D2-MCS allows defining an objective function to customize the model parameter-optimization process. To follow the same criterion as previously commented, we use both PPV and MCC measures, which entails the generation of two different D2-MCS models (PPV-based and MCC-based).</p>
            <p id="Par44">Subsequently, in order to test the final performance both obtained models (PPV-based and MCC-based) were executed over the remaining dataset (see Group 4 in Fig. <xref rid="Fig1" ref-type="fig">1</xref>) composed by 982 instances (504 active and 478 inactive compounds). To compute the final class of each compound, the outputs of the inner classifiers included in each D2-MCS model are combined using a voting scheme where a compound is classified as Active whenever the number of positive outputs of each inner classifier is greater or equal than the negative ones. Conversely, the compound is classified as Inactive.</p>
            <p id="Par45">Following the same evaluation criteria used during the optimization stage, classification performance achieved in MCC (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a) and PPV (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b) scenarios were assessed using the same metric (MCC and PPV respectively). For each experimental configuration, we plotted a horizontal double arrow representing the final performance achieved during the test of the D2-MCS classifier. Additionally, for each cluster, we represent (as points) the performance achieved by the best classifier during the optimization/training stage. The graphical representation of D2-MCS performance (testing stage) also includes the numeric value represented (P) and the achieved confusion matrix (TP, TN, FP, and FN). Furthermore, the information about the best classifier for each cluster (optimization/training stage) specifies the numeric value represented (P) and the (greatest) classifier name (C).<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>Performance comparison plot for testing stage (represented as a double arrow). <bold>a</bold> Indicates the performance obtained using the MCC measure and <bold>b</bold> shows the performance obtained using the PPV measure. Also shown (represented as dots) the name of classifier achieving the best performance for each cluster (C) together with its performance value during the optimization/training stage (P)</p></caption><graphic specific-use="HTML" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_389_Fig4_HTML.png" /></fig></p>
            <p id="Par46">As shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, the performance achieved during the test stage slightly outperforms the individual outcomes obtained during the optimization stage. Additionally, the use of the MCC measure allows achieving a balanced number of misclassification errors (FP ≈ FN). Furthermore, from Fig. <xref rid="Fig4" ref-type="fig">4</xref>b it is easy to realize that using PPV as an objective function reduces the number of FP errors at expenses of increasing FN errors. Moreover, the D2-MCS classifier achieved better performance than simple ML models (see Additional file <xref ref-type="supplementary-material" rid="MOESM2">2</xref>).</p>
            <p id="Par47">Additionally, after performing a global overview of Fig. <xref rid="Fig4" ref-type="fig">4</xref> it can be conclude that: (i) D2-MCS can be used to build suitable measure-guided knowledge-generalization models, and (ii) it is important to use an adequate domain-oriented measure in order to minimize the number of misclassification errors. In fact, as can be seen in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, MCC based models achieve fewer error rates than the PPV measure (113 and 132 errors respectively). Despite this, the results are quite promising (the rate of correctly classified compounds is very high), although we are aware that can be increased even more by taking advantage of the intrinsic characteristics of D2-MCS.</p>
            <p id="Par48">In order to demonstrate this hypothesis, we generate two meta-models by combining the predictions achieved by the D2-MCS models trained using MCC and PPV measures (see Minimize FP and Minimize FN in Fig. <xref rid="Fig5" ref-type="fig">5</xref>). Concretely, Minimize FP is responsible for labeling the target compound as Active whenever is predicted as ‘Active’ by both D2-MCS models (PPV and MCC) while Minimize FN identifies the target compound as Active only if one of the D2-MCS models (PPV and MCC) predicts the compound as ‘Active’. For comparison purposes, both meta-models were executed over the same testing dataset (see Group 4 in Fig. <xref rid="Fig3" ref-type="fig">3</xref>) as used by primitive D2-MCS models (PPV-based and MCC-based).<fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p>Performance comparison achieved for Minimize FP and Minimize FN meta-models</p></caption><graphic specific-use="HTML" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_389_Fig5_HTML.png" /></fig></p>
            <p id="Par49">As can be seen in Fig. <xref rid="Fig5" ref-type="fig">5</xref>, both meta-models clearly improve the performance achieved by the primitive D2-MCS models. Focusing on the first approximation (Minimize FP), the performance is increased up to 21.3% (MCC) and 8.5% (PPV) regarding the original models optimized for MCC and PPV respectively. On the other hand, the second meta-model outperforms up to 7.9% (MCC) but decreases 2.9% (PPV) compared to the corresponding primitive models. The first approximation seems the most suitable alternative (best values of MCC, Accuracy, and PPV. The main reason for this circumstance can be easily explained through the confusion matrix described in Table <xref rid="Tab2" ref-type="table">2</xref>.<table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>Confusion matrix achieved for both configurations</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" /><th align="left"><p>TP</p></th><th align="left"><p>FP</p></th><th align="left"><p>TN</p></th><th align="left"><p>FN</p></th></tr></thead><tbody><tr><td align="left"><p>Minimize FP</p></td><td char="." align="char"><p>474</p></td><td char="." align="char"><p>3</p></td><td char="." align="char"><p>475</p></td><td char="." align="char"><p>30</p></td></tr><tr><td align="left"><p>Minimize FN</p></td><td char="." align="char"><p>480</p></td><td char="." align="char"><p>60</p></td><td char="." align="char"><p>418</p></td><td char="." align="char"><p>24</p></td></tr></tbody></table></table-wrap></p>
            <p id="Par50">As can be seen in Table <xref rid="Tab2" ref-type="table">2</xref>, the number of overall errors achieved by second approximation is bigger than <italic>Minimize FP</italic> (84 vs 33 respectively). Considering that Accuracy computes the overall probability of performing a correct classification, it is easy to conclude that the low rate of misclassification errors motivates the good Accuracy level achieved by first approximation.</p>
            <p id="Par51">Additionally, as can be realized from Table <xref rid="Tab2" ref-type="table">2</xref>, the ability to avoid discarding potential Active compounds makes Minimize FN an adequate alternative for the research domain (where discovering the whole spectrum of potential candidate drugs is more important than minimizing trial costs). Conversely, the Minimize FP approximation achieves a significant reduction of FP errors (up to 95%) when compared with Minimize FP. This fact makes Minimize FP a suitable approximation for the pharmaceutical industry where minimizing unnecessary trial tests (reduce costs) is more important than losing potential Active candidates.</p>
          </sec>
          <sec id="Sec16">
            <title>Virtual screening</title>
            <p id="Par52">We applied our D2-MCS models in virtual screening prospectively. Here, we do not know the activities of the compounds screened a priori. Virtual screening refers to the use of computational approaches to identify chemical structures that are predicted to have particular properties. To this end, we analyzed the behavior of both meta-models (<italic>Minimize FP</italic> and <italic>Minimize FN</italic>) in a realistic scenario. We classified a list of chemical compounds included in the ValidationSet in order to determine their activity. Below, Table <xref rid="Tab4" ref-type="table">4</xref> summarizes the outcomes achieved by each model grouped by activity (Active or Inactive). As can be depicted for Table <xref rid="Tab4" ref-type="table">4</xref>, the number of Active compounds predicted by <italic>Minimize FN</italic> is higher than <italic>Minimize FP</italic> (representing 9.085% and 2.629% of the whole dataset), while <italic>Minimize FP</italic> was able to classify more compounds as Inactive.</p>
            <p id="Par53">This scenario clearly fits the behavior described in Table <xref rid="Tab3" ref-type="table">3</xref>, where <italic>Minimize FP</italic> trends to reduce the FP rate despite sacrificing potential Active compounds while <italic>Minimize FN</italic> is focused on exploring all the potential candidate compounds at expenses of increasing the number of unnecessary trials (caused by FP errors).<table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p>Summary of predictions group by model</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="2"><p>Meta-models</p></th><th align="left" rowspan="2"><p>Predictions</p></th></tr><tr><th align="left"><p>Minimize FP</p></th><th align="left"><p>Minimize FN</p></th></tr></thead><tbody><tr><td align="left"><p>48,232</p></td><td char="." align="char"><p>166,664</p></td><td align="left"><p>Active</p></td></tr><tr><td align="left"><p>1,786,130</p></td><td char="." align="char"><p>1,667,698</p></td><td align="left"><p>Inactive</p></td></tr><tr><td align="left"><p>1,834,362</p></td><td char="." align="char"><p>1,834,362</p></td><td align="left"><p>Total</p></td></tr></tbody></table></table-wrap></p>
            <p id="Par54">The high amount of potential Active components (48,232) makes it unfeasible (in terms of human resources and trial cost) to perform an evaluation of all the predicted actives. Therefore, we selected the most promising candidates for experimental validation from the compounds classified as Active by <italic>Minimize FP</italic>. We address the importance of using an adequate candidate-selection method when dealing with a reduced set of compounds (representing only 0.083% of the potential candidates) to avoid obtaining unrepresentative information. To prevent random selection of candidates, we combined a chemical clustering method with a probabilistic-based ranking methodology. The designed probabilistic-based ranking methodology was used to rank each active-predicted compound (see Additional file <xref ref-type="supplementary-material" rid="MOESM3">3</xref>). This ranking was subsequently used to select the most suitable candidates from chemical clusters. These clusters were constituted from the list of 48,232 predicted actives. Clustering of the predicted actives resulted in 28,217 chemical clusters. From each cluster, the top scoring member (based on the ranks generated by the probabilistic-based ranking methodology) was kept while the other cluster members were discarded. Using this rank, 21 novel and diverse compounds were purchased. The average distance in the set based on Tanimoto distance was 0.81 ± 0.11, the average probability to be active was 0.77 ± 0.02, and the average distance to the training set was 0.26 ± 0.06. Hence, it can be concluded that the set selected was internally chemically diverse, highly probable to be active, and relatively close to the training set.</p>
            <sec id="Sec17">
              <title>In vitro evaluation</title>
              <p id="Par55">The affinities of the 21 purchased compounds for the human CB2 receptor were determined in a radioligand displacement assay using [<sup>3</sup>H]CP55940 as the radiolabeled competitor (Table <xref rid="Tab4" ref-type="table">4</xref>). Six compounds were able to displace more than 50% of the radioligand at 10 uM, and were thus further characterized for their affinity, where the compound with the highest affinity was <bold><italic>Z336532434</italic></bold> (pKi 7.67). Moreover, 5 more compounds were able to displace > 25% of the radioligand and are considered medium hits. Taken together, we were able to obtain 11 hits from the 21 novel compounds (representing a 52% hit rate). As can be seen from Table <xref rid="Tab4" ref-type="table">4</xref>, four out of these 11 are in the top five based on probability. Moreover, the top 10 compounds based on probability contained 7 out of 11 actives. We conclude that our defined probability can be a good estimator of biological activity. Most notable is compound <bold><italic>Z27680708</italic></bold>, which was measured to have a pKi of 7.46 while the Tanimoto distance to the training set was one of the largest at 0.31.<table-wrap id="Tab4"><label>Table 4</label><caption xml:lang="en"><p>Experimentally validated compounds</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Data image</p></th><th align="left"><p>IDnumber/</p><p>InChiKey</p></th><th align="left"><p>Probability</p></th><th align="left"><p>Distance</p><p>To closest</p></th><th align="left"><p>pKi ± SEM</p><p>or</p><p> % displ.</p></th></tr></thead><tbody><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Stra_HTML.gif" /></p></td><td align="left"><p><italic>Z336532434</italic></p><p><italic>/</italic></p><p><italic>MQIUMQLPFGFWME-UHFFFAOYSA-N</italic></p></td><td align="left"><p><italic>0.82</italic></p></td><td align="left"><p><italic>0.32</italic></p></td><td align="left"><p><italic>7.67 ± 0.17</italic></p></td></tr><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Strb_HTML.gif" /></p></td><td align="left"><p>Z28609248</p><p>/</p><p>HXJYJTXXUOYRSB-UHFFFAOYSA-N</p></td><td align="left"><p>0.81</p></td><td align="left"><p>0.29</p></td><td align="left"><p>16%</p></td></tr><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Strc_HTML.gif" /></p></td><td align="left"><p><italic>Z26476746</italic></p><p><italic>/</italic></p><p><italic>VYCWCTZNPBMJFW-UHFFFAOYSA-N</italic></p></td><td align="left"><p><italic>0.80</italic></p></td><td align="left"><p><italic>0.21</italic></p></td><td align="left"><p><italic>6.54 ± 0.14</italic></p></td></tr><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Strd_HTML.gif" /></p></td><td align="left"><p><italic>Z91179667</italic></p><p><italic>/</italic></p><p><italic>XGVYRTRSINEVTE-UHFFFAOYSA-N</italic></p></td><td align="left"><p><italic>0.78</italic></p></td><td align="left"><p><italic>0.15</italic></p></td><td align="left"><p><italic>29%</italic></p></td></tr><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Stre_HTML.gif" /></p></td><td align="left"><p><italic>Z32934509</italic></p><p><italic>/</italic></p><p><italic>OLTBRCMQFCQBIR-UHFFFAOYSA-N</italic></p></td><td align="left"><p><italic>0.78</italic></p></td><td align="left"><p><italic>0.28</italic></p></td><td align="left"><p><italic>6.47 ± 0.02</italic></p></td></tr><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Strf_HTML.gif" /></p></td><td align="left"><p><italic>Z28357657</italic></p><p><italic>/</italic></p><p><italic>NPRYSOPFJOGFSA-UHFFFAOYSA-N</italic></p></td><td align="left"><p><italic>0.78</italic></p></td><td align="left"><p><italic>0.34</italic></p></td><td align="left"><p><italic>6.81 ± 0.29</italic></p></td></tr><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Strg_HTML.gif" /></p></td><td align="left"><p>Z30007452</p><p>/</p><p>VBFKBSAAMKINJD-UHFFFAOYSA-N</p></td><td align="left"><p>0.77</p></td><td align="left"><p>0.24</p></td><td align="left"><p>− 2%</p></td></tr><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Strh_HTML.gif" /></p></td><td align="left"><p><italic>Z27687312</italic></p><p><italic>/</italic></p><p><italic>IHBHBQAPEZJCNM-UHFFFAOYSA-N</italic></p></td><td align="left"><p><italic>0.77</italic></p></td><td align="left"><p><italic>0.23</italic></p></td><td align="left"><p><italic>7.22 ± 0.46</italic></p></td></tr><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Stri_HTML.gif" /></p></td><td align="left"><p><italic>Z46091805</italic></p><p><italic>/</italic></p><p><italic>QKQCBVJKUBSZOR-UHFFFAOYSA-N</italic></p></td><td align="left"><p><italic>0.76</italic></p></td><td align="left"><p><italic>0.24</italic></p></td><td align="left"><p><italic>38%</italic></p></td></tr><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Strj_HTML.gif" /></p></td><td align="left"><p><italic>Z27687279</italic></p><p><italic>/</italic></p><p><italic>WTGACPGXOMAZFA-UHFFFAOYSA-N</italic></p></td><td align="left"><p><italic>0.76</italic></p></td><td align="left"><p><italic>0.22</italic></p></td><td align="left"><p><italic>38%</italic></p></td></tr><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Strk_HTML.gif" /></p></td><td align="left"><p>Z44866691</p><p>/</p><p>WPWBUEOMELTWOC-FCDQGJHFSA-N</p></td><td align="left"><p>0.76</p></td><td align="left"><p>0.25</p></td><td align="left"><p>− 1%</p></td></tr><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Strl_HTML.gif" /></p></td><td align="left"><p><italic>Z28357392</italic></p><p><italic>/</italic></p><p><italic>VBIMVPWQQQESTK-UHFFFAOYSA-N</italic></p></td><td align="left"><p><italic>0.76</italic></p></td><td align="left"><p><italic>0.13</italic></p></td><td align="left"><p><italic>26%</italic></p></td></tr><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Strm_HTML.gif" /></p></td><td align="left"><p>Z1317886912</p><p>/</p><p>MEXULSRPIBCDQX-UHFFFAOYSA-N</p></td><td align="left"><p>0.76</p></td><td align="left"><p>0.28</p></td><td align="left"><p>3%</p></td></tr><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Strn_HTML.gif" /></p></td><td align="left"><p>Z44867007</p><p>/</p><p>PCCXRCZRXNECAZ-JLPGSUDCSA-N</p></td><td align="left"><p>0.76</p></td><td align="left"><p>0.30</p></td><td align="left"><p>0%</p></td></tr><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Stro_HTML.gif" /></p></td><td align="left"><p>Z237484560</p><p>/</p><p>LIGIHTRZFDFDAN-UHFFFAOYSA-N</p></td><td align="left"><p>0.75</p></td><td align="left"><p>0.15</p></td><td align="left"><p>− 1%</p></td></tr><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Strp_HTML.gif" /></p></td><td align="left"><p>Z223843850</p><p>/</p><p>CVSSLUCDGJDGHX-UHFFFAOYSA-N</p></td><td align="left"><p>0.75</p></td><td align="left"><p>0.32</p></td><td align="left"><p>− 5%</p></td></tr><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Strq_HTML.gif" /></p></td><td align="left"><p><italic>Z27019562</italic></p><p><italic>/</italic></p><p><italic>WNXCAGCQOBOQMO-UHFFFAOYSA-N</italic></p></td><td align="left"><p><italic>0.75</italic></p></td><td align="left"><p><italic>0.33</italic></p></td><td align="left"><p><italic>30%</italic></p></td></tr><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Strr_HTML.gif" /></p></td><td align="left"><p>Z55473655</p><p>/</p><p>VDTRQSFAESBVFB-UHFFFAOYSA-N</p></td><td align="left"><p>0.75</p></td><td align="left"><p>0.26</p></td><td align="left"><p>7%</p></td></tr><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Strs_HTML.gif" /></p></td><td align="left"><p>Z2094674960</p><p>/</p><p>RISCNDGLDMULEE-UHFFFAOYSA-N</p></td><td align="left"><p>0.75</p></td><td align="left"><p>0.29</p></td><td align="left"><p>0%</p></td></tr><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Strt_HTML.gif" /></p></td><td align="left"><p>Z1523102560</p><p>/</p><p>IXASXIGZGJSBJT-UHFFFAOYSA-N</p></td><td align="left"><p>0.75</p></td><td align="left"><p>0.30</p></td><td align="left"><p>18%</p></td></tr><tr><td align="left"><p><inline-graphic xlink:href="MediaObjects/13321_2019_389_Stru_HTML.gif" /></p></td><td align="left"><p><italic>Z27680708</italic></p><p><italic>/</italic></p><p><italic>HKWXDCJIBMAAFV-UHFFFAOYSA-N</italic></p></td><td align="left"><p><italic>0.74</italic></p></td><td align="left"><p><italic>0.31</italic></p></td><td align="left"><p><italic>7.46 ± 0.32</italic></p></td></tr></tbody></table><table-wrap-foot><p>Shown are the structure, enamine identifier (ID number), InChIKey, assigned probability, distance to the training set, and biological activity. Biological activity is shown as pKi (with a standard error of the mean) when available or  % displacement of the radioligand by 10 μM of the compound. Identified novel hits are indicated in italic</p></table-wrap-foot></table-wrap></p>
            </sec>
          </sec>
        </sec>
        <sec id="Sec18" sec-type="conclusions">
          <title>Conclusions</title>
          <p id="Par56">This work uses Multiple Classifier Systems (MCS) in early preclinical drug discovery. Concretely, we apply D2-MCS over a training dataset to build two measure-guided D2-MCS models (PPV and MCC). Furthermore, two meta-models (<italic>Minimize FP</italic> and <italic>Minimize FN</italic>) were generated by combining the predictions achieved by the previous D2-MCS models.</p>
          <p id="Par57">Results achieved by both meta-models show the suitability of using <italic>Minimize FP</italic> due to its ability to avoid FP errors (only 3 from 477). To this end, we execute <italic>Minimize FP</italic> over a validation dataset (comprised of 1,834,62 compounds) together with our probabilistic-based ranking methodology to obtain the 21 most promising active compounds.</p>
          <p id="Par58">We have demonstrated that an appropriate combination of D2-MCS models can be successfully used for virtual screening (to predict the biological activity of chemical structures). The identified hits were chemically diverse while similar to the training set. We were successfully able to determine a probability of biological activity, which demonstrated a predictive performance for biological activity.</p>
          <p id="Par59">Despite the promising results achieved here (being a 52% hit rate), further improvements should be addressed to increase the classification performance. Therefore, future work should be focused on two main aspects (i) dataset processing and (ii) the improvement of the D2-MCS toolkit. Regarding data quality, the detection, and removal of irrelevant, noisy, or valueless features from the input dataset should be considered. Moreover, to increase the performance of D2-MCS new and efficient feature clustering methods should be implemented.</p>
        </sec>
      </body>
      <back>
        <ack>
          <title>Acknowledgements</title>
          <p>D. Ruano-Ordás was supported by a post-doctoral fellowship from Xunta de Galicia (ED481B 2017/018). SING group thanks CITI (<italic>Centro de Investigación, Transferencia e Innovación</italic>) from the University of Vigo for hosting its IT infrastructure.</p>
        </ack>
        <sec sec-type="author-contribution">
          <title>Authors’ contributions</title>
          <p>DRO, JRM, ME, and GvW conceived the study. DRO and IY were responsible for designing and executing the in silico experiments. IY designed the three-stage candidate ranker methodology. JRM supervised the in silico experimentation; DRO, JRM, and GvW wrote the paper. LB generated the dataset. GvW performed clustering and compound selection. RL and CvdH performed the in vitro experimental validation. LHH supervised the in vitro experimentation. All authors read and approved the final manuscript.</p>
        </sec>
        <sec>
          <title>Funding</title>
          <p>This work was supported by the Consellería de Educación, Universidades e Formación Profesional (Xunta de Galicia) under the scope of the strategic funding of ED431C2018/55-GRC Competitive Reference Group.Gerard JP van Westen thanks the Dutch Scientific Council Applied and Engineering Sciences (NWO-TTW) for funding (VENI 14410).</p>
        </sec>
        <sec sec-type="data-availability">
          <title>Availability of data and materials</title>
          <p>The MCS framework is available on GitHub: <ext-link xlink:href="https://github.com/drordas/D2-MCS" ext-link-type="uri">https://github.com/drordas/D2-MCS</ext-link> The data used/generated in this study is available from ChEMBL and is available here: <ext-link xlink:href="http://doi.org/10.5281/zenodo.2677650" ext-link-type="uri">http://doi.org/10.5281/zenodo.2677650</ext-link> The predicted probabilities for the virtual screening are included as Additional file.</p>
        </sec>
        <sec sec-type="ethics-statement">
          <sec id="FPar1" sec-type="COI-statement">
            <title>Competing interests</title>
            <p id="Par60">The authors declare that they have no competing interests.</p>
          </sec>
        </sec>
        <ref-list id="Bib1">
          <title>References</title>
          <ref-list>
            <ref id="CR1">
              <label>1.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Sieburg</surname>
                    <given-names>HB</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Physiological studies in silico</article-title>
                <source>Stud Sci Complex</source>
                <year>1990</year>
                <volume>12</volume>
                <fpage>321</fpage>
                <lpage>342</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR2">
              <label>2.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Danchin</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Médigue</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Gascuel</surname>
                    <given-names>O</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">From data banks to data bases</article-title>
                <source>Res Microbiol</source>
                <year>1991</year>
                <volume>142</volume>
                <fpage>913</fpage>
                <lpage>916</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:STN:280:DyaK387ltVOqsQ%3D%3D</pub-id>
                <pub-id pub-id-type="doi">10.1016/0923-2508(91)90073-J</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR3">
              <label>3.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Gaulton</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Bellis</surname>
                    <given-names>LJ</given-names>
                  </name>
                  <name>
                    <surname>Bento</surname>
                    <given-names>AP</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">ChEMBL: a large-scale bioactivity database for drug discovery</article-title>
                <source>Nucleic Acids Res</source>
                <year>2012</year>
                <volume>40</volume>
                <fpage>D1100</fpage>
                <lpage>D1107</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXhs12htbjN</pub-id>
                <pub-id pub-id-type="doi">10.1093/nar/gkr777</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR4">
              <label>4.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Sieburg</surname>
                    <given-names>HB</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The cellular device machine: point of departure for large-scale simulations of complex biological systems</article-title>
                <source>Comput Math Appl</source>
                <year>1990</year>
                <volume>20</volume>
                <fpage>247</fpage>
                <lpage>267</lpage>
                <pub-id pub-id-type="doi">10.1016/0898-1221(90)90332-E</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR5">
              <label>5.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Briem</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Lessel</surname>
                    <given-names>UF</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">In vitro and in silico affinity fingerprints: finding similarities beyond structural classes</article-title>
                <source>Perspect Drug Discov Des</source>
                <year>2000</year>
                <volume>20</volume>
                <fpage>231</fpage>
                <lpage>244</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3MXptFSn</pub-id>
                <pub-id pub-id-type="doi">10.1023/A:1008793325522</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR6">
              <label>6.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Mahé</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Ralaivola</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Stoven</surname>
                    <given-names>V</given-names>
                  </name>
                  <name>
                    <surname>Vert</surname>
                    <given-names>J-P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The pharmacophore kernel for virtual screening with support vector machines</article-title>
                <source>J Chem Inf Model</source>
                <year>2006</year>
                <volume>46</volume>
                <fpage>2003</fpage>
                <lpage>2014</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD28XnvFOqt7g%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci060138m</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR7">
              <label>7.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Azencott</surname>
                    <given-names>C-A</given-names>
                  </name>
                  <name>
                    <surname>Ksikes</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Swamidass</surname>
                    <given-names>SJ</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">One- to four-dimensional kernels for virtual screening and the prediction of physical, chemical, and biological properties</article-title>
                <source>J Chem Inf Model</source>
                <year>2007</year>
                <volume>47</volume>
                <fpage>965</fpage>
                <lpage>974</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2sXisVGls70%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci600397p</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR8">
              <label>8.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Schneider</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Jäckels</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Andres</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Hutter</surname>
                    <given-names>MC</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Gradual in silico filtering for druglike substances</article-title>
                <source>J Chem Inf Model</source>
                <year>2008</year>
                <volume>48</volume>
                <fpage>613</fpage>
                <lpage>628</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1cXhsl2qurs%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci700351y</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR9">
              <label>9.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Watson</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Naïve Bayes classification using 2D pharmacophore feature triplet vectors</article-title>
                <source>J Chem Inf Model</source>
                <year>2008</year>
                <volume>48</volume>
                <fpage>166</fpage>
                <lpage>178</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1cXksVyksg%3D%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci7003253</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR10">
              <label>10.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Kauffman</surname>
                    <given-names>GW</given-names>
                  </name>
                  <name>
                    <surname>Jurs</surname>
                    <given-names>PC</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">QSAR and k -nearest neighbor classification analysis of selective cyclooxygenase-2 inhibitors using topologically-based numerical descriptors</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>2001</year>
                <volume>41</volume>
                <fpage>1553</fpage>
                <lpage>1560</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3MXmvF2htrY%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci010073h</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR11">
              <label>11.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Niculescu</surname>
                    <given-names>SP</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Artificial neural networks and genetic algorithms in QSAR</article-title>
                <source>J Mol Struct THEOCHEM</source>
                <year>2003</year>
                <volume>622</volume>
                <fpage>71</fpage>
                <lpage>83</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3sXhsVSrurc%3D</pub-id>
                <pub-id pub-id-type="doi">10.1016/S0166-1280(02)00619-X</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR12">
              <label>12.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Vracko</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Kohonen artificial neural network and counter propagation neural network in molecular structure-toxicity studies</article-title>
                <source>Curr Comput Aided Drug Des</source>
                <year>2005</year>
                <volume>1</volume>
                <fpage>73</fpage>
                <lpage>78</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2MXhs1eksbg%3D</pub-id>
                <pub-id pub-id-type="doi">10.2174/1573409052952224</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR13">
              <label>13.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Bolton</surname>
                    <given-names>EE</given-names>
                  </name>
                  <name>
                    <surname>Wang</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Thiessen</surname>
                    <given-names>PA</given-names>
                  </name>
                  <name>
                    <surname>Bryant</surname>
                    <given-names>SH</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">PubChem: integrated platform of small molecules and biological activities</article-title>
                <source>Annu Rep Comput Chem</source>
                <year>2008</year>
                <volume>4</volume>
                <fpage>217</fpage>
                <lpage>241</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXpsFWqsA%3D%3D</pub-id>
                <pub-id pub-id-type="doi">10.1016/S1574-1400(08)00012-1</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR14">
              <label>14.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Dietterich</surname>
                    <given-names>TG</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Ensemble methods in machine learning</article-title>
                <source>Multiple classifier systems</source>
                <year>2000</year>
                <publisher-loc>Berlin, Heidelberg</publisher-loc>
                <publisher-name>Springer</publisher-name>
                <pub-id pub-id-type="doi">10.1007/3-540-45014-9_1</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR15">
              <label>15.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Lenselink</surname>
                    <given-names>EB</given-names>
                  </name>
                  <name>
                    <surname>ten Dijke</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Bongers</surname>
                    <given-names>B</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Beyond the hype: deep neural networks outperform established methods using a ChEMBL bioactivity benchmark set</article-title>
                <source>J Cheminform</source>
                <year>2017</year>
                <volume>9</volume>
                <fpage>45</fpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXnsVygtLk%3D</pub-id>
                <pub-id pub-id-type="doi">10.1186/s13321-017-0232-0</pub-id>
                <pub-id pub-id-type="pmid">29086168</pub-id>
                <pub-id pub-id-type="pmcid">29086168</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR16">
              <label>16.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Schmidhuber</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Deep learning in neural networks: an overview</article-title>
                <source>Neural Networks</source>
                <year>2015</year>
                <volume>61</volume>
                <fpage>85</fpage>
                <lpage>117</lpage>
                <pub-id pub-id-type="doi">10.1016/j.neunet.2014.09.003</pub-id>
                <pub-id pub-id-type="pmid">25462637</pub-id>
                <pub-id pub-id-type="pmcid">25462637</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR17">
              <label>17.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Boulesteix</surname>
                    <given-names>A-L</given-names>
                  </name>
                  <name>
                    <surname>Janitza</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Kruppa</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>König</surname>
                    <given-names>IR</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Overview of random forest methodology and practical guidance with emphasis on computational biology and bioinformatics</article-title>
                <source>Wiley Interdiscip Rev Data Min Knowl Discov</source>
                <year>2012</year>
                <volume>2</volume>
                <fpage>493</fpage>
                <lpage>507</lpage>
                <pub-id pub-id-type="doi">10.1002/widm.1072</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR18">
              <label>18.</label>
              <mixed-citation publication-type="other">Hashim H, Saeed F (2017) Prediction of new bioactive molecules of chemical compound using boosting ensemble methods. In: International conference on soft computing in data science. pp 255–262</mixed-citation>
            </ref>
            <ref id="CR19">
              <label>19.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Acharya</surname>
                    <given-names>UR</given-names>
                  </name>
                  <name>
                    <surname>Akter</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Chowriappa</surname>
                    <given-names>P</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Use of nonlinear features for automated characterization of suspicious ovarian tumors using ultrasound images in fuzzy forest framework</article-title>
                <source>Int J Fuzzy Syst</source>
                <year>2018</year>
                <volume>20</volume>
                <fpage>1385</fpage>
                <lpage>1402</lpage>
                <pub-id pub-id-type="doi">10.1007/s40815-018-0456-9</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR20">
              <label>20.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Woźniak Michałand Graña</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Corchado</surname>
                    <given-names>E</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">A survey of multiple classifier systems as hybrid systems</article-title>
                <source>Inf Fusion</source>
                <year>2014</year>
                <volume>16</volume>
                <fpage>3</fpage>
                <lpage>17</lpage>
                <pub-id pub-id-type="doi">10.1016/j.inffus.2013.04.006</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR21">
              <label>21.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Ruano-Ordás</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Yevseyeva</surname>
                    <given-names>I</given-names>
                  </name>
                  <name>
                    <surname>Fernandes</surname>
                    <given-names>VB</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Improving the drug discovery process by using multiple classifier systems</article-title>
                <source>Expert Syst Appl</source>
                <year>2019</year>
                <volume>121</volume>
                <fpage>292</fpage>
                <lpage>303</lpage>
                <pub-id pub-id-type="doi">10.1016/j.eswa.2018.12.032</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR22">
              <label>22.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Rogers</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Hahn</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Extended-connectivity fingerprints</article-title>
                <source>J Chem Inf Model</source>
                <year>2010</year>
                <volume>50</volume>
                <fpage>742</fpage>
                <lpage>754</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3cXlt1Onsbg%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci100050t</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR23">
              <label>23.</label>
              <mixed-citation publication-type="other">Dassault Systèmes BIOVIA (2016) Pipeline Pilot (version 2016)</mixed-citation>
            </ref>
            <ref id="CR24">
              <label>24.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Heller</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>McNaught</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Stein</surname>
                    <given-names>S</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">InChI—the worldwide chemical structure identifier standard</article-title>
                <source>J Cheminform</source>
                <year>2013</year>
                <volume>5</volume>
                <fpage>7</fpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3sXlvVyhtLw%3D</pub-id>
                <pub-id pub-id-type="doi">10.1186/1758-2946-5-7</pub-id>
                <pub-id pub-id-type="pmid">3599061</pub-id>
                <pub-id pub-id-type="pmcid">3599061</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR25">
              <label>25.</label>
              <mixed-citation publication-type="other">Burggraaff L (2018) CB2 set supporting information. <ext-link xlink:href="https://surfdrive.surf.nl/files/index.php/s/RAjHDCwZ3H3Lazr/download%3fpath%3d%252FCB2%26files%3dFCFP_6_Supporting_info_dataset.txt.gz" ext-link-type="uri">https://surfdrive.surf.nl/files/index.php/s/RAjHDCwZ3H3Lazr/download?path=%2FCB2&amp;files=FCFP_6_Supporting_info_dataset.txt.gz</ext-link>. Accessed 2019</mixed-citation>
            </ref>
            <ref id="CR26">
              <label>26.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Boughorbel</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Jarray</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>El-Anbari</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Optimal classifier for imbalanced data using Matthews Correlation Coefficient metric</article-title>
                <source>PLoS ONE</source>
                <year>2017</year>
                <volume>12</volume>
                <fpage>e0177678</fpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXkvFaktLk%3D</pub-id>
                <pub-id pub-id-type="doi">10.1371/journal.pone.0177678</pub-id>
                <pub-id pub-id-type="pmid">28574989</pub-id>
                <pub-id pub-id-type="pmcid">28574989</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR27">
              <label>27.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Matthews</surname>
                    <given-names>BW</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Comparison of the predicted and observed secondary structure of T4 phage lysozyme</article-title>
                <source>Biochim Biophys Acta</source>
                <year>1975</year>
                <volume>405</volume>
                <fpage>442</fpage>
                <lpage>451</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaE2MXlslCksbk%3D</pub-id>
                <pub-id pub-id-type="doi">10.1016/0005-2795(75)90109-9</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR28">
              <label>28.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Lalkhen</surname>
                    <given-names>AG</given-names>
                  </name>
                  <name>
                    <surname>McCluskey</surname>
                    <given-names>A</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Clinical tests: sensitivity and specificity</article-title>
                <source>Contin Educ Anaesth Crit Care Pain</source>
                <year>2008</year>
                <volume>8</volume>
                <fpage>221</fpage>
                <lpage>223</lpage>
                <pub-id pub-id-type="doi">10.1093/bjaceaccp/mkn041</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR29">
              <label>29.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Bewick</surname>
                    <given-names>V</given-names>
                  </name>
                  <name>
                    <surname>Cheek</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Ball</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Receiver operating characteristic curves</article-title>
                <source>Crit Care</source>
                <year>2004</year>
                <volume>8</volume>
                <fpage>508</fpage>
                <pub-id pub-id-type="doi">10.1186/cc3000</pub-id>
                <pub-id pub-id-type="pmid">1065080</pub-id>
                <pub-id pub-id-type="pmcid">1065080</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR30">
              <label>30.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Hajian-Tilaki</surname>
                    <given-names>K</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Receiver operating characteristic (ROC) curve analysis for medical diagnostic test evaluation</article-title>
                <source>Casp J Intern Med</source>
                <year>2013</year>
                <volume>4</volume>
                <fpage>627</fpage>
                <lpage>635</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR31">
              <label>31.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Fawcett</surname>
                    <given-names>T</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">An introduction to ROC analysis</article-title>
                <source>Pattern Recognit Lett</source>
                <year>2006</year>
                <volume>27</volume>
                <fpage>861</fpage>
                <lpage>874</lpage>
                <pub-id pub-id-type="doi">10.1016/j.patrec.2005.10.010</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR32">
              <label>32.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Goutte</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Gaussier</surname>
                    <given-names>E</given-names>
                  </name>
                </person-group>
                <person-group person-group-type="editor">
                  <name>
                    <surname>Losada</surname>
                    <given-names>DE</given-names>
                  </name>
                  <name>
                    <surname>Fernández-Luna</surname>
                    <given-names>JM</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">A probabilistic interpretation of precision, recall and F-score, with implication for evaluation</article-title>
                <source>Advances in information retrieval</source>
                <year>2005</year>
                <publisher-loc>Berlin, Heidelberg</publisher-loc>
                <publisher-name>Springer</publisher-name>
                <pub-id pub-id-type="doi">10.1007/978-3-540-31865-1_25</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR33">
              <label>33.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Chicco</surname>
                    <given-names>D</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Ten quick tips for machine learning in computational biology</article-title>
                <source>BioData Min</source>
                <year>2017</year>
                <volume>10</volume>
                <fpage>35</fpage>
                <pub-id pub-id-type="doi">10.1186/s13040-017-0155-3</pub-id>
                <pub-id pub-id-type="pmid">5721660</pub-id>
                <pub-id pub-id-type="pmcid">5721660</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR34">
              <label>34.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Maxim</surname>
                    <given-names>LD</given-names>
                  </name>
                  <name>
                    <surname>Niebo</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Utell</surname>
                    <given-names>MJ</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Screening tests: a review with examples</article-title>
                <source>Inhal Toxicol</source>
                <year>2014</year>
                <volume>26</volume>
                <fpage>811</fpage>
                <lpage>828</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2cXhvVCls7fJ</pub-id>
                <pub-id pub-id-type="doi">10.3109/08958378.2014.955932</pub-id>
                <pub-id pub-id-type="pmid">25264934</pub-id>
                <pub-id pub-id-type="pmcid">4389712</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR35">
              <label>35.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Kuhn</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Building predictive models in R using the caret package</article-title>
                <source>J Stat Softw</source>
                <year>2008</year>
                <pub-id pub-id-type="doi">10.18637/jss.v028.i05</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR36">
              <label>36.</label>
              <mixed-citation publication-type="other">GraphPad Software Inc (2018) GraphPad Prism 7</mixed-citation>
            </ref>
            <ref id="CR37">
              <label>37.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Yung-Chi</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Prusoff</surname>
                    <given-names>WH</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Relationship between the inhibition constant (KI) and the concentration of inhibitor which causes 50 per cent inhibition (I50) of an enzymatic reaction</article-title>
                <source>Biochem Pharmacol</source>
                <year>1973</year>
                <volume>22</volume>
                <fpage>3099</fpage>
                <lpage>3108</lpage>
                <pub-id pub-id-type="doi">10.1016/0006-2952(73)90196-2</pub-id>
              </mixed-citation>
            </ref>
          </ref-list>
        </ref-list>
        <app-group>
          <app id="App1">
            <sec id="Sec19">
              <title>Supplementary information</title>
              <p>
                <supplementary-material content-type="local-data" id="MOESM1" xlink:title="Supplementary information">
                  <media mimetype="application" mime-subtype="msword" xlink:href="MediaObjects/13321_2019_389_MOESM1_ESM.docx" position="anchor">
                    <caption xml:lang="en">
                      <p><bold>Additional file 1.</bold> Physicochemical descriptors comprising CB2Set.</p>
                    </caption>
                  </media>
                </supplementary-material>
                <supplementary-material content-type="local-data" id="MOESM2" xlink:title="Supplementary information">
                  <media mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="MediaObjects/13321_2019_389_MOESM2_ESM.xlsx" position="anchor">
                    <caption xml:lang="en">
                      <p><bold>Additional file 2.</bold> Performance comparison of Simple ML models and D2-MCS.</p>
                    </caption>
                  </media>
                </supplementary-material>
                <supplementary-material content-type="local-data" id="MOESM3" xlink:title="Supplementary information">
                  <media mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="MediaObjects/13321_2019_389_MOESM3_ESM.xlsx" position="anchor">
                    <caption xml:lang="en">
                      <p><bold>Additional file 3.</bold> List of potential candidates sorted by probability of being Active.</p>
                    </caption>
                  </media>
                </supplementary-material>
              </p>
            </sec>
          </app>
        </app-group>
        <glossary>
          <title>Abbreviations</title>
          <def-list>
            <def-item>
              <term>HTS</term>
              <def>
                <p id="Par2">high-throughput screening</p>
              </def>
            </def-item>
            <def-item>
              <term>FP</term>
              <def>
                <p id="Par3">false positives</p>
              </def>
            </def-item>
            <def-item>
              <term>FN</term>
              <def>
                <p id="Par4">false negatives</p>
              </def>
            </def-item>
            <def-item>
              <term>TP</term>
              <def>
                <p id="Par5">true positives</p>
              </def>
            </def-item>
            <def-item>
              <term>TN</term>
              <def>
                <p id="Par6">true negatives</p>
              </def>
            </def-item>
            <def-item>
              <term>MCS</term>
              <def>
                <p id="Par7">multiple classifier systems</p>
              </def>
            </def-item>
            <def-item>
              <term>DNN</term>
              <def>
                <p id="Par8">deep neural networks</p>
              </def>
            </def-item>
            <def-item>
              <term>SVM</term>
              <def>
                <p id="Par9">support vector machines</p>
              </def>
            </def-item>
            <def-item>
              <term>D2-MCS</term>
              <def>
                <p id="Par10">drugs discovery for multi-clustering system</p>
              </def>
            </def-item>
            <def-item>
              <term>PPV</term>
              <def>
                <p id="Par11">positive prediction values</p>
              </def>
            </def-item>
            <def-item>
              <term>MCC</term>
              <def>
                <p id="Par12">Matthews Correlation Coefficient</p>
              </def>
            </def-item>
          </def-list>
        </glossary>
        <notes notes-type="ESMHint">
          <title>Supplementary information</title>
          <p><bold>Supplementary information</bold> accompanies this paper at <ext-link xlink:href="10.1186/s13321-019-0389-9" ext-link-type="doi">https://doi.org/10.1186/s13321-019-0389-9</ext-link>.</p>
        </notes>
        <notes notes-type="Misc">
          <title>Publisher's Note</title>
          <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
        </notes>
      </back>
    </article>
