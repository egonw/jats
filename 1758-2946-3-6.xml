<?xml version="1.0"?>
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="research-article" xml:lang="en">
      <front>
        <journal-meta>
          <journal-id journal-id-type="publisher-id">13321</journal-id>
          <journal-title-group>
            <journal-title>Journal of Cheminformatics</journal-title>
            <abbrev-journal-title abbrev-type="publisher">J Cheminform</abbrev-journal-title>
          </journal-title-group>
          <issn pub-type="epub">1758-2946</issn>
          <publisher>
            <publisher-name>Springer International Publishing</publisher-name>
            <publisher-loc>Cham</publisher-loc>
          </publisher>
        </journal-meta>
        <article-meta>
          <article-id pub-id-type="publisher-id">BMC1758-2946-3-6</article-id>
          <article-id pub-id-type="manuscript">121</article-id>
          <article-id pub-id-type="doi">10.1186/1758-2946-3-6</article-id>
          <article-categories>
            <subj-group subj-group-type="heading">
              <subject>Software</subject>
            </subj-group>
          </article-categories>
          <title-group>
            <article-title xml:lang="en">FlaME: Flash Molecular Editor - a 2D structure input tool for the web</article-title>
          </title-group>
          <contrib-group>
            <contrib contrib-type="author" corresp="yes">
              <name>
                <surname>Dallakian</surname>
                <given-names>Pavel</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="corresp" rid="IDBMC1758294636_cor1">a</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Haider</surname>
                <given-names>Norbert</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <aff id="Aff1">
              <label>1</label>
              <institution-wrap>
                <institution-id institution-id-type="GRID">grid.10420.37</institution-id>
                <institution-id institution-id-type="ISNI">0000000122861424</institution-id>
                <institution content-type="org-division">Department of Drug and Natural Product Synthesis</institution>
                <institution content-type="org-name">University of Vienna</institution>
              </institution-wrap>
              <addr-line content-type="street">Althanstraße 14</addr-line>
              <addr-line content-type="postcode">A-1090</addr-line>
              <addr-line content-type="city">Vienna</addr-line>
              <country country="AT">Austria</country>
            </aff>
          </contrib-group>
          <author-notes>
            <corresp id="IDBMC1758294636_cor1">
              <label>a</label>
              <email>HIDDEN</email>
            </corresp>
          </author-notes>
          <pub-date date-type="pub" publication-format="electronic">
            <day>1</day>
            <month>2</month>
            <year>2011</year>
          </pub-date>
          <pub-date date-type="collection" publication-format="electronic">
            <month>12</month>
            <year>2011</year>
          </pub-date>
          <volume>3</volume>
          <issue seq="6">1</issue>
          <elocation-id>6</elocation-id>
          <history>
            <date date-type="registration">
              <day>25</day>
              <month>11</month>
              <year>2010</year>
            </date>
            <date date-type="received">
              <day>25</day>
              <month>11</month>
              <year>2010</year>
            </date>
            <date date-type="accepted">
              <day>1</day>
              <month>2</month>
              <year>2011</year>
            </date>
            <date date-type="online">
              <day>1</day>
              <month>2</month>
              <year>2011</year>
            </date>
          </history>
          <permissions>
            <copyright-statement content-type="compact">© Dallakian and Haider; licensee Chemistry Central Ltd. 2011</copyright-statement>
            <copyright-statement content-type="comment">This article is published under license to BioMed Central Ltd. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link xlink:href="http://creativecommons.org/licenses/by/2.0" ext-link-type="uri">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</copyright-statement>
            <copyright-year>2011</copyright-year>
            <copyright-holder>Dallakian and Haider; licensee Chemistry Central Ltd.</copyright-holder>
            <license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/2.0">
              <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 2.0 International License (<ext-link xlink:href="https://creativecommons.org/licenses/by/2.0" ext-link-type="uri">https://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
            </license>
          </permissions>
          <abstract xml:lang="en" id="Abs1">
            <title>Abstract</title>
            <sec id="ASec1">
              <title>Background</title>
              <p>So far, there have been no Flash-based web tools available for chemical structure input. The authors herein present a feasibility study, aiming at the development of a compact and easy-to-use 2D structure editor, using Adobe's Flash technology and its programming language, ActionScript. As a reference model application from the Java world, we selected the Java Molecular Editor (JME). In this feasibility study, we made an attempt to realize a subset of JME's functionality in the Flash Molecular Editor (FlaME) utility. These basic capabilities are: structure input, editing and depiction of single molecules, data import and export in molfile format.</p>
            </sec>
            <sec id="ASec2">
              <title>Implementation</title>
              <p>The result of molecular diagram sketching in FlaME is accessible in V2000 molfile format. By integrating the molecular editor into a web page, its communication with the HTML elements on this page is established using the two JavaScript functions, <italic>getMol()</italic> and <italic>setMol()</italic>. In addition, structures can be copied to the <italic>system clipboard</italic>.</p>
            </sec>
            <sec id="ASec3">
              <title>Conclusion</title>
              <p>A first attempt was made to create a compact single-file application for 2D molecular structure input/editing on the web, based on Flash technology. With the application examples presented in this article, it could be demonstrated that the Flash methods are principally well-suited to provide the requisite communication between the Flash object (application) and the HTML elements on a web page, using JavaScript functions.</p>
            </sec>
            <sec>
              <fig id="Figa" position="anchor">
                <graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2010_Article_121_Figa_HTML.gif" position="anchor" />
              </fig>
            </sec>
          </abstract>
          <kwd-group xml:lang="en">
            <title>Keywords</title>
            <kwd>Flash Method</kwd>
            <kwd>Adobe Flash</kwd>
            <kwd>Data Exchange Format</kwd>
            <kwd>Structure Editor</kwd>
            <kwd>Query Atom</kwd>
          </kwd-group>
          <custom-meta-group>
            <custom-meta>
              <meta-name>publisher-imprint-name</meta-name>
              <meta-value>Chemistry Central</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-issue-count</meta-name>
              <meta-value>1</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-article-count</meta-name>
              <meta-value>54</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-holder</meta-name>
              <meta-value>The Author(s)</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-year</meta-name>
              <meta-value>2011</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-contains-esm</meta-name>
              <meta-value>Yes</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-year</meta-name>
              <meta-value>2010</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-month</meta-name>
              <meta-value>11</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-day</meta-name>
              <meta-value>25</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-product</meta-name>
              <meta-value>ArchiveJournal</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-grants-type</meta-name>
              <meta-value>OpenChoice</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>metadata-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>abstract-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodypdf-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodyhtml-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bibliography-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>esm-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>online-first</meta-name>
              <meta-value>false</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-file-reference</meta-name>
              <meta-value>BodyRef/PDF/13321_2010_Article_121.pdf</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-type</meta-name>
              <meta-value>Typeset</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>target-type</meta-name>
              <meta-value>OnlinePDF</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-type</meta-name>
              <meta-value>OriginalPaper</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-primary</meta-name>
              <meta-value>Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computer Applications in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Documentation and Information in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Theoretical and Computational Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computational Biology/Bioinformatics</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-collection</meta-name>
              <meta-value>Chemistry and Materials Science</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>open-access</meta-name>
              <meta-value>true</meta-value>
            </custom-meta>
          </custom-meta-group>
        </article-meta>
        <notes notes-type="ESMHint">
          <title>Electronic supplementary material</title>
          <p>The online version of this article (doi:<ext-link xlink:href="10.1186/1758-2946-3-6" ext-link-type="doi">10.1186/1758-2946-3-6</ext-link>) contains supplementary material, which is available to authorized users.</p>
        </notes>
      </front>
      <body>
        <sec id="Sec1">
          <title>Background</title>
          <sec id="Sec2">
            <title>About the Project</title>
            <p>At present, there are various tools available for structure input on web pages, for example Marvin Sketch [<xref ref-type="bibr" rid="CR1">1</xref>], PubChem Sketcher [<xref ref-type="bibr" rid="CR2">2</xref>], NIST Molecule Editor [<xref ref-type="bibr" rid="CR3">3</xref>] or JME [<xref ref-type="bibr" rid="CR4">4</xref>]. The latter one is very popular because of its compact footprint and intuitive use. It has been utilized by many web developers (including the authors of this article) for sites with chemical content. Recently, a comprehensive review article [<xref ref-type="bibr" rid="CR5">5</xref>] summarized the developments in this field. Prompted by the statement that so far no Flash-based web tool for structure input is available, we decided to undertake a feasibility study, aiming at the development of a compact and easy-to-use 2D structure editor, using Adobe's Flash technology and its programming language, ActionScript. As a reference model application from the Java world, we selected the Java Molecular Editor (JME). In this feasibility study, we made an attempt to realize a subset of JME's functionality in the FlaME utility (<italic>part I, this article</italic>). These basic capabilities are: structure input, editing and depiction of single molecules, data import and export in molfile format. As this is just the beginning of the project, we intend to continue and extend this work with additional features like reaction editing and the implementation of other data exchange formats (e.g., SMILES) (<italic>part II, in planning</italic>).</p>
          </sec>
          <sec id="Sec3">
            <title>Objectives and expectations</title>
            <p>The primary objective of this work has been to demonstrate a usable Flash application (written in Flash/ActionScript) for drawing and editing molecules directly within a HTML/JavaScript web page. The goals are as follows: a) we want to achieve the convenience of common structure editors such as ISIS (Symyx) Draw [<xref ref-type="bibr" rid="CR6">6</xref>] or Marvin Sketch [<xref ref-type="bibr" rid="CR1">1</xref>], which are easy and intuitive to use; b) at the same time the application should be compact - in other words: small and smart. As the data exchange format (<italic>result or output format</italic>), the well-documented and proven MDL MOL format V2000 [<xref ref-type="bibr" rid="CR7">7</xref>] was chosen. This format is still very popular for structural data exchange and it is used by many databases and cheminformatics applications, despite its inherent limitations, e.g. with respect to the maximum number of atoms. The latter aspect, however, does not affect its suitability for FlaME, as this editor is primarily designed to handle "small molecules".</p>
          </sec>
        </sec>
        <sec id="Sec4">
          <title>Results and discussion</title>
          <sec id="Sec5">
            <title>The FlaME Molecular Editor: features - graphical user interface and layout</title>
            <p>As mentioned above, the authors were inspired by the JME applet written by P. Ertl [<xref ref-type="bibr" rid="CR4">4</xref>] when designing the layout of the graphical user interface (GUI). Nevertheless, we tried to create a typical and unique look-and-feel for our new tool (Figure <xref rid="Fig1" ref-type="fig">1</xref>). Actually, there should be no explanation needed for a novice user of FlaME. Users should immediately feel familiar with the buttons and functions in FlaME. Furthermore, tooltips are displayed in the right bottom area of the GUI which are activated by slowly moving the mouse pointer over the various buttons, thus facilitating use of the applet.<fig id="Fig1"><label>Figure 1</label><caption xml:lang="en"><p><bold>FlaME graphical user interface</bold>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_121_Fig1_HTML.jpg" /></fig></p>
          </sec>
          <sec id="Sec6">
            <title>GUI buttons</title>
            <p>The FlaME GUI is simple and all icons on the buttons should be intuitively understood. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the icons and a description of the individual buttons.<fig id="Fig2"><label>Figure 2</label><caption xml:lang="en"><p><bold>Description of the GUI buttons</bold>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_121_Fig2_HTML.jpg" /></fig></p>
          </sec>
          <sec id="Sec7">
            <title>Subjects and actions</title>
            <p>Based on the definition of operations (drawing primitives) for molecular structure diagram sketching as discussed by A. M. Clark [<xref ref-type="bibr" rid="CR8">8</xref>], we can define the subjects in FlaME as atoms and bonds. The actions implemented so far are as follows:</p>
            <p>add or delete atom</p>
            <p>add or delete bond</p>
            <p>add structure fragment (as pre-defined <italic>template structure</italic>)</p>
            <p>set or change the atom type (as a pre-defined element or as input via X-button)</p>
            <p>set or change the bond order</p>
            <p>set or change the stereo style (<italic>stereo marking</italic>)</p>
            <p>set or change the ionic charge</p>
            <p>The element or group label will change automatically depending on element and current environment of the particular structure node (<italic>node environment</italic>).</p>
          </sec>
          <sec id="Sec8">
            <title>Molecular structure output</title>
            <p>The result of molecular diagram sketching in FlaME is accessible in V2000 molfile format [<xref ref-type="bibr" rid="CR7">7</xref>]. This result can be copied to the <italic>system clipboard</italic> (by clicking the corresponding button). On the other hand, by integrating the molecular editor into a web page, its communication with the HTML elements on this page must be established. For this purpose, two JavaScript functions are implemented which are described below.</p>
          </sec>
          <sec id="Sec9">
            <title>Flash Methods - JavaScript getMol() and setMol() functions</title>
            <p>The Flash documentation states: "<italic>A Flash method is a JavaScript function that is specific to Flash movies. Use Flash methods to send JavaScript calls to Flash movies from a scripting environment</italic>." [<xref ref-type="bibr" rid="CR9">9</xref>]</p>
            <p>Using the Flash methods, two functions (<italic>getMol</italic> and <italic>setMol</italic>) were written: the function <italic>getMol()</italic> ensures that the structure drawn in the molecular editor will be copied as a molfile to a <italic>textarea</italic> field (<italic>id = "mol"</italic>) within the web page for further use, e.g. as a query structure for a database search. The second JavaScript function <italic>setMol()</italic> sends the molfile from the web page to the Flash object, in our case to the FlaME molecular editor. The second line in this function just ensures compatibility with all common web browsers, such as Internet Explorer, Firefox, Opera, Chrome, Safari etc.</p>
            <p>While the purpose of the <italic>getMol()</italic> function could be described as "<italic>export as MOL file</italic>", the <italic>setMol()</italic> function could be called "<italic>import MOL file</italic>" and it can be used for structure input in textual form for further structural modification using FlaME (see example 1).</p>
            <p>function getMol() {</p>
            <p>var m = thisMovie("flame").GetVariable("mol");</p>
            <p>document.getElementById("mol").value = m;</p>
            <p>}</p>
            <p>function setMol() {</p>
            <p>var m = document.getElementById("mol").value;</p>
            <p>m = m.replace(/\r\n/g, "\r");</p>
            <p>thisMovie("flame").send2Flame(m);</p>
            <p>}</p>
          </sec>
          <sec id="Sec10">
            <title>Drawing operations and template structures</title>
            <p>The actions of FlaME implemented so far do not reflect all of the basic primitives for molecular diagram sketching, described previously [<xref ref-type="bibr" rid="CR8">8</xref>]. It was not the purpose of this tool to cover all these possible functionalities, but to provide users (and developers) with an opportunity to use a rather compact input tool for chemistry-related websites. The standard template structures included in FlaME are: cyclopropane, cyclobutane, cyclopentane, cyclohexane, benzene, cycloheptane, and cyclooctane. Once placed in the drawing area, these structures can be edited by changing the bond order (single, double and triple), by changing the atom type (element), or by changing the stereo style (stereo marking).</p>
          </sec>
          <sec id="Sec11">
            <title>Use of a special key</title>
            <p>The <italic>Shift</italic> key on the computer keyboard can be used to modify some of the drawing operations of FlaME: whereas ring fusion (annulation) by clicking with a ring template on an existing ring bond normally produces a fully expanded condensed system, pressing the <italic>Shift</italic> key while clicking will cause the new ring to be flipped to the opposite direction (Figure <xref rid="Fig3" ref-type="fig">3</xref>, structure a). Similarly, adding a ring template to an existing ring atom normally produces two rings connected by a single bond, whereas the <italic>Shift</italic> key modifies this behavior and leads to a spiro ring system (Figure <xref rid="Fig3" ref-type="fig">3</xref>, structure b). Furthermore, by pressing the <italic>Shift</italic> key the user can prevent the delete operation from removing terminal ("orphan") atoms when a bond is deleted (Figure <xref rid="Fig3" ref-type="fig">3</xref>, structure c). The latter option can be used to create disconnected structures (e.g., salts) from a single molecule, thus providing a work-around for the current limitation of FlaME to handle only a single connection table.<fig id="Fig3"><label>Figure 3</label><caption xml:lang="en"><p><bold>Using the Shift key while editing a molecular structure</bold>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_121_Fig3_HTML.jpg" /></fig></p>
          </sec>
          <sec id="Sec12">
            <title>Features which are not yet implemented</title>
            <p>Compared to the JME applet, FlaME still lacks a number of features which may be implemented in future versions. For instance, there is currently support for only one connection table at a time. Thus, there is no mode available for reaction input and depiction. Special definitions for query atoms are limited to A, Q, and X (see below), while R groups are not yet supported. Moreover, at present the only data exchange format is the MDL molfile format (V2000), whereas SMILES export is still on the to-do list.</p>
          </sec>
        </sec>
        <sec id="Sec13">
          <title>Implementation</title>
          <sec id="Sec14">
            <title>Development environment</title>
            <p>Flash applications are frequently used for advertisements and as games. Very useful applications have been also developed and widely employed for e-learning purposes. Flash as well as Java and JavaScript can be used to add interactivity to web pages using the programming language ActionScriipt, which has a similar syntax and semantics as JavaScript (or, more generally, is a dialect of ECMAScript). The FlaME application itself was developed using Adobe Flash Professional CS4, which provides an integrated development environment. It is equipped with a compiler which can produce either compact SWF files suitable for use on web pages, or so-called Windows-projectors or Macintosh-projectors which are platform-specific executables.</p>
            <p>FlaME is a single-file Flash application. It was written in ActionScript (AS2) and compiled as a Flash 8 SWF file. Thus, this application requires a common web browser (Firefox, IE, Opera, Chrome, Safari etc.) and the Flash Player plug-in at least in version 8. According to Adobe: "<italic>Today, over 86% of Internet-connected computers have adopted the Flash Player version 9</italic>" [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
            <p>Whereas there should be no principal (technical) problem to make use of an Adobe Flash Player also on Apple's mobile devices (iPhone, iPad and iPod touch), Apple has decided not to support Flash on these devices and therefore, applications such as FlaME cannot be used on them. However, essentially the same restriction applies to Java on the iPhone/iPad which also prevents Java-based structure editors from being employed on these mobile devices. Although there are some "inofficial" ways to install unsupported software on Apple's mobile devices, only a change in Apple's policy would lead to a general solution of this Flash/Java lack-of-support issue. It should be noted, however, that FlaME was developed for use on typical desktop computers rather than on mobile gadgets.</p>
          </sec>
          <sec id="Sec15">
            <title>Limitations</title>
            <p>Because of the inherent limitations of the V2000 MDL molfile format (see the CTfile formats description [<xref ref-type="bibr" rid="CR7">7</xref>]) which is used by FlaME for data exchange, the maximum number of atoms is limited to 999.</p>
          </sec>
          <sec id="Sec16">
            <title>FlaME application examples</title>
            <p>In this section, three application examples are presented which have been built around FlaME and which are freely accessible on the web. A common web development practice is to use both an &lt;object> tag and an &lt;embed> tag to display Flash (SWF) content within an HTML page [<xref ref-type="bibr" rid="CR11">11</xref>]. The nested-objects method requires a double <italic>object</italic> definition (the &lt;object> tag targeting older versions of Internet Explorer and the &lt;embed> tag targeting all other browsers), so it is necessary to define the object attributes and nested <italic>param</italic> elements twice [<xref ref-type="bibr" rid="CR12">12</xref>]. The required attributes are: <italic>classid</italic> (the value is always as shown below), <italic>type</italic>, <italic>width</italic>, and <italic>height</italic>. The required <italic>param</italic> element is <italic>movie</italic>, which defines once more the URL of a SWF file. For up-to-date web browsers, one specifies the URL of the Flash application with the <italic>src</italic> attribute.</p>
          </sec>
          <sec id="Sec17">
            <title>Embedding SWF content (i.e., the FlaME application) in HTML</title>
            <p>&lt;object classid='clsid:d27cdb6e-ae6d-11cf-96b8-444553540000'</p>
            <p>id='flame' height='438' width='350' align='middle'></p>
            <p>&lt;param name='allowScriptAccess' value='sameDomain'/></p>
            <p>&lt;param name='movie' value='flame.swf'/></p>
            <p>&lt;param name='quality' value='high'/></p>
            <p>&lt;param name='bgcolor' value='white'/></p>
            <p>&lt;embed src='flame.swf' quality='high' bgcolor='#ffffff' width='438' height='350'</p>
            <p>name='flame' align='middle' allowScriptAccess='sameDomain'</p>
            <p>type='application/x-shockwave-flash'</p>
            <p>pluginspage=<ext-link xlink:href="http://www.macromedia.com/go/getflashplayer" ext-link-type="uri">http://www.macromedia.com/go/getflashplayer</ext-link>/></p>
            <p>&lt;/object></p>
          </sec>
          <sec id="Sec18">
            <title>Application example 1: Structure Search</title>
            <p>This demonstration page [<xref ref-type="bibr" rid="CR13">13</xref>] uses FlaME as a replacement for JME in a modified version of the open-source structure database system MolDB5R [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR16">16</xref>]. The latter software employs the <italic>checkmol/matchmol</italic> program [<xref ref-type="bibr" rid="CR17">17</xref>] as the search engine. Figure <xref rid="Fig4" ref-type="fig">4</xref> shows a run in "similarity search" mode (using the Tanimoto index [<xref ref-type="bibr" rid="CR18">18</xref>] derived from binary fingerprints as similarity criterion), Figure <xref rid="Fig5" ref-type="fig">5</xref> shows another example in "substructure search" mode. Like with JME, special symbols (to be entered via the X-button) can be used for the definition of query atoms:<fig id="Fig4"><label>Figure 4</label><caption xml:lang="en"><p><bold>MolDB5R similarity search using FlaME for query input</bold>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_121_Fig4_HTML.jpg" /></fig><fig id="Fig5"><label>Figure 5</label><caption xml:lang="en"><p><bold>MolDB5R substructure search using FlaME for query input</bold>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_121_Fig5_HTML.jpg" /></fig></p>
            <p><bold>A</bold> for any atom except H</p>
            <p><bold>Q</bold> for any atom except H and C</p>
            <p><bold>X</bold> for any halogen atom</p>
            <p>Explicit <bold>H</bold>ydrogens are entered via a separate H button.</p>
          </sec>
          <sec id="Sec19">
            <title>Application example 2: Presentation of structure collections in "slide show" mode</title>
            <p>This web page (Figure <xref rid="Fig6" ref-type="fig">6</xref>) uses the JavaScript function <italic>setMol()</italic> to send the molfile of the selected structure to FlaME. The user can either send any of the listed structures to FlaME by clicking on the respective chemical name in the right area (printed in arbitrary color) or he/she can start a "slide show" by selecting the "play" button below the list. In the latter case, the data transfer process runs automatically with a pre-defined time interval.<fig id="Fig6"><label>Figure 6</label><caption xml:lang="en"><p><bold>FlaME demo page in "slide show" mode</bold>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_121_Fig6_HTML.jpg" /></fig></p>
          </sec>
          <sec id="Sec20">
            <title>Application example 3: FlaME editor vs. depiction</title>
            <p>This example (Figure <xref rid="Fig7" ref-type="fig">7</xref>) shows the FlaME editor (left side) in combination with a depiction-only version of the software (right side). In the latter incarnation, the "move structure" mode is activated by default, as well as "zoom in" and "zoom out" functions which are accessible on a web page via keyboard shortcuts or via HTML elements (buttons) connected to appropriate JavaScript functions.<fig id="Fig7"><label>Figure 7</label><caption xml:lang="en"><p><bold>FlaME: Molecular Editor vs. Depiction</bold>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_121_Fig7_HTML.jpg" /></fig></p>
            <p>This depiction-only version of FlaME was compiled separately without any GUI buttons and layout options. By doing so, the size of the SWF file could be reduced to approximately one third (25 kB) of the original file size of the editor version.</p>
          </sec>
        </sec>
        <sec id="Sec21">
          <title>Conclusions and Outlook</title>
          <p>A first attempt was made to create a compact single-file application for 2D molecular structure input/editing on the web, based on Flash technology. At present, the project should be regarded as a feasibility study and any feedback (comments and suggestions for further development and extensions) will be welcome.</p>
          <p>With the introduction of the Flash Molecular Editor (FlaME) as an alternative to similar input tools based on Java technology, we would like to start a discussion about the suitability (advantages and limitations) of the Flash environment for interactive chemistry-related websites. With the application examples presented in this article, it could be demonstrated that the Flash methods are principally well-suited to provide the requisite communication between the Flash object (application) and the HTML elements on the web page, using JavaScript functions.</p>
          <p>The next version of FlaME should include a reaction editor and some other extensions, for instance generation of SMILES [<xref ref-type="bibr" rid="CR19">19</xref>] output. For future developments, we envisage a separate Flash application for handling spectral data, e.g. for JCAMP-DX spectra viewing/editing. In this field, there are already some nice plug-ins and Java applets available (e.g., MDL Chime [<xref ref-type="bibr" rid="CR20">20</xref>], JSpecView Applet [<xref ref-type="bibr" rid="CR21">21</xref>], or the NIST JCAMP-DX Viewer [<xref ref-type="bibr" rid="CR22">22</xref>]), which could be taken as models for writing a comparable Flash-based tool.</p>
          <sec id="Sec22">
            <title>Use and Reference</title>
            <p>Developers of chemistry-enabled websites are invited to try FlaME on their pages. The utility [Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>] can be obtained free of charge from the authors. As the only condition for its use, we ask to place an appropriate reference next to the applet. The authors provide the present version of FlaME only as compiled SWF file, but we are contemplating the possibility to make it an open-source project in the future. We are aware of the fact that the major Flash development tools are not free. For a true open-source project, an open-source development tool such as AJAX Animator [<xref ref-type="bibr" rid="CR23">23</xref>] would be desirable. However, at present the latter product is still far away from its goal to be a complete web-based animation suite.</p>
          </sec>
        </sec>
        <sec id="Sec23">
          <title>Availability and requirements</title>
          <p>Project name: FlaME: Flash Molecular Editor - a 2D structure input tool for the web</p>
          <p>Project homepage and application examples URL: <ext-link xlink:href="http://synthon.pch.univie.ac.at/flame/" ext-link-type="uri">http://synthon.pch.univie.ac.at/flame/</ext-link></p>
          <p>Application download URL: <ext-link xlink:href="http://synthon.pch.univie.ac.at/flame/flame.swf" ext-link-type="uri">http://synthon.pch.univie.ac.at/flame/flame.swf</ext-link></p>
          <p>Operating system(s): Platform independent</p>
          <p>Programming language: Flash, ActionScript 2</p>
          <p>Other requirements: Adobe Flash Player 8 or higher</p>
          <p>License: individual license on request (free of charge).</p>
          <p>Any restrictions to use by non-academics: none</p>
        </sec>
      </body>
      <back>
        <ack>
          <title>Acknowledgements</title>
          <p>We thank all interested colleagues at our department for helpful discussions during the development and suggestions for further extension of FlaME.</p>
        </ack>
        <ref-list id="Bib1">
          <title>References</title>
          <ref-list>
            <ref id="CR1">
              <label>1.</label>
              <mixed-citation publication-type="other">Marvin Sketch. [<ext-link xlink:href="http://www.chemaxon.com/products/marvin/marvinsketch/" ext-link-type="uri">http://www.chemaxon.com/products/marvin/marvinsketch/</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR2">
              <label>2.</label>
              <mixed-citation publication-type="other">The PubChem Project, PubChem Sketcher. [<ext-link xlink:href="http://pubchem.ncbi.nlm.nih.gov/" ext-link-type="uri">http://pubchem.ncbi.nlm.nih.gov/</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR3">
              <label>3.</label>
              <mixed-citation publication-type="other">NIST Chemistry Webbook. NIST Molecule Editor. [<ext-link xlink:href="http://webbook.nist.gov/chemistry/str-app.shtml" ext-link-type="uri">http://webbook.nist.gov/chemistry/str-app.shtml</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR4">
              <label>4.</label>
              <mixed-citation publication-type="other">JME Molecular Editor. [<ext-link xlink:href="http://www.molinspiration.com/jme/index.html" ext-link-type="uri">http://www.molinspiration.com/jme/index.html</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR5">
              <label>5.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Ertl</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Molecular structure input on the web</article-title>
                <source>J Cheminf</source>
                <year>2010</year>
                <volume>2</volume>
                <fpage>1</fpage>
                <pub-id pub-id-type="doi">10.1186/1758-2946-2-1</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR6">
              <label>6.</label>
              <mixed-citation publication-type="other">ISIS (Symyx) Draw/Accelrys Draw. [<ext-link xlink:href="http://accelrys.com/products/informatics/cheminformatics/draw/index.html" ext-link-type="uri">http://accelrys.com/products/informatics/cheminformatics/draw/index.html</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR7">
              <label>7.</label>
              <mixed-citation publication-type="other">CT file formats (MDL MOL file). [<ext-link xlink:href="http://www.symyx.com/downloads/public/ctfile/ctfile.jsp" ext-link-type="uri">http://www.symyx.com/downloads/public/ctfile/ctfile.jsp</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR8">
              <label>8.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Clark</surname>
                    <given-names>AM</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Basic primitives for molecular diagram sketching</article-title>
                <source>J Cheminf</source>
                <year>2010</year>
                <volume>2</volume>
                <fpage>8</fpage>
                <pub-id pub-id-type="doi">10.1186/1758-2946-2-8</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR9">
              <label>9.</label>
              <mixed-citation publication-type="other">Macromedia Flash Support Center, Publishing and Exporting - Flash Methods. [<ext-link xlink:href="http://www.coldfusionmx.com.br/support/flash/publishexport/scriptingwithflash/scriptingwithflash_03.html" ext-link-type="uri">http://www.coldfusionmx.com.br/support/flash/publishexport/scriptingwithflash/scriptingwithflash_03.html</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR10">
              <label>10.</label>
              <mixed-citation publication-type="other">Adobe Flash website. [<ext-link xlink:href="http://kb2.adobe.com/cps/405/kb405456.html" ext-link-type="uri">http://kb2.adobe.com/cps/405/kb405456.html</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR11">
              <label>11.</label>
              <mixed-citation publication-type="other">Adobe Flash Platform - Embedding SWF content in HTML. [<ext-link xlink:href="http://help.adobe.com/en_US/air/html/dev/WS4B441C24-BAE3-4110-91FD-A4E5EEFB2467.html" ext-link-type="uri">http://help.adobe.com/en_US/air/html/dev/WS4B441C24-BAE3-4110-91FD-A4E5EEFB2467.html</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR12">
              <label>12.</label>
              <mixed-citation publication-type="other">Embedding Adobe Flash Player content using SWFObject. [<ext-link xlink:href="http://code.google.com/p/swfobject/wiki/documentation" ext-link-type="uri">http://code.google.com/p/swfobject/wiki/documentation</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR13">
              <label>13.</label>
              <mixed-citation publication-type="other">FlaME: Flash Molecular Editor, application examples. [<ext-link xlink:href="http://synthon.pch.univie.ac.at/flame/" ext-link-type="uri">http://synthon.pch.univie.ac.at/flame/</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR14">
              <label>14.</label>
              <mixed-citation publication-type="other">MolDB5 homepage. [<ext-link xlink:href="http://merian.pch.univie.ac.at/~nhaider/cheminf/moldb5.html" ext-link-type="uri">http://merian.pch.univie.ac.at/~nhaider/cheminf/moldb5.html</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR15">
              <label>15.</label>
              <mixed-citation publication-type="other">Haider N: Creating a Web-based, Searchable Molecular Structure Database Using Free Software. [<ext-link xlink:href="http://merian.pch.univie.ac.at/~nhaider/cheminf/moldb.html" ext-link-type="uri">http://merian.pch.univie.ac.at/~nhaider/cheminf/moldb.html</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR16">
              <label>16.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Haider</surname>
                    <given-names>N</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Functionality Pattern Matching as an Efficient Complementary Structure/Reaction Search Tool: an Open-Source Approach</article-title>
                <source>Molecules</source>
                <year>2010</year>
                <volume>15</volume>
                <fpage>5079</fpage>
                <lpage>5092</lpage>
                <pub-id pub-id-type="doi">10.3390/molecules15085079</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3cXpvV2qtro%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR17">
              <label>17.</label>
              <mixed-citation publication-type="other">The checkmol/matchmol homepage. [<ext-link xlink:href="http://merian.pch.univie.ac.at/~nhaider/cheminf/cmmm.html" ext-link-type="uri">http://merian.pch.univie.ac.at/~nhaider/cheminf/cmmm.html</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR18">
              <label>18.</label>
              <mixed-citation publication-type="other">Tanimoto TT: IBM Internal Report 17th Nov 1957, <italic>taken from</italic> Daylight Theory: Fingerprints - Screening and Similarity. [<ext-link xlink:href="http://www.daylight.com/dayhtml/doc/theory/theory.finger.html" ext-link-type="uri">http://www.daylight.com/dayhtml/doc/theory/theory.finger.html</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR19">
              <label>19.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Weininger</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Weininger</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Weininger</surname>
                    <given-names>JL</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">SMILES. 2. Algorithm for Generation of Unique SMILES Notation</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>1989</year>
                <volume>29</volume>
                <fpage>97</fpage>
                <lpage>101</lpage>
                <pub-id pub-id-type="doi">10.1021/ci00062a008</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaL1MXitFWlt7s%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR20">
              <label>20.</label>
              <mixed-citation publication-type="other">MDL Chime. [<ext-link xlink:href="http://www.symyx.com/support/developer/chime/" ext-link-type="uri">http://www.symyx.com/support/developer/chime/</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR21">
              <label>21.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Lancashire</surname>
                    <given-names>RJ</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The JSpecView Project: an Open Source Java viewer and converter for JCAMP-DX, and XML spectral data files</article-title>
                <source>Chem Cent J</source>
                <year>2007</year>
                <volume>1</volume>
                <fpage>31</fpage>
                <pub-id pub-id-type="doi">10.1186/1752-153X-1-31</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR22">
              <label>22.</label>
              <mixed-citation publication-type="other">NIST Chemistry Webbook. NIST JCAMP-DX Viewer. [<ext-link xlink:href="http://webbook.nist.gov/chemistry/" ext-link-type="uri">http://webbook.nist.gov/chemistry/</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR23">
              <label>23.</label>
              <mixed-citation publication-type="other">AJAX Animator. [<ext-link xlink:href="http://osflash.org/ajaxanimator" ext-link-type="uri">http://osflash.org/ajaxanimator</ext-link>]</mixed-citation>
            </ref>
          </ref-list>
        </ref-list>
        <app-group>
          <app id="App1">
            <sec id="Sec24">
              <title>Electronic supplementary material</title>
              <p>
                <supplementary-material content-type="local-data" id="MOESM1" xlink:title="Electronic supplementary material">
                  <media mimetype="application" mime-subtype="x-shockwave-flash" xlink:href="MediaObjects/13321_2010_121_MOESM1_ESM.SWF" position="anchor">
                    <caption xml:lang="en">
                      <p>Additional file 1: FlaME - Flash Molecular Editor. Platform independent SWF application file (SWF 78 KB)</p>
                    </caption>
                  </media>
                </supplementary-material>
              </p>
            </sec>
            <sec id="Sec25">
              <title>Authors’ original submitted files for images</title>
              <p>Below are the links to the authors’ original submitted files for images.<supplementary-material content-type="local-data" id="MOESM2" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="png" xlink:href="MediaObjects/13321_2010_121_MOESM2_ESM.png" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 1</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM3" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="png" xlink:href="MediaObjects/13321_2010_121_MOESM3_ESM.png" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 2</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM4" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="png" xlink:href="MediaObjects/13321_2010_121_MOESM4_ESM.png" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 3</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM5" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="png" xlink:href="MediaObjects/13321_2010_121_MOESM5_ESM.png" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 4</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM6" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="png" xlink:href="MediaObjects/13321_2010_121_MOESM6_ESM.png" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 5</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM7" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="png" xlink:href="MediaObjects/13321_2010_121_MOESM7_ESM.png" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 6</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM8" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="png" xlink:href="MediaObjects/13321_2010_121_MOESM8_ESM.png" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 7</p></caption></media></supplementary-material></p>
            </sec>
          </app>
        </app-group>
        <notes notes-type="Misc">
          <title>Competing interests</title>
          <p>The authors declare that they have no competing interests.</p>
        </notes>
        <notes notes-type="Misc">
          <title>Authors' contributions</title>
          <p>PD was involved in the design and programming of the FlaME software, in the implementation of the software and preparation of the application examples, and the manuscript preparation. NH was involved in testing and intellectual guidance during FlaME software development, in preparation of application examples, and manuscript preparation. All authors read and approved the final manuscript.</p>
        </notes>
      </back>
    </article>
