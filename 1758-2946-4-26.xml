<?xml version="1.0"?>
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="research-article" xml:lang="en">
      <front>
        <journal-meta>
          <journal-id journal-id-type="publisher-id">13321</journal-id>
          <journal-title-group>
            <journal-title>Journal of Cheminformatics</journal-title>
            <abbrev-journal-title abbrev-type="publisher">J Cheminform</abbrev-journal-title>
          </journal-title-group>
          <issn pub-type="epub">1758-2946</issn>
          <publisher>
            <publisher-name>Springer International Publishing</publisher-name>
            <publisher-loc>Cham</publisher-loc>
          </publisher>
        </journal-meta>
        <article-meta>
          <article-id pub-id-type="publisher-id">BMC1758-2946-4-26</article-id>
          <article-id pub-id-type="manuscript">364</article-id>
          <article-id pub-id-type="doi">10.1186/1758-2946-4-26</article-id>
          <article-categories>
            <subj-group subj-group-type="heading">
              <subject>Methodology</subject>
            </subj-group>
          </article-categories>
          <title-group>
            <article-title xml:lang="en">A rule-based algorithm for automatic bond type perception</article-title>
          </title-group>
          <contrib-group>
            <contrib contrib-type="author">
              <name>
                <surname>Zhang</surname>
                <given-names>Qian</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Zhang</surname>
                <given-names>Wei</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff3">3</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Li</surname>
                <given-names>Youyong</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Wang</surname>
                <given-names>Junmei</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff3">3</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Zhang</surname>
                <given-names>Liling</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author" corresp="yes">
              <name>
                <surname>Hou</surname>
                <given-names>Tingjun</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="aff" rid="Aff2">2</xref>
              <xref ref-type="corresp" rid="IDBMC17582946426_cor6">f</xref>
            </contrib>
            <aff id="Aff1">
              <label>1</label>
              <institution-wrap>
                <institution-id institution-id-type="GRID">grid.263761.7</institution-id>
                <institution-id institution-id-type="ISNI">0000000101980694</institution-id>
                <institution content-type="org-division">>Institute of Functional Nano &amp; Soft Materials (FUNSOM) and Jiangsu Key Laboratory for Carbon-Based Functional Materials &amp; Devices</institution>
                <institution content-type="org-name">Soochow University</institution>
              </institution-wrap>
              <addr-line content-type="postcode">215123</addr-line>
              <addr-line content-type="city">Suzhou</addr-line>
              <addr-line content-type="state">Jiangsu</addr-line>
              <country country="CN">China</country>
            </aff>
            <aff id="Aff2">
              <label>2</label>
              <institution-wrap>
                <institution-id institution-id-type="GRID">grid.263761.7</institution-id>
                <institution-id institution-id-type="ISNI">0000000101980694</institution-id>
                <institution content-type="org-division">College of Pharmaceutical Sciences</institution>
                <institution content-type="org-name">Soochow University</institution>
              </institution-wrap>
              <addr-line content-type="postcode">215123</addr-line>
              <addr-line content-type="city">Suzhou</addr-line>
              <addr-line content-type="state">Jiangsu</addr-line>
              <country country="CN">China</country>
            </aff>
            <aff id="Aff3">
              <label>3</label>
              <institution-wrap>
                <institution-id institution-id-type="GRID">grid.267313.2</institution-id>
                <institution-id institution-id-type="ISNI">0000000094827121</institution-id>
                <institution content-type="org-division">Department of Biochemistry</institution>
                <institution content-type="org-name">The University of Texas Southwestern Medical Center</institution>
              </institution-wrap>
              <addr-line content-type="street">5323 Harry Hines Blvd</addr-line>
              <addr-line content-type="postcode">75390</addr-line>
              <addr-line content-type="city">Dallas</addr-line>
              <addr-line content-type="state">TX</addr-line>
              <country country="US">USA</country>
            </aff>
          </contrib-group>
          <author-notes>
            <corresp id="IDBMC17582946426_cor6">
              <label>f</label>
              <email>HIDDEN</email>
            </corresp>
          </author-notes>
          <pub-date date-type="pub" publication-format="electronic">
            <day>31</day>
            <month>10</month>
            <year>2012</year>
          </pub-date>
          <pub-date date-type="collection" publication-format="electronic">
            <month>12</month>
            <year>2012</year>
          </pub-date>
          <volume>4</volume>
          <issue seq="34">1</issue>
          <elocation-id>26</elocation-id>
          <history>
            <date date-type="registration">
              <day>11</day>
              <month>7</month>
              <year>2012</year>
            </date>
            <date date-type="received">
              <day>11</day>
              <month>7</month>
              <year>2012</year>
            </date>
            <date date-type="accepted">
              <day>23</day>
              <month>10</month>
              <year>2012</year>
            </date>
            <date date-type="online">
              <day>31</day>
              <month>10</month>
              <year>2012</year>
            </date>
          </history>
          <permissions>
            <copyright-statement content-type="compact">© Zhang et al.; licensee Chemistry Central Ltd. 2012</copyright-statement>
            <copyright-statement content-type="comment">This article is published under license to BioMed Central Ltd. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link xlink:href="http://creativecommons.org/licenses/by/2.0" ext-link-type="uri">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</copyright-statement>
            <copyright-year>2012</copyright-year>
            <copyright-holder>Zhang et al.; licensee Chemistry Central Ltd.</copyright-holder>
            <license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/2.0">
              <license-p><bold>Open Access</bold>
 This article is distributed under the terms of the Creative Commons Attribution 2.0 International License (
    <ext-link xlink:href="https://creativecommons.org/licenses/by/2.0" ext-link-type="uri">https://creativecommons.org/licenses/by/2.0</ext-link>
    ), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.
</license-p>
            </license>
          </permissions>
          <abstract xml:lang="en" id="Abs1">
            <title>Abstract</title>
            <p>Assigning bond orders is a necessary and essential step for characterizing a chemical structure correctly in force field based simulations. Several methods have been developed to do this. They all have advantages but with limitations too. Here, an automatic algorithm for assigning chemical connectivity and bond order regardless of hydrogen for organic molecules is provided, and only three dimensional coordinates and element identities are needed for our algorithm. The algorithm uses hard rules, length rules and conjugation rules to fix the structures. The hard rules determine bond orders based on the basic chemical rules; the length rules determine bond order by the length between two atoms based on a set of predefined values for different bond types; the conjugation rules determine bond orders by using the length information derived from the previous rule, the bond angles and some small structural patterns. The algorithm is extensively evaluated in three datasets, and achieves good accuracy of predictions for all the datasets. Finally, the limitation and future improvement of the algorithm are discussed.</p>
            <fig id="Figa" position="anchor">
              <graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_Figa_HTML.gif" position="anchor" />
            </fig>
          </abstract>
          <kwd-group xml:lang="en">
            <title>Keywords</title>
            <kwd>Bond type perception</kwd>
            <kwd>Bond order</kwd>
            <kwd>Chemical bond</kwd>
            <kwd>Molecular modeling</kwd>
          </kwd-group>
          <custom-meta-group>
            <custom-meta>
              <meta-name>publisher-imprint-name</meta-name>
              <meta-value>Chemistry Central</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-issue-count</meta-name>
              <meta-value>1</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-article-count</meta-name>
              <meta-value>39</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-holder</meta-name>
              <meta-value>The Author(s)</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-year</meta-name>
              <meta-value>2012</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-contains-esm</meta-name>
              <meta-value>Yes</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-year</meta-name>
              <meta-value>2012</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-month</meta-name>
              <meta-value>7</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-day</meta-name>
              <meta-value>11</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-product</meta-name>
              <meta-value>ArchiveJournal</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-grants-type</meta-name>
              <meta-value>OpenChoice</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>metadata-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>abstract-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodypdf-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodyhtml-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bibliography-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>esm-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>online-first</meta-name>
              <meta-value>false</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-file-reference</meta-name>
              <meta-value>BodyRef/PDF/13321_2012_Article_364.pdf</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-type</meta-name>
              <meta-value>Typeset</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>target-type</meta-name>
              <meta-value>OnlinePDF</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-type</meta-name>
              <meta-value>OriginalPaper</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-primary</meta-name>
              <meta-value>Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computer Applications in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Documentation and Information in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Theoretical and Computational Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computational Biology/Bioinformatics</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-collection</meta-name>
              <meta-value>Chemistry and Materials Science</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>open-access</meta-name>
              <meta-value>true</meta-value>
            </custom-meta>
          </custom-meta-group>
        </article-meta>
        <notes notes-type="ESMHint">
          <title>Electronic supplementary material</title>
          <p>The online version of this article (doi:<ext-link xlink:href="10.1186/1758-2946-4-26" ext-link-type="doi">10.1186/1758-2946-4-26</ext-link>) contains supplementary material, which is available to authorized users.</p>
        </notes>
      </front>
      <body>
        <sec id="Sec1">
          <title>Background</title>
          <p>The advances in protein cloning, expression, labeling, purification, protein crystallization and structure determination has resulted in a rapid increase in protein structures having been determined [<xref ref-type="bibr" rid="CR1">1</xref>]. Nearly 45 years ago, the process to determine a small-molecule crystal structure consumed several months, and the bottlenecks were the data-collection, structure-solution and structure-refinements stages [<xref ref-type="bibr" rid="CR2">2</xref>]. In recent years, X-ray crystallography and solution NMR, the two major techniques broadly used for determining the atomic structures of biomolecules, have been improved substantially [<xref ref-type="bibr" rid="CR3">3</xref>]. There already have 85212 PDB files (2012.10.09) deposited in the RCSB Protein Data Bank [<xref ref-type="bibr" rid="CR4">4</xref>]. For proteins and nucleic acids, bond orders can be easily deduced but it is not so easy for other types of molecules, such as ligands [<xref ref-type="bibr" rid="CR5">5</xref>]. Because the resolutions of a lot of X-ray structures are not high enough, the hydrogen atoms and bond type information usually cannot be identified and even the coordinates have large errors, which bring difficulty in confirming the bond types of the structures. Although we can manually assign the bond types for the co-crystalized ligands, the procedure is tedious and time-consuming if one wants to deal with a large number of structures.</p>
          <p>Many methods have been developed for automatically detecting the chemical structures [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR14">14</xref>]. For example, Baber et al. developed an algorithm to assign the bond orders by comparing the bond length with ideal values, and this algorithm uses a confidence value for each bond to solve the conflicts between coordination state and bond order [<xref ref-type="bibr" rid="CR6">6</xref>]. Hendlich and co-workers proposed the BALI method to automatically assign bonds for protein ligand in the Brookhaven Protein Data Bank, and the assignment procedure of BALI has several stages, including the recognition of simple functional groups, the perception of ring systems, and the optimization of the assignment of alternating single and double bonds to networks of sp<sup>2</sup> hybridized atoms [<xref ref-type="bibr" rid="CR9">9</xref>]. Froeyen and Herdewijn proposed a procedure to assign double and triple bonds in small molecules from simple PDB files; the method uses sigma bonds connectivity and atom symbols as the input, and then assigns double and triple bonds by translating the octet equations into an integer liner program [<xref ref-type="bibr" rid="CR8">8</xref>]. Bruno et al. designed an algorithm to assign bonds for the molecules in the CSD (Cambridge Structural Database). Bruno’s algorithm divides the whole molecule into small fragments at first, then calculates the frequencies of the fragments in the CSD and uses geometry tests to obtain conditional probability, and finally apply Bayes’ formula to assign structures [<xref ref-type="bibr" rid="CR7">7</xref>]. Zhao’s method detects the hybridization states of atoms and then uses functional groups and length rules to determine the bond types [<xref ref-type="bibr" rid="CR13">13</xref>]. Wang and Case applied a recursive algorithm to assign bond types using the atom symbols and bond connectivity table as input. In Wang’s algorithm, the best assignment is recognized when the total bond order of each atom satisfying the predefined atomic valence parameter [<xref ref-type="bibr" rid="CR14">14</xref>].</p>
          <p>All these available methods have their own advantages, but at the same time, have some disadvantages too. For example, Labute used Maximum Weighted Matching algorithm to assign bond orders instead of using group patterns in order to avoid mis-constructing structures that are similar to group patterns [<xref ref-type="bibr" rid="CR10">10</xref>]. However, due to this advantage, the structures with large coordinate errors usually cannot be fixed because this method heavily relies on precise coordinates. Opposite to Labute’s work, the algorithm developed by Zhao et al. assigns the hybridization states for each atom first, and then uses a lot of functional groups to assign bond orders [<xref ref-type="bibr" rid="CR13">13</xref>]. Using functional groups can avoid the disadvantage of poor coordinates, but the false detections of hybridization and similar structures will impair bond perception. Wang and Case’s algorithm, which has been implemented in the Antechamber module of AMBER package, is robust and widely used among the AMBER community; however, their method fails if the input molecule has open valences.</p>
          <p>In our work, in order to overcome the disadvantages mentioned above, we designed a new algorithm for the bond perception based on three different sets of rules: hard rules, length rules and conjugation rules. Moreover, in this algorithm, we employed small structural patterns to assign the matched groups rather than using large ones, which can avoid the errors caused by similar structures. In conjugation rules, we divide the bonds that remain unfixed into several groups, and the bonds that connect to each other are in the same group. And then, in order to enhance the reliability of the results we fix these groups one by one instead of fixing bonds separately. The flow chart of our algorithm is shown in Figure <xref rid="Fig1" ref-type="fig">1</xref>. Compared with the other algorithms, our algorithm has the following advantages: (1). this algorithm has a better tolerance of coordinate error; (2). it can avoid many false perceptions because of the employment of fewer patterns; (3). it can select a better structure from isomers by using the bond entropy; (4). it can assign the bond orders for the structures without hydrogen.<fig id="Fig1"><label>Figure 1</label><caption xml:lang="en"><p><bold>The flow chart of the algorithm.</bold></p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2012_Article_364_Fig1_HTML.jpg" /></fig></p>
        </sec>
        <sec id="Sec2">
          <title>Results and discussion</title>
          <p>We used three data sets to validate our algorithm. The first data set collected by Ricketts et al. [<xref ref-type="bibr" rid="CR15">15</xref>] has 17 ligands extracted from the PDB files (PDB entries are 1cla, 1fcb, 1fx1, 1gox, 2aat, 2dhf, 2gbp, 2trm, 3cpp, 3ptb, 4dfr, 4xia, 5xia, 7dfr, 8atc, and 8rsa), and it has been extensively used for testing the algorithms of bond assignment. Therefore, this data set was also used by us to evaluate our algorithm.</p>
          <p>The performance of our algorithm and the other four algorithms for the first data set is summarized in Table <xref rid="Tab1" ref-type="table">1</xref>. In all these algorithms, the algorithm developed by Sayle et al. correctly fixed all the structures. It should be noted that all the structures were used to train the Sayle’s algorithm [<xref ref-type="bibr" rid="CR12">12</xref>], and therefore it is understandable that the Sayle’s algorithm can fix all the structures in the first data set. The Labute’s algorithm correctly perceived 14 structures, the Baber’s algorithm 7, and the Meng’s algorithm 5. Our algorithm correctly perceived 16 structures, and only failed on 1 structure in 2trm. The ligand in 2trm is benzamidine, and our method detects a cyclohexene ring instead of a benzene ring. From the front view shown in Figure <xref rid="Fig2" ref-type="fig">2</xref>, it can be found that the ring of six carbons is just like cyclohexane in its chair form, and therefore our algorithm assigns the six C-C bonds to single bonds because all these atoms are not on the same plane.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p><bold>The performance of different algorithms on the first data set</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th><p>Algorithm</p></th><th><p>Success number</p></th><th><p>Success rate</p></th></tr></thead><tbody><tr><td><p>Baber</p></td><td><p>7</p></td><td><p>41.2%</p></td></tr><tr><td><p>Meng</p></td><td><p>5</p></td><td><p>29.4%</p></td></tr><tr><td><p>Sayle</p></td><td><p>17</p></td><td><p>100%</p></td></tr><tr><td><p>Labute</p></td><td><p>14</p></td><td><p>82.4%</p></td></tr><tr><td><p>Our</p></td><td><p>16</p></td><td><p>94.1%</p></td></tr></tbody></table></table-wrap><fig id="Fig2"><label>Figure 2</label><caption xml:lang="en"><p><bold>The representation of the ligand in 2trm in different orientations.</bold></p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2012_Article_364_Fig2_HTML.jpg" /></fig></p>
          <p>According to the evaluation results for the first data set, our algorithm has excellent performance among those algorithms. Then, a larger data set with 179 entries (hydrogen suppressed) from the PDB was used for the further assessment of our algorithm. Labute et al. [<xref ref-type="bibr" rid="CR10">10</xref>] and Zhao et al. [<xref ref-type="bibr" rid="CR13">13</xref>] used this data set to test their algorithms. The PDB codes of these structures in the second data set are listed in Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>: Table S2. Among the 179 structures, 170 were correctly interpreted (95.0%) by our algorithm and 9 were incorrectly perceived. The Labute’s algorithm failed on 11 structures and the Zhao’s algorithm on 9 structures. Moreover, two popular molecular simulation packages, including Discovery Studio (version 2.5) [<xref ref-type="bibr" rid="CR16">16</xref>] and SYBYL-X (version 1.3) [<xref ref-type="bibr" rid="CR17">17</xref>], were used to perceive the molecules in the second data set. According to the prediction results, Discovery Studio failed on 25 structures and SYBYL even failed on 46 structures. That is to say, the performance of Discovery Studio and SYBYL is much worse than that of our algorithm. The problematic structures predicted by our algorithm are listed in Table <xref rid="Tab2" ref-type="table">2</xref>:<list list-type="order"><list-item><p>1cps and 3dfr: several bonds in 1cps and 3dfr that were supposed to be double are too long, and then they were assigned to single due to their lengths. The lengths of two C-C bonds in the ring of 1cps are 1.62Å and 1.57Å, respectively, and are larger than 1.49Å. The length of a C-C bond in 3DFR is 1.54Å and was set to single according to length rules.</p></list-item><list-item><p>1bzm, 1nnb, 1rne and 3fx2: for the ligands extracted from these four PDB files, several double bonds were incorrectly detected because they are not on the plane. We calculated the smallest angle between the bond and plane, and found that none of them satisfied the plane rule, and therefore all of them were set to single bonds. Here we may find two solutions to improve our algorithm: design and apply more structural patterns or modify the criteria used to check the plane.</p></list-item><list-item><p>5tln and 8xia: the terminal bond C-O is supposed to be double but the angle of O-C-C deviates greatly from 120° (90.56° and 97.63°, respectively), so our algorithm set their bond orders to 1 based on our rules. We suspect inadequate refinement of the ligand geometry because the same functional groups in the other entries can be correctly perceived by our algorithm.</p></list-item><list-item><p>5tim: two sulfurs in 5tim are not connected to each other in the correct structure. But because of short distance, a connection between them was established. Moreover, due to the non-existence of hydrogen, and the maximum connection number of sulfur is 4, and therefore we could not find out the false connection by detecting the number of the connected atoms and the valence. One way that may solve this problem is to calculate the hybridization of sulfur. But because no hydrogen is provided, even if the two sulfurs are connected, we still cannot find the mistake just based on the structure.</p></list-item></list><table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p><bold>The nine failed structures predicted by our algorithm</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>PDB code</p></th><th align="center"><p>Predicted structure</p></th><th align="center"><p>Correct structure</p></th></tr></thead><tbody><tr><td align="left"><p>1bzm</p></td><td align="center"><p><inline-formula id="IEq1"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq1_HTML.gif" /></inline-formula></p></td><td align="center"><p><inline-formula id="IEq2"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq2_HTML.gif" /></inline-formula></p></td></tr><tr><td align="left"><p>1cps</p></td><td align="center"><p><inline-formula id="IEq3"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq3_HTML.gif" /></inline-formula></p></td><td align="center"><p><inline-formula id="IEq4"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq4_HTML.gif" /></inline-formula></p></td></tr><tr><td align="left"><p>1nnb</p></td><td align="center"><p><inline-formula id="IEq5"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq5_HTML.gif" /></inline-formula></p></td><td align="center"><p><inline-formula id="IEq6"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq6_HTML.gif" /></inline-formula></p></td></tr><tr><td align="left"><p>1rne</p></td><td align="center"><p><inline-formula id="IEq7"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq7_HTML.gif" /></inline-formula></p></td><td align="center"><p><inline-formula id="IEq8"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq8_HTML.gif" /></inline-formula></p></td></tr><tr><td align="left"><p>3dfr</p></td><td align="center"><p><inline-formula id="IEq9"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq9_HTML.gif" /></inline-formula></p></td><td align="center"><p><inline-formula id="IEq10"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq10_HTML.gif" /></inline-formula></p></td></tr><tr><td align="left"><p>3fx2</p></td><td align="center"><p><inline-formula id="IEq11"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq11_HTML.gif" /></inline-formula></p></td><td align="center"><p><inline-formula id="IEq12"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq12_HTML.gif" /></inline-formula></p></td></tr><tr><td align="left"><p>5tim</p></td><td align="center"><p><inline-formula id="IEq13"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq13_HTML.gif" /></inline-formula></p></td><td align="center"><p><inline-formula id="IEq14"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq14_HTML.gif" /></inline-formula></p></td></tr><tr><td align="left"><p>5tln</p></td><td align="center"><p><inline-formula id="IEq15"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq15_HTML.gif" /></inline-formula></p></td><td align="center"><p><inline-formula id="IEq16"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq16_HTML.gif" /></inline-formula></p></td></tr><tr><td align="left"><p>8xia</p></td><td align="center"><p><inline-formula id="IEq17"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq17_HTML.gif" /></inline-formula></p></td><td align="center"><p><inline-formula id="IEq18"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq18_HTML.gif" /></inline-formula></p></td></tr></tbody></table></table-wrap></p>
          <p>Compared with the results predicted by the Labute’s algorithm, we find that 2cgr, 3dfr and 5tln were not correctly detected by both of the Labute’s algorithm and our algorithm. Labute ascribed these errors to questionable or ambiguous geometry. According to our analysis, we think that the wrong perception of structures can be explained by the following two reasons: awkward structures and imperfect algorithm. For awkward coordinates, we may analyze the large prior data to get an amendment between PDB files and true structures instead of using patterns, because if more patterns are used, more errors may be introduced. But on the other hand, we still need some structural patterns to deal with the coordinate errors when the resolution of a PDB file is not high. Furthermore, the judgment of atom connection is also an important point to which we need to pay more attention.</p>
          <p>Finally, we tested our algorithm on an extensive collection of 1290 small molecules (with hydrogen) used by us to train a prediction model of solubility [<xref ref-type="bibr" rid="CR18">18</xref>]. For this dataset, our algorithm achieves the prediction accuracy is 97.8% (1265 structures were correctly perceived). Out of the 25 failed structures, most of them (19) were found to have unusual bond lengths. For those failed cases, two possibilities lead to false perception: (1). in most cases distance between two atoms that is supposed to be connected is longer than the upper limit defined in our algorithm, and in some cases bonds were assigned to double by the length rules because of the short distance due to bad coordinates; (2). for some special structures, the rules in our algorithm cannot be applied correctly, and four structures are shown in Figure <xref rid="Fig3" ref-type="fig">3</xref> as examples. As shown in Figure <xref rid="Fig3" ref-type="fig">3</xref>, the double bonds colored in red were predicted to be single by our algorithm. For these four structures the bond types of them are just beyond our rules. For example, for structure (a) in Figure <xref rid="Fig3" ref-type="fig">3</xref>, the length of the falsely predicted bond is 1.33 Å, suggesting that this bond has chance to be double by the length rule. While applying the conjugation rule, we found that cos of this bond is 0.60, which is larger than 0.50. Therefore this bond was set to single regardless of its bond length; however, it should be a double bond because it is in an aromatic ring. Thus, we can understand why the incorrect bond lengths in these structures cannot be handled by our algorithm because they are beyond the conventional values defined in our algorithm. We then used Discovery Studio [<xref ref-type="bibr" rid="CR16">16</xref>], MOE [<xref ref-type="bibr" rid="CR19">19</xref>] and SYBYL [<xref ref-type="bibr" rid="CR17">17</xref>] to perceive the bond types for these 25 molecules that cannot be correctly predicted by our algorithm. We found that only one of them could be fixed by Discovery Studio and MOE, and none of the 19 molecules that have unusual bond lengths could be fixed. However, it is interesting to find that SYBYL can fix seven of them. That is to say, for these 25 molecules that cannot be correctly predicted by our algorithm, SYBYL performs better than Discovery Studio, MOE and even our algorithm.<fig id="Fig3"><label>Figure 3</label><caption xml:lang="en"><p><bold>Four failed small molecules with the bond types beyond the rules in our algorithm</bold><bold>(the unfixed bonds are colored in red).</bold></p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2012_Article_364_Fig3_HTML.jpg" /></fig></p>
          <p>Then, these 1290 molecules were minimized using the MMFF94 force field implemented in SYBYL [<xref ref-type="bibr" rid="CR17">17</xref>]. Each structure in the sdf file was converted to the PDB format. After applying our algorithm, all molecules could be fixed correctly, suggesting that when the coordinates of the studied small molecules are reasonable the prediction accuracy of our algorithm can almost achieve 100%.</p>
        </sec>
        <sec id="Sec3" sec-type="conclusions">
          <title>Conclusions</title>
          <p>We have presented a rule-based algorithm for automatic bond type perception in molecules given 3D atomic coordinates and element identities. Our algorithm is efficient to detect the structures when their geometries are reasonable. For many structures with coordinate errors, we can also perceive them by applying the small structural patterns.</p>
          <p>However, there still remain some challenges, especially for molecules with misconnected and false connected bonds. Due to the absence of hydrogen in many structures we cannot determine whether bond efficiency is satisfied or not. And for the false connected bonds, we check the maximum connection number first, and detect the valence at last. In our algorithm we prefer to use small structural patterns to perceive structures instead of using a lot of large ones, and this will reduce the possibilities of perceiving structures incorrectly caused by similar structures. When fixing the isomers, we use the entropy of bond to select the best isomer.</p>
          <p>In the near future we plan to improve our algorithm in two directions:<list list-type="order"><list-item><p>Connection detection: We plan to design and employ better rules to detect the bonds which should be connected but are ignored by our algorithm and to reduce the redundant bonds that are over-connected.</p></list-item><list-item><p>Define the entropy of bond by using more subtle scheme: To achieve this, a training process based on a lot of data is necessary. Some parameters and formula should be changed according to the training results.</p></list-item></list></p>
        </sec>
        <sec id="Sec4" sec-type="methods">
          <title>Methods</title>
          <sec id="Sec5">
            <title>Identification of connected atoms</title>
            <p>First, connection between atoms should be judged according to Equation <xref rid="Equ1" ref-type="disp-formula">1</xref>.<disp-formula id="Equ1"><label>1</label><alternatives><mml:math id="Equ1_Math"><mml:mrow><mml:mn>0.8</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mtext mathvariant="italic">ij</mml:mtext></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_Equ1_HTML.gif" /></alternatives></disp-formula></p>
            <p>where <italic>r</italic><sub><italic>i</italic></sub> and <italic>r</italic><sub><italic>j</italic></sub> are the covalent radii of atoms <italic>i</italic> and <italic>j</italic> (the detailed data is listed in Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>: Table S1[<xref ref-type="bibr" rid="CR20">20</xref>]), and <italic>d</italic><sub><italic>ij</italic></sub> is the distance between them.</p>
            <p>The right side of Equation <xref rid="Equ1" ref-type="disp-formula">1</xref> is derived by Meng and Lewis [<xref ref-type="bibr" rid="CR11">11</xref>], and the left side was derived from our structural analysis based on 126,292 small molecules extracted from the ZINC database [<xref ref-type="bibr" rid="CR21">21</xref>], and these molecules belong to the “all-purchasable” subset in ZINC. When the cutoff of 0.8 was not used and only the right side of Equation <xref rid="Equ1" ref-type="disp-formula">1</xref> was used to detect the connection of small molecules, 78 molecules had false connections. After adding the cutoff of 0.8, the number of the molecules with false predictions was reduced to 58. Therefore, in order to achieve more accurate predictions, the cutoff of 0.8 was employed. When bond <italic>b</italic><sub><italic>ij</italic></sub> was established, its initial bond order <italic>O</italic><sub><italic>ij</italic></sub> was set to 1.</p>
            <p>This algorithm only judges the bond type between H, C, N, O, F, P, S, Cl, Br, and I, and the other kinds of bond order were simply set to 1. The bonds that have already been fixed would not be detected in the following steps, except that it is in a group and the group has many isomers.</p>
          </sec>
          <sec id="Sec6">
            <title>Over-connected correction</title>
            <p>Due to the intrinsic property of each element, it should have the maximum connections. Here, we check whether C(4), N(4), P(4) or S(4) is over-connected (the number in parenthesis represents the maximum number of connections); if so, the longest bond is removed and the atom is check again until the number of the connections is no longer bigger than its maximum connection number. Here we only consider the above four kinds of elements, and the connections for the other elements are handled at the bottom of this algorithm.</p>
          </sec>
          <sec id="Sec7">
            <title>Hard rules</title>
            <p>We employed some basic chemical rules to assign the bond types.<list list-type="order"><list-item><p>We use <italic>A</italic><sub><italic>i</italic></sub> to denote atom <italic>i</italic>, and set its bonded number, <italic>C</italic><sub><italic>i</italic></sub>, be the number of the atoms that are connected with this atom. If the number equals to<list list-type="order"><list-item><p>If the atom is hydrogen or halogen, <italic>O</italic><sub><italic>ij</italic></sub> is set to 1.</p></list-item><list-item><p>If the atom is sulfur and it connects to phosphorus, or the atom is nitrogen and it connects to sulfur, <italic>O</italic><sub><italic>ij</italic></sub> is set to 2.</p></list-item><list-item><p>If else, leave the bond unfixed and leave this rule.</p></list-item></list></p></list-item><list-item><p>when <italic>C</italic><sub><italic>i</italic></sub> is 2 1 we apply the following rules:<list list-type="order"><list-item><p>If the atom is oxygen or sulfur, <italic>O</italic><sub><italic>ij</italic></sub> is set to 1 as the valence of oxygen and sulfur is 2.</p></list-item><list-item><p><italic>C</italic><sub><italic>j</italic></sub> = max {<italic>C</italic><sub><italic>j</italic></sub>, <italic>C</italic><sub><italic>k</italic></sub>}, <italic>C</italic><sub><italic>k</italic></sub> = max {<italic>C</italic><sub><italic>j</italic></sub>, <italic>C</italic><sub><italic>k</italic></sub>}, if <italic>Cj</italic> = 1, skip step 2.</p></list-item><list-item><p>Calculate the angle of two connected bonds (<italic>b</italic><sub><italic>ij</italic></sub> and <italic>b</italic><sub><italic>ik</italic></sub>) using the following two equations: <disp-formula id="Equ2"><label>2</label><alternatives><mml:math id="Equ2_Math"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mtext>cos</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>·</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mfrac></mml:mrow></mml:math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_Equ2_HTML.gif" /></alternatives></disp-formula><disp-formula id="Equ3"><label>3</label><alternatives><mml:math id="Equ3_Math"><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>θ</mml:mi><mml:mo>·</mml:mo><mml:msup><mml:mn>180</mml:mn><mml:mo>∘</mml:mo></mml:msup><mml:mo>/</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_Equ3_HTML.gif" /></alternatives></disp-formula></p></list-item></list></p></list-item></list></p>
            <p>where <italic>x</italic><sub><italic>i</italic></sub>, <italic>x</italic><sub><italic>j</italic></sub> and <italic>x</italic><sub><italic>k</italic></sub> are the coordinates of atoms <italic>i</italic>, <italic>j</italic>, and <italic>k</italic>.</p>
            <p>If <italic>θ</italic><sup>’</sup> is between 175° and 185°, these two bonds are considered to be linearly connected, and there are three kinds of possible schemes: when <italic>C</italic><sub><italic>j</italic></sub> equals to 2, suggesting that the bonded number of this atom is 2 and if the bond angle between its two bonds is between 175° and 185°, three adjacent bonds are therefore just in line. Here, we assume no continuous triple bond systems, and considering <italic>b</italic><sub><italic>ij</italic></sub> is in the middle of them, <italic>O</italic><sub><italic>ij</italic></sub> is set to 3 and then <italic>O</italic><sub><italic>ik</italic></sub> is set to 1. If <italic>A</italic><sub><italic>k</italic></sub> is C or N, <italic>O</italic><sub><italic>ij</italic></sub> is set to 1 and then <italic>O</italic><sub><italic>ik</italic></sub> is set to 2. In the other cases, both of <italic>O</italic><sub><italic>ij</italic></sub> and <italic>O</italic><sub><italic>ik</italic></sub> are set to 2. All models are applied if the previous ones do not work. <list list-type="order"><list-item><p>when <italic>C</italic><sub><italic>i</italic></sub> equals to 3<list list-type="order"><list-item><p>When the atom is N or P, and if it connects to oxygen (<italic>A</italic><sub><italic>j</italic></sub>) and <italic>C</italic><sub><italic>j</italic></sub> = 1, this group is fixed using an acid model. If not, and all bond orders are set to be single.</p></list-item><list-item><p>When the atom is S, Cl, Br or I, and if it connects to oxygen (<italic>A</italic><sub><italic>j</italic></sub>) and <italic>C</italic><sub><italic>j</italic></sub> = 1, this group is fixed as an acid. If not, leave it.</p></list-item><list-item><p>When the atom is C, this atom and its connected atoms are put into one group, and the cos  of this group (Figure <xref rid="Fig4" ref-type="fig">4</xref>) is calculated using the following two equations:</p></list-item></list></p></list-item></list><fig id="Fig4"><label>Figure 4</label><caption xml:lang="en"><p><bold>The definition of</bold><italic>φ</italic>. <bold>S is the plane that line a1 and line a2 forms</bold>, <bold>line F is the normal line of plane S</bold>, <bold>and</bold><italic>φ</italic><bold>is the angle between line F and line a3.</bold></p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2012_Article_364_Fig4_HTML.jpg" /></fig></p>
            <p>
              <disp-formula id="Equ4">
                <label>4</label>
                <alternatives>
                  <mml:math id="Equ4_Math">
                    <mml:mrow>
                      <mml:mtable columnalign="left">
                        <mml:mtr>
                          <mml:mtd>
                            <mml:mo>cos</mml:mo>
                            <mml:msub>
                              <mml:mi>φ</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                            <mml:mo>=</mml:mo>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mfenced close=")" open="(">
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>x</mml:mi>
                                      <mml:mi>i</mml:mi>
                                    </mml:msub>
                                    <mml:mo>−</mml:mo>
                                    <mml:mn>1</mml:mn>
                                    <mml:mo>−</mml:mo>
                                    <mml:msub>
                                      <mml:mi>x</mml:mi>
                                      <mml:mi>i</mml:mi>
                                    </mml:msub>
                                  </mml:mrow>
                                </mml:mfenced>
                                <mml:mo>×</mml:mo>
                                <mml:mfenced close=")" open="(">
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>x</mml:mi>
                                      <mml:mi>i</mml:mi>
                                    </mml:msub>
                                    <mml:mo>+</mml:mo>
                                    <mml:mn>1</mml:mn>
                                    <mml:mo>−</mml:mo>
                                    <mml:msub>
                                      <mml:mi>x</mml:mi>
                                      <mml:mi>i</mml:mi>
                                    </mml:msub>
                                  </mml:mrow>
                                </mml:mfenced>
                                <mml:mo>·</mml:mo>
                                <mml:mfenced close=")" open="(">
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>x</mml:mi>
                                      <mml:mi>i</mml:mi>
                                    </mml:msub>
                                    <mml:mo>+</mml:mo>
                                    <mml:mn>2</mml:mn>
                                    <mml:mo>−</mml:mo>
                                    <mml:msub>
                                      <mml:mi>x</mml:mi>
                                      <mml:mi>i</mml:mi>
                                    </mml:msub>
                                  </mml:mrow>
                                </mml:mfenced>
                              </mml:mrow>
                              <mml:mfenced close="|" open="|">
                                <mml:mrow>
                                  <mml:mfenced close=")" open="(">
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mi>x</mml:mi>
                                        <mml:mi>i</mml:mi>
                                      </mml:msub>
                                      <mml:mo>−</mml:mo>
                                      <mml:mn>1</mml:mn>
                                      <mml:mo>−</mml:mo>
                                      <mml:msub>
                                        <mml:mi>x</mml:mi>
                                        <mml:mi>i</mml:mi>
                                      </mml:msub>
                                    </mml:mrow>
                                  </mml:mfenced>
                                  <mml:mo>×</mml:mo>
                                  <mml:mfenced close=")" open="(">
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mi>x</mml:mi>
                                        <mml:mi>i</mml:mi>
                                      </mml:msub>
                                      <mml:mo>+</mml:mo>
                                      <mml:mn>1</mml:mn>
                                      <mml:mo>−</mml:mo>
                                      <mml:msub>
                                        <mml:mi>x</mml:mi>
                                        <mml:mi>i</mml:mi>
                                      </mml:msub>
                                    </mml:mrow>
                                  </mml:mfenced>
                                  <mml:mo stretchy="true">|</mml:mo>
                                  <mml:mo stretchy="true">|</mml:mo>
                                  <mml:msub>
                                    <mml:mi>x</mml:mi>
                                    <mml:mi>i</mml:mi>
                                  </mml:msub>
                                  <mml:mo>+</mml:mo>
                                  <mml:mn>2</mml:mn>
                                  <mml:mo>−</mml:mo>
                                  <mml:msub>
                                    <mml:mi>x</mml:mi>
                                    <mml:mi>i</mml:mi>
                                  </mml:msub>
                                </mml:mrow>
                              </mml:mfenced>
                            </mml:mfrac>
                            <mml:mi>i</mml:mi>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd>
                            <mml:mspace width="2.8em" />
                            <mml:mo>=</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mspace width="0.25em" />
                            <mml:mtext>mod</mml:mtext>
                            <mml:mspace width="0.25em" />
                            <mml:mi>k</mml:mi>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                    </mml:mrow>
                  </mml:math>
                  <graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_Equ4_HTML.gif" />
                </alternatives>
              </disp-formula>
              <disp-formula id="Equ5">
                <label>5</label>
                <alternatives>
                  <mml:math id="Equ5_Math">
                    <mml:mrow>
                      <mml:mo>cos</mml:mo>
                      <mml:mi>φ</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mo>max</mml:mo>
                      <mml:mfenced close="}" open="{">
                        <mml:mrow>
                          <mml:mo>cos</mml:mo>
                          <mml:msub>
                            <mml:mi>φ</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:mo stretchy="true">|</mml:mo>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mtext>1…</mml:mtext>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mrow>
                  </mml:math>
                  <graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_Equ5_HTML.gif" />
                </alternatives>
              </disp-formula>
            </p>
            <p>If the cos <italic>ϕ</italic> > 0.25, all the bonds connected by this atom are set to be single; otherwise, we will apply four models shown in Figure <xref rid="Fig5" ref-type="fig">5</xref>.<fig id="Fig5"><label>Figure 5</label><caption xml:lang="en"><p><bold>Patterns of atom C with the connection number of 3 (the dashed bond means that its order is unsure).</bold></p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2012_Article_364_Fig5_HTML.jpg" /></fig></p>
            <p>
              <list list-type="order">
                <list-item>
                  <p>When <italic>C</italic><sub><italic>i</italic></sub> equals to 4<list list-type="order"><list-item><p>If the atom is C or N, because the number of the maximum connections is 4, and when they are connected with 4 atoms, all the bonds should be single.</p></list-item><list-item><p>Else, if the atom is P, S, Cl or Br, I, it must be an acid group, then fix it.</p></list-item></list></p>
                </list-item>
              </list>
            </p>
          </sec>
          <sec id="Sec8">
            <title>Length rules</title>
            <p>For each bond <italic>B</italic><sub><italic>ij</italic></sub> connected to <italic>A</italic><sub><italic>i</italic></sub>, the bond order is determined by the bond length. We use <italic>Z</italic><sub><italic>i</italic></sub> to denote the atomic number of <italic>A</italic><sub><italic>i</italic></sub>, <italic>Z</italic><sub><italic>x</italic></sub> = min {<italic>Z</italic><sub><italic>i</italic></sub>, <italic>Z</italic><sub><italic>j</italic></sub>} and <italic>Z</italic><sub><italic>y</italic></sub> = max {<italic>Z</italic><sub><italic>i</italic></sub>, <italic>Z</italic><sub><italic>j</italic></sub>}.<list list-type="order"><list-item><p>If <italic>A</italic><sub><italic>x</italic></sub> is hydrogen, considering its valence, the bond order is set to 1; and if <italic>A</italic><sub><italic>y</italic></sub> is halogen, the bond order is also set to 1 because the acid model has already been considered in the hard rules.</p></list-item><list-item><p>The length of <italic>B</italic><sub><italic>ij</italic></sub> is defined as <italic>L</italic><sub><italic>ij</italic></sub>. If this bond can be found in Table <xref rid="Tab3" ref-type="table">3</xref> (bond lengths in this table were obtained by a parameterization process to achieve the best prediction accuracy), the bond order is assigned by the following steps. It should be noted that the minor changes of the bond lengths listed in Table <xref rid="Tab3" ref-type="table">3</xref> do not change the prediction accuracy obviously, and the low sensitivity of bond lengths is also an advantage of our algorithm.<list list-type="order"><list-item><p><italic>L</italic><sub><italic>ij</italic></sub> &lt; <italic>L</italic><sub>2</sub>: the bond length is smaller than the length of double bond, and the bond order is set to 2.</p></list-item><list-item><p><italic>L</italic><sub><italic>ij</italic></sub> &lt; <italic>L</italic><sub>2</sub> + 0.05: the bond type is set to 5, suggesting it is not sure, and it has better chance to be 2</p></list-item><list-item><p><italic>L</italic><sub><italic>ij</italic></sub> &lt; <italic>L</italic><sub>1</sub> − 0.04: the bond type is set to 4, suggesting that it is not sure.</p></list-item><list-item><p><italic>L</italic><sub><italic>ij</italic></sub> &lt; <italic>L</italic><sub>1</sub>: the bond type is set to 6, suggesting that it has better chance to be 1.</p></list-item><list-item><p>For the rest unsigned bonds, their bond orders are set to 1.</p></list-item></list></p></list-item></list><table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p><bold>The reference bond lengths</bold> (<bold>Å</bold>)</p></caption><table frame="hsides" rules="groups"><thead><tr><th><p>Bond</p></th><th><p>L1<sup><bold><italic>a</italic></bold></sup></p></th><th><p>L2<sup><bold><italic>b</italic></bold></sup></p></th></tr></thead><tbody><tr><td><p>C-C</p></td><td><p>1.49</p></td><td><p>1.33</p></td></tr><tr><td><p>C-N</p></td><td><p>1.43</p></td><td><p>1.29</p></td></tr><tr><td><p>C-O</p></td><td><p>1.41</p></td><td><p>1.28</p></td></tr><tr><td><p>C-S</p></td><td><p>1.80</p></td><td><p>1.72</p></td></tr><tr><td><p>N-N</p></td><td><p>1.38</p></td><td><p>1.29</p></td></tr><tr><td><p>N-O</p></td><td><p>1.39</p></td><td><p>1.24</p></td></tr></tbody></table><table-wrap-foot><p><sup><italic>a</italic></sup>L1 represents the length of single bond; <sup><italic>b</italic></sup>L2 represents the length of double bond.</p></table-wrap-foot></table-wrap></p>
            <p>
              <list list-type="order">
                <list-item>
                  <p>If the bond cannot be found in Table <xref rid="Tab3" ref-type="table">3</xref>, the bond type is set to 4.</p>
                </list-item>
              </list>
            </p>
            <p>Each step is applied after the application of the previous steps.</p>
          </sec>
          <sec id="Sec9">
            <title>Conjugation rules</title>
            <p>After applying the previous steps, part of the bonds have been fixed, but there are still many unassigned bonds (bond type equals to 4, 5 or 6). Most of them have improper bond’s length and have the biggest chance to be aromatic. At this step, we design the conjugation rules to determine these unassigned bonds.<list list-type="order"><list-item><p>For bond <italic>B</italic><sub><italic>i</italic>,<italic>i</italic> + 1</sub>, atoms that connect to this bond, and <italic>A</italic><sub><italic>i</italic></sub>, <italic>A</italic><sub><italic>i</italic></sub> + 1 are put into one group <italic>G</italic>(<italic>k</italic>)</p><p>If cos > 0.50, suggesting that they are totally not on the same plane, the bond order is then set to 1. If <italic>O</italic><sub><italic>i</italic>, <italic>i</italic> + 1</sub>=6, <italic>C</italic><sub><italic>i</italic></sub> ≥ 2, <italic>C</italic><sub><italic>i</italic> + 1</sub> ≥ 2, <italic>C</italic><sub><italic>i</italic></sub> + 1≥2 and cos  > 0.2, they are likely not on the same plane, and the bond type of 6 indicates that the bond order has the chance to be single (<italic>Oi</italic>, <italic>i</italic> + 1=1).</p></list-item><list-item><p>The remaining unfixed connected bonds are divided into groups, and therefore we may have several groups for a molecule.<list list-type="order"><list-item><p>Group size equals to 1: We will check if this bond is connected with any double bond. If the bond is not connected with any double bond, and this bond and its neighbor bonds are on plane (when cos <italic>ϕ</italic> &lt; 0.2, see above), the bond order is set to 2. There is one exception: if the bond is at the edge of the structure and the number of the bonds to which it are connected equals to 1, they are always on the same plane. In this condition, we will check if the bond type is 5 and the angle between these two bonds differs from 120°in 3 degrees. If not, the bond order is set to 1. When they are not on the same plane and the bond type is 5, we denote <italic>BA</italic><sub><italic>ij</italic></sub> as the bond angle between bond <italic>i</italic> and bond <italic>j</italic></p></list-item><list-item><p>Group size equals to 2: we will get a return value after judging the previous bond orders that is larger than 3 and their neighbors of the two bonds (Table <xref rid="Tab4" ref-type="table">4</xref>).</p></list-item><list-item><p>Fix isomers: For each bond, if one of the atoms is nitrogen and this nitrogen is only connected with one bond, the order is set to 1. For the others, a new rule is applied.<disp-formula id="Equ6"><label>6</label><alternatives><mml:math id="Equ6_Math"><mml:mrow><mml:mi>B</mml:mi><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mo>min</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>120</mml:mn><mml:mo stretchy="true">|</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mtext>1…</mml:mtext><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_Equ6_HTML.gif" /></alternatives></disp-formula></p></list-item></list></p></list-item></list></p>
            <p>where <inline-formula id="IEq19"><alternatives><mml:math id="IEq19_Math"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>O</mml:mi><mml:mn>12</mml:mn><mml:mo>></mml:mo><mml:mn>4</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>O</mml:mi><mml:mn>23</mml:mn><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq19_HTML.gif" /></alternatives></inline-formula> equals to the number of the bonds that are connected to bond <italic>i</italic>. If <italic>A</italic><sub>2</sub> is smaller than 3, the bond order is then set to 2; and otherwise, the bond order is set to 1.<table-wrap id="Tab4"><label>Table 4</label><caption xml:lang="en"><p><bold>Return numbers based on small structural patterns</bold><sup><bold><italic>a</italic></bold></sup></p></caption><table frame="hsides" rules="groups"><thead><tr><th><p>Return number</p></th><th align="center"><p>0</p></th><th align="center"><p>1</p></th><th align="center"><p>2</p></th><th align="center"><p>4</p></th><th align="center"><p>5</p></th></tr></thead><tbody><tr><td><p><italic>Aii</italic> doesn't have a double bond</p></td><td align="center"><p><inline-formula id="IEq20"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq20_HTML.gif" /></inline-formula></p></td><td /><td /><td align="center"><p><inline-formula id="IEq21"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq21_HTML.gif" /></inline-formula></p></td><td align="center"><p><inline-formula id="IEq22"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq22_HTML.gif" /></inline-formula></p></td></tr><tr><td><p>Bond types are 5 and 6</p></td><td /><td align="center"><p><inline-formula id="IEq23"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq23_HTML.gif" /></inline-formula></p></td><td align="center"><p><inline-formula id="IEq24"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq24_HTML.gif" /></inline-formula></p></td><td /><td /></tr><tr><td><p><italic>A</italic>1 has more than 1 bonds</p></td><td /><td align="center"><p><inline-formula id="IEq25"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq25_HTML.gif" /></inline-formula></p></td><td align="center"><p><inline-formula id="IEq26"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq26_HTML.gif" /></inline-formula></p></td><td align="center"><p><inline-formula id="IEq27"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq27_HTML.gif" /></inline-formula></p></td><td /></tr><tr><td><p><italic>A</italic>3 has more than 1 bonds</p></td><td /><td align="center"><p><inline-formula id="IEq28"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq28_HTML.gif" /></inline-formula></p></td><td /><td /><td align="center"><p><inline-formula id="IEq29"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq29_HTML.gif" /></inline-formula></p></td></tr><tr><td><p> <inline-formula id="IEq30"><alternatives><mml:math id="IEq30_Math"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>O</mml:mi><mml:mn>12</mml:mn><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>O</mml:mi><mml:mn>23</mml:mn><mml:mo>></mml:mo><mml:mn>4</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq30_HTML.gif" /></alternatives></inline-formula></p></td><td /><td align="center"><p><inline-formula id="IEq31"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq31_HTML.gif" /></inline-formula></p></td><td align="center"><p><inline-formula id="IEq32"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq32_HTML.gif" /></inline-formula></p></td><td /><td /></tr><tr><td><p> <inline-formula id="IEq33"><alternatives><mml:math id="IEq33_Math"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>O</mml:mi><mml:mn>12</mml:mn><mml:mo>></mml:mo><mml:mn>4</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>O</mml:mi><mml:mn>23</mml:mn><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq33_HTML.gif" /></alternatives></inline-formula></p></td><td /><td align="center"><p><inline-formula id="IEq34"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq34_HTML.gif" /></inline-formula></p></td><td align="center"><p><inline-formula id="IEq35"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq35_HTML.gif" /></inline-formula></p></td><td /><td /></tr><tr><td><p><italic>A</italic>2 has three bonds</p></td><td align="center"><p><inline-formula id="IEq36"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq36_HTML.gif" /></inline-formula></p></td><td /><td align="center"><p><inline-formula id="IEq37"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_IEq37_HTML.gif" /></inline-formula></p></td><td /><td /></tr><tr><td><p> Others</p></td><td /><td /><td align="center"><p>others</p></td><td /><td /></tr></tbody></table><table-wrap-foot><p><sup><italic>a</italic></sup>The dashed bond means this bond has already been fixed. The bold atom/bond means atoms/bonds around it are on the same plane. Conditions are taken into account from up to down. The plain bonds represents bonds to be fixed. Some fixed bonds are not given in the structures.</p></table-wrap-foot></table-wrap></p>
            <p>If return = 0, 1, 2: <italic>O</italic><sub>12</sub> =1 + return/2, <italic>O</italic><sub>23</sub> = 1 + return%2</p>
            <p>If return = 4: <italic>O</italic><sub>12</sub> = 1, assign the other bonds using rule 2.1</p>
            <p>If return =5: <italic>O</italic><sub>23</sub> = 1, assign the other bonds using rule 2.1</p>
            <p>Rule: for one bond, if it connects to a fixed double bond, its order is set to 1; otherwise, we will check if one of its atoms just has three bonds and two of the bonds are single. If so, we will have the following two possibilities: (1). the bond type is 5, and the bond order is then set to 2; (2). the minimal angle between this bond and the connected bonds is larger or smaller than 120°in 3 degrees, the bond order is set to 1. If the above possibilities are not satisfied, the bond remains unfixed.</p>
            <p>If there still remain bonds to be fixed after applying the above rule, for those unfixed ones, the order of one bond is set to 2 each time, and then the rule is applied again; if those bonds cannot be fixed, we will set the next bond and try the rule again. Once it has been done, we can get one isomer. Then, the bond order for the next unfixed bond is set to 2, and we will check if we can get another suitable structure. Thus, it is quite possible that we can get several isomers.</p>
            <p>To determine the best structure from multiple isomers, we propose a new parameter: Entropy of bonds. For each isomer, the entropy of bonds is the number of bonds that satisfy the following criteria for each <italic>B</italic><sub><italic>ij</italic></sub>:<list list-type="order"><list-item><p><italic>O</italic><sub><italic>ij</italic></sub> = 1</p></list-item><list-item><p>it connected to at least two double bonds</p></list-item><list-item><p>The double bonds it connected at least connected to another bond.</p></list-item></list></p>
            <p>Then the structure with the largest entropy is chosen as the best choice. If some isomers have the same entropy values, the structure that we first meet is chosen. Our results show that for most cases the representative structures can be chosen accurately using the easy definition.</p>
          </sec>
          <sec id="Sec10">
            <title>Fixing disordered bonds</title>
            <p>We already checked the atoms to make sure they are not over-connected, but after the application of the rules above, many single bonds have been changed to double or triple bonds, and then some atoms are over-connected. Therefore, we use the maximum valence to judge if this atom is over-connected. For atom <italic>A</italic><sub><italic>i</italic></sub>, the number of the connected bonds is calculated based on the following equation:<disp-formula id="Equ7"><label>7</label><alternatives><mml:math id="Equ7_Math"><mml:mrow><mml:mi>i</mml:mi><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mtext mathvariant="italic">ik</mml:mtext></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_364_Equ7_HTML.gif" /></alternatives></disp-formula></p>
            <p>If <italic>iCon</italic> > valence, the longest single bond is deleted, and the structure is checked again until <italic>iCon</italic> is no longer larger than the maximum valence. Here we just handle single bond, because for the bond with the bond order larger than 1, its bond length is reliable if this bond can be judged by the rules applied above.</p>
          </sec>
        </sec>
      </body>
      <back>
        <ack>
          <title>Acknowledgments</title>
          <p>This study was supported by the National Science Foundation of China (21173156), the National Basic Research Program of China (973 program, 2012CB932600), and the Priority Academic Program Development of Jiangsu Higher Education Institutions (PAPD).</p>
        </ack>
        <ref-list id="Bib1">
          <title>References</title>
          <ref-list>
            <ref id="CR1">
              <label>1.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Berman</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Henrick</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Nakamura</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Markley</surname>
                    <given-names>JL</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The worldwide Protein Data Bank (wwPDB): ensuring a single, uniform archive of PDB data</article-title>
                <source>Nucleic Acids Res</source>
                <year>2007</year>
                <volume>35</volume>
                <fpage>D301</fpage>
                <lpage>D303</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2sXivFKmtQ%3D%3D</pub-id>
                <pub-id pub-id-type="doi">10.1093/nar/gkl971</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR2">
              <label>2.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Spek</surname>
                    <given-names>AL</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Structure validation in chemical crystallography</article-title>
                <source>Acta Crystallogr D</source>
                <year>2009</year>
                <volume>65</volume>
                <fpage>148</fpage>
                <lpage>155</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXhtVWhtL8%3D</pub-id>
                <pub-id pub-id-type="doi">10.1107/S090744490804362X</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR3">
              <label>3.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Yang</surname>
                    <given-names>LW</given-names>
                  </name>
                  <name>
                    <surname>Eyal</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Chennubhotla</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Jee</surname>
                    <given-names>JG</given-names>
                  </name>
                  <name>
                    <surname>Gronenborn</surname>
                    <given-names>AM</given-names>
                  </name>
                  <name>
                    <surname>Bahar</surname>
                    <given-names>I</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Insights into equilibrium dynamics of proteins from comparison of NMR and X-ray data with computational predictions</article-title>
                <source>Structure</source>
                <year>2007</year>
                <volume>15</volume>
                <fpage>741</fpage>
                <lpage>749</lpage>
                <pub-id pub-id-type="doi">10.1016/j.str.2007.04.014</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR4">
              <label>4.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Berman</surname>
                    <given-names>HM</given-names>
                  </name>
                  <name>
                    <surname>Westbrook</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Feng</surname>
                    <given-names>Z</given-names>
                  </name>
                  <name>
                    <surname>Gilliland</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Bhat</surname>
                    <given-names>TN</given-names>
                  </name>
                  <name>
                    <surname>Weissig</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Shindyalov</surname>
                    <given-names>IN</given-names>
                  </name>
                  <name>
                    <surname>Bourne</surname>
                    <given-names>PE</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The protein data bank</article-title>
                <source>Nucleic Acids Res</source>
                <year>2000</year>
                <volume>28</volume>
                <fpage>235</fpage>
                <lpage>242</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3cXhvVKjt7w%3D</pub-id>
                <pub-id pub-id-type="doi">10.1093/nar/28.1.235</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR5">
              <label>5.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Dehof</surname>
                    <given-names>AK</given-names>
                  </name>
                  <name>
                    <surname>Rurainski</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Bui</surname>
                    <given-names>QBA</given-names>
                  </name>
                  <name>
                    <surname>Bocker</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Lenhof</surname>
                    <given-names>HP</given-names>
                  </name>
                  <name>
                    <surname>Hildebrandt</surname>
                    <given-names>A</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Automated bond order assignment as an optimization problem</article-title>
                <source>Bioinformatics</source>
                <year>2011</year>
                <volume>27</volume>
                <fpage>619</fpage>
                <lpage>625</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXis1ektbw%3D</pub-id>
                <pub-id pub-id-type="doi">10.1093/bioinformatics/btq718</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR6">
              <label>6.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Baber</surname>
                    <given-names>JC</given-names>
                  </name>
                  <name>
                    <surname>Hodgkin</surname>
                    <given-names>EE</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Automatic assignment of chemical connectivity to organic molecules in the Cambridge structural database</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>1992</year>
                <volume>32</volume>
                <fpage>401</fpage>
                <lpage>406</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK38XlsFShu7g%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci00009a001</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR7">
              <label>7.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Bruno</surname>
                    <given-names>IJ</given-names>
                  </name>
                  <name>
                    <surname>Shields</surname>
                    <given-names>GP</given-names>
                  </name>
                  <name>
                    <surname>Taylor</surname>
                    <given-names>R</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Deducing chemical structure from crystallographically determined atomic coordinates</article-title>
                <source>Acta Crystallogr B</source>
                <year>2011</year>
                <volume>67</volume>
                <fpage>333</fpage>
                <lpage>349</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXptVOgtLk%3D</pub-id>
                <pub-id pub-id-type="doi">10.1107/S0108768111024608</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR8">
              <label>8.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Froeyen</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Herdewijn</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Correct bond order assignment in a molecular framework using integer linear programming with application to molecules where only non-hydrogen atom coordinates are available</article-title>
                <source>J Chem Inf Comput Model</source>
                <year>2005</year>
                <volume>45</volume>
                <fpage>1267</fpage>
                <lpage>1274</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2MXlt1Shsrc%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci049645z</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR9">
              <label>9.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Hendlich</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Rippmann</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Barnickel</surname>
                    <given-names>G</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">BALI: automatic assignment of bond and atom types for protein ligands in the brookhaven protein databank</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>1997</year>
                <volume>37</volume>
                <fpage>774</fpage>
                <lpage>778</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK2sXktl2rsLs%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci9603487</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR10">
              <label>10.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Labute</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">On the perception of molecules from 3D atomic coordinates</article-title>
                <source>J Chem Inf Comput Model</source>
                <year>2005</year>
                <volume>45</volume>
                <fpage>215</fpage>
                <lpage>221</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2MXksFSnsg%3D%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci049915d</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR11">
              <label>11.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Meng</surname>
                    <given-names>EC</given-names>
                  </name>
                  <name>
                    <surname>Lewis</surname>
                    <given-names>RA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Determination of molecular topology and atomic hybridization states from heavy atom coordinates</article-title>
                <source>J Comput Chem</source>
                <year>1991</year>
                <volume>12</volume>
                <fpage>891</fpage>
                <lpage>898</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK3MXlvVahur4%3D</pub-id>
                <pub-id pub-id-type="doi">10.1002/jcc.540120716</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR12">
              <label>12.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Sayle</surname>
                    <given-names>R</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">PDB: Cruft to content (Perception of molecular connectivity from 3D coordinates)</article-title>
                <source>Daylight user meeting MUG01</source>
                <year>2001</year>
              </mixed-citation>
            </ref>
            <ref id="CR13">
              <label>13.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Zhao</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Cheng</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Wang</surname>
                    <given-names>R</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Automatic perception of organic molecules based on essential structural information</article-title>
                <source>J Chem Inf Comput Model</source>
                <year>2007</year>
                <volume>47</volume>
                <fpage>1379</fpage>
                <lpage>1385</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2sXlvVWjs7Y%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci700028w</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR14">
              <label>14.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Wang</surname>
                    <given-names>JM</given-names>
                  </name>
                  <name>
                    <surname>Wang</surname>
                    <given-names>W</given-names>
                  </name>
                  <name>
                    <surname>Kollman</surname>
                    <given-names>PA</given-names>
                  </name>
                  <name>
                    <surname>Case</surname>
                    <given-names>DA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Automatic atom type and bond type perception in molecular mechanical calculations</article-title>
                <source>J Mol Graph Model</source>
                <year>2006</year>
                <volume>25</volume>
                <fpage>247</fpage>
                <lpage>260</lpage>
                <pub-id pub-id-type="doi">10.1016/j.jmgm.2005.12.005</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR15">
              <label>15.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Ricketts</surname>
                    <given-names>EM</given-names>
                  </name>
                  <name>
                    <surname>Bradshaw</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Hann</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Hayes</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Tanna</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Ricketts</surname>
                    <given-names>DM</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Comparison of conformations of small molecule structures from the protein data bank with those generated by Concord, Cobra, ChemDBS-3D, and converter and those extracted from the Cambridge structural database</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>1993</year>
                <volume>33</volume>
                <fpage>905</fpage>
                <lpage>925</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK3sXmsV2hsrY%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci00016a013</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR16">
              <label>16.</label>
              <mixed-citation publication-type="other">Discovery Studio 2.5 Guide, Accelrys Inc., San Diego. 2009, <ext-link xlink:href="http://www.accelrys.com" ext-link-type="uri">http://www.accelrys.com</ext-link>,</mixed-citation>
            </ref>
            <ref id="CR17">
              <label>17.</label>
              <mixed-citation publication-type="other">SYBYL-X 1.3 molecular simulation package. 2011, St. Louis, <ext-link xlink:href="http://www.sybyl.com" ext-link-type="uri">http://www.sybyl.com</ext-link>,</mixed-citation>
            </ref>
            <ref id="CR18">
              <label>18.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Hou</surname>
                    <given-names>TJ</given-names>
                  </name>
                  <name>
                    <surname>Xia</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Zhang</surname>
                    <given-names>W</given-names>
                  </name>
                  <name>
                    <surname>Xu</surname>
                    <given-names>XJ</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">ADME evaluation in drug discovery. 4. Prediction of aqueous solubility based on atom contribution approach</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>2004a</year>
                <volume>44</volume>
                <fpage>266</fpage>
                <lpage>275</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3sXosVCqtLY%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci034184n</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR19">
              <label>19.</label>
              <mixed-citation publication-type="other">MOE, Chemical Computing Group Inc: 2011, Montreal, Canada, <ext-link xlink:href="http://www.chemcomp.com/" ext-link-type="uri">http://www.chemcomp.com/</ext-link>. 2011,</mixed-citation>
            </ref>
            <ref id="CR20">
              <label>20.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Allen</surname>
                    <given-names>FH</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The Cambridge structural database: a quarter of a million crystal structures and rising</article-title>
                <source>Acta Crystallogr B</source>
                <year>2002</year>
                <volume>58</volume>
                <fpage>380</fpage>
                <lpage>388</lpage>
                <pub-id pub-id-type="doi">10.1107/S0108768102003890</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR21">
              <label>21.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Irwin</surname>
                    <given-names>JJ</given-names>
                  </name>
                  <name>
                    <surname>Shoichet</surname>
                    <given-names>BK</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">ZINC-a free database of commercially available compounds for virtual screening</article-title>
                <source>J Chem Inf Comput Model</source>
                <year>2005</year>
                <volume>45</volume>
                <fpage>177</fpage>
                <lpage>182</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2cXhtVOjt77J</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci049714+</pub-id>
              </mixed-citation>
            </ref>
          </ref-list>
        </ref-list>
        <app-group>
          <app id="App1">
            <sec id="Sec11">
              <title>Electronic supplementary material</title>
              <p>
                <supplementary-material content-type="local-data" id="MOESM1" xlink:title="Electronic supplementary material">
                  <media mimetype="application" mime-subtype="msword" xlink:href="MediaObjects/13321_2012_364_MOESM1_ESM.doc" position="anchor">
                    <caption xml:lang="en">
                      <p>Additional file 1: <bold>Table S1.</bold> The radius of different elements; <bold>Table S2.</bold> The PDB codes for the structures used in the second data set. (DOC 69 KB)</p>
                    </caption>
                  </media>
                </supplementary-material>
              </p>
            </sec>
            <sec id="Sec12">
              <title>Authors’ original submitted files for images</title>
              <p>Below are the links to the authors’ original submitted files for images.<supplementary-material content-type="local-data" id="MOESM2" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="tiff" xlink:href="MediaObjects/13321_2012_364_MOESM2_ESM.tiff" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 1</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM3" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/13321_2012_364_MOESM3_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 2</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM4" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/13321_2012_364_MOESM4_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 3</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM5" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="tiff" xlink:href="MediaObjects/13321_2012_364_MOESM5_ESM.tiff" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 4</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM6" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/13321_2012_364_MOESM6_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 5</p></caption></media></supplementary-material></p>
            </sec>
          </app>
        </app-group>
        <notes notes-type="Misc">
          <title>Competing interests</title>
          <p>The authors declare that they have no competing interests.</p>
        </notes>
        <notes notes-type="Misc">
          <title>Authors' contributions</title>
          <p>QZ wrote the paper, implemented the algorithm and ran tests; TH contributed to the paper and provided guidance; WZ, YL, JW, LZ ran tests; all authors read and approved the final manuscript.</p>
        </notes>
      </back>
    </article>
