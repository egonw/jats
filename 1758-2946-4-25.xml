<?xml version="1.0"?>
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="research-article" xml:lang="en">
      <front>
        <journal-meta>
          <journal-id journal-id-type="publisher-id">13321</journal-id>
          <journal-title-group>
            <journal-title>Journal of Cheminformatics</journal-title>
            <abbrev-journal-title abbrev-type="publisher">J Cheminform</abbrev-journal-title>
          </journal-title-group>
          <issn pub-type="epub">1758-2946</issn>
          <publisher>
            <publisher-name>Springer International Publishing</publisher-name>
            <publisher-loc>Cham</publisher-loc>
          </publisher>
        </journal-meta>
        <article-meta>
          <article-id pub-id-type="publisher-id">BMC1758-2946-4-25</article-id>
          <article-id pub-id-type="manuscript">371</article-id>
          <article-id pub-id-type="doi">10.1186/1758-2946-4-25</article-id>
          <article-categories>
            <subj-group subj-group-type="heading">
              <subject>Research Article</subject>
            </subj-group>
          </article-categories>
          <title-group>
            <article-title xml:lang="en">HSQC spectral based similarity matching of compounds using nearest neighbours and a fast discrete genetic algorithm</article-title>
          </title-group>
          <contrib-group>
            <contrib contrib-type="author" corresp="yes">
              <name>
                <surname>Pierens</surname>
                <given-names>Gregory K</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="corresp" rid="IDBMC17582946425_cor1">a</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Brossi</surname>
                <given-names>Steven</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Yang</surname>
                <given-names>Zhengyi</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Reutens</surname>
                <given-names>David C</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Vegh</surname>
                <given-names>Viktor</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <aff id="Aff1">
              <label>1</label>
              <institution-wrap>
                <institution-id institution-id-type="GRID">grid.1003.2</institution-id>
                <institution-id institution-id-type="ISNI">0000000093207537</institution-id>
                <institution content-type="org-division">Centre for Advanced Imaging</institution>
                <institution content-type="org-name">The University of Queensland</institution>
              </institution-wrap>
              <addr-line content-type="street">Level 2, Gehrmann Laboratories, Research Road</addr-line>
              <addr-line content-type="postcode">4072</addr-line>
              <addr-line content-type="city">Brisbane</addr-line>
              <addr-line content-type="state">Queensland</addr-line>
              <country country="AU">Australia</country>
            </aff>
          </contrib-group>
          <author-notes>
            <corresp id="IDBMC17582946425_cor1">
              <label>a</label>
              <email>HIDDEN</email>
            </corresp>
          </author-notes>
          <pub-date date-type="pub" publication-format="electronic">
            <day>3</day>
            <month>10</month>
            <year>2012</year>
          </pub-date>
          <pub-date date-type="collection" publication-format="electronic">
            <month>12</month>
            <year>2012</year>
          </pub-date>
          <volume>4</volume>
          <issue seq="38">1</issue>
          <elocation-id>25</elocation-id>
          <history>
            <date date-type="registration">
              <day>9</day>
              <month>7</month>
              <year>2012</year>
            </date>
            <date date-type="received">
              <day>9</day>
              <month>7</month>
              <year>2012</year>
            </date>
            <date date-type="accepted">
              <day>24</day>
              <month>9</month>
              <year>2012</year>
            </date>
            <date date-type="online">
              <day>3</day>
              <month>10</month>
              <year>2012</year>
            </date>
          </history>
          <permissions>
            <copyright-statement content-type="compact">© Pierens et al.; licensee Chemistry Central Ltd. 2012</copyright-statement>
            <copyright-statement content-type="comment">This article is published under license to BioMed Central Ltd. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link xlink:href="http://creativecommons.org/licenses/by/2.0" ext-link-type="uri">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</copyright-statement>
            <copyright-year>2012</copyright-year>
            <copyright-holder>Pierens et al.; licensee Chemistry Central Ltd.</copyright-holder>
            <license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/2.0">
              <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 2.0 International License (<ext-link xlink:href="https://creativecommons.org/licenses/by/2.0" ext-link-type="uri">https://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
            </license>
          </permissions>
          <abstract xml:lang="en" id="Abs1">
            <title>Abstract</title>
            <p>HSQC spectra are routinely acquired for chemical structure analysis based on hydrogen and carbon chemical environments. Two fast HSQC peak matching algorithms have been developed; a nearest neighbour approach and a probabilistic method based on an existing discrete genetic algorithm. Both of these techniques are intended to find HSQC spectra matches that supplement information generated by established molecular fingerprint methods. Our results are compared to those calculated using a specific implementation of molecular fingerprints. The nearest neighbour and genetic algorithm-based methods ranked highly particular structures missed by molecular fingerprints. Our analysis shows that by complementing molecular fingerprint matches with our findings, a comprehensive list of matches can be identified. The refined list of compounds could be used to improve the quality of compounds used in screening libraries in the pharmaceutical industry.</p>
            <fig id="Figa" position="anchor">
              <graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_371_Figa_HTML.gif" position="anchor" />
            </fig>
          </abstract>
          <kwd-group xml:lang="en">
            <title>Keywords</title>
            <kwd>HSQC</kwd>
            <kwd>Spectral matching</kwd>
            <kwd>Similarity</kwd>
            <kwd>Nearest neighbours</kwd>
            <kwd>Discrete genetic algorithm</kwd>
          </kwd-group>
          <custom-meta-group>
            <custom-meta>
              <meta-name>publisher-imprint-name</meta-name>
              <meta-value>Chemistry Central</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-issue-count</meta-name>
              <meta-value>1</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-article-count</meta-name>
              <meta-value>39</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-holder</meta-name>
              <meta-value>The Author(s)</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-year</meta-name>
              <meta-value>2012</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-contains-esm</meta-name>
              <meta-value>Yes</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-year</meta-name>
              <meta-value>2012</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-month</meta-name>
              <meta-value>7</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-day</meta-name>
              <meta-value>9</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-product</meta-name>
              <meta-value>ArchiveJournal</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-grants-type</meta-name>
              <meta-value>OpenChoice</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>metadata-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>abstract-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodypdf-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodyhtml-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bibliography-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>esm-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>online-first</meta-name>
              <meta-value>false</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-file-reference</meta-name>
              <meta-value>BodyRef/PDF/13321_2012_Article_371.pdf</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-type</meta-name>
              <meta-value>Typeset</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>target-type</meta-name>
              <meta-value>OnlinePDF</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-type</meta-name>
              <meta-value>OriginalPaper</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-primary</meta-name>
              <meta-value>Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computer Applications in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Documentation and Information in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Theoretical and Computational Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computational Biology/Bioinformatics</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-collection</meta-name>
              <meta-value>Chemistry and Materials Science</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>open-access</meta-name>
              <meta-value>true</meta-value>
            </custom-meta>
          </custom-meta-group>
        </article-meta>
        <notes notes-type="ESMHint">
          <title>Electronic supplementary material</title>
          <p>The online version of this article (doi:<ext-link xlink:href="10.1186/1758-2946-4-25" ext-link-type="doi">10.1186/1758-2946-4-25</ext-link>) contains supplementary material, which is available to authorized users.</p>
        </notes>
      </front>
      <body>
        <sec id="Sec1">
          <title>Background</title>
          <p>Database driven chemical structure identification is common practice in drug discovery. Classification of similar compounds is based on the premise that physicochemical properties are comparable [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. The mapping of specific compound properties to “fingerprints” has provided a robust method of searching large databases. Currently, database searching efficiency is constrained by the size of the database, the method used to determine similarity and the function defining match quality. To improve database searching, we have concentrated on the latter two constraints and propose a new approach of identifying similar compounds using heteronuclear single quantum coherence (HSQC) spectra.</p>
          <p>Carbon HSQC spectra are collected routinely to confirm or elucidate molecular structure in synthetic and natural product chemistry. Experimental results are presented as 2D plots with axes defined by proton (<sup>1</sup> H) and carbon (<sup>13</sup>C) chemical shifts. The high-intensity plot features, referred to as “peaks”, delineate directly bonded hydrogen and carbon atoms of a compound. Generally, the 2D Cartesian coordinates of the peaks are reported without any reference to intensity or peak size. The intensity of the peaks could also be included in the analysis. However, care must be taken to ensure that all data was acquired using the same acquisition parameters. Since we validate our findings using published data, in this work, peak intensities are not included as part of the spectra matching. The location of peaks provides valuable information about the chemical environment of hydrogen and carbon atoms allowing molecular structure to be inferred from the number and location of peaks which have specific distributions for each compound.</p>
          <p>A number of metrics have been used to quantify the similarity between a compound of interest and a database of compounds allowing the best database results to be selected as possible replacements for the candidate structure. For example, compound fragments and related properties have been mapped to molecular fingerprints defined using bit strings [<xref ref-type="bibr" rid="CR4">4</xref>]. The fingerprints capture specific information about molecular structure and specific properties of a molecule [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. In bit string-based fingerprinting, the Tanimoto (T<sub>c</sub>) [<xref ref-type="bibr" rid="CR6">6</xref>] and Tversky [<xref ref-type="bibr" rid="CR7">7</xref>] coefficients have been used widely to quantify the level of similarity. Above an acceptable threshold, compounds are deemed similar and therefore have similar chemical or biological properties.</p>
          <p>We previously outlined a method of matching HSQC spectra of small compounds motivated by evolutionary optimization [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. The use of self-adaptive differential evolution allowed matching of a candidate compound HSQC peaks to individual entries of a database. However, as the number of peaks increased (i.e. larger than 20), the search space became very large, to the extent that the quality of match was not computable in a reasonable amount of time. Our new approach is aimed at increasing computational efficiency by considering three factors limiting the rate of convergence of any algorithm, the choice of the metric and method to obtain an optimal solution and the size of the search space. The outcome is a robust algorithm capable of matching spectra containing a large number of peaks rapidly on a standard desktop computer.</p>
          <p>We improved the efficiency of our previously reported HSQC spectra matching algorithm by using a discrete genetic algorithm (DGA) implementation instead of differential evolution. We tested our new method on a compound database containing 51 HSQC spectra. The results were compared to bit string based molecular fingerprints incorporating a suitable threshold for the Tanimoto coefficient [<xref ref-type="bibr" rid="CR10">10</xref>] and to nearest neighbour search, also known as proximity search or closest point search which is the simplest implementation of all peak matching methods.</p>
        </sec>
        <sec id="Sec2">
          <title>Results and discussion</title>
          <p>The database of 51 HSQC spectra from our previous work [<xref ref-type="bibr" rid="CR8">8</xref>] was used to test the efficacy of our newly developed algorithm. The actual structures of the 51 compounds are listed in Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>.</p>
          <sec id="Sec3">
            <title>Treatment of outliers in DGA</title>
            <p>A problem with performing DGA-based unique matching of peaks between two spectra is that a single long match can greatly affect the outcome. An example of this problem is the peak-to-peak match of compounds <bold>10</bold> and <bold>12</bold> (Figure <xref rid="Fig1" ref-type="fig">1</xref>). The only difference between the structures is the number of aromatic methoxy groups; compound <bold>12</bold> has two and compound <bold>10</bold> has one with the other methoxy group being replaced by an aromatic CH. Examining the DGA matched HSQC spectra; we observed one long distance peak match and all other peaks were matched to close peaks. According to our algorithm definition, all peaks have to be uniquely matched because both compounds had 11 peaks. This resulted in an aromatic peak being matched to an aliphatic peak affecting the mean distance metric and resulting in a misclassification.<fig id="Fig1"><label>Figure 1</label><caption xml:lang="en"><p><bold>The matched HSQC spectra for compounds 10 and 12.</bold> The plot shows a single long distance match between two peaks leading to an amplified mean distance per peak metric value.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2012_Article_371_Fig1_HTML.jpg" /></fig></p>
            <p>To remedy a single long distance peak-to-peak match, we identify outliers and exclude their matches in the metric used to classify match quality. We thus modified the mean distance per peak, excluding outliers by statistically examining each set of matched peak distances and applying a rejection criterion. The mean and standard deviation (σ) was calculated for all pairs of matched peaks in the HSQC spectrum to spectrum comparison. If an individual distance was greater than <italic>S</italic> times σ from the mean, it was considered an outlier. We then rematched any outliers to their nearest neighbour in the other spectrum. We examined several values of <italic>S</italic> (1.75 – 3.0) and settled on 2.5σ as the threshold value for outlier rejection. We arrived at this result by qualitatively evaluating characteristics of many spectral matches. The value of <italic>S</italic> is a user defined variable and can changed if unsuitable for the HSQC matching under consideration.</p>
          </sec>
          <sec id="Sec4">
            <title>Effect of population size and number of iterations in the DGA</title>
            <p>We examined the effect of changing <italic>K</italic> (population size) and <italic>G</italic><sub>max</sub> (maximum number of generations) on convergence using the DGA method. The HSQC spectra of the 51 compounds were matched to all other spectra and the similarity metric from <bold>p</bold> to <bold>q</bold> and <bold>q</bold> to <bold>p</bold> were compared, to establish the stability of results from the algorithm. The 2601 spectral match results were recorded in a 51x51 matrix with the columns and rows corresponding to the referencing of the compounds. The upper and lower triangular parts of the matrix consisted of <bold>p</bold> to <bold>q</bold> and <bold>q</bold> to <bold>p</bold> matches, respectively. Ideally, the matrix should be symmetrical. However, since our approach is probabilistic and we limit the maximum number of iterations, corresponding entries in the upper and lower triangular sections of the matrix may differ. To examine this possibility, we compared the corresponding upper and lower triangular entries of the matrix for the three parameter sets. We considered a small (<italic>K</italic> = 2 and <italic>G</italic><sub>max</sub> = 5 <italic>N</italic>, where <italic>N</italic> is the largest of number of peaks in <bold>p</bold> or <bold>q</bold>), medium (<italic>K</italic> = 5 and <italic>G</italic><sub>max</sub> = 10 <italic>N</italic>) and large (<italic>K</italic> = 20 and <italic>G</italic><sub>max</sub> = 50 <italic>N</italic>) implementation as defined by the size of the parameters. The small parameter set was the fastest to compute with 32 differences between <bold>p</bold> to <bold>q</bold> and <bold>q</bold> to <bold>p</bold> matches, which represented an error rate of 2.5%. The medium set gave six different outcomes with an error rate of 0.5%, and the large parameter set showed only one difference with an error rate less than 0.1%. Spectra for the above data set were also matched by the SADE method and the results are shown in Table <xref rid="Tab1" ref-type="table">1</xref>. Overall, DGA converged with fewer function evaluations than SADE. Taking into account convergence error and speed of the calculation, we chose the medium parameter set for the DGA matching in the rest of the analysis. Extrapolating the SADE data to an error rate of 0.5% means that ~ 10<sup>14</sup> function evaluations have to be performed, in comparison to ~ 10<sup>10</sup> for DGA.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p><bold>The number of function evaluations (NFE) and corresponding error rate for the DGA and SADE methods</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>NFE</p></th><th align="center"><p>DGA (%)</p></th><th align="center"><p>SADE (%)</p></th></tr></thead><tbody><tr><td align="left"><p>1.60E + 09</p></td><td align="center"><p>2.5</p></td><td align="center"><p>5.0</p></td></tr><tr><td align="left"><p>7.98E + 09</p></td><td align="center"><p>0.5</p></td><td align="center"><p>2.7</p></td></tr><tr><td align="left"><p>1.60E + 11</p></td><td align="center"><p>0.1</p></td><td align="center"><p>2.1</p></td></tr></tbody></table></table-wrap></p>
            <p>In the integer optimization problem mutations and crossovers were chosen to improve performance with respect to our application, and hence, we were able to set <italic>G</italic><sub><italic>max</italic></sub> relatively small. The calculation of the 2601 HSQC spectral matches using the medium settings (<italic>K</italic> = 5 and <italic>G</italic><sub><italic>max</italic></sub> = 10 N) took approximately 85 minutes, which was an average of ~ 2 seconds per match which includes overheads from the GUI and reading and writing data files. The largest peak matching was between compounds <bold>17</bold> (17 peaks) and <bold>18</bold> (22 peaks), taking approximately 4 seconds. If 20,000 HSQC spectral matches were required on similar sized spectra using the medium settings, then it would take ~ 11 hours.</p>
          </sec>
          <sec id="Sec5">
            <title>Ranking of matches against molecular fingerprint (MFP)</title>
            <p>The results of NN and DGA approaches of matching HSQC spectra were compared to those obtained using the MFP method within Open Babel: The Open Source Chemistry Toolbox [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. The FP2 path-based fingerprint, which indexes small molecule fragments, was used to generate the similarity results. All compound similarities were calculated using the Tanimoto coefficient (T<sub>c</sub>) which ranges from 0, no similarity, to 1, maximum similarity. The selection criterion for T<sub>c</sub> of equal to or greater than a value of 0.7 was used and resulted in 44 compound matches. Of these, 38 were between compounds <bold>1</bold><bold>13</bold>. This was not unexpected, as these compounds are part of a combinatorial library based around 2-(3-chloro-4-hydroxyphenyl) acetamide.</p>
            <p>To compare the two HSQC matching protocols (NN and DGA) with MFP, the 44 most similar HSQC spectra for each method were considered. Cut-off thresholds were 0.0228 for NN and 0.0294 for DGA (smaller number is more similar). The similarity matches for all three methods are shown in matrix form in Figure <xref rid="Fig2" ref-type="fig">2</xref>. As in the case of MFP, for NN and DGA, the majority of the retained matches were for compounds <bold>1</bold> – <bold>13</bold>. For compounds <bold>20 – 45</bold>, both NN and DGA found a larger number of matches than MFP.<fig id="Fig2"><label>Figure 2</label><caption xml:lang="en"><p><bold>The similarity match matrices for (a) MFP, (b) NN and (c) DGA are shown.</bold> The off-diagonal black squares represent the top 44 ranked matches and the diagonal entries were included for reference purposes. The <bold>p</bold> to <bold>q</bold> (upper triangle) and <bold>q to p</bold> (lower triangle) matches are both provided.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2012_Article_371_Fig2_HTML.jpg" /></fig></p>
            <p>We further considered all matching metrics in 6 categories. Categories and respective cut-off values are provided in Table <xref rid="Tab2" ref-type="table">2</xref>. A smaller category number reflects a better match. The top three categories (1–3) were all above the threshold used for the top 44 matches and cut-offs for them were at regular intervals. The same intervals were continued below the threshold for Categories 4 and 5. Category 6 contained the rest of the matches. In the following subsections we investigate how these categories overlap amongst the various matching approaches.<table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p><bold>The categories and cut-offs for MFP, NN and DGA</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Category</p></th><th align="center"><p>MFP</p></th><th align="center"><p>NN</p></th><th align="center"><p>DGA</p></th></tr></thead><tbody><tr><td align="left"><p>1</p></td><td align="center"><p>[0.9, 1.0]</p></td><td align="center"><p>[0, 0.0076)</p></td><td align="center"><p>[0, 0.0098)</p></td></tr><tr><td align="left"><p>2</p></td><td align="center"><p>[0.8, 0.9)</p></td><td align="center"><p>[0.0076, 0.0152)</p></td><td align="center"><p>[0.0098, 0.0196)</p></td></tr><tr><td align="left"><p>3</p></td><td align="center"><p>[0.7, 0.8)</p></td><td align="center"><p>[0.0152, 0.0228)</p></td><td align="center"><p>[0.0196, 0.0294)</p></td></tr><tr><td align="left"><p>4</p></td><td align="center"><p>[0.6, 0.7)</p></td><td align="center"><p>[0.0228, 0.0304)</p></td><td align="center"><p>[0.0294, 0.0392)</p></td></tr><tr><td align="left"><p>5</p></td><td align="center"><p>[0.5, 0.6)</p></td><td align="center"><p>[0.0304, 0.0380)</p></td><td align="center"><p>[0.0392, 0.0490)</p></td></tr><tr><td align="left"><p>6</p></td><td align="center"><p>&lt; 0.5</p></td><td align="center"><p>≥ 0.0380</p></td><td align="center"><p>≥ 0.0490</p></td></tr></tbody></table><table-wrap-foot><p>The smaller the category number, the better the expected match. The first three categories capture the 44 matches of Figure <xref rid="Fig4" ref-type="fig">4</xref>.</p></table-wrap-foot></table-wrap></p>
          </sec>
          <sec id="Sec6">
            <title>NN versus DGA based HSQC spectra matching</title>
            <p>Among the top 44 similarity matches, NN and DGA HSQC similarity methods identified only seven different matches. The matches unique to NN were all within compounds <bold>1</bold>–<bold>13</bold>, while for DGA, only one was from this group of compounds. All NN matches were all in category 4 for DGA, just outside the threshold to be classed as similar. Five out of the seven DGA matches were in Category 4 and two were in Category 6 from NN. The two HSQC matches for compounds <bold>7</bold> and <bold>11</bold> are provided in Figure <xref rid="Fig2" ref-type="fig">2</xref>. In this case the spectra classified in Category 3 for NN and Category 6 for DGA.</p>
            <p>Figure <xref rid="Fig3" ref-type="fig">3</xref> illustrates the impact of the outlier rejection criterion of 2.5σ used in this DGA comparison. In this case, DGA places the match in Category 6 whereas NN places it in Category 3. If the criterion for an outlier was lowered from 2.5σ to 2.25σ, classification would change from category 6 to 3. Hence, DGA would identify them as similar HSQC spectra. The NN methodology can therefore be used to identify matches that may be overlooked in the DGA matches. We propose the use of NN and DGA in conjunction to identify and validate HSQC spectral matches.<fig id="Fig3"><label>Figure 3</label><caption xml:lang="en"><p><bold>The HSQC spectra matching result of compounds 7 and 11 using (a) NN and (b) DGA.</bold></p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2012_Article_371_Fig3_HTML.jpg" /></fig></p>
          </sec>
          <sec id="Sec7">
            <title>Comparison of MFP, NN and DGA results</title>
            <p>A histogram was created from the 1275 match results of each method, as illustrated in Figure <xref rid="Fig4" ref-type="fig">4</xref>. There are differences in the shape of the histograms obtained using MFP (negatively skewed) as compared to the two HSQC spectral matching methods (positively skewed). For the MFP method, the region of the histogram corresponding to most similar spectra is widely spread, indicating that the method can discriminate between similar compounds. The MFP distribution shows that a large proportion of the matches are classified as dissimilar, suggesting that it is highly sensitive to changes in the bit-string fingerprint.<fig id="Fig4"><label>Figure 4</label><caption xml:lang="en"><p><bold>Illustrated are histograms of the similarity measures for the 1275 comparisons.</bold> Provided are results for (<bold>a.</bold>) MFP, (<bold>b.</bold>) NN and (<bold>c.</bold>) DGA.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2012_Article_371_Fig4_HTML.jpg" /></fig></p>
            <p>The NN and DGA histograms are similar with the highest frequency of scores appearing in the “most similar” region. The primary difference between MFP and the other two matching methods is that in MFP, a feature is either present or not within a fingerprint, whereas a distance between matched peaks is computed in both NN and DGA. This means that a feature is always included in NN and DGA, irrespective of whether a peak match is identified as an outlier in the latter approach. The histogram distribution is narrower for NN than for DGA. Thus is likely to be due to DGA identifying a unique peak-to-peak match, which results in an overemphasis of the peak distances. On the other hand, NN matches peaks non-uniquely, essentially providing information about the peaks’ neighbourhoods with respect to the other HSQC spectrum. NN and DGA can both suffer from false positives.</p>
            <p>To simplify the interpretation of our results, the 44 most similar compounds or spectra from each methodology were compared using a Venn diagram and for the full list of similar matches refer to Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>. The sets and their overlaps are provided in Figure <xref rid="Fig5" ref-type="fig">5</xref>.<fig id="Fig5"><label>Figure 5</label><caption xml:lang="en"><p><bold>The Venn diagram showing the top 44 ranked matches and how matches relate between MFP, NN and DGA.</bold></p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2012_Article_371_Fig5_HTML.jpg" /></fig></p>
            <p>There were 19 HSQC matches that were only common to NN and DGA. Of the 19 common matches, 14 were between spectra of compounds <bold>1</bold>–<bold>13</bold>. The other five are shown in Table <xref rid="Tab3" ref-type="table">3</xref> along with their chemical structure and ranking category. All other results are provided in the supporting information. Spectra from compounds <bold>24</bold> and <bold>32</bold> were found to be in category 1 for NN and DGA, but MFP placed it in category 4. Category 4 is just below the threshold for being classified as similar, and MFP would have disqualified it from further investigation, even though the compounds are similar from a structural point-of-view. Compound matches <bold>24</bold> to <bold>42</bold> and <bold>26</bold> to <bold>32</bold> were not identified as similar using MFP (category 5). All of these compounds have similar structural groups, but they are arranged differently around the phenyl ring. We consider these compounds to be similar based on their structures.<table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p><bold>Illustrated are specific compound structures found to be similar using NN and DGA and not using MFP</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Compound A</p></th><th align="center"><p>Compound B</p></th><th align="center" colspan="3"><p>Categories</p></th></tr><tr><th /><th /><th align="center"><p>MFP</p></th><th align="center"><p>NN</p></th><th align="center"><p>DGA</p></th></tr></thead><tbody><tr><td align="left"><p><inline-formula id="IEq1"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_371_IEq1_HTML.gif" /></inline-formula>24</p></td><td align="center"><p><inline-formula id="IEq2"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_371_IEq2_HTML.gif" /></inline-formula>32</p></td><td align="center"><p>4</p></td><td align="center"><p>1</p></td><td align="center"><p>1</p></td></tr><tr><td align="left"><p><inline-formula id="IEq3"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_371_IEq3_HTML.gif" /></inline-formula>24</p></td><td align="center"><p><inline-formula id="IEq4"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_371_IEq4_HTML.gif" /></inline-formula>42</p></td><td align="center"><p>5</p></td><td align="center"><p>2</p></td><td align="center"><p>2</p></td></tr><tr><td align="left"><p><inline-formula id="IEq5"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_371_IEq5_HTML.gif" /></inline-formula>26</p></td><td align="center"><p><inline-formula id="IEq6"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_371_IEq6_HTML.gif" /></inline-formula>32</p></td><td align="center"><p>5</p></td><td align="center"><p>2</p></td><td align="center"><p>2</p></td></tr><tr><td align="left"><p><inline-formula id="IEq7"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_371_IEq7_HTML.gif" /></inline-formula>30</p></td><td align="center"><p><inline-formula id="IEq8"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_371_IEq8_HTML.gif" /></inline-formula>33</p></td><td align="center"><p>4</p></td><td align="center"><p>3</p></td><td align="center"><p>3</p></td></tr><tr><td align="left"><p><inline-formula id="IEq9"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_371_IEq9_HTML.gif" /></inline-formula>32</p></td><td align="center"><p><inline-formula id="IEq10"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_371_IEq10_HTML.gif" /></inline-formula>42</p></td><td align="center"><p>4</p></td><td align="center"><p>2</p></td><td align="center"><p>3</p></td></tr></tbody></table></table-wrap></p>
            <p>In view of our findings, we recommend the following protocol for matching of HSQC spectra. First, calculate MFP, NN and DGA based similarities. Determine the MFP cut-off to be used; this is usually set to 0.7. Calculate the number of structures identified by the MFP method and set a suitable threshold to obtain the same number of structures using NN and DGA in accordance with their ranking. The highly significant compound structures would be matches identified by at least two of the methods. In our case, this would be 43 [18(common to all), 3(MFP and NN only), 3(MFP and DGA only) and 19(NN and DGA)]. The compounds that were identified only by one method should be reviewed on a case-by-case basis.</p>
          </sec>
        </sec>
        <sec id="Sec8" sec-type="conclusions">
          <title>Conclusions</title>
          <p>The research aimed to investigate whether new approaches can improve a molecular fingerprint-based method of identifying structurally similar compounds from databases of HSQC spectra. Two fast peak-to-peak spectral matching methods were developed, the nearest neighbour and discrete genetic algorithm methods. We found that complementary information from both methods improved the classification of compound structures. We compared our new approaches to a method based on molecular fingerprints, and investigated differences between matches. We conclude that our approaches are not a replacement for existing established methods; instead they should be used to refine the assessment of similarity. The use of our algorithms can help counter missed similarity matches arising when molecular fingerprint is used solely for matching of HSQC spectra.</p>
        </sec>
        <sec id="Sec9" sec-type="methods">
          <title>Methods</title>
          <p>The <italic>n</italic><sup>th</sup> peak in a 2D HSQC spectrum is defined as a feature point, denoted as:<disp-formula id="Equ1"><label>1</label><alternatives><mml:math id="Equ1_Math"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mtext>,</mml:mtext></mml:mrow></mml:math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_371_Equ1_HTML.gif" /></alternatives></disp-formula></p>
          <p>where <italic>x</italic><sub><italic>n</italic></sub> and <italic>y</italic><sub><italic>n</italic></sub> are the real valued Cartesian coordinates for the normalized <sup>13</sup>C and <sup>1</sup> H chemical shifts, respectively. A spectrum is then defined as a set of points:<disp-formula id="Equ2"><label>2</label><alternatives><mml:math id="Equ2_Math"><mml:mrow><mml:mi mathvariant="bold">p</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mfenced><mml:mtext>,</mml:mtext></mml:mrow></mml:math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_371_Equ2_HTML.gif" /></alternatives></disp-formula></p>
          <p>where <italic>p</italic><sub><italic>n</italic></sub> is the coordinate of the <italic>n</italic><sup>th</sup> peak and <italic>N</italic> is the number of peaks. Given another spectrum <inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:mrow><mml:mi mathvariant="bold">q</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mfenced><mml:mtext>,</mml:mtext></mml:mrow></mml:math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_371_IEq11_HTML.gif" /></alternatives></inline-formula> the goal is then to match peaks by minimizing a metric quantifying the quality of match between <bold>p</bold> and <bold>q</bold>.</p>
          <p>We first define a positive metric for two peaks <italic>p</italic><sub><italic>n</italic></sub> and <italic>q</italic><sub><italic>m</italic></sub>:<disp-formula id="Equ3"><label>3</label><alternatives><mml:math id="Equ3_Math"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="‖" open="‖"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mtext>,</mml:mtext></mml:mrow></mml:math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_371_Equ3_HTML.gif" /></alternatives></disp-formula></p>
          <p>and the error in the match when all peaks are considered is:<disp-formula id="Equ4"><label>4</label><alternatives><mml:math id="Equ4_Math"><mml:mrow><mml:msub><mml:mi>ɛ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">j</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="true">{</mml:mo><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mrow><mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mtext>,</mml:mtext></mml:mrow></mml:math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_371_Equ4_HTML.gif" /></alternatives></disp-formula></p>
          <p>where <bold>j</bold> is a vector of <italic>N</italic> elements and <inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_371_IEq12_HTML.gif" /></alternatives></inline-formula> is a perturbation on <italic>m</italic> given <italic>n</italic>, such that <inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:mi>ε</mml:mi></mml:math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_371_IEq13_HTML.gif" /></alternatives></inline-formula> is minimized when <bold>j</bold> is the optimal indexing of <bold>q</bold>. The term <inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:msub><mml:mi>ε</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_371_IEq14_HTML.gif" /></alternatives></inline-formula> measures the quality of match when all peaks are matched. In the case when one spectrum contains more or less peaks than the other, all peaks from the smaller spectrum are matched, leaving some peaks in the larger spectrum unmatched. We will use the “matched” and “unmatched” terminology throughout this paper. If <italic>N</italic> &lt; <italic>M</italic>, <bold>j</bold> contains <italic>N</italic> unique integers in [1,<italic>M</italic>], and hence, the unmatched peaks of <bold>q</bold> do not appear in <bold>j</bold>. If <italic>N</italic> > <italic>M</italic>, then <bold>j</bold> contains <italic>N</italic> unique integers from [1,<italic>N</italic>]. As such, the entries where <italic>j</italic><sub>n</sub> > <italic>M</italic> are left unmatched. The modified metric, <inline-formula id="IEq15"><alternatives><mml:math id="IEq15_Math"><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2012_Article_371_IEq15_HTML.gif" /></alternatives></inline-formula>, accounts for this case.</p>
          <sec id="Sec10">
            <title>Nearest Neighbour (NN) matching</title>
            <p>A nearest neighbour HSQC similarity match was computed where each peak of <bold>p</bold> is matched to the nearest peak of <bold>q</bold> and each peak of <bold>q</bold> was matched to the nearest peak in <bold>p</bold>. Furthermore, an average distance-per-peak metric was used, as illustrated in Figure <xref rid="Fig6" ref-type="fig">6</xref>. The NN based matching can result in a single peak being matched to many peaks from the other spectrum. Therefore, it gives an indication of relative clustering of peaks. Overall, NN based matching of HSQC spectra is computationally efficient and provides a deterministic result.<fig id="Fig6"><label>Figure 6</label><caption xml:lang="en"><p><bold>The schematic outlines the matching process of HSQC spectra using the nearest neighbour method.</bold> Illustrated are (<bold>a</bold>) nearest neighbour matchings from squares to circles and (<bold>b</bold>) nearest neighbour matchings from circles to squares. The average distance per peak is calculated by averaging all matched distances.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2012_Article_371_Fig6_HTML.jpg" /></fig></p>
            <p>The NN approach does not take into account different numbers of peaks in different areas of the spectrum. This can result errors in ascribing compound similarity on the basis of HSQC spectra. For this reason, we also propose to uniquely match spectra peaks, enabling improved differentiation of compound structures through the introduction of long distance peak matching in the metric. This type of matching implemented in our previous work using differential evolution had the drawback that establishing matches to database entries with more than 20 HSQC spectra peaks was time consuming. Our improved method based on a discrete genetic algorithm is still probabilistic and obtains good approximations for large numbers of peaks in a practical amount of time.</p>
          </sec>
          <sec id="Sec11">
            <title>Discrete genetic algorithm (DGA) matching</title>
            <p>We use a discrete genetic algorithm to optimize the optimal indexing in (4). Our implementation was inspired by the algorithm applied to solve traveling salesman problems. In this work we closely followed the implementation outlined by Schneider [<xref ref-type="bibr" rid="CR13">13</xref>]. We defined <italic>K</italic> to be the population size (i.e. the number of solutions) and <italic>G</italic><sub>max</sub> as the maximum number of generations.</p>
            <p>Our DGA implementation did not involve forcing of match directions. That is, given a spectrum <bold>p</bold> to be matched to <bold>q</bold>, we did not require the denotation of spectrum to be such that <bold>q</bold> always had a larger number of peaks than <bold>p</bold>. Furthermore, we used injection of sort solutions through progressive iterations of the algorithm, and when the number of peaks in <bold>p</bold> and <bold>q</bold> were differed, we left |<italic>N – M</italic>| peaks unmatched. The following mutations were used in DGA:</p>
            <p>
              <list list-type="bullet">
                <list-item>
                  <p>EXC(L2O): Select two peak matches and exchange them;</p>
                </list-item>
                <list-item>
                  <p>L3O: Select three peak matches and shuffle them such that none of them are the same as the starting point;</p>
                </list-item>
                <list-item>
                  <p>L4O: Same as L3O but using four peak matches;</p>
                </list-item>
                <list-item>
                  <p>EXON: Used only when <italic>N</italic> &lt; <italic>M</italic>. Exchanges a peak match of set <bold>s</bold> with a number from [1,<italic>M</italic>] that is not an element of <bold>s</bold>, hence named <italic>EX</italic>change with <italic>O</italic>utside <italic>N</italic>ode.</p>
                </list-item>
              </list>
            </p>
            <p>We updated the population using five mutation sweeps using: RX, BURTRAND and SINGLEBURST crossovers [<xref ref-type="bibr" rid="CR13">13</xref>]:</p>
            <p>
              <list list-type="bullet">
                <list-item>
                  <p>RX (random): <bold>r</bold> is a string of independent random bits of length <italic>N</italic>, with equal probabilities for zero and one.</p>
                </list-item>
                <list-item>
                  <p>BURSTRAND: Same as above but with dependence between the bits such that P(<bold>r</bold>(<italic>i</italic> + 1) ~ = <bold>r</bold>(<italic>i</italic>)) = 2/<italic>N</italic>, where P denotes probability. This way of generating “perturbation” or noise is often used for simulating bursty channels (also known as Gilbert–Elliott channel).</p>
                </list-item>
                <list-item>
                  <p>SINGLEBURST: <bold>r</bold> is a continuous block of ones. The length is chosen randomly in [3, <italic>N</italic>] and the start position <italic>i</italic> is chosen randomly in [1, <italic>N</italic>]. The block rolls over when <italic>i</italic> + l > <italic>N</italic>, such that <bold>r</bold>(1 to (l + <italic>i</italic>-<italic>N</italic>)) = 1.</p>
                </list-item>
              </list>
            </p>
            <p>DGA minimizes (4), the sum of all peak-to-peak distances constituting a matching. For comparing the similarity of compounds we extend this concept further by introducing three levels of the metric. The first level is a unique match between two spectra, where |<italic>N – M</italic>| unmatched peaks are not penalized. The second level involves the identification of outliers, as determined from a single individual large distance, and the removal of these connections. The third level is the application of a penalty to unmatched peaks. This process is outlined in Figure <xref rid="Fig7" ref-type="fig">7</xref>.<fig id="Fig7"><label>Figure 7</label><caption xml:lang="en"><p><bold>The schematic outlines the HSQC spectra matching process using the DGA.</bold> Illustrated are (<bold>a</bold>) unique peak-to-peak matching (solid lines), (<bold>b</bold>) identification of outliers (bold dotted line), (<bold>c</bold>) removal of outlier match and (<bold>d</bold>) matching of unmatched peaks to nearest neighbours from the other spectrum (dotted lines).</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2012_Article_371_Fig7_HTML.jpg" /></fig></p>
            <p>We provide the functions of DGA, description of terms and detailed explanation of our specific metric implementation can be found in Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>.</p>
          </sec>
        </sec>
      </body>
      <back>
        <ack>
          <title>Acknowledgements</title>
          <p>The research was supported with assistance from the State Government of Queensland through the Queensland NMR Network and the National Health and Medical Research Council of Australia.</p>
        </ack>
        <ref-list id="Bib1">
          <title>References</title>
          <ref-list>
            <ref id="CR1">
              <label>1.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Johnson</surname>
                    <given-names>MA</given-names>
                  </name>
                  <name>
                    <surname>Maggiora</surname>
                    <given-names>GM</given-names>
                  </name>
                </person-group>
                <source>Concepts and applications of molecular similarity</source>
                <year>1990</year>
                <publisher-loc>New York</publisher-loc>
                <publisher-name>John Wiley &amp; Sons</publisher-name>
              </mixed-citation>
            </ref>
            <ref id="CR2">
              <label>2.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Martin</surname>
                    <given-names>YC</given-names>
                  </name>
                  <name>
                    <surname>Kofron</surname>
                    <given-names>JL</given-names>
                  </name>
                  <name>
                    <surname>Traphagen</surname>
                    <given-names>LM</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Do structurally similar molecules have similar biological activity</article-title>
                <source>J Med Chem</source>
                <year>2002</year>
                <volume>45</volume>
                <fpage>4350</fpage>
                <lpage>4358</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD38XmtVCntLw%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/jm020155c</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR3">
              <label>3.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Patterson</surname>
                    <given-names>DE</given-names>
                  </name>
                  <name>
                    <surname>Cramer</surname>
                    <given-names>RD</given-names>
                  </name>
                  <name>
                    <surname>Ferguson</surname>
                    <given-names>AM</given-names>
                  </name>
                  <name>
                    <surname>Clark</surname>
                    <given-names>RD</given-names>
                  </name>
                  <name>
                    <surname>Weinberger</surname>
                    <given-names>LE</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Neighborhood behavior: a useful concept for validation of "molecular diversity" descriptors</article-title>
                <source>J Med Chem</source>
                <year>1996</year>
                <volume>39</volume>
                <fpage>3049</fpage>
                <lpage>3059</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK28Xkt1alur8%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/jm960290n</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR4">
              <label>4.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Eckert</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Bajorath</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Molecular similarity analysis in virtual screening: foundations, limitations and novel approaches</article-title>
                <source>Drug Discov Today</source>
                <year>2007</year>
                <volume>12</volume>
                <fpage>225</fpage>
                <lpage>233</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2sXitl2htLw%3D</pub-id>
                <pub-id pub-id-type="doi">10.1016/j.drudis.2007.01.011</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR5">
              <label>5.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Willett</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Similarity-based virtual screening using 2D fingerprints</article-title>
                <source>Drug Discov Today</source>
                <year>2006</year>
                <volume>11</volume>
                <fpage>1046</fpage>
                <lpage>1053</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD28Xht1eqtb%2FN</pub-id>
                <pub-id pub-id-type="doi">10.1016/j.drudis.2006.10.005</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR6">
              <label>6.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Willett</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Barnard</surname>
                    <given-names>JM</given-names>
                  </name>
                  <name>
                    <surname>Downs</surname>
                    <given-names>GM</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Chemical similarity searching</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>1998</year>
                <volume>38</volume>
                <fpage>983</fpage>
                <lpage>996</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK1cXks1ynu74%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci9800211</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR7">
              <label>7.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Tversky</surname>
                    <given-names>A</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Features of similarity</article-title>
                <source>Psychol Rev</source>
                <year>1977</year>
                <volume>84</volume>
                <fpage>327</fpage>
                <lpage>352</lpage>
                <pub-id pub-id-type="doi">10.1037/0033-295X.84.4.327</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR8">
              <label>8.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Pierens</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Mobli</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Vegh</surname>
                    <given-names>V</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Effective protocol for database similarity searching of heteronuclear single quantum coherence spectra</article-title>
                <source>Anal Chem</source>
                <year>2009</year>
                <volume>81</volume>
                <fpage>9329</fpage>
                <lpage>9335</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXhtlWmtbbI</pub-id>
                <pub-id pub-id-type="doi">10.1021/ac901616t</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR9">
              <label>9.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Vegh</surname>
                    <given-names>V</given-names>
                  </name>
                  <name>
                    <surname>Pierens</surname>
                    <given-names>GK</given-names>
                  </name>
                  <name>
                    <surname>Tieng</surname>
                    <given-names>QM</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">A variant of differential evolution for discrete optimization problems requiring mutually distinct parameters</article-title>
                <source>International Journal of Innovative Computing, Information and Control</source>
                <year>2011</year>
                <volume>7</volume>
                <fpage>897</fpage>
                <lpage>914</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR10">
              <label>10.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Bajorath</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Integration of virtual and high-throughput screening</article-title>
                <source>Nat Rev Drug Discovery</source>
                <year>2002</year>
                <volume>1</volume>
                <fpage>882</fpage>
                <lpage>894</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD38XotleqtLY%3D</pub-id>
                <pub-id pub-id-type="doi">10.1038/nrd941</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR11">
              <label>11.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Guha</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Howard</surname>
                    <given-names>MT</given-names>
                  </name>
                  <name>
                    <surname>Hutchison</surname>
                    <given-names>GR</given-names>
                  </name>
                  <name>
                    <surname>Murray-Rust</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Rzepa</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Steinbeck</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Wegner</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Willighagen</surname>
                    <given-names>EL</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The blue obelisk interoperability in chemical informatics</article-title>
                <source>J Chem Inf Model</source>
                <year>2006</year>
                <volume>46</volume>
                <fpage>991</fpage>
                <lpage>998</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD28Xhs1Wjsbw%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci050400b</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR12">
              <label>12.</label>
              <mixed-citation publication-type="other">The open babel package, version 2.3.0. <ext-link xlink:href="http://openbabel.sourceforge.net/" ext-link-type="uri">http://openbabel.sourceforge.net/</ext-link>,</mixed-citation>
            </ref>
            <ref id="CR13">
              <label>13.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Schneider</surname>
                    <given-names>JJ</given-names>
                  </name>
                  <name>
                    <surname>Kirkpatrick</surname>
                    <given-names>S</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Stochastic optimization</article-title>
                <source>Application of genetic algorithms to TSP</source>
                <year>2006</year>
                <publisher-loc>Berlin Heidelberg</publisher-loc>
                <publisher-name>Springer</publisher-name>
                <fpage>415</fpage>
                <lpage>422</lpage>
                <comment>Scientific Computation</comment>
              </mixed-citation>
            </ref>
          </ref-list>
        </ref-list>
        <app-group>
          <app id="App1">
            <sec id="Sec12">
              <title>Electronic supplementary material</title>
              <p>
                <supplementary-material content-type="local-data" id="MOESM1" xlink:title="Electronic supplementary material">
                  <media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/13321_2012_371_MOESM1_ESM.pdf" position="anchor">
                    <caption xml:lang="en">
                      <p>Additional file 1: Contains the structures of the 51 compounds in the database, detailed information on the Discrete Genetic Algorithm (DGA) Algorithm and the comparison of Similarity classification for top44 matches in MFP, NN and DGA.(PDF 442 KB)</p>
                    </caption>
                  </media>
                </supplementary-material>
              </p>
            </sec>
            <sec id="Sec13">
              <title>Authors’ original submitted files for images</title>
              <p>Below are the links to the authors’ original submitted files for images.<supplementary-material content-type="local-data" id="MOESM2" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/13321_2012_371_MOESM2_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 1</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM3" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="tiff" xlink:href="MediaObjects/13321_2012_371_MOESM3_ESM.tiff" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 2</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM4" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/13321_2012_371_MOESM4_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 3</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM5" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/13321_2012_371_MOESM5_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 4</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM6" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/13321_2012_371_MOESM6_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 5</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM7" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/13321_2012_371_MOESM7_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 6</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM8" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/13321_2012_371_MOESM8_ESM.pdf" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 7</p></caption></media></supplementary-material></p>
            </sec>
          </app>
        </app-group>
        <notes notes-type="Misc">
          <title>Competing interests</title>
          <p>The authors declare that they have no competing interests.</p>
        </notes>
        <notes notes-type="Misc">
          <title>Authors’ contributions</title>
          <p>GP: Conceived idea, developed methodology and wrote paper SB: Developed methodology and Matlab programming ZY: Developed methodology DR: Developed methodology VV: Developed idea, methodology and wrote paper. All authors read and approved the final manuscript.</p>
        </notes>
      </back>
    </article>
