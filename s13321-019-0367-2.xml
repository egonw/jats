<?xml version="1.0"?>
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="research-article" xml:lang="en">
      <?properties open_access?>
      <front>
        <journal-meta>
          <journal-id journal-id-type="publisher-id">13321</journal-id>
          <journal-title-group>
            <journal-title>Journal of Cheminformatics</journal-title>
            <abbrev-journal-title abbrev-type="publisher">J Cheminform</abbrev-journal-title>
          </journal-title-group>
          <issn pub-type="epub">1758-2946</issn>
          <publisher>
            <publisher-name>Springer International Publishing</publisher-name>
            <publisher-loc>Cham</publisher-loc>
          </publisher>
        </journal-meta>
        <article-meta>
          <article-id pub-id-type="publisher-id">s13321-019-0367-2</article-id>
          <article-id pub-id-type="manuscript">367</article-id>
          <article-id pub-id-type="doi">10.1186/s13321-019-0367-2</article-id>
          <article-categories>
            <subj-group subj-group-type="heading">
              <subject>Software</subject>
            </subj-group>
          </article-categories>
          <title-group>
            <article-title xml:lang="en">Interoperable chemical structure search service</article-title>
          </title-group>
          <contrib-group>
            <contrib contrib-type="author" id="Au1">
              <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-7356-4075</contrib-id>
              <name>
                <surname>Kratochvíl</surname>
                <given-names>Miroslav</given-names>
              </name>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="aff" rid="Aff2">2</xref>
            </contrib>
            <contrib contrib-type="author" id="Au2">
              <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-6066-973X</contrib-id>
              <name>
                <surname>Vondrášek</surname>
                <given-names>Jiří</given-names>
              </name>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author" corresp="yes" id="Au3">
              <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-7038-544X</contrib-id>
              <name>
                <surname>Galgonek</surname>
                <given-names>Jakub</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="corresp" rid="IDs1332101903672_cor3">c</xref>
            </contrib>
            <aff id="Aff1">
              <label>1</label>
              <institution-wrap>
                <institution-id institution-id-type="ISNI">0000 0001 2188 4245</institution-id>
                <institution-id institution-id-type="GRID">grid.418892.e</institution-id>
                <institution content-type="org-name">Institute of Organic Chemistry and Biochemistry of the CAS</institution>
              </institution-wrap>
              <addr-line content-type="street">Flemingovo náměstí 2</addr-line>
              <addr-line content-type="postcode">166 10</addr-line>
              <addr-line content-type="city">Prague 6</addr-line>
              <country country="CZ">Czech Republic</country>
            </aff>
            <aff id="Aff2">
              <label>2</label>
              <institution-wrap>
                <institution-id institution-id-type="ISNI">0000 0004 1937 116X</institution-id>
                <institution-id institution-id-type="GRID">grid.4491.8</institution-id>
                <institution content-type="org-division">Department of Software Engineering, Faculty of Mathematics and Physics</institution>
                <institution content-type="org-name">Charles University</institution>
              </institution-wrap>
              <addr-line content-type="street">Malostranské náměstí 25</addr-line>
              <addr-line content-type="postcode">118 00</addr-line>
              <addr-line content-type="city">Prague 1</addr-line>
              <country country="CZ">Czech Republic</country>
            </aff>
          </contrib-group>
          <author-notes>
            <corresp id="IDs1332101903672_cor3">
              <label>c</label>
              <email>HIDDEN</email>
            </corresp>
          </author-notes>
          <pub-date date-type="pub" publication-format="electronic">
            <day>28</day>
            <month>6</month>
            <year>2019</year>
          </pub-date>
          <pub-date date-type="collection" publication-format="electronic">
            <month>12</month>
            <year>2019</year>
          </pub-date>
          <volume>11</volume>
          <issue seq="45">1</issue>
          <elocation-id>45</elocation-id>
          <history>
            <date date-type="registration">
              <day>21</day>
              <month>6</month>
              <year>2019</year>
            </date>
            <date date-type="received">
              <day>26</day>
              <month>2</month>
              <year>2019</year>
            </date>
            <date date-type="accepted">
              <day>21</day>
              <month>6</month>
              <year>2019</year>
            </date>
            <date date-type="online">
              <day>28</day>
              <month>6</month>
              <year>2019</year>
            </date>
          </history>
          <pub-history>
            <event event-type="Correction">
              <event-desc>It was highlighted that the original article [1] contained an error in the last paragraph of the section ���Structure search using SPARQL���, specifically in the radius of the used fingerprint. This Correction article shows the incorrect and correct paragraph of this section.</event-desc>
              <date>
                <day>13</day>
                <month>2</month>
                <year>2020</year>
              </date>
            </event>
          </pub-history>
          <permissions>
            <copyright-statement content-type="compact">© The Author(s) 2019</copyright-statement>
            <copyright-year>2019</copyright-year>
            <copyright-holder>The Author(s)</copyright-holder>
            <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
              <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link xlink:href="http://creativecommons.org/publicdomain/zero/1.0/" ext-link-type="uri">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
            </license>
          </permissions>
          <related-article related-article-type="correction" ext-link-type="doi" xlink:href="10.1186/s13321-020-0418-8" />
          <abstract xml:lang="en" id="Abs1">
            <title>Abstract</title>
            <sec id="ASec1">
              <title>Motivation</title>
              <p id="Par1">The existing connections between large databases of chemicals, proteins, metabolites and assays offer valuable resources for research in fields ranging from drug design to metabolomics. Transparent search across multiple databases provides a way to efficiently utilize these resources. To simplify such searches, many databases have adopted semantic technologies that allow interoperable querying of the datasets using SPARQL query language. However, the interoperable interfaces of the chemical databases still lack the functionality of structure-driven chemical search, which is a fundamental method of data discovery in the chemical search space.</p>
            </sec>
            <sec id="ASec2">
              <title>Results</title>
              <p id="Par2">We present a SPARQL service that augments existing semantic services by making interoperable substructure and similarity searches in small-molecule databases possible. The service thus offers new possibilities for querying interoperable databases, and simplifies writing of heterogeneous queries that include chemical-structure search terms.</p>
            </sec>
            <sec id="ASec3">
              <title>Availability</title>
              <p id="Par3">The service is freely available and accessible using a standard SPARQL endpoint interface. The service documentation and user-oriented demonstration interfaces that allow quick explorative querying of datasets are available at <ext-link xlink:href="https://idsm.elixir-czech.cz" ext-link-type="uri">https://idsm.elixir-czech.cz</ext-link>.</p>
            </sec>
          </abstract>
          <kwd-group xml:lang="en">
            <title>Keywords</title>
            <kwd>Substructure search</kwd>
            <kwd>Small molecule databases</kwd>
            <kwd>Interoperability</kwd>
            <kwd>Linked data</kwd>
          </kwd-group>
          <funding-group>
            <award-group>
              <funding-source>
                <institution-wrap>
                  <institution>Ministerstvo Školství, Mládeže a Tělovýchovy</institution>
                  <institution-id institution-id-type="doi" vocab="open-funder-registry">http://dx.doi.org/10.13039/501100001823</institution-id>
                </institution-wrap>
              </funding-source>
              <award-id award-type="FundRef grant">LM2015047</award-id>
              <award-id award-type="FundRef grant">LM2015042</award-id>
              <award-id award-type="FundRef grant">LM2015085</award-id>
            </award-group>
            <award-group>
              <funding-source>
                <institution-wrap>
                  <institution>Ústav Organické Chemie a Biochemie, Akademie Věd České Republiky</institution>
                  <institution-id institution-id-type="doi" vocab="open-funder-registry">http://dx.doi.org/10.13039/501100010099</institution-id>
                </institution-wrap>
              </funding-source>
              <award-id award-type="FundRef grant">61388963</award-id>
              <principal-award-recipient>
                <name>
                  <surname>Vondrášek</surname>
                  <given-names>Jiří</given-names>
                </name>
              </principal-award-recipient>
            </award-group>
          </funding-group>
          <custom-meta-group>
            <custom-meta>
              <meta-name>publisher-imprint-name</meta-name>
              <meta-value>Springer</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-issue-count</meta-name>
              <meta-value>1</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-article-count</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-pricelist-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-holder</meta-name>
              <meta-value>The Author(s)</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-contains-esm</meta-name>
              <meta-value>No</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-month</meta-name>
              <meta-value>6</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-day</meta-name>
              <meta-value>21</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-product</meta-name>
              <meta-value>ArchiveJournal</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-grants-type</meta-name>
              <meta-value>OpenChoice</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>metadata-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>abstract-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodypdf-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodyhtml-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bibliography-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>esm-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>online-first</meta-name>
              <meta-value>false</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-file-reference</meta-name>
              <meta-value>BodyRef/PDF/13321_2019_Article_367.pdf</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-type</meta-name>
              <meta-value>Typeset</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>target-type</meta-name>
              <meta-value>OnlinePDF</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-type</meta-name>
              <meta-value>OriginalPaper</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-primary</meta-name>
              <meta-value>Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computer Applications in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Documentation and Information in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Theoretical and Computational Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computational Biology/Bioinformatics</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-collection</meta-name>
              <meta-value>Chemistry and Materials Science</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>open-access</meta-name>
              <meta-value>true</meta-value>
            </custom-meta>
          </custom-meta-group>
        </article-meta>
        <notes notes-type="CrossLinking">
          <sec>
            <p>A correction to this article is available online at <ext-link xlink:href="10.1186/s13321-020-0418-8" ext-link-type="doi">https://doi.org/10.1186/s13321-020-0418-8</ext-link>.</p>
          </sec>
        </notes>
      </front>
      <body>
        <sec id="Sec1">
          <title>Introduction</title>
          <p id="Par4">The vast availability of research-related data sources on the Internet has created a need for tools that can efficiently search through these data and automatically collect and associate information from multiple interoperable sources. In the chemistry field, chemical structure search is an extremely useful tool provided by many small-molecule databases as a free, on-line service. However, such services typically offer a simple, human-oriented user interface, which makes them unsuitable for automated use (e. g. by other services) or use in arbitrary combinations with other interoperable data sources. Here, we introduce a service that uses a standard-compliant interoperable interface to address these deficiencies and provide high-performance chemical structure search across many available chemical databases.</p>
          <p id="Par5">To promote interoperability among the diverse data sources accessible on the Internet, the World Wide Web Consortium (W3C) introduced semantic web technologies [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. The properties of semantic technologies make them ideal for interoperable publishing of datasets, the use of which has been consistently increasing over the past decade. Semantic data structured according to the <italic>Resource Description Framework</italic> (RDF) [<xref ref-type="bibr" rid="CR3">3</xref>] are now routinely published by many well-established databases, including those from EBI, EMBL, UniProt, neXtProt, and KEGG. Interoperability of datasets provides the ability to automatically answer complex heterogeneous queries that cannot be answered by individual databases separately. However, the ability to pose chemical structure-driven queries over interoperable databases is currently limited. Consequently, comprehensive information about structural relations is largely absent in chemistry-oriented RDF datasets. This also limits opportunities to observe relationships with other linked information, such as proteins and metabolic pathways that are connected by chemically similar ligands or metabolites. To address this issue, we developed a publicly available service that augments the interoperable chemical search space by providing chemical similarity and substructure relations. This creates new ways to query and obtain more precise, meaningful data from currently available data sources.</p>
          <p id="Par6">Database interoperability is made possible by widespread standardization of data models and interfaces, and RDF is the key standardized semantic technology for interoperable representation of datasets [<xref ref-type="bibr" rid="CR4">4</xref>]. Individual entities in RDF-formatted datasets are identified by <italic>Internationalized Resource Identifiers</italic> (IRI), which guarantee single global identification of each entity and avoid potential collisions of identifiers across datasets. <italic>RDF vocabularies</italic> are published to globally standardize identifiers for particular use cases [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>] to make data more discoverable and prevent ambiguity in interpretation. Query services for published RDF datasets typically support the <italic>SPARQL</italic> query language [<xref ref-type="bibr" rid="CR7">7</xref>], which can be used to query datasets online, without the need to download them. Each SPARQL-supporting service is identified by a unique IRI, called a SPARQL <italic>endpoint</italic> [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
          <p id="Par7">Importantly, many SPARQL services support the <italic>Federated Query Extension</italic> [<xref ref-type="bibr" rid="CR9">9</xref>]. With this extension, the user may instruct a service to execute specified parts of the query on other services and combine the collected data in one federated result [<xref ref-type="bibr" rid="CR10">10</xref>]. This virtually removes the boundaries between different data sources, which greatly simplifies heterogeneous querying of the available data and promotes interoperability.</p>
          <p id="Par8">RDF specifies that datasets be modeled as sets of RDF <italic>triples</italic> [<xref ref-type="bibr" rid="CR4">4</xref>], which provides sufficient expressive power to describe any data that can be modeled as graphs, including similarity and substructure relations between molecules. Current implementations of RDF databases, on the other hand, are typically only able to handle finite amounts of statically stored RDF entries, which leads to technical problems when handling data that may potentially match large numbers of RDF triplets. Chemical similarity and substructure relations are common examples of such data. Storing a predicate like hasSimilarity for each pair of molecules in a database is not only impractical, but technically impossible if the predicate should match structures not present in the databases (e. g. arbitrary structures defined by SMILES).</p>
          <p id="Par9">In classical SQL-based relational databases, this issue can be easily solved, for example, by implementing a stored procedure that dynamically creates the relations for the given parameters. Unfortunately, there is no similar concept standardized for RDF and SPARQL. We address this issue for the specific case of chemical search—the presented service is a publicly available SPARQL server that provides similarity and substructure relations generated on demand. Additionally, the procedure calls do not require extension of the SPARQL syntax, as they are triggered by simple data patterns in queries. Thus, the extension is transparent to services that are not aware of the involved procedure calls, which ensures compatibility with existing interoperable services.</p>
          <p id="Par10">A running instance of the chemical structure search service is available for free use at <ext-link xlink:href="https://idsm.elixir-czech.cz/" ext-link-type="uri">https://idsm.elixir-czech.cz/</ext-link>, as a part of the larger <italic>Integrated Database of Small Molecules</italic> (IDSM) project.</p>
        </sec>
        <sec id="Sec2">
          <title>Implementation</title>
          <p id="Par11">Overall, the service implementation can be viewed as an interoperable wrap of the structure search interface of the Sachem cartridge [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
          <p id="Par12">Sachem is an open-source chemical cartridge that we previously designed to provide chemical search capabilities in small-molecule databases, with performance sufficient for online services. Sachem exposes its search functionality using SQL stored procedures provided in a special PostgreSQL extension, which handles the necessary low-level, high-performance chemical indexing and search. Using the available SQL functions, Sachem users may create indexes of large searchable datasets and run substructure and similarity searches on them.</p>
          <p id="Par13">The main improvement offered by the new service is the ability to make the search interfaces of a running Sachem installation publicly available and interoperable, thus allowing anyone to quickly search through the indexed datasets. This functionality is provided by a generic SPARQL-to-SQL translator, which is the main part of the IDSM SPARQL engine.</p>
          <p id="Par14">All components of the service are displayed in the overview in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.</p>
          <sec id="Sec3">
            <title>IDSM SPARQL engine</title>
            <p id="Par15">Through our implementation of a SPARQL engine, we aimed to address several shortcomings of other RDF triple stores and SPARQL engines. Our implementation bridges the gap between triplet-based handling of interoperable RDF data and dynamically generated data required for work with chemical databases. This is achieved by completely translating the incoming SPARQL queries into SQL queries enriched with stored procedure calls, which are then executed by a high-performance relational database.</p>
            <p id="Par16">This translation is performed by the SPARQL engine (displayed in the frontend section of Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The dataset is stored in a PostgreSQL database in an optimized relational schema that allows high-performance querying. To represent the relational data in a given dataset as RDF, we created an <italic>RDF/SQL mapping</italic> that describes conversion of individual rows of tables in the relational schema into equivalent sets of RDF triples. This mapping is used to translate the incoming SPARQL queries into SQL queries that generate SPARQL-compatible query results. This mapping method is generally similar to the Linked Data Views in OpenLink Virtuoso [<xref ref-type="bibr" rid="CR12">12</xref>].</p>
            <p id="Par17">Major differences between SPARQL and SQL functions and data types are addressed by using the custom PostgreSQL extension pgSPARQL (placed in the backend section in Fig. <xref rid="Fig1" ref-type="fig">1</xref>), which re-implements the SPARQL-specific behavior and functions in PostgreSQL.</p>
            <p id="Par18">The SPARQL engine is written in Java as a standard web application for Apache Tomcat. The frontend supports SPARQL 1.1 protocol for query submission. After the SPARQL query is translated into SQL and executed by PostgreSQL, the results are repacked to a user-selected standard query result format (XML, JSON, CSV or TSV [<xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR15">15</xref>]) and sent back to the client.<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>Overview of the interoperable chemical structure search implementation, separated into logical layers. Clients submit the SPARQL queries to the frontend HTTP server in Apache Tomcat. The incoming queries are passed to the SPARQL engine, which uses the connected RDF/SQL mapping to translate them into equivalent SQL queries. The resulting queries are evaluated by backend PostgreSQL DBMS, using the Sachem extension (which executes chemical structure search) and pgSPARQL extension (which evaluates SPARQL-specific parts of the query and gathers metadata). Stored data include the relational data in PostgreSQL and specialized chemical indexes in Sachem. Resultsets of the evaluated queries are passed back to the SPARQL engine, translated into a SPARQL result in the requested format, and sent back to the client</p></caption><graphic specific-use="HTML" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_367_Fig1_HTML.png" /></fig></p>
          </sec>
          <sec id="Sec4">
            <title>Procedure call extension</title>
            <p id="Par19">Currently, there is no standardized way to represent a procedure call in SPARQL. Although a straight-forward syntactic extension for procedure calls could be implemented, it would make the service non-interoperable with existing standard-compliant services. Thus, we chose to adopt an approach from our earlier work [<xref ref-type="bibr" rid="CR16">16</xref>]. We encode the procedure calls as SPARQL patterns that do not differ syntactically from regular query patterns, but are recognized by the SPARQL service upon processing and handled in a special way.</p>
            <p id="Par20">The procedure call pattern is a standard triple pattern with subject, predicate and object. The engine uses the predicate part of the pattern to identify the stored procedure to be called—a special IRI contained in the predicate triggers translation of the entire pattern into the corresponding SQL procedure call. Procedure call arguments are represented by a blank node contained in the pattern as an object; individual properties of the blank node represent individual named arguments of the procedure. This allows the user to specify parameters in any order, or omit them and use the default parameter values. Results of the procedure call are bound to the RDF node specified in the pattern as a subject, either directly if the returned result is not structured or as blank nodes with properties if the result is structured.</p>
          </sec>
          <sec id="Sec5">
            <title>Structure search using SPARQL</title>
            <p id="Par21">We mapped the high-performance substructure and similarity search SQL procedures from Sachem to corresponding SPARQL procedure calls. These are identified by the predicates sachem:substructureSearch and sachem:similaritySearch, respectively.</p>
            <p id="Par22">The procedure calls take several arguments. The main argument is sachem:query, which specifies either SMILES or MDL description of the queried molecule structure. A comprehensive list of other search arguments is provided in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Parameters of the chemical structure query executed via the SPARQL procedure call</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Parameter name</p></th><th align="left"><p>Description and values</p></th></tr></thead><tbody><tr><td align="left" colspan="2"><p><italic>Common parameters</italic></p></td></tr><tr><td align="left"><p>sachem:query</p></td><td align="left"><p>Query molecule structure, formatted as SMILES or MDL</p></td></tr><tr><td align="left"><p>sachem:topn</p></td><td align="left"><p>Maximum number of results to return</p></td></tr><tr><td align="left" colspan="2"><p><italic>Substructure search parameters</italic></p></td></tr><tr><td align="left"><p>sachem:searchMode</p></td><td align="left"><p>Chooses between exact structure and substructure search, values:</p></td></tr><tr><td align="left" /><td align="left"><p> sachem:substructureSearch</p></td></tr><tr><td align="left" /><td align="left"><p> sachem:exactSearch</p></td></tr><tr><td align="left"><p>sachem:tautomerMode</p></td><td align="left"><p>Tautomer handling, accepted values:</p></td></tr><tr><td align="left" /><td align="left"><p> sachem:ignoreTautomers (do not consider tautomerism)</p></td></tr><tr><td align="left" /><td align="left"><p> sachem:inchiTautomers (use InChI-based algorithm [<xref ref-type="bibr" rid="CR17">17</xref>] for tautomer matching)</p></td></tr><tr><td align="left"><p>sachem:chargeMode</p></td><td align="left"><p>Selects coalescing of unspecified charge values in query:</p></td></tr><tr><td align="left" /><td align="left"><p> sachem:defaultChargeAsAny (unspecified charge is wildcard)</p></td></tr><tr><td align="left" /><td align="left"><p> sachem:defaultChargeAsZero (unspecified charge matches only uncharged atoms)</p></td></tr><tr><td align="left" /><td align="left"><p> sachem:ignoreCharges (ignores all charge annotations)</p></td></tr><tr><td align="left"><p>sachem:isotopeMode</p></td><td align="left"><p>Selects coalescing of unspecified isotope values in query:</p></td></tr><tr><td align="left" /><td align="left"><p> sachem:defaultIsotopeAsStandard (unspecified isotope matches only the standard isotope)</p></td></tr><tr><td align="left" /><td align="left"><p> sachem:defaultIsotopeAsAny (unspecified isotope is wildcard)</p></td></tr><tr><td align="left" /><td align="left"><p> sachem:ignoreIsotopes (ignore all isotope annotations)</p></td></tr><tr><td align="left"><p>sachem:stereoMode</p></td><td align="left"><p>Handling of stereochemistry:</p></td></tr><tr><td align="left" /><td align="left"><p> sachem:strictStereo (remove results with conflicting stereochemistry information)</p></td></tr><tr><td align="left" /><td align="left"><p> sachem:ignoreStereo (ignore all stereochemistry annotations)</p></td></tr><tr><td align="left" colspan="2"><p><italic>Similarity search parameters</italic></p></td></tr><tr><td align="left"><p>sachem:cutoff</p></td><td align="left"><p>Minimum similarity score of returned results in range 0–1, defaults to 0.8</p></td></tr></tbody></table></table-wrap></p>
            <p id="Par23">Using this framework, an example procedure call that finds all compounds that contain any tautomeric form of adenine as a substructure can be encoded to pattern as follows: <fig id="Figa" position="anchor"><graphic specific-use="HTML" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_367_Figa_HTML.png" position="anchor" /></fig></p>
            <p id="Par24">When included in a query that queries the ChEMBL dataset, the pattern will bind the variable COMPOUND to IRIs of the matching compounds (the result in CSV format is shortened for brevity): <fig id="Figb" position="anchor"><graphic specific-use="HTML" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_367_Figb_HTML.png" position="anchor" /></fig></p>
            <p id="Par25">The results of the similarity search are structured values, encoded as blank RDF nodes with the properties sachem:compound and sachem:score, which represent the identifier of the retrieved compound and its similarity score, respectively. An example pattern that executes a search for compounds similar to adenine can be encoded as follows: <fig id="Figc" position="anchor"><graphic specific-use="HTML" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_367_Figc_HTML.png" position="anchor" /></fig></p>
            <p id="Par26">If included in the query, the similarity search results will be mapped to the two corresponding variables: <fig id="Figd" position="anchor"><graphic specific-use="HTML" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_367_Figd_HTML.png" position="anchor" /></fig></p>
            <p id="Par27">The returned similarity score is based on Jaccard similarity [<xref ref-type="bibr" rid="CR18">18</xref>] of Morgan-style connectivity fingerprints [<xref ref-type="bibr" rid="CR19">19</xref>] with a radius of up to 5.</p>
          </sec>
          <sec id="Sec6">
            <title>IDSM service dataset support</title>
            <p id="Par28">The service can provide chemical search functionality across datasets that have been indexed by the internal Sachem cartridge. IDSM currently includes the well-established public databases DrugBank [<xref ref-type="bibr" rid="CR20">20</xref>], ChEBI [<xref ref-type="bibr" rid="CR21">21</xref>], ChEMBL [<xref ref-type="bibr" rid="CR22">22</xref>] and PubChem [<xref ref-type="bibr" rid="CR23">23</xref>], thus providing fast search in more than 100 million total compounds.</p>
            <p id="Par29">Maintenance of the search indexes is crucial for the service to provide a lasting, reliable source of accurate search results. The IDSM service therefore aims to provide indexed data that is as up-to-date as possible. This is currently ensured by running automated nightly checks and updates of all datasets.</p>
          </sec>
        </sec>
        <sec id="Sec7" sec-type="results">
          <title>Results</title>
          <p id="Par30">A running instance of the interoperable structure search service is accessible at the SPARQL endpoint https://idsm.elixir-czech.cz/sparql/endpoint/&lt;database>, where <inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi mathvariant="monospace">database</mml:mi><mml:mo>></mml:mo></mml:mrow></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\texttt {&lt;database>}}$$\end{document}</tex-math><inline-graphic xlink:href="13321_2019_367_Article_IEq1.gif" /></alternatives></inline-formula> comprises pubchem, drugbank, chebi and chembl.</p>
          <p id="Par31">We present two use cases: (1) a single-purpose chemical structure search application called ‘Sachem GUI,’ which serves as an example of using an interoperable chemical search in a web application, and (2) the general application ‘SPARQL GUI,’ which serves as a tool for constructing and running heterogeneous, federated queries that employ the service.</p>
          <sec id="Sec8">
            <title>Use case: chemical search in web applications</title>
            <p id="Par32">The possibility to obtain JSON-formatted output from the SPARQL interface makes the interoperable search functionality readily available for use in web applications. Public availability of this chemical information may be beneficial for construction of various domain-specific search tools and database access utilities atop the IDSM service.</p>
            <p id="Par33">We demonstrate this functionality in the online search tool ‘Sachem GUI,’ available at <ext-link xlink:href="https://idsm.elixir-czech.cz/sachem" ext-link-type="uri">https://idsm.elixir-czech.cz/sachem</ext-link>. Sachem GUI represents the simplest possible JavaScript wrapper over the Sachem search functionality. It provides a user-friendly molecule-drawing interface for input of chemical structure queries (the JavaScript implementation of the drawing interface is based on the EPAM Ketcher tool<xref ref-type="fn" rid="Fn1">1</xref>). After users draw a query, they may choose several other search parameters and hit the search button. Queries are then evaluated online by the IDSM service, and results are displayed as molecule images with metadata.</p>
            <p id="Par35">The source code of this application is intended as a starting point for development of more complicated search applications. For example, it could be easily adapted to allow the user to set additional search parameters and display the results of more complicated search queries, such as interactions with proteins (as shown in Sect. <xref rid="Sec10" ref-type="sec">3.3</xref>).</p>
          </sec>
          <sec id="Sec9">
            <title>Use case: heterogeneous chemical search</title>
            <p id="Par36">Examples of the various functionalities of federated queries across interoperable databases are presented in an interactive, modifiable form in the SPARQL GUI interface, available at <ext-link xlink:href="https://idsm.elixir-czech.cz/sparql" ext-link-type="uri">https://idsm.elixir-czech.cz/sparql</ext-link>.</p>
            <p id="Par37">Technically, SPARQL GUI is a universal SPARQL interface enriched with IDSM-specific functionalities, which mainly comprise improved display of chemical results, available examples, and search API documentation. The JavaScript implementation of SPARQL GUI is based on YASGUI, which is a stand-alone SPARQL frontend.<xref ref-type="fn" rid="Fn2">2</xref> Queries tested in SPARQL GUI can be easily transferred to other software (e. g. web applications based on the first use case) or used to gather data programmatically.</p>
          </sec>
          <sec id="Sec10">
            <title>Heterogeneous query example</title>
            <p id="Par39">Of the examples available in SPARQL GUI, we selected protein–small molecule interactions to demonstrate the intended usage of the service.</p>
            <p id="Par40">It is generally straightforward to search for proteins that have a known interaction or measured activity with a small molecule—protein databases are already referenced by chemical databases that contain measured activities. This is also true for ChEMBL [<xref ref-type="bibr" rid="CR22">22</xref>], which links chemical information to UniProt [<xref ref-type="bibr" rid="CR24">24</xref>] references <italic>via</italic> a chain of activities, assays, targets and target components that ends in chembl:UniprotRef.</p>
            <p id="Par41">A related and potentially desirable search would be to query the activities of proteins with compounds that contain a certain molecular core bearing arbitrary additional ligands. For example, the user might be interested in protein activities with any existing derivatives of morphine. Such a query is, however, not directly executable using current database interfaces. To run it, the user would first have to employ a simple substructure search tool (either the ChEMBL online search or a self-hosted substructure search) to extract a potentially long list of morphine-containing ChEMBL IDs [<xref ref-type="bibr" rid="CR22">22</xref>], which could then be used to construct a large query to obtain the protein information from UniProt.</p>
            <p id="Par42">With our interoperable chemical search service, this query can be run without any client-side overhead. Instead of listing the ChEMBL identifiers manually in the query, the user can employ a federated query that transparently retrieves the list of desired compound identifiers from the IDSM SPARQL endpoint. An example implementation of such a query is illustrated in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, along with a schema of its distributed processing. To complete the example, the displayed query code connects the morphine derivatives with additional UniProt content to obtain more metadata, including the names of the corresponding organisms.<fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p><bold>a</bold> An example of a federated SPARQL query that connects assay results of morphine derivatives to corresponding organism names. <bold>b</bold> Response to the same query in JSON format (shortened for brevity). <bold>c</bold> Schematic view of the distributed query processing. Colors match the execution place of the corresponding query parts, and the data source of the JSON response entries</p></caption><graphic specific-use="HTML" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_367_Fig2_HTML.png" /></fig></p>
          </sec>
        </sec>
        <sec id="Sec11" sec-type="discussion">
          <title>Discussion</title>
          <p id="Par43">Representation of chemistry-related structure search results in the context of semantic search creates a new source of data linkages. The ability to query for structural similarity or sub- and super-structures of molecules enables retrieval of precisely specified chemical relations between identifiers of molecules, which can be transparently and transitively extended to any molecule-referencing data.</p>
          <p id="Par44">The new links can be used to alleviate some archetypal sources of trouble in chemical search, including the problems of annotation granularity and canonization.</p>
          <p id="Par45">Metadata about chemical compounds (e. g. assay results) are typically present only for a single variant of a molecule in a database, but may be valid for multiple different tautomeric structures or even some derivatives. If the user searches for a connection between two annotations (e. g. assay results and vendor availability) using only the exact molecule identifiers, this connection may be missed if the annotations were unintentionally placed with related (in this case, chemically identical) but differently identified molecules. The presented service allows users to enrich the search by including annotations from small similarity- or structure-defined ‘neighborhoods’ of molecules, thus effectively avoiding this problem in a wide variety of search scenarios.</p>
          <p id="Par46">This approach can be viewed as complementary to the more common canonization policies that are enforced in chemical databases [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]. From a search perspective, both approaches help reduce the rate of false negatives by connecting larger amounts of available information. At the same time, they can potentially increase the rate of false positives. Manual annotation of canonized structure adds bias and maintenance problems derived from the human factor. Automatically produced links, on the other hand, may not have a chemically relevant interpretation and are biased by factors such as the similarity indexing method used.</p>
        </sec>
        <sec id="Sec12" sec-type="conclusions">
          <title>Conclusion</title>
          <p id="Par47">We have described a new service that delivers chemical structure search capabilities to searches in interoperable RDF databases. This innovation can be used to extend the rich heterogeneous search possibilities of current RDF databases by including automatically provided substructure and similarity relations between chemical identifiers in the search. We have demonstrated that this extension enables facile discovery of new, meaningful connections in data from multiple databases, and alleviates the impact of common canonization and curation problems in chemical databases.</p>
          <p id="Par48">The SPARQL engine is the main innovative component of the service. Although it is currently used only to provide an interoperable interface for Sachem, it is designed as a generic tool. Using the SPARQL engine, the same approach of improving dataset interoperability also can be applied to other areas of cheminformatics and bioinformatics, providing searches of metabolic pathways, biopolymer sequences, full-text metadata, etc.</p>
          <p id="Par49">The presented service is free, publicly available at <ext-link xlink:href="https://idsm.elixir-czech.cz" ext-link-type="uri">https://idsm.elixir-czech.cz</ext-link> and accessible through a SPARQL-compatible machine interface. The service includes two demonstration user interfaces that can be used to manually test the service viability and as a basis for implementing the provided chemical search in new applications.</p>
        </sec>
      </body>
      <back>
        <ack>
          <title>Acknowlegements</title>
          <p>Computational resources were provided by CESNET LM2015042 and CERIT Scientific Cloud LM2015085, provided under the programme “Projects of Large Research, Development, and Innovations Infrastructures”.</p>
        </ack>
        <sec sec-type="author-contribution">
          <title>Authors' contributions</title>
          <p>JG and JV designed the software and study. JG and MK implemented the Sachem cartridge and the web interfaces. JG implemented the SPARQL engine. MK wrote the manuscript. All authors participated in preparing the manuscript. All authors read and approved the final manuscript.</p>
        </sec>
        <sec>
          <title>Funding</title>
          <p>This project was supported by ELIXIR CZ (MEYS), Grant No. LM2015047. Funding for open access publication was provided by the Institute of Organic Chemistry and Biochemistry of the CAS (RVO), Project No. 61388963.</p>
        </sec>
        <sec sec-type="data-availability">
          <title>Availability of data and materials</title>
          <p>All datasets used are publicly accessible the respective databases. The service is public and freely available.</p>
        </sec>
        <sec sec-type="ethics-statement">
          <sec sec-type="COI-statement">
            <title>Competing interests</title>
            <p>The authors declare that they have no competing interests.</p>
          </sec>
        </sec>
        <ref-list id="Bib1">
          <title>References</title>
          <ref-list>
            <ref id="CR1">
              <label>1.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Berners-Lee</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Hendler</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Lassila</surname>
                    <given-names>O</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The semantic web</article-title>
                <source>Sci Am</source>
                <year>2001</year>
                <volume>284</volume>
                <issue>5</issue>
                <fpage>34</fpage>
                <lpage>43</lpage>
                <pub-id pub-id-type="doi">10.1038/scientificamerican0501-34</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR2">
              <label>2.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Jacob</surname>
                    <given-names>EK</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Ontologies and the semantic web</article-title>
                <source>Bull Am Soc Inf Sci Technol</source>
                <year>2003</year>
                <volume>29</volume>
                <issue>4</issue>
                <fpage>19</fpage>
                <lpage>22</lpage>
                <pub-id pub-id-type="doi">10.1002/bult.283</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR3">
              <label>3.</label>
              <mixed-citation publication-type="other">World Wide Web Consortium et al (2014) RDF 1.1 Primer. World Wide Web Consortium</mixed-citation>
            </ref>
            <ref id="CR4">
              <label>4.</label>
              <mixed-citation publication-type="other">World Wide Web Consortium et al (2014) RDF 1.1 concepts and abstract syntax. World Wide Web Consortium</mixed-citation>
            </ref>
            <ref id="CR5">
              <label>5.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>McBride</surname>
                    <given-names>B</given-names>
                  </name>
                </person-group>
                <person-group person-group-type="editor">
                  <name>
                    <surname>Staab</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Studer</surname>
                    <given-names>R</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The resource description framework (RDF) and its vocabulary description language RDFS</article-title>
                <source>Handbook on ontologies</source>
                <year>2004</year>
                <publisher-loc>Berlin</publisher-loc>
                <publisher-name>Springer</publisher-name>
                <fpage>51</fpage>
                <lpage>65</lpage>
                <pub-id pub-id-type="doi">10.1007/978-3-540-24750-0_3</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR6">
              <label>6.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Allemang</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Hendler</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <source>Semantic web for the working ontologist: effective modeling in RDFS and OWL</source>
                <year>2011</year>
                <publisher-loc>Amsterdam</publisher-loc>
                <publisher-name>Elsevier</publisher-name>
              </mixed-citation>
            </ref>
            <ref id="CR7">
              <label>7.</label>
              <mixed-citation publication-type="other">World Wide Web Consortium et al (2013) SPARQL 1.1 Query language: W3C recommendation. World Wide Web Consortium</mixed-citation>
            </ref>
            <ref id="CR8">
              <label>8.</label>
              <mixed-citation publication-type="other">World Wide Web Consortium et al (2013) SPARQL 1.1 protocol: W3C recommendation. World Wide Web Consortium</mixed-citation>
            </ref>
            <ref id="CR9">
              <label>9.</label>
              <mixed-citation publication-type="other">World Wide Web Consortium et al (2013) SPARQL 1.1 federated query: W3C recommendation. World Wide Web Consortium</mixed-citation>
            </ref>
            <ref id="CR10">
              <label>10.</label>
              <mixed-citation publication-type="other">Buil-Aranda C, Arenas M, Corcho O (2011) Semantics and optimization of the SPARQL 1.1 federation extension. In: Extended semantic web conference. Springer, pp 1–15</mixed-citation>
            </ref>
            <ref id="CR11">
              <label>11.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Kratochvíl</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Vondrášek</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Galgonek</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Sachem: a chemical cartridge for high-performance substructure search</article-title>
                <source>J Cheminform</source>
                <year>2018</year>
                <volume>10</volume>
                <issue>1</issue>
                <fpage>27</fpage>
                <pub-id pub-id-type="pmid">29797000</pub-id>
                <pub-id pub-id-type="pmcid">5966370</pub-id>
                <pub-id pub-id-type="doi">10.1186/s13321-018-0282-y</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR12">
              <label>12.</label>
              <mixed-citation publication-type="other">Mapping SQL Data to Linked Data Views; 2016. Online. <ext-link xlink:href="http://vos.openlinksw.com/owiki/wiki/VOS/VOSSQL2RDF" ext-link-type="uri">http://vos.openlinksw.com/owiki/wiki/VOS/VOSSQL2RDF</ext-link>. Accessed 2019-05-01</mixed-citation>
            </ref>
            <ref id="CR13">
              <label>13.</label>
              <mixed-citation publication-type="other">World Wide Web Consortium et al (2013) SPARQL 1.1 query results JSON format: W3C recommendation. World Wide Web Consortium</mixed-citation>
            </ref>
            <ref id="CR14">
              <label>14.</label>
              <mixed-citation publication-type="other">World Wide Web Consortium et al (2013) SPARQL 1.1 query results XML format, 2nd edn. W3C recommendation. World Wide Web Consortium</mixed-citation>
            </ref>
            <ref id="CR15">
              <label>15.</label>
              <mixed-citation publication-type="other">World Wide Web Consortium et al (2013) SPARQL 1.1 query results CSV and TSV formats: W3C recommendation. World Wide Web Consortium</mixed-citation>
            </ref>
            <ref id="CR16">
              <label>16.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Galgonek</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Hurt</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Michlíková</surname>
                    <given-names>V</given-names>
                  </name>
                  <name>
                    <surname>Onderka</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Schwarz</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Vondrášek</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Advanced SPARQL querying in small molecule databases</article-title>
                <source>J Cheminform</source>
                <year>2016</year>
                <volume>8</volume>
                <issue>1</issue>
                <fpage>31</fpage>
                <pub-id pub-id-type="pmid">27275187</pub-id>
                <pub-id pub-id-type="pmcid">4893829</pub-id>
                <pub-id pub-id-type="doi">10.1186/s13321-016-0144-4</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR17">
              <label>17.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Thalheim</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Vollmer</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Ebert</surname>
                    <given-names>RU</given-names>
                  </name>
                  <name>
                    <surname>Kühne</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Schüürmann</surname>
                    <given-names>G</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Tautomer identification and tautomer structure generation based on the InChI code</article-title>
                <source>J Chem Inf Model</source>
                <year>2010</year>
                <volume>50</volume>
                <issue>7</issue>
                <fpage>1223</fpage>
                <lpage>1232</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3cXotVOmsbk%3D</pub-id>
                <pub-id pub-id-type="pmid">20666407</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci1001179</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR18">
              <label>18.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Choi</surname>
                    <given-names>SS</given-names>
                  </name>
                  <name>
                    <surname>Cha</surname>
                    <given-names>SH</given-names>
                  </name>
                  <name>
                    <surname>Tappert</surname>
                    <given-names>CC</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">A survey of binary similarity and distance measures</article-title>
                <source>J Syst Cybern Inform</source>
                <year>2010</year>
                <volume>8</volume>
                <issue>1</issue>
                <fpage>43</fpage>
                <lpage>48</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR19">
              <label>19.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Rogers</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Hahn</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Extended-connectivity fingerprints</article-title>
                <source>J Chem Inf Model</source>
                <year>2010</year>
                <volume>50</volume>
                <issue>5</issue>
                <fpage>742</fpage>
                <lpage>754</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3cXlt1Onsbg%3D</pub-id>
                <pub-id pub-id-type="pmid">20426451</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci100050t</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR20">
              <label>20.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Law</surname>
                    <given-names>V</given-names>
                  </name>
                  <name>
                    <surname>Knox</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Djoumbou</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Jewison</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Guo</surname>
                    <given-names>AC</given-names>
                  </name>
                  <name>
                    <surname>Liu</surname>
                    <given-names>Y</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">DrugBank 4.0: shedding new light on drug metabolism</article-title>
                <source>Nucleic Acids Res</source>
                <year>2013</year>
                <volume>42</volume>
                <issue>D1</issue>
                <fpage>D1091</fpage>
                <lpage>D1097</lpage>
                <pub-id pub-id-type="pmid">24203711</pub-id>
                <pub-id pub-id-type="pmcid">3965102</pub-id>
                <pub-id pub-id-type="doi">10.1093/nar/gkt1068</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR21">
              <label>21.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Hastings</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Owen</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Dekker</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Ennis</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Kale</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Muthukrishnan</surname>
                    <given-names>V</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">ChEBI in 2016: improved services and an expanding collection of metabolites</article-title>
                <source>Nucleic Acids Res</source>
                <year>2015</year>
                <volume>44</volume>
                <issue>D1</issue>
                <fpage>D1214</fpage>
                <lpage>D1219</lpage>
                <pub-id pub-id-type="pmid">26467479</pub-id>
                <pub-id pub-id-type="pmcid">4702775</pub-id>
                <pub-id pub-id-type="doi">10.1093/nar/gkv1031</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR22">
              <label>22.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Gaulton</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Bellis</surname>
                    <given-names>LJ</given-names>
                  </name>
                  <name>
                    <surname>Bento</surname>
                    <given-names>AP</given-names>
                  </name>
                  <name>
                    <surname>Chambers</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Davies</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Hersey</surname>
                    <given-names>A</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">ChEMBL: a large-scale bioactivity database for drug discovery</article-title>
                <source>Nucleic Acids Res</source>
                <year>2011</year>
                <volume>40</volume>
                <issue>D1</issue>
                <fpage>D1100</fpage>
                <lpage>D1107</lpage>
                <pub-id pub-id-type="pmid">21948594</pub-id>
                <pub-id pub-id-type="pmcid">3245175</pub-id>
                <pub-id pub-id-type="doi">10.1093/nar/gkr777</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR23">
              <label>23.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Kim</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Thiessen</surname>
                    <given-names>PA</given-names>
                  </name>
                  <name>
                    <surname>Bolton</surname>
                    <given-names>EE</given-names>
                  </name>
                  <name>
                    <surname>Chen</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Fu</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Gindulyte</surname>
                    <given-names>A</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">PubChem substance and compound databases</article-title>
                <source>Nucleic Acids Res</source>
                <year>2015</year>
                <volume>44</volume>
                <issue>D1</issue>
                <fpage>D1202</fpage>
                <lpage>D1213</lpage>
                <pub-id pub-id-type="pmid">26400175</pub-id>
                <pub-id pub-id-type="pmcid">4702940</pub-id>
                <pub-id pub-id-type="doi">10.1093/nar/gkv951</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR24">
              <label>24.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Apweiler</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Bairoch</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Wu</surname>
                    <given-names>CH</given-names>
                  </name>
                  <name>
                    <surname>Barker</surname>
                    <given-names>WC</given-names>
                  </name>
                  <name>
                    <surname>Boeckmann</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>Ferro</surname>
                    <given-names>S</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">UniProt: the universal protein knowledgebase</article-title>
                <source>Nucleic Acids Res</source>
                <year>2004</year>
                <volume>32</volume>
                <issue>Suppl 1</issue>
                <fpage>D115</fpage>
                <lpage>D119</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3sXhtVSru7vK</pub-id>
                <pub-id pub-id-type="pmid">14681372</pub-id>
                <pub-id pub-id-type="pmcid">308865</pub-id>
                <pub-id pub-id-type="doi">10.1093/nar/gkh131</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR25">
              <label>25.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Fourches</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Muratov</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Tropsha</surname>
                    <given-names>A</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Trust, but verify: on the importance of chemical structure curation in cheminformatics and QSAR modeling research</article-title>
                <source>J Chem Inf Model</source>
                <year>2010</year>
                <volume>50</volume>
                <issue>7</issue>
                <fpage>1189</fpage>
                <lpage>1204</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3cXnvVeitLk%3D</pub-id>
                <pub-id pub-id-type="pmid">20572635</pub-id>
                <pub-id pub-id-type="pmcid">2989419</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci100176x</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR26">
              <label>26.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Warr</surname>
                    <given-names>WA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Tautomerism in chemical information management systems</article-title>
                <source>J Comput Aided Mol Des</source>
                <year>2010</year>
                <volume>24</volume>
                <issue>6–7</issue>
                <fpage>497</fpage>
                <lpage>520</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3cXnsFGqtLk%3D</pub-id>
                <pub-id pub-id-type="pmid">20372974</pub-id>
                <pub-id pub-id-type="doi">10.1007/s10822-010-9338-4</pub-id>
              </mixed-citation>
            </ref>
          </ref-list>
        </ref-list>
        <fn-group>
          <fn id="Fn1">
            <label>1</label>
            <p id="Par34"><ext-link xlink:href="http://lifescience.opensource.epam.com/ketcher/" ext-link-type="uri">http://lifescience.opensource.epam.com/ketcher/</ext-link>.</p>
          </fn>
          <fn id="Fn2">
            <label>2</label>
            <p id="Par38"><ext-link xlink:href="https://github.com/OpenTriply/YASGUI" ext-link-type="uri">https://github.com/OpenTriply/YASGUI</ext-link>.</p>
          </fn>
        </fn-group>
        <notes notes-type="Misc">
          <title>Publisher's Note</title>
          <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
        </notes>
      </back>
    </article>
