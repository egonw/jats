<?xml version="1.0"?>
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="research-article" xml:lang="en">
      <?properties open_access?>
      <front>
        <journal-meta>
          <journal-id journal-id-type="publisher-id">13321</journal-id>
          <journal-title-group>
            <journal-title>Journal of Cheminformatics</journal-title>
            <abbrev-journal-title abbrev-type="publisher">J Cheminform</abbrev-journal-title>
          </journal-title-group>
          <issn pub-type="epub">1758-2946</issn>
          <publisher>
            <publisher-name>Springer International Publishing</publisher-name>
            <publisher-loc>Cham</publisher-loc>
          </publisher>
        </journal-meta>
        <article-meta>
          <article-id pub-id-type="publisher-id">s13321-019-0376-1</article-id>
          <article-id pub-id-type="manuscript">376</article-id>
          <article-id pub-id-type="doi">10.1186/s13321-019-0376-1</article-id>
          <article-categories>
            <subj-group subj-group-type="heading">
              <subject>Research Article</subject>
            </subj-group>
            <subj-group subj-group-type="article-collection" specific-use="Regular">
              <subject>Big Data in Chemistry</subject>
            </subj-group>
          </article-categories>
          <title-group>
            <article-title xml:lang="en">Combining structural and bioactivity-based fingerprints improves prediction performance and scaffold hopping capability</article-title>
          </title-group>
          <contrib-group>
            <contrib contrib-type="author" corresp="yes" id="Au1">
              <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3353-1601</contrib-id>
              <name>
                <surname>Laufkötter</surname>
                <given-names>Oliver</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="aff" rid="Aff2">2</xref>
              <xref ref-type="corresp" rid="IDs1332101903761_cor1">a</xref>
            </contrib>
            <contrib contrib-type="author" id="Au2">
              <name>
                <surname>Sturm</surname>
                <given-names>Noé</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author" id="Au3">
              <name>
                <surname>Bajorath</surname>
                <given-names>Jürgen</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff2">2</xref>
            </contrib>
            <contrib contrib-type="author" id="Au4">
              <name>
                <surname>Chen</surname>
                <given-names>Hongming</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author" corresp="yes" id="Au5">
              <name>
                <surname>Engkvist</surname>
                <given-names>Ola</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="corresp" rid="IDs1332101903761_cor5">e</xref>
            </contrib>
            <aff id="Aff1">
              <label>1</label>
              <institution-wrap>
                <institution-id institution-id-type="ISNI">0000 0001 1519 6403</institution-id>
                <institution-id institution-id-type="GRID">grid.418151.8</institution-id>
                <institution content-type="org-name">Hit Discovery, Discovery Sciences, R&amp;D, AstraZeneca</institution>
              </institution-wrap>
              <addr-line content-type="city">Gothenburg</addr-line>
              <country country="SE">Sweden</country>
            </aff>
            <aff id="Aff2">
              <label>2</label>
              <institution-wrap>
                <institution-id institution-id-type="ISNI">0000 0004 0621 9417</institution-id>
                <institution-id institution-id-type="GRID">grid.469360.e</institution-id>
                <institution content-type="org-name">Department of Life Science Informatics, B-IT, LIMES Program Unit Chemical Biology and Medicinal Chemistry, Rheinische Friedrich-Wilhelms-Universität</institution>
              </institution-wrap>
              <addr-line content-type="city">Bonn</addr-line>
              <country country="DE">Germany</country>
            </aff>
          </contrib-group>
          <author-notes>
            <corresp id="IDs1332101903761_cor1">
              <label>a</label>
              <email>HIDDEN</email>
            </corresp>
            <corresp id="IDs1332101903761_cor5">
              <label>e</label>
              <email>HIDDEN</email>
            </corresp>
          </author-notes>
          <pub-date date-type="pub" publication-format="electronic">
            <day>8</day>
            <month>8</month>
            <year>2019</year>
          </pub-date>
          <pub-date date-type="collection" publication-format="electronic">
            <month>12</month>
            <year>2019</year>
          </pub-date>
          <volume>11</volume>
          <issue seq="54">1</issue>
          <elocation-id>54</elocation-id>
          <history>
            <date date-type="registration">
              <day>31</day>
              <month>7</month>
              <year>2019</year>
            </date>
            <date date-type="received">
              <day>19</day>
              <month>2</month>
              <year>2019</year>
            </date>
            <date date-type="accepted">
              <day>31</day>
              <month>7</month>
              <year>2019</year>
            </date>
            <date date-type="online">
              <day>8</day>
              <month>8</month>
              <year>2019</year>
            </date>
          </history>
          <permissions>
            <copyright-statement content-type="compact">© The Author(s) 2019</copyright-statement>
            <copyright-year>2019</copyright-year>
            <copyright-holder>The Author(s)</copyright-holder>
            <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
              <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (http://creativecommons.org/publicdomain/zero/1.0/) applies to the data made available in this article, unless otherwise stated.</license-p>
            </license>
          </permissions>
          <abstract xml:lang="en" id="Abs1">
            <title>Abstract</title>
            <p id="Par1">This study aims at improving upon existing activity predictions methods by augmenting chemical structure fingerprints with bio-activity based fingerprints derived from high-throughput screening (HTS) data (HTSFPs) and thereby showcasing the benefits of combining different descriptor types. This type of descriptor would be applied in an iterative screening scenario for more targeted compound set selection. The HTSFPs were generated from HTS data obtained from PubChem and combined with an ECFP4 structural fingerprint. The bioactivity-structure hybrid (BaSH) fingerprint was benchmarked against the individual ECFP4 and HTSFP fingerprints. Their performance was evaluated via retrospective analysis of a subset of the PubChem HTS data. Results showed that the BaSH fingerprint has improved predictive performance as well as scaffold hopping capability. The BaSH fingerprint identified unique compounds compared to both the ECFP4 and the HTSFP fingerprint indicating synergistic effects between the two fingerprints. A feature importance analysis showed that a small subset of the HTSFP features contribute most to the overall performance of the BaSH fingerprint. This hybrid approach allows for activity prediction of compounds with only sparse HTSFPs due to the supporting effect from the structural fingerprint.<fig id="Figa" position="anchor"><graphic specific-use="HTML" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_376_Figa_HTML.png" position="anchor" /></fig></p>
          </abstract>
          <kwd-group xml:lang="en">
            <title>Keywords</title>
            <kwd>Machine learning</kwd>
            <kwd>Random forest</kwd>
            <kwd>High throughput screening</kwd>
            <kwd>Activity prediction</kwd>
            <kwd>HTSFP</kwd>
            <kwd>ECFP</kwd>
            <kwd>Circular fingerprints</kwd>
            <kwd>Scaffold hopping</kwd>
          </kwd-group>
          <funding-group>
            <award-group>
              <funding-source>
                <institution-wrap>
                  <institution>Horizon 2020</institution>
                  <institution-id institution-id-type="doi" vocab="open-funder-registry">http://dx.doi.org/10.13039/501100007601</institution-id>
                </institution-wrap>
              </funding-source>
              <award-id award-type="FundRef grant">676434</award-id>
              <award-id award-type="FundRef grant">671555</award-id>
              <principal-award-recipient>
                <name>
                  <surname>Laufkötter</surname>
                  <given-names>Oliver</given-names>
                </name>
              </principal-award-recipient>
              <principal-award-recipient>
                <name>
                  <surname>Sturm</surname>
                  <given-names>Noé</given-names>
                </name>
              </principal-award-recipient>
            </award-group>
          </funding-group>
          <custom-meta-group>
            <custom-meta>
              <meta-name>publisher-imprint-name</meta-name>
              <meta-value>Springer</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-issue-count</meta-name>
              <meta-value>1</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-article-count</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-pricelist-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-holder</meta-name>
              <meta-value>The Author(s)</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-contains-esm</meta-name>
              <meta-value>Yes</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-month</meta-name>
              <meta-value>7</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-day</meta-name>
              <meta-value>31</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-product</meta-name>
              <meta-value>ArchiveJournal</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-grants-type</meta-name>
              <meta-value>OpenChoice</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>metadata-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>abstract-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodypdf-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodyhtml-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bibliography-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>esm-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>online-first</meta-name>
              <meta-value>false</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-file-reference</meta-name>
              <meta-value>BodyRef/PDF/13321_2019_Article_376.pdf</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>target-type</meta-name>
              <meta-value>OnlinePDF</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-type</meta-name>
              <meta-value>OriginalPaper</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-primary</meta-name>
              <meta-value>Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computer Applications in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Documentation and Information in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Theoretical and Computational Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computational Biology/Bioinformatics</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-collection</meta-name>
              <meta-value>Chemistry and Materials Science</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>open-access</meta-name>
              <meta-value>true</meta-value>
            </custom-meta>
          </custom-meta-group>
        </article-meta>
        <notes notes-type="ESMHint">
          <title>Electronic supplementary material</title>
          <p>The online version of this article (<ext-link xlink:href="10.1186/s13321-019-0376-1" ext-link-type="doi">https://doi.org/10.1186/s13321-019-0376-1</ext-link>) contains supplementary material, which is available to authorized users.</p>
        </notes>
      </front>
      <body>
        <sec id="Sec1">
          <title>Introduction</title>
          <p id="Par10">The traditional and most intuitive method of predicting compound activity is through the use of structure activity relationship (SAR) models. Logically, compounds with similar structural features or scaffolds would express similar activities. While SAR-based activity predictions are a practical and often effective method, the predictions made are based on structural similarity and therefore are inherently limited in structural diversity. This limits the scaffold hopping potential or exploration of chemical space and impedes the identification of novel active compounds. Another limitation of structure based fingerprints is the existence of activity cliffs, this is where two compounds with high degrees of similarity express inverse activity relationships towards a target. It is therefore very difficult to distinguish such compounds using structural descriptors. To bypass the drawbacks of SAR models, historical bioactivity data can be used to build fingerprints for each compound which can subsequently be applied in machine learning to make compound property predictions independent of chemical structural information. Such predictive models have been built using bioactivity data obtained from various sources, e.g. transcriptomics [<xref ref-type="bibr" rid="CR1">1</xref>], cell imaging [<xref ref-type="bibr" rid="CR2">2</xref>], affinity/inhibition data [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>], or high throughput screening (HTS) [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. Such bioactivity data has been utilized for a number of applications such as compound safety/toxicity predictions [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR8">8</xref>], compound potency/activity predictions [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>], target elucidation [<xref ref-type="bibr" rid="CR11">11</xref>], or elucidation of compound MoA [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. A review by Wassermann et al. provides an in-depth summary of the history and applications of historical bioactivity data to date [<xref ref-type="bibr" rid="CR14">14</xref>]. A study by Kauvar et al. presented one of the earliest applications of bioactivity profiles for compound property prediction [<xref ref-type="bibr" rid="CR3">3</xref>]. In this study, affinity profiles of compounds based on a panel of 18 olfactory proteins were generated and used to predict compound binding properties on external targets. A study presented by Fliri et al. used a somewhat larger database to build bioactivity profiles termed ‘biospectra’ to predict compound-target activities [<xref ref-type="bibr" rid="CR4">4</xref>]. This bioactivity profile was based on a panel of 1567 compounds and 92 assays representing a diverse cross-section of the proteome.</p>
          <p id="Par11">HTS is a method used for large scale testing of compound libraries, containing up to five million compounds, against a single target [<xref ref-type="bibr" rid="CR15">15</xref>]. HTS has become feasible during the last three decades due to advances in process automation along with the development of new technologies [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. HTS is a resource-intensive process, which usually only identifies a very small portion of active compounds [<xref ref-type="bibr" rid="CR17">17</xref>]. To reduce resource costs in HTS, compound activity prediction methods can be employed. Using machine learning together with either structural or bioactivity descriptors, predictive models can be built. The limiting factor in using bioactivity based methods is the lack of data, meaning this method can only be applied to existing compounds which have sufficient bioactivity data. Structural descriptors can be useful for predicting a variety of compound properties [<xref ref-type="bibr" rid="CR18">18</xref>]. Structure based descriptors such as ECFP/Morgan circular fingerprints are an effective and established method for predicting compound activity [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>], although the structural diversity of predictions can be limited by the training data. To overcome this potential drawback Petrone et al. introduced a bioactivity based descriptor derived from historical HTS data i.e. the HTS Fingerprint (HTSFP) [<xref ref-type="bibr" rid="CR5">5</xref>]. The HTSFP has the advantage of not containing any structural information and thereby can be used to make activity predictions independent of any structural features. Moreover, in phenotypic screens HTS fingerprints may detect active compounds with distinct MoAs, such as alternate binding sites. Unfortunately, the HTSFP has one major drawback, which is that predictions cannot be made for all compounds but only for compounds that have been previously tested in HTS assays, compounds without any HTS data cannot have an HTSFP. Furthermore, compounds with very sparse HTSFPs i.e. compounds having only been tested in very few assays, have limited practicality in such predictive models. These compounds are often not useful as they introduce noise into the data and reduce the predictive performance of models and therefore are removed from the dataset. A fingerprint density cutoff is commonly used to exclude these compounds [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. This method of data processing leads to the loss of a significant amount of potentially valuable information. Despite these problems HTSFPs have proven to be an effective and robust tool for compound activity predictions in a number of retrospective studies.</p>
          <p id="Par12">Petrone et al. compared the performance of HTSFP and ECFP4 and showed that the HTSFP had better performance for certain targets. The most prominent aspect of this study was the increased structural diversity of the HTSFP predictions [<xref ref-type="bibr" rid="CR5">5</xref>]. Paricharak et al. showed that HTSFPs are effective tools for iterative screening approaches in HTS to provide more targeted and efficient screening, saving costs and resources [<xref ref-type="bibr" rid="CR10">10</xref>]. More recently, HTSFPs have been employed for multitask machine learning methods. The study by Sturm et al. compared HTSFP and ECFP4, again showing that the predictions returned from HTSFP models have little overlap with those of the ECFP, concluding that HTSFPs are valuable tools for scaffold hopping [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. A study by Wassermann et al. in 2013 showed the first step in the direction of combining structural and bioactivity descriptors [<xref ref-type="bibr" rid="CR9">9</xref>]. Their study focused on generating HTSFPs for compounds which had no available HTS data. This was performed by calculating an untested compounds structural similarity to compounds with existing HTSFPs. The HTSFP of compounds with high similarity were substituted onto the untested compounds. A different study by Riniker et al. went a step further and described a method of using both ECFP4 and HTSFPs for activity prediction by building machine learning models on each of the two descriptor types individually and subsequently combining the two trained models using heterogeneous classifier fusion for the final activity predictions [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
          <p id="Par13">In this study, a novel fingerprint was designed by combining bioactivity descriptors (HTSFPs) with structural descriptors. The aim was to improve compound activity predictions and scaffold hopping potential of structural fingerprints while also showing that the method of combining different types of descriptors can in general be beneficial in terms of synergistic effects. This method is developed with the prospect of improving iterative screening approaches, through targeted compound set selection with greater accuracy and coverage of chemical space. The underlying idea was that combining the fingerprints fortifies the HTSFP with structural data, thereby removing the necessity of having to make a HTSFP density cutoff and allowing for a more efficient use of available HTS data. The fingerprint introduced herein was designed by concatenating the HTSFP with an ECFP4 to make a <underline>b</underline>io<underline>a</underline>ctivity-<underline>s</underline>tructure <underline>h</underline>ybrid (BaSH) fingerprint. The HTSFP was constructed using HTS data from PubChem made up of 561 assays and is based on the activity flags set in the PubChem database. A random forest binary classifier was used to build the predictive model. The results were validated via a retrospective analysis on a set of HTS assays which had been excluded from the training data, i.e. these assays were not included in the HTSFP or BaSH fingerprint. The results were benchmarked against the individual HTSFP and ECFP4.</p>
        </sec>
        <sec id="Sec2">
          <title>Results and discussion</title>
          <p id="Par14">The HTS data was obtained from PubChem bioassays and post-refinement contained a total of 715,000 unique compounds and 561 HTS assays. A retrospective analysis was performed using separate test and validation sets. A set of ten test assays were randomly chosen and excluded from the HTSFP and BaSH fingerprint and used for the hyperparameter optimization. Another 24 assays where chosen at random from the HTS dataset as the validation set and were excluded from the HTSFP and BaSH fingerprint, a detailed overview of these assays is shown in Table <xref rid="Tab1" ref-type="table">1</xref>. These 24 validation set assays did in some cases have a biological overlap with the assays in the HTSFP. While this overlap was not investigated prior to building the predictive models, the overlap is discussed for the relevant assays further on in the results. The results from the bioactivity-structure hybrid (BaSH) fingerprint were benchmarked against the un-concatenated HTSFP and ECFP4. Furthermore, the scaffold hopping potential of the BaSH fingerprint was investigated by comparing topological scaffolds and performing a nearest neighbor comparison. The random forest classifier models built on the ECFP4, HTSFP, and BaSH fingerprint were used to make predictions for each assay. The results of the random forest analysis were investigated for each of the three fingerprint types using a variety of different performance metrics most of which are derived from values of the confusion matrix. Each metric was averaged using the results of a sixfold cross validation and are discussed in detail in the following paragraphs. An overview of all metrics and the confusion matrix for all assays can be found in Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>: Table S2.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Overview of the 24 test assays used in the validation set</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>AID</p></th><th align="left"><p>Compounds tested</p></th><th align="left"><p>Actives</p></th><th align="left"><p>% Actives</p></th><th align="left"><p>Target information</p></th><th align="left"><p>Assay type</p></th></tr></thead><tbody><tr><td align="left"><p>522</p></td><td char="." align="char"><p>64907</p></td><td char="." align="char"><p>1225</p></td><td char="." align="char"><p>1.89%</p></td><td align="left"><p>Nuclear receptor Steroidogenic Factor 1 (SF-1)</p></td><td align="left"><p>Cell-based</p></td></tr><tr><td align="left"><p>527</p></td><td char="." align="char"><p>24074</p></td><td char="." align="char"><p>64</p></td><td char="." align="char"><p>0.27%</p></td><td align="left"><p>Bacterial Quorum Sensing</p></td><td align="left"><p>Cell-based</p></td></tr><tr><td align="left"><p>555</p></td><td char="." align="char"><p>65239</p></td><td char="." align="char"><p>316</p></td><td char="." align="char"><p>0.48%</p></td><td align="left"><p>Mevalonate kinase</p></td><td align="left"><p>Biochemical</p></td></tr><tr><td align="left"><p>560</p></td><td char="." align="char"><p>64907</p></td><td char="." align="char"><p>979</p></td><td char="." align="char"><p>1.51%</p></td><td align="left"><p>Retinoic Acid Receptor-related orphan receptor A (RORA)</p></td><td align="left"><p>Cell-based</p></td></tr><tr><td align="left"><p>746</p></td><td char="." align="char"><p>59787</p></td><td char="." align="char"><p>366</p></td><td char="." align="char"><p>0.61%</p></td><td align="left"><p>c-Jun N-Terminal Kinase 3 (JNK3)</p></td><td align="left"><p>Biochemical</p></td></tr><tr><td align="left"><p>798</p></td><td char="." align="char"><p>218716</p></td><td char="." align="char"><p>302</p></td><td char="." align="char"><p>0.14%</p></td><td align="left"><p>Coagulation factor XIa</p></td><td align="left"><p>Biochemical</p></td></tr><tr><td align="left"><p>1006</p></td><td char="." align="char"><p>195564</p></td><td char="." align="char"><p>2976</p></td><td char="." align="char"><p>1.52%</p></td><td align="left"><p>Compounds inhibiting luciferase</p></td><td align="left"><p>Biochemical</p></td></tr><tr><td align="left"><p>1273</p></td><td char="." align="char"><p>127297</p></td><td char="." align="char"><p>1153</p></td><td char="." align="char"><p>0.91%</p></td><td align="left"><p>Insulin promoter activity—Proinsulin</p></td><td align="left"><p>Cell-based<sup>a</sup></p></td></tr><tr><td align="left"><p>1515</p></td><td char="." align="char"><p>217964</p></td><td char="." align="char"><p>445</p></td><td char="." align="char"><p>0.20%</p></td><td align="left"><p>Retinoblastoma binding protein 9 (RBBP9)</p></td><td align="left"><p>Biochemical</p></td></tr><tr><td align="left"><p>2129</p></td><td char="." align="char"><p>315002</p></td><td char="." align="char"><p>2199</p></td><td char="." align="char"><p>0.70%</p></td><td align="left"><p>BCL2-related protein, long isoform (BCLXL).</p></td><td align="left"><p>Biochemical</p></td></tr><tr><td align="left"><p>2280</p></td><td char="." align="char"><p>324750</p></td><td char="." align="char"><p>1419</p></td><td char="." align="char"><p>0.44%</p></td><td align="left"><p>GLD-1 protein—TGE RNA interaction.</p></td><td align="left"><p>Biochemical</p></td></tr><tr><td align="left"><p>2540</p></td><td char="." align="char"><p>330397</p></td><td char="." align="char"><p>4119</p></td><td char="." align="char"><p>1.25%</p></td><td align="left"><p>Sentrin-specific protease 8 (SENP8)</p></td><td align="left"><p>Biochemical</p></td></tr><tr><td align="left"><p>2544</p></td><td char="." align="char"><p>330397</p></td><td char="." align="char"><p>393</p></td><td char="." align="char"><p>0.12%</p></td><td align="left"><p>Intestinal alkaline phosphatase</p></td><td align="left"><p>Biochemical</p></td></tr><tr><td align="left"><p>2553</p></td><td char="." align="char"><p>305614</p></td><td char="." align="char"><p>3253</p></td><td char="." align="char"><p>1.06%</p></td><td align="left"><p>Transient receptor potential cation channel C6 (TRPC6)</p></td><td align="left"><p>Cell-based<sup>a</sup></p></td></tr><tr><td align="left"><p>2606</p></td><td char="." align="char"><p>324751</p></td><td char="." align="char"><p>157</p></td><td char="." align="char"><p>0.05%</p></td><td align="left"><p>Membrane-associated serine protease Rv3671c</p></td><td align="left"><p>Biochemical</p></td></tr><tr><td align="left"><p>463104</p></td><td char="." align="char"><p>331676</p></td><td char="." align="char"><p>1100</p></td><td char="." align="char"><p>0.33%</p></td><td align="left"><p>Adaptive arm of the Unfolded Protein response</p></td><td align="left"><p>Cell-based</p></td></tr><tr><td align="left"><p>504406</p></td><td char="." align="char"><p>323914</p></td><td char="." align="char"><p>194</p></td><td char="." align="char"><p>0.06%</p></td><td align="left"><p>UDP-galactopyranose mutase (UGM) enzyme</p></td><td align="left"><p>Biochemical</p></td></tr><tr><td align="left"><p>504454</p></td><td char="." align="char"><p>339285</p></td><td char="." align="char"><p>1446</p></td><td char="." align="char"><p>0.43%</p></td><td align="left"><p>Beta-2AR agonists-b2AR</p></td><td align="left"><p>Cell-based</p></td></tr><tr><td align="left"><p>588497</p></td><td char="." align="char"><p>340322</p></td><td char="." align="char"><p>780</p></td><td char="." align="char"><p>0.23%</p></td><td align="left"><p>Botulinum neurotoxin light chain F protease</p></td><td align="left"><p>Biochemical</p></td></tr><tr><td align="left"><p>602363</p></td><td char="." align="char"><p>347157</p></td><td char="." align="char"><p>446</p></td><td char="." align="char"><p>0.13%</p></td><td align="left"><p>Modulators of the fidelity of start codon recognition</p></td><td align="left"><p>Cell-based</p></td></tr><tr><td align="left"><p>623901</p></td><td char="." align="char"><p>332759</p></td><td char="." align="char"><p>470</p></td><td char="." align="char"><p>0.14%</p></td><td align="left"><p>Inhibitors of miR-122 (miRNA)</p></td><td align="left"><p>Cell-based</p></td></tr><tr><td align="left"><p>624414</p></td><td char="." align="char"><p>400339</p></td><td char="." align="char"><p>482</p></td><td char="." align="char"><p>0.12%</p></td><td align="left"><p>Mucolipin-1 Transient Receptor Potential 1 (TRPML1)</p></td><td align="left"><p>Cell-based</p></td></tr><tr><td align="left"><p>686964</p></td><td char="." align="char"><p>369939</p></td><td char="." align="char"><p>1149</p></td><td char="." align="char"><p>0.31%</p></td><td align="left"><p>Methyl-CpG binding domain protein 2</p></td><td align="left"><p>Biochemical</p></td></tr><tr><td align="left"><p>720700</p></td><td char="." align="char"><p>369939</p></td><td char="." align="char"><p>3123</p></td><td char="." align="char"><p>0.84%</p></td><td align="left"><p>Phospholipase C, gamma 1</p></td><td align="left"><p>Biochemical</p></td></tr></tbody></table><table-wrap-foot><p>Shown are their PubChem AID, total number of compounds tested in assay, and the proportion of active compounds, assay target information, and assay type. Compounds are labeled active or inactive based on the activity flag set in the PubChem data</p><p><sup>a</sup>Assay types were not indicated in PubChem for these assays and were interpreted manually</p></table-wrap-foot></table-wrap></p>
          <sec id="Sec3">
            <title>Classification performance</title>
            <sec id="Sec4">
              <title>Receiver operator characteristic</title>
              <p id="Par15">Receiver-operator-characteristic (ROC) curves for each of the three fingerprint types and eight of the 24 test assays are displayed in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. The ROC area-under-curve (ROC-AUC), shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref> bar plot, were calculated to compare the relative performances between the three fingerprint models. The ROC curve compares the true positive rate (TPR) against the false positive rate (FPR), while varying the threshold of the classification confidence scores, this provides an indication of the early enrichment and gives a rough idea of the overall performance. Analysis of these curves and AUC values indicates that prediction performance of the ECFP was better than the HTSFP in only seven of the 24 test assays. The original study on HTSFPs by Petrone et al. showed that the ECFP was a more reliable descriptor than HTSFP in terms of ROC AUC [<xref ref-type="bibr" rid="CR5">5</xref>]. The HTSFP used in Petrone’s study was based on 195 assays which may have limited its potential performance compared with 651 assays used in this study. Other recent studies also show that the HTSFP often outperforms the ECFP in terms of ROC AUC, but credit this in part to the presence of confirmatory or similar assays [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. The relative performance between the ECFP and HTSFP varied from assay to assay, which is likely dependent on the assay target types and also on the density of the HTSFPs for the compounds tested in each assay. Some of the test assay targets have also been tested in other assays or have closely related targets in other assays, thereby boosting the predictive performance of these particular assays. The BaSH fingerprint predictions showed increased ROC for 18 of the 24 test assays, although in the remaining seven assays the BaSH fingerprint showed comparable performance to the better of the HTSFP and ECFP. Noticeably the ROC curves showed that the early enrichment appeared to be improved in most test assays.<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>Receiver operator characteristic (ROC) curves comparing the hybrid fingerprint (BaSH) with the HTSFP and ECFP4, green, orange, and blue respectively. The shaded area either side of the ROC curve represents one standard deviation. Shown are 8 of the 24 validation set assays with the most diverse results</p></caption><graphic specific-use="HTML" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_376_Fig1_HTML.png" /></fig><fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>Performance metrics for the 24 test assays comparing the hybrid fingerprint (BaSH) with the HTSFP and the ECFP4, green, orange, and blue respectively. Top: ROC-AUC, Middle: Matthews correlation coefficient, Bottom: enrichment factor. The errors bars in black represent one standard deviation</p></caption><graphic specific-use="HTML" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_376_Fig2_HTML.png" /></fig></p>
            </sec>
            <sec id="Sec5">
              <title>Precision, recall, and F1 score</title>
              <p id="Par16">The precision, recall and F1 scores were calculated for each of fingerprints, these were based on the averages from the sixfold cross validation and are plotted in Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>: Figure S3. The HTSFP had relatively low precision compared to the ECFP, for all but five of the 24 test assays but inversely had the highest recall/sensitivity in every test assay except one (623901). The BaSH fingerprint performed best in all 24 assays for precision but was out performed by the HTSFP in the sensitivity scores in all but one assay (623901), although the BaSH fingerprint sensitivity was still better than that of the ECFP4 In the majority of cases. This shows that the HTSFP is predicting a very large number of compounds to be active, thereby recovering a large portion of the true positives, i.e. the high sensitivity, but at the same time a large number of false positives are predicted giving the HTSFP a low precision. To further analyze these results the F1 scores were compared, which gave the harmonic mean of the precision and sensitivity. The plot of the F1 scores resolves the previously unclear results, showing that the BaSH fingerprint is on par, or outperforming the other two fingerprints in all test assays. The trends seen in the F1 scores are similar to those of the MCC analysis seen in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.</p>
            </sec>
          </sec>
          <sec id="Sec6">
            <title>Mathews correlation coefficient</title>
            <p id="Par17">Results were also compared using the Mathews correlation coefficient (MCC). This is a well-suited metric for measuring the predictive quality on very unbalanced datasets, which is the case for this data, having an average active compound rate of 0.80% across the 561 assays used. The average proportion of actives across the 24 tested assays was 0.57% which is very imbalanced and can affect the quality of other measurement techniques. The bar plot in Fig. <xref rid="Fig2" ref-type="fig">2</xref> compares the average MCC scores from the sixfold cross validation for each of the three fingerprint types. In eight of the 24 test assays the ECFP4 outperformed the HTSFP by a clear margin, in fourteen assays the HTSFP scored higher than the ECFP4 and in the remaining two MCC scores were similar. Again, the varying relative performances between these two fingerprints is likely highly dependent on the amount of information in the assay compounds’ HTS fingerprints, therefore test assays who have biological overlap with the assays of the fingerprint will have better performance and also assays with large portions of mostly sparse HTSFPs will be expected to perform poorer. The MCC scores for the BaSH fingerprint are higher than those of the other two fingerprints for all but five of the 24 test assays.</p>
            <sec id="Sec7">
              <title>Cohen’s Kappa score</title>
              <p id="Par18">The Cohen’s kappa scores were also calculated from the cross-validation results and are plotted in Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>: Figure S3. The plot again shows the improved performance of the BaSH fingerprint compared with the other two fingerprints. The Kappa score shows an identical trend to that seen in the MCC plot.</p>
            </sec>
            <sec id="Sec8">
              <title>Enrichment</title>
              <p id="Par19">To further investigate the relative performances of the three different fingerprints, the top scoring 1% of compounds from each prediction run of the cross validation were compared. The top 1% represented between 240 and 4000 compounds, depending on the assay (see Table <xref rid="Tab1" ref-type="table">1</xref>). The enrichment factor (EF<sub>1%</sub>) for each assay was determined. The average enrichment factor for each fingerprint type in each assay is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The ECFP4 showed the poorest enrichment in 18 of the 24 test assays. Overall, the BaSH fingerprint produced the on par or better enrichment factor for all test assays except one (assay 602363). In many cases the EF<sub>1%</sub> differences were only marginal but the EF of the BaSH fingerprint did become slightly more apparent when taking into account a higher percentage of compounds, i.e. EF<sub>1.5%</sub>, EF<sub>2%</sub>, EF<sub>2.5%</sub>.</p>
            </sec>
          </sec>
          <sec id="Sec9">
            <title>Scaffold hopping analysis</title>
            <sec id="Sec10">
              <title>Scaffold overlap</title>
              <p id="Par20">The second goal of the study was to determine the scaffold hopping potential of the BaSH fingerprint compared with the ECFP4 and the HTSFP. The scaffold hopping capabilities of the HTSFP is well known and has been demonstrated in a number of studies [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. To compare the chemical diversity of the predicted compounds, the topological-Murcko scaffolds of each of the true positive predicted compounds in the top scoring 1% of predictions were compared. The topological-Murcko scaffold is created by removing all side chains and subsequently converting all atoms in the structure to sp3 carbons. As expected the scaffolds predicted using the HTSFP had only a limited overlap with the scaffolds predicted using the ECFP4. On average, 59% of the scaffolds from the ECFP4 were also detected by HTSFP. Venn diagrams were constructed for the three fingerprint types and are shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. The Venn diagrams in Fig. <xref rid="Fig3" ref-type="fig">3</xref> show the total number of unique scaffolds detected by each descriptor next to the descriptor name. The blue orange and green circles represent the unique scaffolds retrieved by the ECFP, HTSFP, and BaSH respectively. The numbers in each segment of the circles correspond to the number of unique scaffolds found in that segment. The number of scaffolds is proportional to the sizes of the circles. Combining the structural (ECFP4) and bioactivity (HTSFP) fingerprints into one fingerprint (BaSH), one would expect the therefrom predicted scaffolds to reflect some form of overlap from the predictions of both the other two fingerprint types. Assays 527 and 1515 are representatives of the two extremes within the 24 test assays and are shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. In the case of assay 1515, a very wide separation between the three scaffold groups can be seen, whereas in assay 527 the BaSH overlaps with almost all the scaffolds of both the ECFP4 and the HTSFP. The latter is the expected result, which shows no or very few novel scaffolds relative to the ECFP and HTSFP. This distribution pattern seen in the Venn diagram for assay 527 was not very common among the other 24 test assays. Interestingly, the BaSH fingerprint also predicted an additional completely unique set of topological scaffolds that did not overlap with either of the ECFP4 or the HTSFP predictions in all test assays (green shaded area). This effect was most pronounced in assay 1515 showing 37% unique scaffolds predicted only by the BaSH fingerprint. On average, the BaSH fingerprint predicted 16% unique scaffolds across the 24 test assays. The 33 scaffolds unique to assay 1515 (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>) were investigated more closely, an example of six of these structurally diverse compounds predicted correctly only by the BaSH are shown in Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>: Figure S8. These results indicate synergistic effects when combining the two fingerprints, leading to the detection of additional novel scaffolds. The overall count of true positive scaffolds predicted within the top scoring 1% of compounds was also highest for the BaSH fingerprint in most test assays. This suggested that the BaSH fingerprint was a more effective fingerprint for scaffold hopping than its precursors. Venn diagrams of all test assays can be found in the additional data Fig. <xref rid="Fig4" ref-type="fig">4</xref>.<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>Venn diagrams showing the number of unique topological-Murcko scaffolds in the top scoring 1% of predictions. Each circle represents one of the three predictive models: BaSH, HTSFP, and ECFP4 (green, orange, blue respectively). Left diagram refers to test assay 527 and right diagram to test assay 1515</p></caption><graphic specific-use="HTML" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_376_Fig3_HTML.png" /></fig><fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>Compound diversity of top scoring 1000 compounds. The nearest neighbor Tanimoto similarity was calculated for each of the 1000 compounds and plotted as a fitted histogram. The nearest neighbor similarity was calculated for each of the 3 predictive models BaSH: green, HTSFP: orange, and ECFP4: blue</p></caption><graphic specific-use="HTML" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_376_Fig4_HTML.png" /></fig></p>
            </sec>
            <sec id="Sec11">
              <title>Nearest neighbor Tanimoto similarity</title>
              <p id="Par21">To further investigate the results shown in the Venn diagrams a nearest neighbor analysis was performed. The Venn diagrams revealed the presence of different scaffolds but did not reveal how different these scaffolds were to one another structurally. By plotting the nearest neighbor for each compound, the overall structural diversity of the compound set could be visualized. Figure <xref rid="Fig4" ref-type="fig">4</xref> shows the plot of the nearest neighbor Tanimoto similarity of the top scoring 1000 compounds of assay 463104 using each of the three prediction models. The plot shows that the compounds predicted using the ECFP4 share a larger degree of structural similarity relative to the predictions made using the HTSFP. The majority of the compounds predicted using ECFP4 have a Tanimoto similarity between 0.7 and 0.9 whereas the majority of compounds predicted using the HTSFP have a Tanimoto similarity around 0.3–0.4. The compounds predicted using the BaSH fingerprint had similarity values in between those of ECFP4 and the HTSFP. This distribution provides evidence that the ECFP4 is not as well suited for scaffold hopping as the HTSFP or the BaSH. It must also be mentioned that the diversity of the ECFP predictions is highly dependent on the diversity of its training data, i.e. highly diverse training data can also lead to diverse predictions for ECFP but these predictions would theoretically never expand into new chemical space as well as bioactivity fingerprints. Although the compounds predicted with the BaSH fingerprint exhibit a lower degree of structural diversity than the HTSFP, the predictive accuracy of the BaSH is better and is therefore the favored model. All 24 test assays followed a similar trend as the seen in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, plots for all test assays are shown in Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>: Figure S4.</p>
            </sec>
          </sec>
          <sec id="Sec12">
            <title>Compound ranking comparison</title>
            <p id="Par22">The top ranking 1000 compounds predicted using BaSH fingerprint were selected. Compounds could be ranked based on their probability scores obtained from the random forest model. This probability score is based on consensus voting by the decision trees of the random forest model. The rankings of these compounds in the ECFP4 predictions were plotted against the rankings from the HTSFP predictions. These plots for assays 463104 and 624414 are shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. The green dots represent active compounds and the orange dots represent inactive compounds. Compounds above the diagonal black line were ranked higher in the ECFP4 model and compounds below the line were ranked higher in the HTSFP model, i.e. a smaller number equals higher rank. The dashed lines represent the boundary for rankings not in the top 1000 for either the ECFP4 or HTSFP. It was expected that the top 1000 BaSH compounds would be within the top ranking 1000 compounds of either the ECFP4 or the HTSFP i.e. not in the upper right quadrant of the plot. This expectation would give a rise to an ‘L’ shaped clustering. This ‘L’ shaped clustering was only partially visible in the plot of assay 624414, but even here a small number of the compounds were located outside the expected rankings, i.e. in the upper right quadrant. The remaining 24 assays larger portions of the 1000 BaSH predicted compounds appeared in the upper right quadrant (see Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>: Figure S6). For example, assay 463104 showed a large portion of compounds ranked outside the top 1000 for both the ECFP4 and the HTSFP. The fact that the BaSH fingerprint predicts many active compounds outside the top 1000 rankings of ECFP4 and HTSFP demonstrates a synergistic effect between structural and bioactivity descriptors. This synergistic effect allows for improved predictive performance and scaffold hopping capability. The scatter plots for all 24 test assays are show in the Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>: Figure S6.<fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p>Comparison of compound rankings for the three prediction models. The top scoring 1000 compounds predicted using the BaSH are shown. The rankings of the same compounds in the HTSFP model (Y-axis) and the ECFP4 model (X-axis) are compared. The green and orange dots represent active and inactive compounds, respectively. The dashed line boarders the upper right quadrant, which refers to rankings outside the top 1000 rankings for the HTSFP and EFCP4. Results from two test assays are shown in the plots left: AID 463104 and right: AID 624414</p></caption><graphic specific-use="HTML" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_376_Fig5_HTML.png" /></fig></p>
            <sec id="Sec13">
              <title>Feature importance</title>
              <p id="Par23">The feature importance of each of the models for the BaSH fingerprint six-fold cross validation were analyzed using a feature importance function [<xref ref-type="bibr" rid="CR23">23</xref>]. The feature importance for assay 463104 is plotted in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. Features 0–560 refer to the HTSFP (orange) while features 560–1584 refer to the ECFP4 (blue). This plot shows the average and the maximum importance (light and dark shades respectively) calculated from the six-fold cross validation. The ECFP4 seldom shows any features that are significantly more important than others and in general displays an overall constant basal level of importance, i.e. almost every ECFP4 feature has some importance. In one case, assay 555, where the HTSFP had no significant contribution did some of the ECFP features show pronounced importance. For some of the assays certain features in the ECFP4 show higher importance but due to the way the ECFP4 is folded into a 1024 binary vector it is impossible to determine precisely which structural features each bit corresponds to. The HTSFP portion of the BaSH shows much greater variability in feature importance from assay to assay. Overall the basal level of feature importance in the HTSFP is lower than in the ECFP4, although a small number of the HTSFP features show highly pronounced importance values. This trend of pronounced HTSFP features could be seen across 19 of the 24 test assays (see plots in Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>: Figure S7). The assays corresponding to these pronounced features were investigated in more detail and an overview of the top 5 most important HTSFP features for each test assay is shown in Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>: Table S1. Discussed here are three representative test assays i.e. AID 798, AID 463104, and AID 504454. The assay biological targets corresponding to the top 5 most important HTSFP features were determined and are shown in Table <xref rid="Tab2" ref-type="table">2</xref>.<fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><p>Feature importance of the combined fingerprint (BaSH) for two representative assays of the validation set. Features 0–560 correspond to the HTSFP portion (orange) and features 560–1584 correspond to the ECFP4 portion (blue) of the combined fingerprint. The light and dark shades of each feature refer to the mean and max values from the six-fold cross validation, respectively</p></caption><graphic specific-use="HTML" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_376_Fig6_HTML.png" /></fig><table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>The PubChem assays corresponding to the five highest importance features as seen in Fig. <xref rid="Fig6" ref-type="fig">6</xref></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>PubChem AID</p></th><th align="left"><p>Feature number</p></th><th align="left"><p>Importance value</p></th><th align="left"><p>Assay biological target</p></th></tr><tr><th align="left"><p>798</p></th><th align="left" colspan="2"><p>Test assay</p></th><th align="left"><p>Coagulation factor XI</p></th></tr></thead><tbody><tr><td align="left"><p>800</p></td><td char="." align="char"><p>532</p></td><td char="." align="char"><p>0.044</p></td><td align="left"><p>Coagulation factor XIIa light chain</p></td></tr><tr><td align="left"><p>873</p></td><td char="." align="char"><p>551</p></td><td char="." align="char"><p>0.035</p></td><td align="left"><p>Human kallikrein 5 (hK5) serine protease</p></td></tr><tr><td align="left"><p>1046</p></td><td char="." align="char"><p>17</p></td><td char="." align="char"><p>0.020</p></td><td align="left"><p>Prothrombin</p></td></tr><tr><td align="left"><p>687</p></td><td char="." align="char"><p>466</p></td><td char="." align="char"><p>0.004</p></td><td align="left"><p>Coagulation factor XI</p></td></tr><tr><td align="left"><p>680</p></td><td char="." align="char"><p>458</p></td><td char="." align="char"><p>0.003</p></td><td align="left"><p>Coagulation factor XI </p></td></tr></tbody></table><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>PubChem AID</p></th><th align="left"><p>Feature number</p></th><th align="left"><p>Importance value</p></th><th align="left"><p>Assay biological target</p></th></tr><tr><th align="left"><p>463104</p></th><th align="left" colspan="2"><p>Test assay</p></th><th align="left"><p>Activators of the adaptive arm of the unfolded protein response</p></th></tr></thead><tbody><tr><td align="left"><p>485346</p></td><td char="." align="char"><p>216</p></td><td char="." align="char"><p>0.074</p></td><td align="left"><p>E3 ubiquitin-protein ligase Mdm2/MdmX</p></td></tr><tr><td align="left"><p>2732</p></td><td char="." align="char"><p>165</p></td><td char="." align="char"><p>0.031</p></td><td align="left"><p>Inhibitors of CHOP to regulate the unfolded protein response </p></td></tr><tr><td align="left"><p>449763</p></td><td char="." align="char"><p>190</p></td><td char="." align="char"><p>0.030</p></td><td align="left"><p>Activators of the apoptotic arm of the unfolded protein response</p></td></tr><tr><td align="left"><p>588405</p></td><td char="." align="char"><p>315</p></td><td char="." align="char"><p>0.028</p></td><td align="left"><p>Protein phosphatase 1 regulatory subunit 15A</p></td></tr><tr><td align="left"><p>540308</p></td><td char="." align="char"><p>293</p></td><td char="." align="char"><p>0.014</p></td><td align="left"><p>Melanocortin receptor 4 (MC4R)</p></td></tr></tbody></table><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>PubChem AID</p></th><th align="left"><p>Feature number</p></th><th align="left"><p>Importance value</p></th><th align="left"><p>Assay biological target</p></th></tr><tr><th align="left"><p>504454</p></th><th align="left" colspan="2"><p>Test assay</p></th><th align="left"><p>Beta-2 adrenergic receptor</p></th></tr></thead><tbody><tr><td align="left"><p>588405</p></td><td char="." align="char"><p>315</p></td><td char="." align="char"><p>0.043</p></td><td align="left"><p>Protein phosphatase 1 regulatory subunit 15A </p></td></tr><tr><td align="left"><p>743279</p></td><td char="." align="char"><p>505</p></td><td char="." align="char"><p>0.026</p></td><td align="left"><p>Inhibitors of inflammasome signaling: IL-1-beta</p></td></tr><tr><td align="left"><p>488899</p></td><td char="." align="char"><p>226</p></td><td char="." align="char"><p>0.018</p></td><td align="left"><p>MITF microphthalmia-associated transcription factor </p></td></tr><tr><td align="left"><p>485346</p></td><td char="." align="char"><p>217</p></td><td char="." align="char"><p>0.016</p></td><td align="left"><p>E3 ubiquitin-protein ligase Mdm2/MdmX</p></td></tr><tr><td align="left"><p>624352</p></td><td char="." align="char"><p>394</p></td><td char="." align="char"><p>0.010</p></td><td align="left"><p>Endothelial PAS domain-containing protein 1</p></td></tr></tbody></table><table-wrap-foot><p>Column one refers to the PubChem AID, column two refers to feature position with the combined fingerprint, column 3 indicates the importance value, and column 4 gives information on the assay target</p></table-wrap-foot></table-wrap></p>
              <p id="Par24">Test assay 798, from the PubChem dataset, is a biochemical assay aimed at identifying compounds which inhibit coagulation factor XI. The random forest model used to make the retrospective predictions on this assay was analyzed and the feature importances were determined. According to the ROC AUC shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref> the HTSFP expressed better performance than the ECFP although the performance difference between the two was negligible when considering the MCC score. The five most important features all correlate to compounds which were active against targets involved in secondary hemostasis which all have a serine protease function. The 4th and 5th most important features referred to assays 687 and 680 which also targeted coagulation factor XI but had surprisingly low importance. Closer investigation of these two assays revealed the reason for their relatively low importance. One point was that the two assays only had tested compound sets with a compound overlap of 32511 and 59853 respectively, which is relatively small compared to the 798-test assay (218716 compounds). Another point was that the agreement between the assays was limited, only 23/94 and 21/120 actives were in agreement with the 798-test assay for assays 687 and 680 respectively. The fact that the random forest model is successfully identifying and correlating compounds which have similar activities against similar targets is an expected result. These results act as a form of validation for the methods and procedure used in this study.</p>
              <p id="Par25">Test assay 463104 is a cell-based, phenotypic assay targeted at identifying promoters of the unfolded protein response (UPR), specifically the adaptive arm. UPR is involved in protein degradation as well as apoptosis related processes. The top 5 most important features of the random forest model were determined for this assay and their corresponding assay biological targets are listed in Table <xref rid="Tab2" ref-type="table">2</xref>. The first most important feature corresponds to an assay targeting E3 ubiquitin protein ligase. The E3 ubiquitin protein ligase is involved in Ubiquitination processes, which are directly involved with protein degradation, and are a vital element of the UPR. The 2nd and 3rd most important features both refer to assays also targeting different domains of the UPR. The 4th most important feature corresponds to an assay targeting ‘Protein phosphatase 1 regulatory subunit 15A’. This target is involved with regulation of protein synthesis and plays a role in the UPR, its relatively high importance suggests that this target is likely also present or closely related to the target(s) in the 463104-test assay. Again, the fact that the four most important features all correspond to compounds which were active in the UPR process, validates the method and observed results. The 5th most important feature corresponds to an assay targeted at melanocortin receptor 4 (MC4R). MC4R is a GPCR which has no known association to the UPR. This result suggests that the predictive model has the ability to draw correlations from unrelated features of the HTSFP, thereby supporting a wider applicability domain which has also been observed in previous studies for HTSFPs [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. Considering this lack of correlation between the two targets, it must also be mentioned that the relative importance of this feature is much lower (0.013) as can be inferred from Fig. <xref rid="Fig6" ref-type="fig">6</xref>.</p>
              <p id="Par26">Assay 504454 is a cell-based, phenotypic assay aimed at identifying inhibitors of the beta-2 adrenergic receptor (b2AR) which is a member of the GPCR family. The biological target of test assay 504454 did not have any known relation to the biological targets of the top 5 features. The PubChem assays and their associated biological targets corresponding to these five features are listed in Table <xref rid="Tab2" ref-type="table">2</xref>. These five assays target a variety of different functional proteins, none of which are members of the GPCR family. The targets types include regulatory subunits, inflammasomes, protein ligases, and two transcription factors. This result shows activity predictions for a given assay are not dependent on the HTSFP containing assays with related or similar biological targets. In other words, valid activity predictions can be made for compounds which are being tested on previously unexplored targets, as has shown in previous studies [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>].</p>
            </sec>
          </sec>
        </sec>
        <sec id="Sec14" sec-type="conclusions">
          <title>Conclusion</title>
          <p id="Par27">From analysis of the various metrics used to assess the prediction quality of the BaSH fingerprint it can be concluded that the BaSH yields a viable improvement in prediction performance relative to the individual ECFP4 and HTSFP. The MCC, F1 score, enrichment factor, ROC-AUC and Cohen’s kappa score all show evidence of the combined fingerprint’s enhanced performance. The results indicate that this combined fingerprint is a useful tool for scaffold hopping, detecting not only a more diverse set of active compounds with different scaffolds but also identifying novel scaffolds that were not identified with either the ECFP4 or the HTSFP. The improved scaffold hopping ability of the BaSH fingerprint was further supported by the nearest neighbor analysis. A comparison of the compound rankings provided evidence of the synergistic effects between the structural and bioactivity-based fingerprints. Feature importance analysis quantified the relative contributions of ECFP4 and HTSFP to the BaSH predictions, revealing that a small subset of the HTSFP features contribute most to the overall performance. This subset of features often corresponded to assays with targets biologically related to the test assays, however, this was not necessary for the HTSFP’s increased contribution. Naturally, the BaSH fingerprint has some limitations due to its HTSFP portion. The most notable limitation being the availability of historical HTS data, meaning that only previously tested compounds can be used. Furthermore, the presence of assays in the HTS portion which have related targets to the test assay has a strong positive influence on model performance. Therefore the inverse also applies, models built for previously untested targets or targets with no close relations, may exhibit reduced performance, although meaningful predictions are still possible. An example for this is provided by assay 504454 for the beta-2 adrenergic receptor. Although the top 5 most important features correlated with unrelated targets, predictive performance was reasonable, with ROC-AUC of 0.78 for HTSFP compared to 0.70 for the ECFP4. Another point is that assays with only small numbers of ‘active’ samples which have limited diversity don’t contain sufficient information for training of a reliable model, which has a negative effect on the model performance. A positive characteristic of the BaSH fingerprint is that although the HTSFP portion was very sparse, and contains a lot of noise through the labelling of missing data points as ‘inactive’, the noise did not negatively effect on the overall performance. Due to the relatively small size of the HTSFP to the ECFP4 (561 to 1024 respectively), the noise presented by the missing data is possibly drowned out by dominating presence of the ECFP. This provides a point of additional optimization, by applying weighting factors or altering the length of the ECFP further performance increases could potentially be achieved. Another positive characteristic of the BaSH is that compounds with sparse or no HTSFP fingerprints need not be filtered out, as they are fortified by the presence of the ECFP and therefore valid activity predictions can still be made. An alternative approach would be to use continuous data such as IC50 values and apply an adjustable threshold to optimize the HTSFP to possibly get further model improvements. Additional improvements could possibly be achieved by implementing frequent hitter or interference compound filters. Overall the BaSH fingerprint appears to be a promising tool for activity prediction and provides evidence that combining different types of descriptors is a valid method for boosting model performance.</p>
        </sec>
        <sec id="Sec15">
          <title>Methods and data</title>
          <sec id="Sec16">
            <title>Dataset</title>
            <p id="Par28">For this research 24 HTS assays obtained from PubChem were investigated retrospectively, they contained diverse ratios of active to inactive compounds as well as varying target types and a range of assay sizes ranging from approximately 20,000–400,000 compounds per assay. An overview of the 24 test assays is shown in Table <xref rid="Tab1" ref-type="table">1</xref>.</p>
          </sec>
          <sec id="Sec17">
            <title>Descriptors for models</title>
            <sec id="Sec18">
              <title>Generation of HTS fingerprints</title>
              <p id="Par29">A set of 582 HTS assays were downloaded from the PubChem database. Assays containing fewer than 20,000 compounds were discarded, leaving a total of 561 assays. This cut off was made to reduce the size and sparsity of the HTS fingerprint. The ‘Active’ or ‘Inactive’ activity flags set by PubChem were used to build the fingerprint. If any compounds were tested multiple times with mixed activity outcomes, the most common activity flag was used. In the case where there were equal numbers of active and inactive flags, the active flag was used. All compound’s activity flags were collated into a matrix of ‘compound ID’ versus ‘Assay ID’, with dimensions 715,328 (compounds) × 561 (assays). The fingerprint was subsequently binarized by converting all ‘active’ labels to ‘1’ and ‘inactive’ labels to ‘0’. All missing data was also set to ‘0’, the reasoning for this was that the HTS data is very unbalanced and a compound with unknown activity has a much higher probability of being inactive and is therefore given the label of an inactive bit. Each test assay was removed from the HTSFP prior to its analysis.</p>
            </sec>
            <sec id="Sec19">
              <title>Structural descriptors</title>
              <p id="Par30">For the same list of 715,328 compounds as in the HTSFP, ECFP4 fingerprints were created. The PubChem HTS data contained only the CID for the compounds and to make the ECFP fingerprints the smiles for each compound was required. Using the list of CIDs, the Smiles for each compound were downloaded from the PubChem database. The Morgan circular fingerprint (an analogue of ECFP) implemented in RDKit was used [<xref ref-type="bibr" rid="CR24">24</xref>]. After removal of compounds with invalid or unreadable smiles for RDKit, a compound set of 715327 was obtained. The bit length was set to 1024 bits and the fragment radius was set to 2 (diameter 4). Tests were run comparing 1024-bit ECFP4 with 1024-bit ECFP6 for one of the test assays. Only minor differences could be seen in predictive performance but the ECFP6 appeared to be slightly weaker, therefore the ECFP4 was chosen for the full analysis. The performance of the 1024 bit ECFP4 was compared with a 2048 bit ECFP4, the results showed no noticeable improvement when using the longer ECFP4, therefore the shorter version was chosen.</p>
            </sec>
            <sec id="Sec20">
              <title>Generation of the BaSH fingerprint</title>
              <p id="Par31">The bioactivity-structure hybrid (BaSH) fingerprint was created by concatenating the ECFP4 to the HTSFP, giving a new fingerprint of length 1585 (561 + 1024). These fingerprints were created using the same compound set (715327) as output from the ECFP4. Prior to analysis of each test assay, it was first removed from the BaSH fingerprint.</p>
            </sec>
          </sec>
          <sec id="Sec21">
            <title>Modelling methods</title>
            <p id="Par32">Due the nature of the random forest learning method, where specific features within a fingerprint are identified and not the entire fingerprint, it was theorized that RF would be the best suited technique to deal with the large portion of majorly sparse HTSFPs in the dataset. A test run was performed comparing random forest with support vector machine models of the Scikit-learn package [<xref ref-type="bibr" rid="CR23">23</xref>]. The two models were tested on one of the ten test assays, the random forest showed better performance according to the ROC AUC values and also ran significantly faster.</p>
            <p id="Par33">The random forest classifier machine learning package from Scikit-learn was used for building models of three different descriptor types, i.e. ECFP4, HTSFP, and BaSH. Here the ECFP4 and HTSFP were used for comparative and benchmarking purposes in all performance evaluations. The hyperparameters were optimized on a set of 10 randomly chosen assays, see Table <xref rid="Tab3" ref-type="table">3</xref> for assay information. For testing each assay was removed from the training data of the HTSFP and BaSH. An independent hyperparameter grid search was carried out for each of the three descriptor types. The most commonly occurring hyperparameter setting across the 10 test assays was chosen. The optimized hyperparameters were as follows:<table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p>Overview of test assays used in hyperparameter search</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>AID</p></th><th align="left"><p>Compounds tested</p></th><th align="left"><p>Actives</p></th><th align="left"><p>% Actives</p></th><th align="left"><p>Target information</p></th><th align="left"><p>Assay type</p></th></tr></thead><tbody><tr><td align="left"><p>834</p></td><td char="." align="char"><p>84880</p></td><td char="." align="char"><p>123</p></td><td char="." align="char"><p>0.14%</p></td><td align="left"><p>Potentiators of clotrimazole</p></td><td align="left"><p>Cell-based</p></td></tr><tr><td align="left"><p>1236</p></td><td char="." align="char"><p>218607</p></td><td char="." align="char"><p>799</p></td><td char="." align="char"><p>0.37%</p></td><td align="left"><p>Calpain II inhibitors</p></td><td align="left"><p>Biochemical</p></td></tr><tr><td align="left"><p>1510</p></td><td char="." align="char"><p>217964</p></td><td char="." align="char"><p>569</p></td><td char="." align="char"><p>0.26%</p></td><td align="left"><p>Sphingosine-1-phosphate receptor 4 (S1P4)</p></td><td align="left"><p>Cell-based</p></td></tr><tr><td align="left"><p>1899</p></td><td char="." align="char"><p>302667</p></td><td char="." align="char"><p>998</p></td><td char="." align="char"><p>0.33%</p></td><td align="left"><p>Hepatitis C Virus (HCV) core protein</p></td><td align="left"><p>Biochemical</p></td></tr><tr><td align="left"><p>2732</p></td><td char="." align="char"><p>218659</p></td><td char="." align="char"><p>8240</p></td><td char="." align="char"><p>3.77%</p></td><td align="left"><p>DNA damage-inducible transcript 3—CHOP—regulates UPR</p></td><td align="left"><p>Cell-based</p></td></tr><tr><td align="left"><p>463165</p></td><td char="." align="char"><p>305614</p></td><td char="." align="char"><p>1365</p></td><td char="." align="char"><p>0.45%</p></td><td align="left"><p>Regulator of G-protein signaling 4 isoform 2 (RGS4)</p></td><td align="left"><p>Cell-based</p></td></tr><tr><td align="left"><p>588621</p></td><td char="." align="char"><p>359231</p></td><td char="." align="char"><p>887</p></td><td char="." align="char"><p>0.25%</p></td><td align="left"><p>Tyrosine-protein phosphatase non-receptor type 5</p></td><td align="left"><p>Biochemical</p></td></tr><tr><td align="left"><p>602229</p></td><td char="." align="char"><p>362013</p></td><td char="." align="char"><p>1281</p></td><td char="." align="char"><p>0.35%</p></td><td align="left"><p>Photoreceptor-specific nuclear receptor (NR2E3)</p></td><td align="left"><p>Cell-based</p></td></tr><tr><td align="left"><p>720543</p></td><td char="." align="char"><p>369939</p></td><td char="." align="char"><p>2005</p></td><td char="." align="char"><p>0.54%</p></td><td align="left"><p>Alpha/beta hydrolase domain containing protein 4 (ABHD4)</p></td><td align="left"><p>Biochemical</p></td></tr><tr><td align="left"><p>1117267</p></td><td char="." align="char"><p>91911</p></td><td char="." align="char"><p>1155</p></td><td char="." align="char"><p>1.26%</p></td><td align="left"><p>Activators of Transthyretin (TTR) transcription</p></td><td align="left"><p>Cell-based</p></td></tr></tbody></table><table-wrap-foot><p>Columns represent PubChem AID, number of compounds tested in assay, number of actives, percentage of actives, target information, and assay type</p></table-wrap-foot></table-wrap></p>
            <p id="Par34"><italic>HTSFP: n_jobs </italic>= −<italic>1, n_estimators </italic>= <italic>150, class_weight </italic>= <italic>‘balanced’, max_features </italic>= <italic>‘sqrt’, criterion </italic>= <italic>‘entropy’, max_depth </italic>= <italic>40, min_samples_split </italic>= <italic>2, min_samples_leaf </italic>= <italic>5, random_state </italic>= <italic>56</italic></p>
            <p id="Par35"><italic>ECFP4: n_jobs </italic>= −<italic>1, n_estimators </italic>= <italic>200, class_weight </italic>= <italic>‘balanced’, max_features </italic>= <italic>‘sqrt’, criterion </italic>= <italic>‘gini’, max_depth </italic>= <italic>30, min_samples_split </italic>= <italic>2, min_samples_leaf </italic>= <italic>8, random_state </italic>= <italic>56)</italic></p>
            <p id="Par36"><italic>BaSH: n_jobs </italic>= −<italic>1, n_estimators </italic>= <italic>150, class_weight </italic>= <italic>‘balanced’, max_features </italic>= <italic>‘sqrt’, criterion </italic>= <italic>‘gini’, max_depth </italic>= <italic>None, min_samples_split </italic>= <italic>2, min_samples_leaf </italic>= <italic>8, random_state </italic>= <italic>56)</italic></p>
            <p id="Par37">The number of trees (n_estimators) was set to 150/200 as above this threshold model performance did not show noticeable improvement. A ‘balanced’ class weighting was used due to the imbalanced nature of the data, the ‘balanced’ setting of this hyperparameter was vital for adequate performance of the models. For the purpose of reproducibility a random_state = 56 was used. For model validation a sixfold cross-validation was performed, averages and standard deviations were calculated across the six folds for each of the test assays. A stratified sampling method was used to generate each fold, this meant that each fold had the same ratio of ‘active’ to ‘inactive’ samples. The metrics for each test assay were calculated using the mean values and standard deviations calculated across the six folds.</p>
            <p id="Par38">For the scaffold hopping analysis the true positives in the top ranked 1% of predictions were extracted for each cross-validation fold and their compound IDs (CIDs) were mapped to smiles. Using RDKit each compound was converted to a topological Bemis-Murcko scaffold (generic scaffold) i.e. all side chains were removed, all heteroatoms converted to carbons, and all bond orders set to 1 (all C = sp3). The number of unique topological scaffolds were then counted and averaged across the six folds. The unique scaffolds predicted from each of the 3 tested fingerprints were compared using Venn diagrams made from the matplotlib-venn add-on. Venn diagrams were made for each cross-validation fold and the average for each region in the diagram was taken to make the final diagram.</p>
            <p id="Par39">To compare the compound diversity for the predictions made using each of 3 fingerprint types (HTSFP, ECFP4, BaSH) a nearest neighbor comparison was performed. The nearest neighbor is calculated by performing a Tanimoto similarity comparison of the ECFP4 s for each compound in the prediction set. A Tanimoto similarity score of 1.0 is obtained for two compounds whose fingerprints are identical, whereas a score of 0.0 means that the fingerprints have no overlap. The similarity scores for all compounds in the top 1000 predictions were calculated and their distribution plotted (Fig. <xref rid="Fig4" ref-type="fig">4</xref>).</p>
          </sec>
          <sec id="Sec22">
            <title>Calculation of metrics</title>
            <p id="Par40">Receiver operator characteristic curves were constructed using the false positive rate (FPR) and true positive rate (TPR) while changing the classification threshold according to the prediction probability scores, this was performed using the SKlearn metrics library. The two equations in (<xref rid="Equ1" ref-type="disp-formula">1</xref>) show how the FPR and TPR are calculated.<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:mtext>FPR</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mtext>FP</mml:mtext><mml:mrow><mml:mtext>FP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>TN</mml:mtext></mml:mrow></mml:mfrac><mml:mspace width="1em" /><mml:mtext>TPR</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mtext>TP</mml:mtext><mml:mrow><mml:mtext>TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FN</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{FPR}} = \frac{\text{FP}}{{{\text{FP}} + {\text{TN}}}}\quad {\text{TPR}} = \frac{\text{TP}}{{{\text{TP}} + {\text{FN}}}}$$\end{document}</tex-math><graphic position="anchor" xlink:href="13321_2019_376_Article_Equ1.gif" /></alternatives></disp-formula></p>
            <p id="Par41">The precision and recall were calculated using the formulas shown in (<xref rid="Equ2" ref-type="disp-formula">2</xref>). The F1 score is the harmonic mean of the precision and recall and the calculation formula is also shown in (<xref rid="Equ2" ref-type="disp-formula">2</xref>).<disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:mtext>Precision</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mtext>TP</mml:mtext><mml:mrow><mml:mrow><mml:mtext>TP</mml:mtext><mml:mspace width="0.333333em" /></mml:mrow><mml:mo>+</mml:mo><mml:mtext>FP</mml:mtext></mml:mrow></mml:mfrac><mml:mspace width="1em" /><mml:mtext>Recall</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mtext>TP</mml:mtext><mml:mrow><mml:mrow><mml:mtext>TP</mml:mtext><mml:mspace width="0.333333em" /></mml:mrow><mml:mo>+</mml:mo><mml:mtext>FN</mml:mtext></mml:mrow></mml:mfrac><mml:mspace width="1em" /><mml:mtext>F</mml:mtext><mml:mn>1</mml:mn><mml:mtext>score</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mtext>TP</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mtext>TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FN</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{Precision}} = \frac{\text{TP}}{{{\text{TP }} + {\text{FP}}}}\quad {\text{Recall}} = \frac{\text{TP}}{{{\text{TP }} + {\text{FN}}}}\quad {\text{F}}1 {\text{score}} = \frac{{2{\text{TP}}}}{{2{\text{TP}} + {\text{FP}} + {\text{FN}}}}$$\end{document}</tex-math><graphic position="anchor" xlink:href="13321_2019_376_Article_Equ2.gif" /></alternatives></disp-formula></p>
            <p id="Par42">The Matthews correlation coefficient (MCC) is a performance metric optimized for imbalanced datasets. The equation to calculate the MCC is shown in (<xref rid="Equ3" ref-type="disp-formula">3</xref>). The MCC covers a range from − 1 to 1, where a value of 1 indicates a perfect prediction, − 1 a perfect inverse prediction and 0 indicating prediction no better than random.<disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:mtext>MCC</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>TP</mml:mtext><mml:mo>·</mml:mo><mml:mtext>TN</mml:mtext><mml:mo>-</mml:mo><mml:mtext>FP</mml:mtext><mml:mo>·</mml:mo><mml:mtext>FN</mml:mtext></mml:mrow><mml:msqrt><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtext>TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FP</mml:mtext></mml:mrow></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtext>TP</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FN</mml:mtext></mml:mrow></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtext>TN</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FP</mml:mtext></mml:mrow></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtext>TN</mml:mtext><mml:mo>+</mml:mo><mml:mtext>FN</mml:mtext></mml:mrow></mml:mfenced></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{MCC}} = \frac{{{\text{TP}} \cdot {\text{TN}} - {\text{FP}} \cdot {\text{FN}}}}{{\sqrt {\left( {{\text{TP}} + {\text{FP}}} \right)\left( {{\text{TP}} + {\text{FN}}} \right)\left( {{\text{TN}} + {\text{FP}}} \right)\left( {{\text{TN}} + {\text{FN}}} \right)} }}$$\end{document}</tex-math><graphic position="anchor" xlink:href="13321_2019_376_Article_Equ3.gif" /></alternatives></disp-formula></p>
            <p id="Par43">The equation in (<xref rid="Equ4" ref-type="disp-formula">4</xref>) shows how the Cohen’s Kappa score is calculated, where <inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:msub><mml:mi>p</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{o}$$\end{document}</tex-math><inline-graphic xlink:href="13321_2019_376_Article_IEq1.gif" /></alternatives></inline-formula> is the relative observed agreement of a class (accuracy) and <inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:msub><mml:mi>p</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{e}$$\end{document}</tex-math><inline-graphic xlink:href="13321_2019_376_Article_IEq2.gif" /></alternatives></inline-formula> is the hypothetical probability of chance agreement. A kappa score of 0 reflects a performance no better than random chance, the more positive the score the better.<disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:mi>κ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa = \frac{{p_{o} - p_{e} }}{{1 - p_{e} }}$$\end{document}</tex-math><graphic position="anchor" xlink:href="13321_2019_376_Article_Equ4.gif" /></alternatives></disp-formula></p>
            <p id="Par44">The Enrichment factor provides a measure of how much the model performance improves compared to random screening. The resulting score refers to a factor of improvement, where a score of 1.0 is equivalent to random. The formula to calculate the enrichment factor for the top scoring 1% of compounds is shown in (<xref rid="Equ5" ref-type="disp-formula">5</xref>). The Hitrate<sup>1%</sup> refers to the rate of true positives in the top scoring 1%, and the Hitrate<sup>100%</sup> refers to the hit rate for the overall screen.<disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:mrow><mml:msub><mml:mtext>EF</mml:mtext><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mtext>\%</mml:mtext><mml:mspace width="0.333333em" /></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mtext>Hitrate</mml:mtext></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mtext>\%</mml:mtext><mml:mspace width="0.333333em" /></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mtext>Hitrate</mml:mtext></mml:mrow><mml:mrow><mml:mn>100</mml:mn><mml:mrow><mml:mtext>\%</mml:mtext><mml:mspace width="0.333333em" /></mml:mrow></mml:mrow></mml:msup></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{EF}}_{{1{\text{\% }}}} = \frac{{{\text{Hitrate}}^{{1{\text{\% }}}} }}{{{\text{Hitrate}}^{{100{\text{\% }}}} }}$$\end{document}</tex-math><graphic position="anchor" xlink:href="13321_2019_376_Article_Equ5.gif" /></alternatives></disp-formula></p>
            <p id="Par45">Software used: Python 3.6.5, SKLearn 0.19.1, SciPy 1.1.0, RDKit 2018.03.1.0.</p>
          </sec>
        </sec>
      </body>
      <back>
        <ack>
          <title>Acknowledgements</title>
          <p>Michael Withnall helped with debugging, implementing code, and proofreading. Laurianne David, Josep Arus-Pous and Thomas Blaschke provided valuable insight and discussions.</p>
        </ack>
        <sec sec-type="author-contribution">
          <title>Authors’ contributions</title>
          <p>OL carried out this study and wrote the manuscript. NS supervised and assisted throughout the project. JB, HC, and OE supervised the project and gave project guidance. All authors participated in manuscript proofreading and approved the final manuscript. All authors read and approved the final manuscript.</p>
        </sec>
        <sec>
          <title>Funding</title>
          <p>Oliver Laufkötter has received funding from the European Union’s Horizon 2020 research and innovation program under the Marie Sklodowska Curie Grant Agreement No. 676434, “Big Data in Chemistry” (“BIGCHEM”, <ext-link xlink:href="http://bigchem.eu" ext-link-type="uri">http://bigchem.eu</ext-link>). Noé Sturm received funding from European Union’s Horizon 2020 research and innovation program under the Grant Agreement No. 671555 “ExCAPE”, <ext-link xlink:href="http://www.excape-h2020.eu/" ext-link-type="uri">http://www.excape-h2020.eu/</ext-link>. The article reflects only the authors view and neither the European Commission nor the Research Executive Agency (REA) are responsible for any use that may be made of the information it contains.</p>
        </sec>
        <sec sec-type="data-availability">
          <title>Availability of data and materials</title>
          <p>The list of PubChem assays used is provided as a.txt file in Additional material, or the raw PubChem HTS files can accessed at <ext-link xlink:href="https://figshare.com/articles/pubchemAssaysRAW_zip/7800554" ext-link-type="uri">https://figshare.com/articles/pubchemAssaysRAW_zip/7800554</ext-link>. Additional figures are also provided in an additional docX file. All source code is available from GitHub repository: <ext-link xlink:href="https://github.com/oml90/Combining-Structural-and-Bioactivity-descriptors" ext-link-type="uri">https://github.com/oml90/Combining-Structural-and-Bioactivity-descriptors</ext-link>.</p>
        </sec>
        <sec sec-type="ethics-statement">
          <sec id="FPar1" sec-type="COI-statement">
            <title>Competing interests</title>
            <p id="Par46">The authors declare that they have no competing interests.</p>
          </sec>
        </sec>
        <ref-list id="Bib1">
          <title>References</title>
          <ref-list>
            <ref id="CR1">
              <label>1.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Wu</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Wang</surname>
                    <given-names>G</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Machine learning based toxicity prediction: from chemical structural description to transcriptome analysis</article-title>
                <source>Int J Mol Sci</source>
                <year>2018</year>
                <pub-id pub-id-type="doi">10.3390/ijms19082358</pub-id>
                <pub-id pub-id-type="pmid">30586948</pub-id>
                <pub-id pub-id-type="pmcid">6337205</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR2">
              <label>2.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Simm</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Klambauer</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Arany</surname>
                    <given-names>A</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Repurposing high-throughput image assays enables biological activity prediction for drug discovery</article-title>
                <source>Cell Chem Biol</source>
                <year>2018</year>
                <volume>25</volume>
                <fpage>611</fpage>
                <lpage>618</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXjsl2ktLc%3D</pub-id>
                <pub-id pub-id-type="doi">10.1016/j.chembiol.2018.01.015</pub-id>
                <pub-id pub-id-type="pmid">29503208</pub-id>
                <pub-id pub-id-type="pmcid">6031326</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR3">
              <label>3.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Kauvar</surname>
                    <given-names>LM</given-names>
                  </name>
                  <name>
                    <surname>Higgins</surname>
                    <given-names>DL</given-names>
                  </name>
                  <name>
                    <surname>Villar</surname>
                    <given-names>HO</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Predicting ligand binding to proteins by affinity fingerprinting</article-title>
                <source>Chem Biol.</source>
                <year>1995</year>
                <pub-id pub-id-type="doi">10.1016/1074-5521(95)90283-X</pub-id>
                <pub-id pub-id-type="pmid">9383411</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR4">
              <label>4.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Fliri</surname>
                    <given-names>AF</given-names>
                  </name>
                  <name>
                    <surname>Loging</surname>
                    <given-names>WT</given-names>
                  </name>
                  <name>
                    <surname>Thadeio</surname>
                    <given-names>PF</given-names>
                  </name>
                  <name>
                    <surname>Volkmann</surname>
                    <given-names>RA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Biological spectra analysis: Linking biological activity profiles to molecular structure</article-title>
                <source>Proc Natl Acad Sci.</source>
                <year>2005</year>
                <volume>1</volume>
                <fpage>1</fpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2MXptFSmsQ%3D%3D</pub-id>
                <pub-id pub-id-type="doi">10.1073/pnas.0407790101</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR5">
              <label>5.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Petrone</surname>
                    <given-names>PM</given-names>
                  </name>
                  <name>
                    <surname>Simms</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>Nigsch</surname>
                    <given-names>F</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Rethinking molecular similarity: comparing compounds on the basis of biological activity</article-title>
                <source>ACS Chem Biol</source>
                <year>2012</year>
                <volume>7</volume>
                <fpage>1399</fpage>
                <lpage>1409</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC38Xnt1WrtLY%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/cb3001028</pub-id>
                <pub-id pub-id-type="pmid">22594495</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR6">
              <label>6.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Riniker</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Wang</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Jenkins</surname>
                    <given-names>JL</given-names>
                  </name>
                  <name>
                    <surname>Landrum</surname>
                    <given-names>GA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Using information from historical high-throughput screens to predict active compounds</article-title>
                <source>J Chem Inf Model</source>
                <year>2014</year>
                <volume>54</volume>
                <fpage>1880</fpage>
                <lpage>1891</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2cXpslegtb4%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci500190p</pub-id>
                <pub-id pub-id-type="pmid">24933016</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR7">
              <label>7.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Wassermann</surname>
                    <given-names>AM</given-names>
                  </name>
                  <name>
                    <surname>Lounkine</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Urban</surname>
                    <given-names>L</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">A screening pattern recognition method finds new and divergent targets for drugs and natural products</article-title>
                <source>ACS Chem Biol</source>
                <year>2014</year>
                <volume>9</volume>
                <fpage>1622</fpage>
                <lpage>1631</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2cXnsVehurY%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/cb5001839</pub-id>
                <pub-id pub-id-type="pmid">24802392</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR8">
              <label>8.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Muthas</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Boyer</surname>
                    <given-names>S</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Exploiting pharmacological similarity to identify safety concerns—listen to what the data tells you</article-title>
                <source>Mol Inform.</source>
                <year>2013</year>
                <pub-id pub-id-type="doi">10.1002/minf.201200088</pub-id>
                <pub-id pub-id-type="pmid">27481022</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR9">
              <label>9.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Wassermann</surname>
                    <given-names>AM</given-names>
                  </name>
                  <name>
                    <surname>Lounkine</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Glick</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Bioturbo similarity searching: combining chemical and biological similarity to discover structurally diverse bioactive molecules</article-title>
                <source>J Chem Inf Model</source>
                <year>2013</year>
                <volume>53</volume>
                <fpage>692</fpage>
                <lpage>703</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3sXjsVylsro%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci300607r</pub-id>
                <pub-id pub-id-type="pmid">23461561</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR10">
              <label>10.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Paricharak</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Bender</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Nigsch</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Nigsch</surname>
                    <given-names>F</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Analysis of iterative screening with stepwise compound selection based on novartis in-house HTS data</article-title>
                <source>ACS Chem Biol</source>
                <year>2016</year>
                <volume>11</volume>
                <fpage>1255</fpage>
                <lpage>1264</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC28XisFShu7o%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/acschembio.6b00029</pub-id>
                <pub-id pub-id-type="pmid">26878899</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR11">
              <label>11.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Campillos</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Kuhn</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Gavin</surname>
                    <given-names>AC</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Drug target identification using side-effect similarity</article-title>
                <source>Science.</source>
                <year>2008</year>
                <volume>1</volume>
                <fpage>1</fpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1cXot1entbY%3D</pub-id>
                <pub-id pub-id-type="doi">10.1126/science.1158140</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR12">
              <label>12.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Paull</surname>
                    <given-names>KD</given-names>
                  </name>
                  <name>
                    <surname>Shoemaker</surname>
                    <given-names>RH</given-names>
                  </name>
                  <name>
                    <surname>Hodes</surname>
                    <given-names>L</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Display and analysis of patterns of differential activity of drugs against human tumor cell lines: Development of mean graph and COMPARE algorithm</article-title>
                <source>J Natl Cancer Inst.</source>
                <year>1989</year>
                <pub-id pub-id-type="doi">10.1093/jnci/81.14.1088</pub-id>
                <pub-id pub-id-type="pmid">2738938</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR13">
              <label>13.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Weinstein</surname>
                    <given-names>JN</given-names>
                  </name>
                  <name>
                    <surname>Kohn</surname>
                    <given-names>KW</given-names>
                  </name>
                  <name>
                    <surname>Grever</surname>
                    <given-names>MR</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Neural computing in cancer drug development: predicting mechanism of action</article-title>
                <source>Science.</source>
                <year>1992</year>
                <pub-id pub-id-type="doi">10.1126/science.1411538</pub-id>
                <pub-id pub-id-type="pmid">1411538</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR14">
              <label>14.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Wassermann</surname>
                    <given-names>AM</given-names>
                  </name>
                  <name>
                    <surname>Lounkine</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Davies</surname>
                    <given-names>JW</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">The opportunities of mining historical and collective data in drug discovery</article-title>
                <source>Drug Discov Today.</source>
                <year>2015</year>
                <volume>20</volume>
                <issue>4</issue>
                <fpage>422</fpage>
                <lpage>434</lpage>
                <pub-id pub-id-type="doi">10.1016/j.drudis.2014.11.004</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR15">
              <label>15.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Mayr</surname>
                    <given-names>LM</given-names>
                  </name>
                  <name>
                    <surname>Bojanic</surname>
                    <given-names>D</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Novel trends in high-throughput screening</article-title>
                <source>Curr Opin Pharmacol</source>
                <year>2009</year>
                <volume>9</volume>
                <fpage>580</fpage>
                <lpage>588</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXht1WntLnL</pub-id>
                <pub-id pub-id-type="doi">10.1016/j.coph.2009.08.004</pub-id>
                <pub-id pub-id-type="pmid">19775937</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR16">
              <label>16.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Battersby</surname>
                    <given-names>BJ</given-names>
                  </name>
                  <name>
                    <surname>Trau</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Novel miniaturized systems in high-throughput screening</article-title>
                <source>Trends Biotechnol</source>
                <year>2002</year>
                <volume>20</volume>
                <fpage>167</fpage>
                <lpage>173</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD38XitFamu7s%3D</pub-id>
                <pub-id pub-id-type="doi">10.1016/S0167-7799(01)01898-4</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR17">
              <label>17.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Karnachi</surname>
                    <given-names>PS</given-names>
                  </name>
                  <name>
                    <surname>Brown</surname>
                    <given-names>FK</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Practical approaches to efficient screening: information-rich screening protocol</article-title>
                <source>J Biomol Screen</source>
                <year>2004</year>
                <volume>9</volume>
                <fpage>678</fpage>
                <lpage>686</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2MXmsFOjtA%3D%3D</pub-id>
                <pub-id pub-id-type="doi">10.1177/1087057104269570</pub-id>
                <pub-id pub-id-type="pmid">15634794</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR18">
              <label>18.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Glem</surname>
                    <given-names>RC</given-names>
                  </name>
                  <name>
                    <surname>Bender</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Arnby</surname>
                    <given-names>CH</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Circular fingerprints: flexible molecular descriptors with applications from physical chemistry to ADME</article-title>
                <source>IDrugs</source>
                <year>2006</year>
                <volume>9</volume>
                <fpage>199</fpage>
                <lpage>204</lpage>
                <pub-id pub-id-type="pmid">16523386</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR19">
              <label>19.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Avram</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Bora</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Halip</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Curpan</surname>
                    <given-names>R</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Modeling kinase inhibition using highly confident data sets</article-title>
                <source>J Chem Inf Model</source>
                <year>2018</year>
                <volume>58</volume>
                <fpage>957</fpage>
                <lpage>967</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXosFensro%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/acs.jcim.7b00729</pub-id>
                <pub-id pub-id-type="pmid">29708742</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR20">
              <label>20.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Sturm</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Sun</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Vandriessche</surname>
                    <given-names>Y</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Application of bioactivity profile based fingerprints for building machine learning models</article-title>
                <source>J Chem Inf Model.</source>
                <year>2018</year>
                <volume>1</volume>
                <fpage>1</fpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXitFaqsbnI</pub-id>
                <pub-id pub-id-type="doi">10.1021/acs.jcim.8b00550</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR21">
              <label>21.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Helal</surname>
                    <given-names>KY</given-names>
                  </name>
                  <name>
                    <surname>Maciejewski</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Gregori-Puigjane</surname>
                    <given-names>E</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Public domain HTS fingerprints: design and evaluation of compound bioactivity profiles from pubchem’s bioassay repository</article-title>
                <source>J Chem Inf Model</source>
                <year>2016</year>
                <volume>56</volume>
                <fpage>390</fpage>
                <lpage>398</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC28XhtVGnsrg%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/acs.jcim.5b00498</pub-id>
                <pub-id pub-id-type="pmid">26898267</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR22">
              <label>22.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Cortes Cabrera</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Petrone</surname>
                    <given-names>PM</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Optimal HTS fingerprint definitions by using a desirability function and a genetic algorithm</article-title>
                <source>J Chem Inf Model</source>
                <year>2018</year>
                <volume>58</volume>
                <fpage>641</fpage>
                <lpage>646</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXisVOksLw%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/acs.jcim.7b00447</pub-id>
                <pub-id pub-id-type="pmid">29425455</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR23">
              <label>23.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Pedregosa</surname>
                    <given-names>F</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Scikit-learn: machine learning in python %J</article-title>
                <source>J. Mach. Learn. Res.</source>
                <year>2011</year>
                <volume>12</volume>
                <fpage>2825</fpage>
                <lpage>2830</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR24">
              <label>24.</label>
              <mixed-citation publication-type="other">Landrum GA (2018) RDKit: open source cheminformatics. <ext-link xlink:href="http://www.rdkit.org" ext-link-type="uri">http://www.rdkit.org</ext-link></mixed-citation>
            </ref>
          </ref-list>
        </ref-list>
        <app-group>
          <app id="App1">
            <sec id="Sec23">
              <title>Additional file</title>
              <p>
                <supplementary-material content-type="local-data" id="MOESM1" xlink:title="Additional file">
                  <media mimetype="application" mime-subtype="msword" xlink:href="MediaObjects/13321_2019_376_MOESM1_ESM.docx" position="anchor">
                    <caption xml:lang="en">
                      <p><ext-link xlink:href="https://doi.org/10.1186/s13321-019-0376-1" ext-link-type="uri">Additional file 1.</ext-link> Additional figures and table.</p>
                    </caption>
                  </media>
                </supplementary-material>
              </p>
            </sec>
          </app>
        </app-group>
        <glossary>
          <title>Abbreviations</title>
          <def-list>
            <def-item>
              <term>HTS</term>
              <def>
                <p id="Par2">high throughput screening</p>
              </def>
            </def-item>
            <def-item>
              <term>BaSH</term>
              <def>
                <p id="Par3">bioactivity-structure hybrid</p>
              </def>
            </def-item>
            <def-item>
              <term>ECFP</term>
              <def>
                <p id="Par4">extended connectivity fingerprint</p>
              </def>
            </def-item>
            <def-item>
              <term>HTSFP</term>
              <def>
                <p id="Par5">high throughput screening fingerprint</p>
              </def>
            </def-item>
            <def-item>
              <term>GPCR</term>
              <def>
                <p id="Par6">G-protein coupled receptor</p>
              </def>
            </def-item>
            <def-item>
              <term>MCC</term>
              <def>
                <p id="Par7">Mathews correlation coefficient</p>
              </def>
            </def-item>
            <def-item>
              <term>EF</term>
              <def>
                <p id="Par8">enrichment factor</p>
              </def>
            </def-item>
            <def-item>
              <term>MoA</term>
              <def>
                <p id="Par9">mechanism of action</p>
              </def>
            </def-item>
          </def-list>
        </glossary>
        <notes notes-type="Misc">
          <title>Publisher's Note</title>
          <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
        </notes>
      </back>
    </article>
