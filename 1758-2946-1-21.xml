<?xml version="1.0"?>
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="research-article" xml:lang="en">
      <?properties open_access?>
      <front>
        <journal-meta>
          <journal-id journal-id-type="publisher-id">13321</journal-id>
          <journal-title-group>
            <journal-title>Journal of Cheminformatics</journal-title>
            <abbrev-journal-title abbrev-type="publisher">J Cheminform</abbrev-journal-title>
          </journal-title-group>
          <issn pub-type="epub">1758-2946</issn>
          <publisher>
            <publisher-name>Springer International Publishing</publisher-name>
            <publisher-loc>Cham</publisher-loc>
          </publisher>
        </journal-meta>
        <article-meta>
          <article-id pub-id-type="publisher-id">BMC1758-2946-1-21</article-id>
          <article-id pub-id-type="manuscript">21</article-id>
          <article-id pub-id-type="doi">10.1186/1758-2946-1-21</article-id>
          <article-categories>
            <subj-group subj-group-type="heading">
              <subject>Research Article</subject>
            </subj-group>
          </article-categories>
          <title-group>
            <article-title xml:lang="en">Virtual screening of bioassay data</article-title>
          </title-group>
          <contrib-group>
            <contrib contrib-type="author" corresp="yes">
              <name>
                <surname>Schierz</surname>
                <given-names>Amanda C</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="corresp" rid="IDBMC17582946121_cor1">a</xref>
            </contrib>
            <aff id="Aff1">
              <label>1</label>
              <institution-wrap>
                <institution-id institution-id-type="GRID">grid.17236.31</institution-id>
                <institution-id institution-id-type="ISNI">0000000107284630</institution-id>
                <institution content-type="org-division">Smart Technology Research Centre</institution>
                <institution content-type="org-name">Bournemouth University</institution>
              </institution-wrap>
              <addr-line content-type="street">Poole House, Talbot Campus</addr-line>
              <addr-line content-type="postcode">BH12 5BB</addr-line>
              <addr-line content-type="city">Poole</addr-line>
              <addr-line content-type="state">Dorset</addr-line>
              <country>UK</country>
            </aff>
          </contrib-group>
          <author-notes>
            <corresp id="IDBMC17582946121_cor1">
              <label>a</label>
              <email>HIDDEN</email>
            </corresp>
          </author-notes>
          <pub-date date-type="pub" publication-format="electronic">
            <day>22</day>
            <month>12</month>
            <year>2009</year>
          </pub-date>
          <pub-date date-type="collection" publication-format="electronic">
            <month>12</month>
            <year>2009</year>
          </pub-date>
          <volume>1</volume>
          <issue seq="21">1</issue>
          <elocation-id>21</elocation-id>
          <history>
            <date date-type="registration">
              <day>8</day>
              <month>10</month>
              <year>2009</year>
            </date>
            <date date-type="received">
              <day>8</day>
              <month>10</month>
              <year>2009</year>
            </date>
            <date date-type="accepted">
              <day>22</day>
              <month>12</month>
              <year>2009</year>
            </date>
            <date date-type="online">
              <day>22</day>
              <month>12</month>
              <year>2009</year>
            </date>
          </history>
          <permissions>
            <copyright-statement content-type="compact">Â© Schierz; licensee BioMed Central Ltd. 2009</copyright-statement>
            <copyright-statement content-type="comment">This article is published under license to BioMed Central Ltd. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link xlink:href="http://creativecommons.org/licenses/by/2.0" ext-link-type="uri">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</copyright-statement>
            <copyright-year>2009</copyright-year>
            <copyright-holder>Schierz; licensee BioMed Central Ltd.</copyright-holder>
            <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0/">
              <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 2.0 International License (<ext-link xlink:href="https://creativecommons.org/licenses/by/2.0" ext-link-type="uri">https://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
            </license>
          </permissions>
          <abstract xml:lang="en" id="Abs1">
            <title>Abstract</title>
            <sec id="ASec1">
              <title>Background</title>
              <p>There are three main problems associated with the virtual screening of bioassay data. The first is access to freely-available curated data, the second is the number of false positives that occur in the physical primary screening process, and finally the data is highly-imbalanced with a low ratio of Active compounds to Inactive compounds. This paper first discusses these three problems and then a selection of Weka cost-sensitive classifiers (Naive Bayes, SVM, C4.5 and Random Forest) are applied to a variety of bioassay datasets.</p>
            </sec>
            <sec id="ASec2">
              <title>Results</title>
              <p>Pharmaceutical bioassay data is not readily available to the academic community. The data held at PubChem is not curated and there is a lack of detailed cross-referencing between Primary and Confirmatory screening assays. With regard to the number of false positives that occur in the primary screening process, the analysis carried out has been shallow due to the lack of cross-referencing mentioned above. In six cases found, the average percentage of false positives from the High-Throughput Primary screen is quite high at 64%. For the cost-sensitive classification, Weka's implementations of the Support Vector Machine and C4.5 decision tree learner have performed relatively well. It was also found, that the setting of the Weka cost matrix is dependent on the base classifier used and not solely on the ratio of class imbalance.</p>
            </sec>
            <sec id="ASec3">
              <title>Conclusions</title>
              <p>Understandably, pharmaceutical data is hard to obtain. However, it would be beneficial to both the pharmaceutical industry and to academics for curated primary screening and corresponding confirmatory data to be provided. Two benefits could be gained by employing virtual screening techniques to bioassay data. First, by reducing the search space of compounds to be screened and secondly, by analysing the false positives that occur in the primary screening process, the technology may be improved. The number of false positives arising from primary screening leads to the issue of whether this type of data should be used for virtual screening. Care when using Weka's cost-sensitive classifiers is needed - across the board misclassification costs based on class ratios should not be used when comparing differing classifiers for the same dataset.</p>
            </sec>
          </abstract>
          <kwd-group xml:lang="en">
            <title>Keywords</title>
            <kwd>Virtual Screening</kwd>
            <kwd>Minority Class</kwd>
            <kwd>Inactive Compound</kwd>
            <kwd>Random Forest Classifier</kwd>
            <kwd>Misclassification Cost</kwd>
          </kwd-group>
          <custom-meta-group>
            <custom-meta>
              <meta-name>publisher-imprint-name</meta-name>
              <meta-value>Chemistry Central</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-issue-count</meta-name>
              <meta-value>1</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-article-count</meta-name>
              <meta-value>22</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-holder</meta-name>
              <meta-value>The Author(s)</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-year</meta-name>
              <meta-value>2009</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-contains-esm</meta-name>
              <meta-value>Yes</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-year</meta-name>
              <meta-value>2009</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-month</meta-name>
              <meta-value>10</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-day</meta-name>
              <meta-value>8</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-product</meta-name>
              <meta-value>ArchiveJournal</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-grants-type</meta-name>
              <meta-value>OpenChoice</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>metadata-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>abstract-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodypdf-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodyhtml-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bibliography-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>esm-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>online-first</meta-name>
              <meta-value>false</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-file-reference</meta-name>
              <meta-value>BodyRef/PDF/13321_2009_Article_21.pdf</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-type</meta-name>
              <meta-value>Typeset</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>target-type</meta-name>
              <meta-value>OnlinePDF</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-type</meta-name>
              <meta-value>OriginalPaper</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-primary</meta-name>
              <meta-value>Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computer Applications in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Documentation and Information in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Theoretical and Computational Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computational Biology/Bioinformatics</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-collection</meta-name>
              <meta-value>Chemistry and Materials Science</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>open-access</meta-name>
              <meta-value>true</meta-value>
            </custom-meta>
          </custom-meta-group>
        </article-meta>
        <notes notes-type="ESMHint">
          <title>Electronic supplementary material</title>
          <p>The online version of this article (doi:<ext-link xlink:href="10.1186/1758-2946-1-21" ext-link-type="doi">10.1186/1758-2946-1-21</ext-link>) contains supplementary material, which is available to authorized users.</p>
        </notes>
      </front>
      <body>
        <sec id="Sec1">
          <title>Background</title>
          <p>The drug-development process is both time-consuming and expensive: it takes an average of 15 years and $800 million to bring a drug to the market [<xref ref-type="bibr" rid="CR1">1</xref>]. The process of discovering a new drug for a particular disease usually involves High-Throughput Screening (HTS), a mixture of robotics, control software, liquid-handlers and optical readers. In HTS, batches of compounds are screened against a biological target (bioassay) to test the compound's ability to bind to the target - if the compound binds then it is an active for that target and known as a <italic>hit</italic>. If this hit is amenable to medicinal chemistry optimization and can be proved to be non-toxic then it may be developed further and become a <italic>lead</italic> for a specific target. Virtual screening is the computational or <italic>in silico</italic> screening of biological compounds and complements the HTS process. It is used to aid the selection of compounds for screening in HTS bioassays or for inclusion in a compound-screening library [<xref ref-type="bibr" rid="CR2">2</xref>]. Virtual screening can utilise several computational techniques depending on the amount and type of information available about the compounds and the target. Protein-based methods are employed when the 3D structure of the bioassay target is known and computational techniques involve the docking (virtual binding), and subsequent scoring, of candidate ligands (the part of the compound that is capable of binding) to the protein target. Ligand-based approaches are usually used when there are compounds known to be active or inactive for a specific target. If a few active compounds are known then structure-similarity techniques may be used; if the activity of several compounds is known then discriminant analysis techniques, such as machine learning approaches, may be applied. This is achieved by choosing several compounds that have known activity for a specific biological target and building predictive models that can discriminate between the active and inactive compounds. The goal is to then apply these models to several other unscreened compounds so that the compounds most likely to be active may be selected for screening. This is the approach taken in this research.</p>
          <p>The major challenge of using machine learning techniques for this type of problem is that the data is highly imbalanced: on average the ratio is 1 active compound to 1000 inactive compounds [<xref ref-type="bibr" rid="CR3">3</xref>]. This means that standard techniques, which assume equality, are not very effective at building predictive models when there is a low minority class ratio. Any tools employed for Virtual Screening must be able to cope with this imbalance and it is this essential criterion that has led to this investigation of Cost-Sensitive Classifiers (CSC). Virtual screening of imbalanced pharmaceutical data has been carried out before: in one study the classifiers used did not use misclassification costs [<xref ref-type="bibr" rid="CR4">4</xref>], and in another, the datasets were very small with only a slight imbalance [<xref ref-type="bibr" rid="CR5">5</xref>]. A recent analysis of PubChem bioassay data using Naive Bayes classifiers has been carried out [<xref ref-type="bibr" rid="CR6">6</xref>]. However, in their analysis, the number of compounds in the bioassay datasets was reduced so that there was a 1:1 ratio of Active to Inactive compounds. This research is a set of experiments to assess the application of meta-learners included in the Weka suite of machine learning algorithms [<xref ref-type="bibr" rid="CR7">7</xref>] to a variety of Primary and Confirmatory bioassay datasets. For the rest of this section, we describe the background to this research: the drug-discovery process, bioassay data and cost-sensitive classifiers. We then discuss the methods and results. In the Experimental section, we give descriptions of the datasets, classifiers and data representation. Finally, we discuss and conclude our findings.</p>
          <sec id="Sec2">
            <title>Drug Discovery and Bioassay Data</title>
            <p>Drug discovery is the first stage of the drug-development process and is concerned with the selection of compounds to screen and their subsequent screening against a specific biological target. This first stage screening process is known as primary-screening and usually involves the screening of thousands of compounds. One of the problems of the primary-screening process is the number of <italic>false positives</italic> (a compound that has been deemed as active but subsequently turned out to be inactive) that occur. Usually a secondary, or confirmatory, screen of the compound at different doses is required to ascertain its confirmed activity for a specific target. The confirmatory-screening process uses the exact technology as for primary screening but the number of compounds screened is usually significantly smaller: it is usually only the actives from the primary screening process that are used for confirmatory screening.</p>
            <p>The main resource for obtaining freely-available bioassay data is the PubChem repository provided by the National Center for Biotechnology Information [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. One of the problems of using the bioassay data from PubChem is that the data is not curated and is potentially erroneous [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. However, there is a lack of publicly-available bioassay data due to the fact that most HTS technology is held at private commercial organisations. In PubChem, there are 506 Primary Screening bioassay results and 858 Confirmatory Screening results (as of November 2009). However, there is no search facility to retrieve the Primary Screening results together with its corresponding Confirmatory Screen (if there is one). Finding corresponding confirmatory bioassays is only achieved by manually going through each primary screen webpage and see if there is one in the <italic>related bioassays</italic> section. The problem is complicated further as sometimes several primary screen bioassay data is used for the one confirmatory screen and vice versa. In database terminology, there is a many-to-many relationship between the 2 types of bioassays. Manually going through each bioassay looking for related bioassays still does not give the complete picture - the bioassay protocol also has to be read. For example, for bioassay AID1919 the Protocol overview states:</p>
            <p><italic>The purpose of this assay is to determine dose response curves for compounds identified as active in a previous set of experiments entitled, "Primary biochemical high throughput screening assay to identify inhibitors of VIM-2 metallo-beta-lactamase" (PubChem AID 1527), and inactive in a set of experiments entitled, "Epi-absorbance primary biochemical high throughput screening assay to identify inhibitors of IMP-1 metallo-beta-lactamase" (PubChem AID 1556)</italic>.</p>
            <p>This type of protocol is common in the bioassay data so a lot of data pre-processing has to be carried out to retrieve the relevant compounds from the bioassays. Sometimes finding the relevant confirmed Actives involves manually going through more than one bioassay, for example AID1509 leads to AID1523 which in turn leads to AID1701. Structuring the data this way also hinders the investigation in to why so many compounds end up as being false positives in the primary screening process. Even reading the bioassay protocols does not provide all the necessary information. For example, in primary screening bioassay AID1663 there are 661 bioactive compounds. In confirmatory screen AID1891 the protocol states:</p>
            <p><italic>Counter screen for luciferase inhibitors of Dense Granule Secretion. 20 ul of 1.5 uM ATP (Sigma, #A1852) in PBS is plated in 384-well white assay plates (Aurora, 00030721) and was exposed to the 1584 cherry-picked compounds chosen based on activity of the platelet dense granule release primary screen (AID1663) and structure to compounds with the highest activity, to provide some SAR data</italic>.</p>
            <p>Over 900 previously unscreened compounds have been added to the bioactive compounds from the primary screen. This type of bioassay protocol is also common throughout PubChem. Occasionally there are also errors or missing information in the bioassay protocols. For example, in AID688 there are 248 Active compounds but in the confirmatory screen AID792 it states</p>
            <p><italic>The HTS has been reported earlier (AID 688). Here we report the follow-up dose-response testing on the 448 compounds identified as hits in the HTS</italic>.</p>
            <p>Other bioassays also contain incorrect information. In AID530, the Data Activity Table is contradictory. According to the main bioassay description, 10,014 compounds were screened with 34 Actives, 9066 Inactives and 1136 Inconclusive compounds. This adds up to 10,236 compounds. When looking at the Data Activity table, the figures are 34 Actives, 9066 Inactives and 222 Discrepant compounds. This adds up to 9322 compounds even though it states that 10,014 compounds were tested. If you download the AID530 Activity information in CSV format, the figures are different from both of these - there are 22 labelled as Active, 8866 as Inactive, 931 as Inconclusive and 195 as Discrepant, which does total the original figure of 10,014.</p>
            <p>Out of 250 manually searched confirmatory screening bioassays, only six had good links to the primary screen. However, four of these still had some compounds either added or removed without a detailed explanation why. Table <xref rid="Tab1" ref-type="table">1</xref> shows a summary of the False Positives that have occurred in the HTS Primary Screen. The table shows the number of Actives founds in the primary screen (PS), the number of compounds tested in the confirmatory screen (CS), the number of Actives in the confirmatory screen and the percentage of false positives from the primary screen.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Summary of Primary Screen false positives</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Primary (PS)</p></th><th align="left"><p>Confirmatory (CS)</p></th><th align="right"><p>PS Actives</p></th><th align="right"><p>CS Tested</p></th><th align="right"><p>CS Actives</p></th><th align="right"><p>False Positive %</p></th></tr></thead><tbody><tr><td align="left"><p>AID604</p></td><td align="left"><p>AID644</p></td><td align="right"><p>212</p></td><td align="right"><p>206</p></td><td align="right"><p>67</p></td><td align="right"><p>65.57%</p></td></tr><tr><td align="left"><p>AID1284</p></td><td align="left"><p>AID746</p></td><td align="right"><p>366</p></td><td align="right"><p>362</p></td><td align="right"><p>57</p></td><td align="right"><p>83.33%</p></td></tr><tr><td align="left"><p>AID439</p></td><td align="left"><p>AID373</p></td><td align="right"><p>62</p></td><td align="right"><p>69</p></td><td align="right"><p>13</p></td><td align="right"><p>90.32%</p></td></tr><tr><td align="left"><p>AID721</p></td><td align="left"><p>AID687</p></td><td align="right"><p>94</p></td><td align="right"><p>94</p></td><td align="right"><p>21</p></td><td align="right"><p>77.66%</p></td></tr><tr><td align="left"><p>AID561</p></td><td align="left"><p>AID611</p></td><td align="right"><p>278</p></td><td align="right"><p>273</p></td><td align="right"><p>195</p></td><td align="right"><p>28.06%</p></td></tr><tr><td align="left"><p>AID525</p></td><td align="left"><p>AID600</p></td><td align="right"><p>359</p></td><td align="right"><p>359</p></td><td align="right"><p>213</p></td><td align="right"><p>40.67%</p></td></tr></tbody></table></table-wrap></p>
            <p>Though a detailed analysis could not be carried out due to the lack of information provided, these false positive rates are quite high (average 64%) and possibly suggest that primary screening data should not be used for virtual screening. For AID688, mentioned above for the cross-referencing error, there was a 100% false positive rate according to the confirmatory screen AID792. These figures have not been included in Table <xref rid="Tab1" ref-type="table">1</xref> in case they are also erroneous.</p>
          </sec>
        </sec>
        <sec id="Sec3" sec-type="methods">
          <title>Methods</title>
          <sec id="Sec4">
            <title>Bioassay Datasets</title>
            <p>A variety of datasets have been chosen for this study. Unfortunately due to computer memory limitations (Weka can only utilise 2 gigabytes of heap space for Windows systems), only small to medium datasets have been selected. However, the datasets are from the differing types of screening that can be performed using HTS technology (both primary and confirmatory screening) and they have varying sizes and minority classes. 21 datasets were created from the screening data. Table <xref rid="Tab2" ref-type="table">2</xref> shows a summary of the datasets used for this study. For four of the primary screening bioassays where there are corresponding confirmatory results, datasets have been created where the false positives from the primary screen are relabelled as Inactive. For the smaller confirmatory bioassay datasets, two types of data representation are used in order to see if adding more information improves the classification results.<table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>Summary of Bioassay datasets used in the predictive models</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Assay</p></th><th align="left"><p>No of Attributes</p></th><th align="left"><p>Screening Type</p></th><th align="right"><p>Compounds</p></th><th align="right"><p>Minority Class %</p></th></tr></thead><tbody><tr><td align="left"><p>AID362</p></td><td align="left"><p>144</p></td><td align="left"><p>Primary</p></td><td align="right"><p>4279</p></td><td align="right"><p>1.4%</p></td></tr><tr><td align="left"><p>AID604</p></td><td align="left"><p>154</p></td><td align="left"><p>Primary</p></td><td align="right"><p>59788</p></td><td align="right"><p>0.35%</p></td></tr><tr><td align="left"><p>AID456</p></td><td align="left"><p>153</p></td><td align="left"><p>Primary</p></td><td align="right"><p>9982</p></td><td align="right"><p>0.27%</p></td></tr><tr><td align="left"><p>AID688</p></td><td align="left"><p>154</p></td><td align="left"><p>Primary</p></td><td align="right"><p>27198</p></td><td align="right"><p>0.91%</p></td></tr><tr><td align="left"><p>AID373</p></td><td align="left"><p>154</p></td><td align="left"><p>Primary</p></td><td align="right"><p>59788</p></td><td align="right"><p>0.1%</p></td></tr><tr><td align="left"><p>AID746</p></td><td align="left"><p>154</p></td><td align="left"><p>Primary</p></td><td align="right"><p>59788</p></td><td align="right"><p>0.61%</p></td></tr><tr><td align="left"><p>AID687</p></td><td align="left"><p>153</p></td><td align="left"><p>Primary</p></td><td align="right"><p>33067</p></td><td align="right"><p>0.28%</p></td></tr><tr><td align="left"><p>AID746&amp;AID1284</p></td><td align="left"><p>154</p></td><td align="left"><p>Primary and Confirmatory</p></td><td align="right"><p>59784</p></td><td align="right"><p>0.1%</p></td></tr><tr><td align="left"><p>AID604&amp;AID644</p></td><td align="left"><p>154</p></td><td align="left"><p>Primary and Confirmatory</p></td><td align="right"><p>59782</p></td><td align="right"><p>0.11%</p></td></tr><tr><td align="left"><p>AID373&amp;AID439</p></td><td align="left"><p>154</p></td><td align="left"><p>Primary and Confirmatory</p></td><td align="right"><p>59795</p></td><td align="right"><p>0.02%</p></td></tr><tr><td align="left"><p>AID687&amp;AID721</p></td><td align="left"><p>153</p></td><td align="left"><p>Primary and Confirmatory</p></td><td align="right"><p>33046</p></td><td align="right"><p>0.06%</p></td></tr><tr><td align="left"><p>AID1608</p></td><td align="left"><p>154</p></td><td align="left"><p>Confirmatory</p></td><td align="right"><p>1033</p></td><td align="right"><p>6.58%</p></td></tr><tr><td align="left"><p>AID644</p></td><td align="left"><p>100</p></td><td align="left"><p>Confirmatory</p></td><td align="right"><p>206</p></td><td align="right"><p>32.52%</p></td></tr><tr><td align="left"><p>AID1284</p></td><td align="left"><p>103</p></td><td align="left"><p>Confirmatory</p></td><td align="right"><p>362</p></td><td align="right"><p>15.75%</p></td></tr><tr><td align="left"><p>AID439</p></td><td align="left"><p>81</p></td><td align="left"><p>Confirmatory</p></td><td align="right"><p>69</p></td><td align="right"><p>18.84%</p></td></tr><tr><td align="left"><p>AID721</p></td><td align="left"><p>87</p></td><td align="left"><p>Confirmatory</p></td><td align="right"><p>94</p></td><td align="right"><p>22.34%</p></td></tr><tr><td align="left"><p>AID1608</p></td><td align="left"><p>914</p></td><td align="left"><p>Confirmatory</p></td><td align="right"><p>1033</p></td><td align="right"><p>6.58%</p></td></tr><tr><td align="left"><p>AID644</p></td><td align="left"><p>914</p></td><td align="left"><p>Confirmatory</p></td><td align="right"><p>206</p></td><td align="right"><p>32.52%</p></td></tr><tr><td align="left"><p>AID1284</p></td><td align="left"><p>914</p></td><td align="left"><p>Confirmatory</p></td><td align="right"><p>362</p></td><td align="right"><p>15.75%</p></td></tr><tr><td align="left"><p>AID439</p></td><td align="left"><p>914</p></td><td align="left"><p>Confirmatory</p></td><td align="right"><p>69</p></td><td align="right"><p>18.84%</p></td></tr><tr><td align="left"><p>AID721</p></td><td align="left"><p>914</p></td><td align="left"><p>Confirmatory</p></td><td align="right"><p>94</p></td><td align="right"><p>22.34%</p></td></tr></tbody></table></table-wrap></p>
            <p>Further information on these assays may be found in the Experimental section and on the PubChem website. The AID number may be used as the search criterion.</p>
          </sec>
          <sec id="Sec5">
            <title>Data Pre-processing</title>
            <p>The chemical structures from PubChem were downloaded in Structure Data Format (SDF) and imported into the molecular descriptor generator PowerMV [<xref ref-type="bibr" rid="CR11">11</xref>]. A total of 179 descriptors were generated for each compound. The details of the descriptors may be found in the Experimental section. The bit-string fingerprint descriptor values that only had one value throughout the dataset (For example, all 0 s or all 1 s) were removed. For a secondary analysis, 735 additional fragment-pair fingerprint descriptors were generated for the confirmatory bioassay datasets.</p>
          </sec>
          <sec id="Sec6">
            <title>Cost-Sensitive Classifiers</title>
            <p>Most classifiers assume equal weighting of the classes in terms of both the number of instances and the level of importance - misclassifying class A has the same importance as misclassifying class B. However, when trying to predict a minority class in an imbalanced dataset or when a false negative is deemed more important than a false positive, standard data mining techniques are not successful.</p>
            <p>This type of problem led to the introduction of cost-sensitive classifiers where instances are predicted to have the class that has the lowest expected cost [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. In Weka, two methods are used to introduce cost-sensitivity - the reweighting of the training instances according to the total cost assigned to each class in the cost matrix or predicting the class with the minimum expected misclassification cost using the values in the cost matrix. A cost matrix may be seen as an overlay to the standard confusion matrix used to evaluate the results of a predictive modelling experiment. The four sections of a confusion matrix are True Positives (TP) - in our case Active compounds correctly classified as Active; False Positives (FP) - Inactive compounds incorrectly classified as Active; True Negatives (TN) - Inactive compounds correctly classified as Inactive; False Negatives (FN) - Active compounds incorrectly classified as Inactive. For bioassay data and more importantly for screening compound selection, it is better to minimise the False Negatives at the expense of increasing the number of False Positives. One of the advantages of using cost-sensitive classifiers is that the number of False Positives may be controlled - increasing the misclassification cost of the False Negatives will potentially increase both the number of False Positives and the number of True Positives. Table <xref rid="Tab3" ref-type="table">3</xref> shows a cost matrix when there is no penalty or cost for classifying the instances correctly, a cost of 1 for misclassifying an Inactive compound (False Positive) and a cost of 5 for misclassifying an Active compound (False Negative). This means that it is more costly misclassifying the positives than misclassifying the negatives. This misclassification cost is then used to build the predictive models.<table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p>A typical Cost Matrix which shows the misclassification cost for Positives and Negatives</p></caption><table frame="hsides" rules="groups"><thead><tr><th /><th align="left"><p>Actual Positive</p></th><th align="left"><p>Actual Negative</p></th></tr></thead><tbody><tr><td align="left"><p><bold>Predicted Positive</bold></p></td><td align="left"><p>0 TP</p></td><td align="left"><p>1 FP</p></td></tr><tr><td align="left"><p><bold>Predicted Negative</bold></p></td><td align="left"><p>5 FN</p></td><td align="left"><p>0 TN</p></td></tr></tbody></table></table-wrap></p>
            <p>One of the problems of cost-sensitive classifiers is that there are no standards or guidelines for setting the misclassification costs. Previous research has used the ratio of positives to negatives as the misclassification cost for fraud detection [<xref ref-type="bibr" rid="CR14">14</xref>] and for medical data classification [<xref ref-type="bibr" rid="CR15">15</xref>]. Other research has employed the number of majority class instances as the misclassification cost [<xref ref-type="bibr" rid="CR16">16</xref>] or bespoke methods of cost calculation that work for specific classifiers only [<xref ref-type="bibr" rid="CR17">17</xref>]. However, when using Weka the differing data mining algorithms utilise costs differently depending on the underlying probability handling of the algorithm. For example, in Sheng and Ling [<xref ref-type="bibr" rid="CR16">16</xref>] they have used Weka's cost-sensitive classifiers to evaluate their novel method. However, for the differing classifiers they have used across-the-board costs of 2, 5, 10 etc. This research shows that setting the Weka cost matrix is dependent on the base classifier used. For example, in one of our experiments using a cost-sensitive Naive Bayes classifier requires a misclassification cost of 2 to achieve the same results as a cost-sensitive Random Forest with a misclassification cost of 75. One of the difficulties in setting up the Weka cost matrix is that the costs are not a straight-forward ratio. Weka normalises (reweights) the cost matrix to ensure that the sum of the costs equals the total amount of instances.</p>
            <p>For our set of experiments, we used incremental costing where the cost was increased in stages from 2 to 1000000. The misclassification cost was incremented until a 20% False Positive rate was reached - a 20% False Positive rate seemed an appropriate place to stop. This meant over 5000 classifiers were built for this study so that we could find an optimal Weka misclassification cost setting for a specific base classifier when applied to a specific type of dataset. The base classifiers used were Naive Bayes, Random Forest and Weka's implementation of a Support Vector Machine (SMO) and a C4.5 (J48) decision tree. Default Weka options were used for the Naive Bayes and Random Forest but for the SMO "build logistic models" was set to true and for the J48 tree "Pruning" was disabled. The standard cost-sensitive classifier was used for Naive Bayes, SMO and Random Forest. For J48, a bagged (Bootstrap Aggregating) meta-learner MetaCost was used as it works more efficiently for unstable, unpruned decision trees [<xref ref-type="bibr" rid="CR18">18</xref>]. Further details of these models may be found in the Experimental section.</p>
            <p>There are two main goals of the classification experiments - to find the most robust and versatile classifier for imbalanced bioassay data and to find out the optimal misclassification cost setting for a classifier. Even though we do not recommend using primary screening data, we have included this type of data as it tends to be larger and more imbalanced than some confirmatory screening data. These experiments are more of a survey of the classifiers rather than an experiment to gain insightful information about potential drugs for the particular targets. The datasets were randomly split into an 80% training and validation set and a 20% independent test set. To train the models cross-validation was employed. Cross-validation is a standard statistical technique where the training and validation data set is split into several parts of equal size, for example 10% of the compounds for a 10 fold cross-validation. For each run of the classifier, 10% of the data is excluded from the training set and put in a corresponding validation set. A 5 fold cross-validation was used for the training and validation of the larger datasets and a 10 fold classification for the smaller confirmatory datasets. In both cases, the resulting model from the cross-validation was applied to the test set. All reported results are based on the independent testing and not on the training.</p>
          </sec>
        </sec>
        <sec id="Sec7" sec-type="results">
          <title>Results</title>
          <p>This section first looks at the setting of the Weka cost matrix and compares the misclassification costs needed for each classifier for each dataset. We then look at the performance results of the primary screen bioassay datasets when constrained to a maximum False Positive limit of approximately 20%. The results of the two types of confirmatory bioassay datasets are then analysed and finally a comparison is made of the results of the datasets that have mixed primary and confirmatory data.</p>
          <sec id="Sec8">
            <title>Weka Cost Matrix</title>
            <p>The set of experiments carried out show that there is a large variability in how the differing classifiers respond to the misclassification costs in the Weka Cost Matrix. The Naive Bayes classifier in all instances requires a smaller misclassification cost setting than the other classifiers. A Random Forest classifier requires more memory than the other classifiers, though this will be due to the fact it utilises bagging. When it could be run, the Random Forest classifier requires a large cost setting to achieve the same results as the others. Table <xref rid="Tab4" ref-type="table">4</xref> shows the Weka Cost matrix misclassification costs for the False Negatives in order to achieve the maximum number of True Positives with a False Positive rate of fewer than 20% for each classifier. The number in brackets after the dataset name is the misclassification cost if the ratio of active compounds to inactive compounds (inactives/actives) had been used.<table-wrap id="Tab4"><label>Table 4</label><caption xml:lang="en"><p>Misclassification Costs per primary screen dataset and mixed primary/confirmatory datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Dataset</p></th><th align="left"><p>Naive Bayes</p></th><th align="left"><p>SMO</p></th><th align="left"><p>Random Forest</p></th><th align="left"><p>J48</p></th></tr></thead><tbody><tr><td align="left"><p>AID362 <bold>(70)</bold></p></td><td align="left"><p>40</p></td><td align="left"><p>150</p></td><td align="left"><p>3000</p></td><td align="left"><p>285</p></td></tr><tr><td align="left"><p>AID604 <bold>(281)</bold></p></td><td align="left"><p>40</p></td><td align="left"><p>250</p></td><td align="left"><p>Out of memory</p></td><td align="left"><p>650</p></td></tr><tr><td align="left"><p>AID456 <bold>(369)</bold></p></td><td align="left"><p>18</p></td><td align="left"><p>200</p></td><td align="left"><p>100000</p></td><td align="left"><p>1000</p></td></tr><tr><td align="left"><p>AID688 <bold>(109)</bold></p></td><td align="left"><p>34</p></td><td align="left"><p>78</p></td><td align="left"><p>Out of memory</p></td><td align="left"><p>220</p></td></tr><tr><td align="left"><p>AID373 <bold>(963)</bold></p></td><td align="left"><p>20</p></td><td align="left"><p>2000</p></td><td align="left"><p>Out of memory</p></td><td align="left"><p>3000</p></td></tr><tr><td align="left"><p>AID746 <bold>(162)</bold></p></td><td align="left"><p>25</p></td><td align="left"><p>100</p></td><td align="left"><p>Out of memory</p></td><td align="left"><p>450</p></td></tr><tr><td align="left"><p>AID687 <bold>(351)</bold></p></td><td align="left"><p>50</p></td><td align="left"><p>250</p></td><td align="left"><p>Out of memory</p></td><td align="left"><p>680</p></td></tr><tr><td align="left"><p>AID746&amp;AID1284 <bold>(1048)</bold></p></td><td align="left"><p>100</p></td><td align="left"><p>1000</p></td><td align="left"><p>Out of memory</p></td><td align="left"><p>1900</p></td></tr><tr><td align="left"><p>AID604&amp;AID644 <bold>(891)</bold></p></td><td align="left"><p>70</p></td><td align="left"><p>750</p></td><td align="left"><p>Out of memory</p></td><td align="left"><p>1500</p></td></tr><tr><td align="left"><p>AID373&amp;AID439 <bold>(4599)</bold></p></td><td align="left"><p>70</p></td><td align="left"><p>9000</p></td><td align="left"><p>Out of memory</p></td><td align="left"><p>9500</p></td></tr><tr><td align="left"><p>AID687&amp;AID721 <bold>(351)</bold></p></td><td align="left"><p>700</p></td><td align="left"><p>6702</p></td><td align="left"><p>Out of memory</p></td><td align="left"><p>1900</p></td></tr></tbody></table></table-wrap></p>
            <p>In 10 out of 11 experiments, Naive Bayes has the smallest cost setting, then the SMO and finally the J48. In all instances, the performance of the classifiers would have been reduced if minority class ratios had been used as the Weka misclassification cost - there are significant differences between the optimal cost and the class ratio cost.</p>
            <p>Confirmatory bioassay data tend to be smaller and less imbalanced (smaller Inactive/Active ratios) than primary bioassay data. For these datasets, standard classifiers were applied first (no misclassification costs) and if there was less than a 20% False Positive rate then cost-sensitive classifiers were used. Table <xref rid="Tab5" ref-type="table">5</xref> shows the misclassification costs, if any, used for the confirmatory datasets. A * indicates that the best results that could be achieved had a greater than 20% False Positive rate. The 'a' after the dataset name represents the smaller dataset and the 'b' represents the larger version of the dataset. The number in brackets after the dataset name is the misclassification cost if the ratio of active compounds to inactive compounds (inactives/actives) had been used.<table-wrap id="Tab5"><label>Table 5</label><caption xml:lang="en"><p>Misclassification Costs for False Negatives per confirmatory dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Dataset</p></th><th align="left"><p>Naive Bayes</p></th><th align="left"><p>SMO</p></th><th align="left"><p>Random Forest</p></th><th align="left"><p>J48</p></th></tr></thead><tbody><tr><td align="left"><p>AID1608a <bold>(14)</bold></p></td><td align="left"><p>2</p></td><td align="left"><p>5</p></td><td align="left"><p>75</p></td><td align="left"><p>25</p></td></tr><tr><td align="left"><p>AID644a <bold>(2)</bold></p></td><td align="left"><p>None*</p></td><td align="left"><p>None</p></td><td align="left"><p>None</p></td><td align="left"><p>None*</p></td></tr><tr><td align="left"><p>AID1284a <bold>(5)</bold></p></td><td align="left"><p>None*</p></td><td align="left"><p>2.7</p></td><td align="left"><p>8</p></td><td align="left"><p>2</p></td></tr><tr><td align="left"><p>AID439a <bold>(4)</bold></p></td><td align="left"><p>None*</p></td><td align="left"><p>None</p></td><td align="left"><p>None</p></td><td align="left"><p>None</p></td></tr><tr><td align="left"><p>AID721a <bold>(3)</bold></p></td><td align="left"><p>None*</p></td><td align="left"><p>None</p></td><td align="left"><p>None</p></td><td align="left"><p>None</p></td></tr><tr><td align="left"><p>AID1608b <bold>(14)</bold></p></td><td align="left"><p>None</p></td><td align="left"><p>200</p></td><td align="left"><p>75</p></td><td align="left"><p>30</p></td></tr><tr><td align="left"><p>AID644b <bold>(2)</bold></p></td><td align="left"><p>None*</p></td><td align="left"><p>None</p></td><td align="left"><p>1.5</p></td><td align="left"><p>2</p></td></tr><tr><td align="left"><p>AID1284b <bold>(5)</bold></p></td><td align="left"><p>None*</p></td><td align="left"><p>6</p></td><td align="left"><p>8</p></td><td align="left"><p>2</p></td></tr><tr><td align="left"><p>AID439b <bold>(4)</bold></p></td><td align="left"><p>None</p></td><td align="left"><p>None</p></td><td align="left"><p>3</p></td><td align="left"><p>None*</p></td></tr><tr><td align="left"><p>AID721b <bold>(3)</bold></p></td><td align="left"><p>None</p></td><td align="left"><p>None</p></td><td align="left"><p>None</p></td><td align="left"><p>None</p></td></tr></tbody></table></table-wrap></p>
            <p>Once again, it seems that there is no connection between the ratios of Inactives:Actives to the Weka cost matrix setting. The Naive Bayes classifier has not needed any misclassification costs for 90% of the datasets, however in 60% of the datasets there are greater than 20% False Positives. Adding approximately 800 more attributes to the larger 'b' datasets has not had an effect on the setting of the misclassification costs. This illustrates that the setting of the Weka misclassification cost is arbitrary and more closely linked to the base classifier used than the class ratios or the number of attributes. As the costs we are discussing are the actual settings of the Weka cost matrix rather than class ratios, the comparison of classifiers cannot be compared using cost curves [<xref ref-type="bibr" rid="CR13">13</xref>].</p>
          </sec>
          <sec id="Sec9">
            <title>Primary Screen Bioassay Datasets</title>
            <p>The independent test performance of each classifier was compared by the maximum number of True Positives that could be attained with approximately a 20% False Positive rate. As mentioned previously, one of the advantages of using cost-sensitive classifiers is that the False Positive rate may be controlled. Figure <xref rid="Fig1" ref-type="fig">1</xref> shows the True Positive rate achieved by each classifier with under a 20% False Positive rate when the training models were applied to the independent test set. The minority class % of each dataset is shown in brackets.<fig id="Fig1"><label>Figure 1</label><caption xml:lang="en"><p><bold>Primary Screen datasets: True Positive rate with under or approximately a 20% False Positive rate</bold>. The True Positive rate achieved by each type of classifier for the Primary Screen datasets. A maximum limit of 20% False Positives were allowed.</p></caption><graphic specific-use="HTML" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2009_Article_21_Fig1_HTML.jpg" /></fig></p>
            <p>These figures are quite promising considering the degree of imbalance in the bioassay data. Though classifier accuracy and precision are not the best statistical evaluation methods for imbalanced datasets, the results of these may be found in the supplementary Excel results file. See Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>: Full results of the classification experiments.</p>
            <p>Some observations from the experiments are detailed below:</p>
            <p>
              <list list-type="bullet">
                <list-item>
                  <p>Even though all the datasets are from primary screening bioassays, there is a big difference in classifier performance. There appears to be no relation of performance to the number of compounds in the bioassay or the size of the minority class. From a cost-sensitive classifier point of view, the experiments show that these types of classifiers are capable of producing some good True Positive rates with a controllable False Positive rate for highly imbalanced data. From a bioassay point of view, it is questionable how helpful these models are: primary screening usually involves a large amount of false positives. For example, AID688 had a 100% false positive rate and AID373 had a 90% false positive rate. This leads back to the issue of whether this type of data should be used for virtual screening.</p>
                </list-item>
                <list-item>
                  <p>As a Random Forest classifier is an ensemble classifier (an ensemble of Random Trees), it requires more computational memory than the other classifiers. It has not been able to run when there has been over 27,000 compounds</p>
                </list-item>
                <list-item>
                  <p>Overall, Weka's implementation of the cost-sensitive Support Vector Machine, the SMO, has performed consistently well. A disadvantage of the SMO has been the amount of time taken to build the model and run the 5 fold cross-validation - in some cases the model took 7 hours to complete per cost setting used. The cost-sensitive Naive Bayes models were the quickest to build and the J48 and Random Forest models took, on average, about 1 hour per cost-setting to build.</p>
                </list-item>
              </list>
            </p>
          </sec>
          <sec id="Sec10">
            <title>Confirmatory Screen Bioassay Datasets</title>
            <p>The independent test performance of each classifier has been harder to compare as some classifiers could not achieve fewer than 20% False Positives. The compounds in confirmatory bioassay data (ie. those compounds that were deemed Active in the primary screen) are, in general, quite similar in terms of unique attributes. In some cases, there has been a 50% reduction in the fingerprint data representation when these attributes are removed. For this reason, another set of experiments was carried out where more descriptors were generated. This could not be done with the primary screening datasets because of computational memory limitations. Though these types of datasets are relatively small with only a small imbalance of Actives and Inactives, the classifiers have not been very successful at predicting the bioassay's active compounds. This could be due to the fact that the compounds in a confirmatory screen are usually closer in structure and physicochemical properties. Table <xref rid="Tab6" ref-type="table">6</xref> shows the results of both sets of experiments in terms of the True Positive and False Positive rates. The 'a' after the dataset name represents the smaller dataset and the 'b' represents the larger version of the dataset. The numbers of attributes in the datasets are written in brackets after the dataset name.<table-wrap id="Tab6"><label>Table 6</label><caption xml:lang="en"><p>The True Positive and False Positive rates for the confirmatory bioassay datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Dataset</p></th><th align="left" colspan="2"><p>Naive Bayes</p></th><th align="left" colspan="2"><p>SMO</p></th><th align="left" colspan="2"><p>Random Forest</p></th><th align="left" colspan="2"><p>J48</p></th></tr><tr><th /><th align="left"><p>TP%</p></th><th align="left"><p>FP%</p></th><th align="left"><p>TP%</p></th><th align="left"><p>FP%</p></th><th align="left"><p>TP%</p></th><th align="left"><p>FP%</p></th><th align="left"><p>TP%</p></th><th align="left"><p>FP%</p></th></tr></thead><tbody><tr><td align="left"><p>AID1608a (154)</p></td><td align="left"><p>23.08</p></td><td align="left"><p>19.17</p></td><td align="left"><p>30.77</p></td><td align="left"><p>8.81</p></td><td align="left"><p>30.77</p></td><td align="left"><p>8.29</p></td><td align="left"><p>15.78</p></td><td align="left"><p>20.21</p></td></tr><tr><td align="left"><p>AID644a (100)</p></td><td align="left"><p>38.46</p></td><td align="left"><p>39.29</p></td><td align="left"><p>23.08</p></td><td align="left"><p>17.86</p></td><td align="left"><p>23.08</p></td><td align="left"><p>7.14</p></td><td align="left"><p>38.46</p></td><td align="left"><p>28.57</p></td></tr><tr><td align="left"><p>AID1284a (103)</p></td><td align="left"><p>27.27</p></td><td align="left"><p>26.23</p></td><td align="left"><p>36.36</p></td><td align="left"><p>13.11</p></td><td align="left"><p>45.45</p></td><td align="left"><p>18.03</p></td><td align="left"><p>54.55</p></td><td align="left"><p>13.11</p></td></tr><tr><td align="left"><p>AID439a (81)</p></td><td align="left"><p>100.00</p></td><td align="left"><p>27.27</p></td><td align="left"><p>50.00</p></td><td align="left"><p>9.09</p></td><td align="left"><p>50.00</p></td><td align="left"><p>18.18</p></td><td align="left"><p>50.00</p></td><td align="left"><p>18.18</p></td></tr><tr><td align="left"><p>AID721a (87)</p></td><td align="left"><p>0.00</p></td><td align="left"><p>28.57</p></td><td align="left"><p>0.00</p></td><td align="left"><p>14.29</p></td><td align="left"><p>0.00</p></td><td align="left"><p>21.43</p></td><td align="left"><p>0.00</p></td><td align="left"><p>14.29</p></td></tr><tr><td align="left"><p>AID1608b (914)</p></td><td align="left"><p>30.77</p></td><td align="left"><p>12.95</p></td><td align="left"><p>38.46</p></td><td align="left"><p>13.47</p></td><td align="left"><p>30.77</p></td><td align="left"><p>12.95</p></td><td align="left"><p>38.46</p></td><td align="left"><p>18.13</p></td></tr><tr><td align="left"><p>AID644b (914)</p></td><td align="left"><p>30.77</p></td><td align="left"><p>28.57</p></td><td align="left"><p>53.85</p></td><td align="left"><p>14.29</p></td><td align="left"><p>38.46</p></td><td align="left"><p>17.86</p></td><td align="left"><p>30.77</p></td><td align="left"><p>14.29</p></td></tr><tr><td align="left"><p>AID1284b (914)</p></td><td align="left"><p>36.36</p></td><td align="left"><p>24.59</p></td><td align="left"><p>36.36</p></td><td align="left"><p>13.11</p></td><td align="left"><p>54.55</p></td><td align="left"><p>18.03</p></td><td align="left"><p>45.45</p></td><td align="left"><p>16.39</p></td></tr><tr><td align="left"><p>AID439b (914)</p></td><td align="left"><p>50.00</p></td><td align="left"><p>18.18</p></td><td align="left"><p>50.00</p></td><td align="left"><p>9.09</p></td><td align="left"><p>50.00</p></td><td align="left"><p>18.18</p></td><td align="left"><p>0.00</p></td><td align="left"><p>27.27</p></td></tr><tr><td align="left"><p>AID721b (914)</p></td><td align="left"><p>0.00</p></td><td align="left"><p>14.29</p></td><td align="left"><p>0.00</p></td><td align="left"><p>21.43</p></td><td align="left"><p>0.00</p></td><td align="left"><p>7.14</p></td><td align="left"><p>0.00</p></td><td align="left"><p>0.00</p></td></tr></tbody></table></table-wrap></p>
            <p>The results have been disappointing and the best True Positive rate that can be achieved with under a 20% False Positive rate is approximately 55% - this is worse than for the large, highly imbalanced data. The number of compounds correctly classified as Active could have been improved if the False Positive rate was increased, but it was decided that the same benchmark as the larger datasets should be used. These results raise the question of molecular structure representation - are Boolean fingerprints the best data representation? The confirmatory datasets represented with significantly more descriptors have only produced slightly better results than the smaller datasets.</p>
          </sec>
          <sec id="Sec11">
            <title>Primary/Confirmatory Screen Bioassay Datasets</title>
            <p>These datasets are a mixture of primary and confirmatory bioassay data - all the false positives from the primary screen are relabelled as inactive. The datasets are generally the same size as for the primary screen datasets but have a smaller minority class. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the True Positive rate achieved by each classifier with under a 20% False Positive rate when the training models were applied to the independent test set. The minority class % of each dataset is shown in brackets.<fig id="Fig2"><label>Figure 2</label><caption xml:lang="en"><p><bold>Mixed datasets: True Positive rate with under or approximately a 20% False Positive rate</bold>. The True Positive rate achieved by each type of classifier for the Mixed Primary Screen/Confirmatory Screen datasets. A maximum limit of 20% False Positives were allowed.</p></caption><graphic specific-use="HTML" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2009_Article_21_Fig2_HTML.jpg" /></fig></p>
            <p>These results were quite surprising - in two cases the MetaCost J48 classified all the Active compounds correctly in the independent test set with fewer than 20% False Positives. Considering the minority classes were less than 1%, this is very promising. In all cases, the datasets were too large for a cost-sensitive Random Forest to be run. The results of the mixed bioassay data were compared to the classification results of the corresponding primary and confirmatory data. Table <xref rid="Tab7" ref-type="table">7</xref> shows the bioassay datasets with the results of the best classification model highlighted.<table-wrap id="Tab7"><label>Table 7</label><caption xml:lang="en"><p>Best classification models for the bioassays with mixed, primary and confirmatory data</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Assay</p></th><th align="left"><p>Best Model</p></th><th align="left"><p>TP%</p></th><th align="left"><p>FP%</p></th><th align="right"><p>Accuracy %</p></th></tr></thead><tbody><tr><td align="left"><p>AID604</p></td><td align="left"><p>CSC SMO</p></td><td align="left"><p>64.29</p></td><td align="left"><p>20.59</p></td><td align="right"><p>79.36</p></td></tr><tr><td align="left"><p>AID644b</p></td><td align="left"><p>SMO</p></td><td align="left"><p>53.85</p></td><td align="left"><p>14.29</p></td><td align="right"><p>75.61</p></td></tr><tr><td align="left"><p><bold>AID604&amp;AID644</bold></p></td><td align="left"><p><bold>CSC SMO</bold></p></td><td align="left"><p><bold>76.92</bold></p></td><td align="left"><p><bold>11.91</bold></p></td><td align="right"><p><bold>88.08</bold></p></td></tr><tr><td align="left"><p>AID373</p></td><td align="left"><p>MetaCost J48</p></td><td align="left"><p>75.00</p></td><td align="left"><p>14.50</p></td><td align="right"><p>85.49</p></td></tr><tr><td align="left"><p>AID439ab</p></td><td align="left"><p>SMO</p></td><td align="left"><p>50.00</p></td><td align="left"><p>9.09</p></td><td align="right"><p>84.62</p></td></tr><tr><td align="left"><p><bold>AID373&amp;AID439</bold></p></td><td align="left"><p><bold>MetaCost J48</bold></p></td><td align="left"><p><bold>100.00</bold></p></td><td align="left"><p><bold>17.65</bold></p></td><td align="right"><p><bold>82.35</bold></p></td></tr><tr><td align="left"><p>AID746</p></td><td align="left"><p>MetaCost J48</p></td><td align="left"><p>63.01</p></td><td align="left"><p>20.30</p></td><td align="right"><p>79.60</p></td></tr><tr><td align="left"><p>AID1284b</p></td><td align="left"><p>CSC Random Forest</p></td><td align="left"><p>54.55</p></td><td align="left"><p>18.03</p></td><td align="right"><p>77.78</p></td></tr><tr><td align="left"><p><bold>AID746&amp;AID1284</bold></p></td><td align="left"><p><bold>MetaCost J48</bold></p></td><td align="left"><p><bold>100.00</bold></p></td><td align="left"><p><bold>19.34</bold></p></td><td align="right"><p><bold>80.68</bold></p></td></tr><tr><td align="left"><p>AID687</p></td><td align="left"><p>CSC Naive Bayes</p></td><td align="left"><p>44.44</p></td><td align="left"><p>18.97</p></td><td align="right"><p>80.93</p></td></tr><tr><td align="left"><p>AID721b</p></td><td align="left"><p>J48</p></td><td align="left"><p>0.00</p></td><td align="left"><p>0.00</p></td><td align="right"><p>77.78</p></td></tr><tr><td align="left"><p><bold>AID687&amp;AID721</bold></p></td><td align="left"><p><bold>MetaCost J48</bold></p></td><td align="left"><p><bold>50.00</bold></p></td><td align="left"><p><bold>9.49</bold></p></td><td align="right"><p><bold>90.49</bold></p></td></tr></tbody></table></table-wrap></p>
            <p>Interestingly, in all cases the best model, in terms of correctly classified Active compounds, has been the mixed datasets that have the smallest minority classes. This once again leads back to the question of whether primary screening data should be solely used to build bioassay predictive models - better models may be built using the confirmed Active compounds only. It is unfortunate that the models that have been the most successful are based on the hardest to obtain data from PubChem.</p>
          </sec>
        </sec>
        <sec id="Sec12">
          <title>Conclusions and Discussion</title>
          <p>This paper has examined the three main problems associated with the virtual screening of bioassay data - the access to freely-available curated data, the number of false positives that occur in the primary screening process and the imbalance of Active compounds to Inactive compounds. Though the first two of these problems are not solvable by this research, it is still important that these problems are pointed out to researchers of virtual screening. This research has shown that the bioassay data at PubChem is not recorded in a standard and consistent way and some entries contain erroneous information. It is unfortunate that there is no direct search facility where related primary and confirmatory bioassays may be retrieved together - the classification models that have been the most successful are based on the hardest to obtain data from PubChem. The number of false positives from the HTS primary screen process is very high and maybe virtual screening techniques should be applied to the bioassays where there is corresponding confirmatory data.</p>
          <p>Weka is a tool that is used by the academic community for both primary and comparative studies and it is important to explain how the cost-sensitive classifiers handle misclassification costs. Previous research has used across-the-board cost settings for differing classifiers and this research has shown that this is not the best way to implement cost-sensitivity in Weka. When using Weka, the cost matrix should be set according to the classifier being used rather than to the ratio of the minority class. From the survey of cost-sensitive classifiers carried out, the Support Vector Machine (SMO) and C4.5 decision tree learner (J48) have performed quite well considering the sizes of the minority classes. The poor results from the confirmatory bioassay experiments have led to a question of molecular structure data representation and this is an area for future work.</p>
          <p>For the virtual screening of bioassay data, it is recommended that both primary and the corresponding confirmatory screening data are used.</p>
        </sec>
        <sec id="Sec13">
          <title>Experimental</title>
          <sec id="Sec14">
            <title>Bioassay Datasets</title>
            <p>The following are the descriptions of the datasets used for these experiments. See additional files Additional file <xref ref-type="supplementary-material" rid="MOESM2">2</xref>: Training and Testing primary screen datasets in CSV format.</p>
            <p>Additional file <xref ref-type="supplementary-material" rid="MOESM3">3</xref>: Training and Testing primary screen datasets in CSV format.</p>
            <p>Additional file <xref ref-type="supplementary-material" rid="MOESM4">4</xref>: Training and Testing confirmatory screen datasets in CSV format.</p>
            <p>Additional file <xref ref-type="supplementary-material" rid="MOESM5">5</xref>: Training and Testing primary/confirmatory screen datasets in CSV format.</p>
            <p>
              <list list-type="bullet">
                <list-item>
                  <p><bold>AID362</bold> details the results of a primary screening bioassay for Formylpeptide Receptor Ligand Binding University from the New Mexico Center for Molecular Discovery. It is a relatively small dataset with 4279 compounds and with a ratio of 1 active to 70 inactive compounds (1.4% minority class). The compounds were selected on the basis of preliminary virtual screening of approximately 480,000 drug-like small molecules from Chemical Diversity Laboratories.</p>
                </list-item>
                <list-item>
                  <p><bold>AID456</bold> is a primary screen assay from the Burnham Center for Chemical Genomics for inhibition of TNFa induced VCAM-1 cell surface expression and consists of 9,982 compounds with a ratio of 1 active compound to 368 inactive compounds (0.27% minority). The compounds have been selected for their known drug-like properties and 9,431 meet the Rule of 5 [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
                </list-item>
                <list-item>
                  <p><bold>AID688</bold> is the result of a primary screen for Yeast eIF2B from the Penn Center for Molecular Discovery and contains activity information of 27,198 compounds with a ratio of 1 active compound to 108 inactive compounds (0.91% minority). The screen is a reporter-gene assay and 25,656 of the compounds have known drug-like properties.</p>
                </list-item>
                <list-item>
                  <p><bold>AID604</bold> is a primary screening bioassay for Rho kinase 2 inhibitors from the Scripps Research Institute Molecular Screening Center. The bioassay contains activity information of 59,788 compounds with a ratio of 1 active compound to 281 inactive compounds (1.4%). 57,546 of the compounds have known drug-like properties.</p>
                </list-item>
                <list-item>
                  <p><bold>AID373</bold> is a primary screen from the Scripps Research Institute Molecular Screening Center for endothelial differentiation, sphingolipid G-protein-coupled receptor, 3. 59,788 compounds were screened with a ratio of 1 active compound to 963 inactive compounds (0.1%). 57,546 of the compounds screened had known drug-like properties.</p>
                </list-item>
                <list-item>
                  <p><bold>AID746</bold> is a primary screen from the Scripps Research Institute Molecular Screening Center for Mitogen-activated protein kinase. 59,788 compounds were screened with a ratio of 1 active compound to 162 inactive compounds (0.61%). 57,546 of the compounds screened had known drug-like properties.</p>
                </list-item>
                <list-item>
                  <p><bold>AID687</bold> is the result of a primary screen for coagulation factor XI from the Penn Center for Molecular Discovery and contains activity information of 33,067 compounds with a ratio of 1 active compound to 350 inactive compounds (0.28% minority). 30,353 of the compounds screened had known drug-like properties.</p>
                </list-item>
                <list-item>
                  <p><bold>AID1608</bold> is a different type of screening assay that was used to identify compounds that prevent HttQ103-induced cell death. National Institute of Neurological Disorders and Stroke Approved Drug Program. The compounds that prevent a release of a certain chemical into the growth medium are labelled as active and the remaining compounds are labelled as having inconclusive activity. AID1608 is a small dataset with 1,033 compounds and a ratio of 1 active to 14 inconclusive compounds (6.58% minority class).</p>
                </list-item>
                <list-item>
                  <p><bold>AID644</bold> confirmatory screen of AID604</p>
                </list-item>
                <list-item>
                  <p><bold>AID1284</bold> confirmatory screen of AID746</p>
                </list-item>
                <list-item>
                  <p><bold>AID439</bold> confirmatory screen of AID373</p>
                </list-item>
                <list-item>
                  <p><bold>AID721</bold> confirmatory screen of AID746</p>
                </list-item>
              </list>
            </p>
          </sec>
          <sec id="Sec15">
            <title>Bioassay Descriptors</title>
            <p>As previously mentioned, the software PowerMV [<xref ref-type="bibr" rid="CR11">11</xref>] was used to generate descriptors for the bioassay SDF files from PubChem. 179 descriptors were generated for each dataset.</p>
            <p>â¢ 8 descriptors useful for characterizing the drug-likeness of a compound. These include XlogP (the propensity of a molecule to partition into water or oil), the number of Hydrogen bond donors and acceptors, molecular weight, polar surface area, the number of rotatable bonds, a descriptor to indicate if the compound penetrates the blood-brain barrier and a descriptor for the number of reactive or toxic functional groups in the compound.</p>
            <p>â¢ 24 continuous descriptors based on a variation of BCUT descriptors to define a low dimensional chemistry space. The method used by PowerMV differs from BCUT in that PowerMV uses electro-negativity, Gasteiger partial charge or XLogP on the diagonal of the Burden connectivity matrix before calculating the eigenvalues.</p>
            <p>â¢ 147 bit-string structural descriptors known as Pharmacophore Fingerprints based on bioisosteric principles - two atoms or functional groups that have approximately the same biological activity are assigned the same class.</p>
            <p>For the confirmatory datasets, Fragment Pair Fingerprints were also generated using PowerMV. For fragment-based descriptors, 14 classes of paired functional groups are defined. For example, two phenyl rings separated by two bonds are expressed as AR_02_AR [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
          </sec>
          <sec id="Sec16">
            <title>Meta-Learners and Base Classifiers</title>
            <p>The following classifiers were implemented for this research. Please note that italics represent Weka key words so that the experiments may be reproducible.</p>
            <p>
              <list list-type="bullet">
                <list-item>
                  <p>Weka's <italic>CostSensitiveClassifier</italic> was used for the base classifiers Naive Bayes, SMO and Random Forest. Cost-sensitivity can be achieved in two ways - the reweighting of the training instances according to the total cost assigned to each class or predicting the class with the minimum expected misclassification cost. The former was used for this research and therefore the <italic>MinimizeExpectedCost</italic> option was set to <italic>False</italic>. Our preliminary experiments, not documented here, showed that the standard <italic>CostSensitiveClassifier</italic> produced better results for these base classifiers than the meta-learners <italic>AdaBoost</italic> and <italic>MetaCost</italic>.</p>
                </list-item>
                <list-item>
                  <p><italic>MetaCost</italic> combines the predictive benefits of bagging (combining the decisions of different models) with a minimized expected cost model for cost-sensitive prediction. An ensemble classifier is built using bagging and it is used to relabel the training data based on the minimised expected costs [<xref ref-type="bibr" rid="CR6">6</xref>]. <italic>Metacost</italic> works well with unstable models and our preliminary experiments found that using <italic>Metacost</italic> with the <italic>J48</italic> unpruned tree produced better results than <italic>AdaBoost</italic> and <italic>CostSensitiveClassifier</italic>.</p>
                </list-item>
                <list-item>
                  <p><italic>NaiveBayes</italic> is a probabilistic classifier based on applying Bayes' theorem with strong independence assumptions. A Naive Bayes classifier assumes that the presence or absence of a particular feature of a class is unrelated to the presence or absence of any other feature. The Weka defaults for this classifier were used.</p>
                </list-item>
                <list-item>
                  <p><italic>SMO</italic> is Weka's implementation of the Support Vector Machine where the sequential minimal optimisation algorithm is used to train a support vector classifier. With the SMO, linear models may be used to implement non-linear class boundaries. As the meta-learner <italic>CostSensitiveClassifier</italic> works better with probability estimates, the SMO option <italic>BuildLogisticModels</italic> was set to <italic>True</italic>.</p>
                </list-item>
                <list-item>
                  <p><italic>J48</italic> is Weka's implementation of a C4.5 decision tree learner. <italic>J48</italic> was used for these experiments as it is not a black box approach and may provide added value to the classification tasks. <italic>MetaCost</italic> works better with unstable data and therefore the <italic>J48</italic> option <italic>Unpruned</italic> was set to <italic>True</italic>.</p>
                </list-item>
                <list-item>
                  <p><italic>RandomForest</italic> is an ensemble classifier that consists of many <italic>RandomTrees</italic>, in this case 10. The output of the <italic>RandomForest</italic> is the class that is the statistical mode of the class's output by the individual trees. Weka defaults were used for the classifier. As a Random Forest classifier is a bagged classifier, more computer memory is required to run them than for the other base classifiers used.</p>
                </list-item>
              </list>
            </p>
          </sec>
        </sec>
      </body>
      <back>
        <ack>
          <title>Acknowledgements</title>
          <p>I would like to thank the National Center for Biotechnology Information for creating and maintaining the PubChem resource.</p>
        </ack>
        <ref-list id="Bib1">
          <title>References</title>
          <ref-list>
            <ref id="CR1">
              <label>1.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>DiMasi</surname>
                    <given-names>JA</given-names>
                  </name>
                  <name>
                    <surname>Hansen</surname>
                    <given-names>RW</given-names>
                  </name>
                  <name>
                    <surname>Grabowski</surname>
                    <given-names>HG</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The price of innovation: new estimates of drug development costs</article-title>
                <source>Journal of Health Economics</source>
                <year>2003</year>
                <volume>22</volume>
                <fpage>151</fpage>
                <lpage>185</lpage>
                <pub-id pub-id-type="doi">10.1016/S0167-6296(02)00126-1</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR2">
              <label>2.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Leach</surname>
                    <given-names>AR</given-names>
                  </name>
                  <name>
                    <surname>Gillet</surname>
                    <given-names>VJ</given-names>
                  </name>
                </person-group>
                <source>An Introduction to Chemoinformatics</source>
                <year>2003</year>
                <publisher-loc>The Netherlands, Dordrecht</publisher-loc>
                <publisher-name>Kluwer Academic Publishers</publisher-name>
              </mixed-citation>
            </ref>
            <ref id="CR3">
              <label>3.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Bradley</surname>
                    <given-names>D</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Dealing with a data dilemma</article-title>
                <source>Nature Reviews: Drug Discovery</source>
                <year>2008</year>
                <volume>7</volume>
                <fpage>632</fpage>
                <lpage>633</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR4">
              <label>4.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Ehrman</surname>
                    <given-names>TM</given-names>
                  </name>
                  <name>
                    <surname>Barlow</surname>
                    <given-names>DJ</given-names>
                  </name>
                  <name>
                    <surname>Hylands</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Virtual Screening of Chinese Herbs with Random Forest</article-title>
                <source>J Chem Inf Model</source>
                <year>2007</year>
                <volume>47</volume>
                <issue>2</issue>
                <fpage>264</fpage>
                <lpage>278</lpage>
                <pub-id pub-id-type="doi">10.1021/ci600289v</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2sXjtVagtg%3D%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR5">
              <label>5.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Eitrich</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Kless</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Druska</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Meyer</surname>
                    <given-names>W</given-names>
                  </name>
                  <name>
                    <surname>Grotendorst</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Classification of Highly Unbalanced CYP450 Data of Drugs Using Cost Sensitive Machine Learning Techniques</article-title>
                <source>J Chem Inf Model</source>
                <year>2007</year>
                <volume>47</volume>
                <fpage>92</fpage>
                <lpage>103</lpage>
                <pub-id pub-id-type="doi">10.1021/ci6002619</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD28Xht1yiurrF</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR6">
              <label>6.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Chen</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>Wild</surname>
                    <given-names>DJ</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">PubChem BioAssays as a data source for predictive models</article-title>
                <source>Journal of Molecular Graphics and Modelling</source>
                <year>2009</year>
              </mixed-citation>
            </ref>
            <ref id="CR7">
              <label>7.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Witten</surname>
                    <given-names>IH</given-names>
                  </name>
                  <name>
                    <surname>Frank</surname>
                    <given-names>E</given-names>
                  </name>
                </person-group>
                <source>Data Mining: Practical machine learning tools and techniques</source>
                <year>2005</year>
                <publisher-loc>San Francisco</publisher-loc>
                <publisher-name>Morgan Kaufmann</publisher-name>
              </mixed-citation>
            </ref>
            <ref id="CR8">
              <label>8.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Bolton</surname>
                    <given-names>EE</given-names>
                  </name>
                  <name>
                    <surname>Wang</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Thiessen</surname>
                    <given-names>PA</given-names>
                  </name>
                  <name>
                    <surname>Bryant</surname>
                    <given-names>SH</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">PubChem: Integrated Platform of Small Molecules and Biological Activities</article-title>
                <source>Annual Reports in Computational Chemistry</source>
                <year>2008</year>
                <volume>4</volume>
                <fpage>217</fpage>
                <lpage>241</lpage>
                <pub-id pub-id-type="doi">10.1016/S1574-1400(08)00012-1</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXpsFWqsA%3D%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR9">
              <label>9.</label>
              <mixed-citation publication-type="other">Wang Y, Xiao J, Suzek TO, Zhang J, Wang J, Bryant SH: PubChem: a public information system for analyzing bioactivities of small molecules. Nucleic acids research. 2009, W623-33. 10.1093/nar/gkp456. 37 Web Server</mixed-citation>
            </ref>
            <ref id="CR10">
              <label>10.</label>
              <mixed-citation publication-type="other">PubChem Help: Sometime I see errors in the substance record, where I should report?. [<ext-link xlink:href="http://pubchem.ncbi.nlm.nih.gov/help.html" ext-link-type="uri">http://pubchem.ncbi.nlm.nih.gov/help.html</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR11">
              <label>11.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Liu</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Feng</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Young</surname>
                    <given-names>SS</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">PowerMV: A Software Environment for Molecular Viewing, Descriptor Generation, Data Analysis and Hit Evaluation</article-title>
                <source>J Chem Inf Model</source>
                <year>2005</year>
                <volume>45</volume>
                <fpage>515</fpage>
                <lpage>522</lpage>
                <pub-id pub-id-type="doi">10.1021/ci049847v</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2MXntFyqsQ%3D%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR12">
              <label>12.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Elkan</surname>
                    <given-names>C</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The Foundations of Cost-Sensitive Learning</article-title>
                <source>Proceedings of the Seventeenth International Conference on Artificial Intelligence: 4-10 August 2001; Seattle</source>
                <year>2001</year>
                <fpage>973</fpage>
                <lpage>978</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR13">
              <label>13.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Drummond</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Holte</surname>
                    <given-names>RC</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Cost curves: An improved Method for visualizing classifier performance</article-title>
                <source>Machine Learning</source>
                <year>2006</year>
                <volume>65</volume>
                <issue>1</issue>
                <fpage>95</fpage>
                <lpage>130</lpage>
                <pub-id pub-id-type="doi">10.1007/s10994-006-8199-5</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR14">
              <label>14.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Seo</surname>
                    <given-names>YW</given-names>
                  </name>
                  <name>
                    <surname>Sycara</surname>
                    <given-names>K</given-names>
                  </name>
                </person-group>
                <person-group person-group-type="editor">
                  <name>
                    <surname>Mchrotra</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>et</surname>
                    <given-names>al</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Cost-Sensitive Access Control for Illegitimate Confidential Access by Insiders</article-title>
                <source>Proceedings of IEEE Intelligence and Security Informatics: 23-24 May 2006</source>
                <year>2006</year>
                <fpage>117</fpage>
                <lpage>128</lpage>
                <pub-id pub-id-type="doi">10.1007/11760146_11</pub-id>
                <comment>San Diego: Berlin: Springer-Verlag; LNCS 3975</comment>
              </mixed-citation>
            </ref>
            <ref id="CR15">
              <label>15.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Lo</surname>
                    <given-names>HL</given-names>
                  </name>
                  <name>
                    <surname>Chang</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Chiang</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Hsiao</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Huang</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Kuo</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Lai</surname>
                    <given-names>W</given-names>
                  </name>
                  <name>
                    <surname>Yang</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Yeh</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Yen</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Lin</surname>
                    <given-names>S</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Learning to Improve Area-Under-FROC for Imbalanced Medical Data Classification Using an Ensemble Method</article-title>
                <source>SIGKDD Explorations</source>
                <year>2008</year>
                <volume>10</volume>
                <issue>2</issue>
                <fpage>43</fpage>
                <lpage>46</lpage>
                <pub-id pub-id-type="doi">10.1145/1540276.1540290</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR16">
              <label>16.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Sheng</surname>
                    <given-names>VS</given-names>
                  </name>
                  <name>
                    <surname>Ling</surname>
                    <given-names>CX</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Thresholding for Making Classifiers Cost-sensitive</article-title>
                <source>Proceedings of the Twenty-first National Conference on Artificial Intelligence: 16-20 July 2006; Boston</source>
                <year>2006</year>
                <fpage>476</fpage>
                <lpage>480</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR17">
              <label>17.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Hollmen</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Skubacz</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Taniguchi</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <person-group person-group-type="editor">
                  <name>
                    <surname>Ebechen</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Brebbia</surname>
                    <given-names>N</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Input dependent misclassification costs for cost-sensitive classifiers</article-title>
                <source>Data Mining II - Proceedings of the second international conference on data mining</source>
                <year>2000</year>
                <publisher-loc>Cambridge</publisher-loc>
                <publisher-name>MIT Press</publisher-name>
                <fpage>495</fpage>
                <lpage>503</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR18">
              <label>18.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Domingos</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">MetaCost: A general method for making classifiers cost-sensitive</article-title>
                <source>Proceedings of the Fifth ACM SIGKDD Int'l. Conf. on Knowledge Discovery &amp; Data Mining</source>
                <year>1999</year>
                <fpage>155</fpage>
                <lpage>164</lpage>
                <pub-id pub-id-type="doi">10.1145/312129.312220</pub-id>
                <comment>San Diego. ACM</comment>
              </mixed-citation>
            </ref>
            <ref id="CR19">
              <label>19.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Lipinski</surname>
                    <given-names>CA</given-names>
                  </name>
                  <name>
                    <surname>Lombardo</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Dominy</surname>
                    <given-names>BW</given-names>
                  </name>
                  <name>
                    <surname>Feeney</surname>
                    <given-names>PJ</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Experimental and computational approaches to estimate solubility and permeability in drug discovery and development settings</article-title>
                <source>Adv Drug Delivery Rev</source>
                <year>1997</year>
                <volume>23</volume>
                <issue>1-3</issue>
                <fpage>3</fpage>
                <lpage>25</lpage>
                <pub-id pub-id-type="doi">10.1016/S0169-409X(96)00423-1</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK2sXktlKlsQ%3D%3D</pub-id>
              </mixed-citation>
            </ref>
          </ref-list>
        </ref-list>
        <app-group>
          <app id="App1">
            <sec id="Sec17">
              <title>Electronic supplementary material</title>
              <p>
                <supplementary-material content-type="local-data" id="MOESM1" xlink:title="Electronic supplementary material">
                  <media mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="MediaObjects/13321_2009_21_MOESM1_ESM.XLS" position="anchor">
                    <caption xml:lang="en">
                      <p>Additional file 1: Virtual Screening Results. Excel spreadsheet containing all the results of the classification experiments. (XLS 76 KB)</p>
                    </caption>
                  </media>
                </supplementary-material>
                <supplementary-material content-type="local-data" id="MOESM2" xlink:title="Electronic supplementary material">
                  <media mimetype="application" mime-subtype="x-zip-compressed" xlink:href="MediaObjects/13321_2009_21_MOESM2_ESM.ZIP" position="anchor">
                    <caption xml:lang="en">
                      <p>Additional file 2: Virtual Screening Data Primary. Training and Testing primary screen datasets in CSV format. (ZIP 7 MB)</p>
                    </caption>
                  </media>
                </supplementary-material>
                <supplementary-material content-type="local-data" id="MOESM3" xlink:title="Electronic supplementary material">
                  <media mimetype="application" mime-subtype="x-zip-compressed" xlink:href="MediaObjects/13321_2009_21_MOESM3_ESM.ZIP" position="anchor">
                    <caption xml:lang="en">
                      <p>Additional file 3: Virtual Screening Data Primary. Training and Testing primary screen datasets in CSV format. (ZIP 17 MB)</p>
                    </caption>
                  </media>
                </supplementary-material>
                <supplementary-material content-type="local-data" id="MOESM4" xlink:title="Electronic supplementary material">
                  <media mimetype="application" mime-subtype="x-zip-compressed" xlink:href="MediaObjects/13321_2009_21_MOESM4_ESM.ZIP" position="anchor">
                    <caption xml:lang="en">
                      <p>Additional file 4: Virtual Screening Data Confirmatory. Training and Testing confirmatory screen datasets in CSV format. (ZIP 460 KB)</p>
                    </caption>
                  </media>
                </supplementary-material>
                <supplementary-material content-type="local-data" id="MOESM5" xlink:title="Electronic supplementary material">
                  <media mimetype="application" mime-subtype="x-zip-compressed" xlink:href="MediaObjects/13321_2009_21_MOESM5_ESM.ZIP" position="anchor">
                    <caption xml:lang="en">
                      <p>Additional file 5: Virtual Screening Data Mixed. Training and Testing primary/confirmatory screen datasets in CSV format. (ZIP 18 MB)</p>
                    </caption>
                  </media>
                </supplementary-material>
              </p>
            </sec>
            <sec id="Sec18">
              <title>Authorsâ original submitted files for images</title>
              <p>Below are the links to the authorsâ original submitted files for images.<supplementary-material content-type="local-data" id="MOESM6" xlink:title="Authorsâ original submitted files for images"><media mimetype="image" mime-subtype="png" xlink:href="MediaObjects/13321_2009_21_MOESM6_ESM.png" position="anchor"><caption xml:lang="en"><p>Authorsâ original file for figure 1</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM7" xlink:title="Authorsâ original submitted files for images"><media mimetype="image" mime-subtype="png" xlink:href="MediaObjects/13321_2009_21_MOESM7_ESM.png" position="anchor"><caption xml:lang="en"><p>Authorsâ original file for figure 2</p></caption></media></supplementary-material></p>
            </sec>
          </app>
        </app-group>
        <glossary>
          <title>Abbreviations</title>
          <def-list>
            <def-item>
              <term>SVM</term>
              <def>
                <p>Support Vector Machine</p>
              </def>
            </def-item>
            <def-item>
              <term>HTS</term>
              <def>
                <p>High-Throughput Screening</p>
              </def>
            </def-item>
            <def-item>
              <term>3D</term>
              <def>
                <p>3 Dimensional</p>
              </def>
            </def-item>
            <def-item>
              <term>CSC</term>
              <def>
                <p>Cost-Sensitive Classifier</p>
              </def>
            </def-item>
            <def-item>
              <term>CSV</term>
              <def>
                <p>Comma Separated Values</p>
              </def>
            </def-item>
            <def-item>
              <term>PS</term>
              <def>
                <p>Primary Screen</p>
              </def>
            </def-item>
            <def-item>
              <term>CS</term>
              <def>
                <p>Confirmatory Screen</p>
              </def>
            </def-item>
            <def-item>
              <term>SDF</term>
              <def>
                <p>Structure Data Format</p>
              </def>
            </def-item>
            <def-item>
              <term>SMO</term>
              <def>
                <p>Sequential Minimal Optimisation.</p>
              </def>
            </def-item>
          </def-list>
        </glossary>
        <notes notes-type="Misc">
          <title>Competing interests</title>
          <p>The author declares that they have no competing interests.</p>
        </notes>
      </back>
    </article>
