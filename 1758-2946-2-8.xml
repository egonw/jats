<?xml version="1.0"?>
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="research-article" xml:lang="en">
      <front>
        <journal-meta>
          <journal-id journal-id-type="publisher-id">13321</journal-id>
          <journal-title-group>
            <journal-title>Journal of Cheminformatics</journal-title>
            <abbrev-journal-title abbrev-type="publisher">J Cheminform</abbrev-journal-title>
          </journal-title-group>
          <issn pub-type="epub">1758-2946</issn>
          <publisher>
            <publisher-name>Springer International Publishing</publisher-name>
            <publisher-loc>Cham</publisher-loc>
          </publisher>
        </journal-meta>
        <article-meta>
          <article-id pub-id-type="publisher-id">BMC1758-2946-2-8</article-id>
          <article-id pub-id-type="manuscript">112</article-id>
          <article-id pub-id-type="doi">10.1186/1758-2946-2-8</article-id>
          <article-categories>
            <subj-group subj-group-type="heading">
              <subject>Research Article</subject>
            </subj-group>
          </article-categories>
          <title-group>
            <article-title xml:lang="en">Basic primitives for molecular diagram sketching</article-title>
          </title-group>
          <contrib-group>
            <contrib contrib-type="author" corresp="yes">
              <name>
                <surname>Clark</surname>
                <given-names>Alex M</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="corresp" rid="IDBMC1758294628_cor1">a</xref>
            </contrib>
            <aff id="Aff1">
              <label>1</label>
              <institution-wrap>
                <institution content-type="org-name">Molecular Materials Informatics, Inc</institution>
              </institution-wrap>
              <addr-line content-type="city">Montréal</addr-line>
              <addr-line content-type="state">QC</addr-line>
              <country country="CA">Canada</country>
            </aff>
          </contrib-group>
          <author-notes>
            <corresp id="IDBMC1758294628_cor1">
              <label>a</label>
              <email>HIDDEN</email>
            </corresp>
          </author-notes>
          <pub-date date-type="pub" publication-format="electronic">
            <day>5</day>
            <month>10</month>
            <year>2010</year>
          </pub-date>
          <pub-date date-type="collection" publication-format="electronic">
            <month>12</month>
            <year>2010</year>
          </pub-date>
          <volume>2</volume>
          <issue seq="8">1</issue>
          <elocation-id>8</elocation-id>
          <history>
            <date date-type="registration">
              <day>12</day>
              <month>8</month>
              <year>2010</year>
            </date>
            <date date-type="received">
              <day>12</day>
              <month>8</month>
              <year>2010</year>
            </date>
            <date date-type="accepted">
              <day>5</day>
              <month>10</month>
              <year>2010</year>
            </date>
            <date date-type="online">
              <day>5</day>
              <month>10</month>
              <year>2010</year>
            </date>
          </history>
          <permissions>
            <copyright-statement content-type="compact">© Clark; licensee BioMed Central Ltd. 2010</copyright-statement>
            <copyright-statement content-type="comment">This article is published under license to BioMed Central Ltd. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link xlink:href="http://creativecommons.org/licenses/by/2.0" ext-link-type="uri">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</copyright-statement>
            <copyright-year>2010</copyright-year>
            <copyright-holder>Clark; licensee BioMed Central Ltd.</copyright-holder>
            <license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/2.0">
              <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 2.0 International License (<ext-link xlink:href="https://creativecommons.org/licenses/by/2.0" ext-link-type="uri">https://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
            </license>
          </permissions>
          <abstract xml:lang="en" id="Abs1">
            <title>Abstract</title>
            <p>A collection of primitive operations for molecular diagram sketching has been developed. These primitives compose a concise set of operations which can be used to construct publication-quality 2 D coordinates for molecular structures using a bare minimum of input bandwidth. The input requirements for each primitive consist of a small number of discrete choices, which means that these primitives can be used to form the basis of a user interface which does not require an accurate pointing device. This is particularly relevant to software designed for contemporary mobile platforms. The reduction of input bandwidth is accomplished by using algorithmic methods for anticipating probable geometries during the sketching process, and by intelligent use of template grafting. The algorithms and their uses are described in detail.</p>
            <fig id="Figa" position="anchor">
              <graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2010_Article_112_Figa_HTML.gif" position="anchor" />
            </fig>
          </abstract>
          <kwd-group xml:lang="en">
            <title>Keywords</title>
            <kwd>Bond Order</kwd>
            <kwd>Ingenol</kwd>
            <kwd>Bond Geometry</kwd>
            <kwd>Default Bond</kwd>
            <kwd>Current Atom</kwd>
          </kwd-group>
          <custom-meta-group>
            <custom-meta>
              <meta-name>publisher-imprint-name</meta-name>
              <meta-value>Chemistry Central</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-issue-count</meta-name>
              <meta-value>1</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-article-count</meta-name>
              <meta-value>11</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-holder</meta-name>
              <meta-value>The Author(s)</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-year</meta-name>
              <meta-value>2010</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-contains-esm</meta-name>
              <meta-value>Yes</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-year</meta-name>
              <meta-value>2010</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-month</meta-name>
              <meta-value>8</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-day</meta-name>
              <meta-value>12</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-product</meta-name>
              <meta-value>ArchiveJournal</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-grants-type</meta-name>
              <meta-value>OpenChoice</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>metadata-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>abstract-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodypdf-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodyhtml-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bibliography-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>esm-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>online-first</meta-name>
              <meta-value>false</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-file-reference</meta-name>
              <meta-value>BodyRef/PDF/13321_2010_Article_112.pdf</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-type</meta-name>
              <meta-value>Typeset</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>target-type</meta-name>
              <meta-value>OnlinePDF</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-type</meta-name>
              <meta-value>OriginalPaper</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-primary</meta-name>
              <meta-value>Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computer Applications in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Documentation and Information in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Theoretical and Computational Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computational Biology/Bioinformatics</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-collection</meta-name>
              <meta-value>Chemistry and Materials Science</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>open-access</meta-name>
              <meta-value>true</meta-value>
            </custom-meta>
          </custom-meta-group>
        </article-meta>
        <notes notes-type="ESMHint">
          <title>Electronic supplementary material</title>
          <p>The online version of this article (doi:<ext-link xlink:href="10.1186/1758-2946-2-8" ext-link-type="doi">10.1186/1758-2946-2-8</ext-link>) contains supplementary material, which is available to authorized users.</p>
        </notes>
      </front>
      <body>
        <sec id="Sec1">
          <title>Introduction</title>
          <p>Molecular structure diagrams have been the mainstay of chemical communication since molecules began to be rationalised as Lewis structures. The basic ideas involved in representing structures have proven to be remarkably resilient [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. While typographic conventions used in the late 19th century differ slightly from modern publications, organic structures are mostly quite recognisable when compared to literature published more than a century ago.</p>
          <p>In recent decades, the process of creating molecular structure diagrams has steadily shifted towards use of computer software, which is now used exclusively for publications, and is in the process of replacing hand-drawings by way of electronic lab notebooks [<xref ref-type="bibr" rid="CR4">4</xref>]. There is now an abundance of software packages which allow the user to sketch a molecular diagram on a desktop or laptop computer, using the mouse and keyboard to specify the content and geometry of the molecule [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. There are also a number of algorithms in general use which allow molecular structure diagrams to be produced automatically using only the molecular topology [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]. The availability of information relating molecular connection tables to important properties has made possible the rise of the subfield of computational chemistry commonly known as cheminformatics [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>], and the usual data entry method for chemical structures is via software designed for sketching 2 D diagrams of molecules.</p>
          <p>The subject of this work is a slightly different perspective on the drawing of a 2 D molecular structure diagram. Assuming that the composition of the molecule is known, and the desired output is an arrangement of atoms and bonds onto a flat surface, the process of building up the diagram can be described as a series of primitive unit steps, leading to a molecular connection table, with 2 D coordinates for each atom [<xref ref-type="bibr" rid="CR13">13</xref>].</p>
          <p>In this work, we will explore an alphabet of primitives which has been chosen for the following properties:<list list-type="bullet"><list-item><p>small number of operation types</p></list-item><list-item><p>minimal degrees of freedom for input</p></list-item><list-item><p>opportunities for automated inference</p></list-item></list></p>
          <p>The primary motivation for abstracting the sketching process in such a way is the emergence of new hardware devices which are highly constrained in terms of user input, such as smartphones, tablets and netbooks. These devices often lack an accurate pointing device. Mobile devices with touch screens, for example, are effective for selecting objects, but they are much less effective for the precise positioning operations upon which conventional molecule drawing software relies. Mobile devices which lack a touch screen offer merely a keypad and directional cursor keys.</p>
          <p>By describing all of the unit primitives needed to produce a molecular structure diagram in such a way that none of them requires precise user-supplied position information, structure sketching becomes possible for environments in which the user input is limited to little more than a series of menu choices.</p>
        </sec>
        <sec id="Sec2">
          <title>Experimental</title>
          <p>The objective of this work is to describe a collection of primitive drawing operations which provides a comprehensive set of editing capabilities. These can be used to compose complex diagrams with minimal effort on behalf of the operator.</p>
          <p>Ideally, each primitive would be able to examine the molecule diagram thus far, determine what it is the user wants changed, and execute the change. In practice, several additional fields are required for most operations. The unit primitives which are described in this work operate as sequences of:<list list-type="bullet"><list-item><p>select <bold>subject</bold></p></list-item><list-item><p>select <bold>action</bold></p></list-item><list-item><p>select <bold>result</bold></p></list-item></list></p>
          <p>The <bold>subject</bold> is an annotation to the existing structure, which consists of:<list list-type="bullet"><list-item><p>current atom or current bond</p></list-item><list-item><p>a set of selected atoms</p></list-item></list></p>
          <p>At any time there may be a current atom or a current bond, but not both. Each atom of the existing structure is either selected or unselected. In the text that follows, the term <italic>subject atoms</italic> is defined as a set of:<list list-type="bullet"><list-item><p>all selected atoms, if there are any;</p></list-item><list-item><p><italic>or:</italic> the current atom, if there is one;</p></list-item><list-item><p><italic>or</italic>: the two atoms of the current bond, if there is one;</p></list-item><list-item><p><italic>else</italic>: an empty set.</p></list-item></list></p>
          <p>The <bold>action</bold> is the choice of primitive to apply to the current subject.</p>
          <p>For many primitives, there is just one possible outcome when applied to a particular subject, e.g. changing atoms to a specific element, for which it is appropriate to design the primitive to have an unambiguous effect. For some of the more complicated primitives, there could be more than one possible outcome, e.g. attaching a template with multiple possible geometries. In these cases, the primitive may choose to generate a number of <bold>results</bold>. The list of results should be sorted so that the most plausible result is first, and the remaining possibilities in order of decreasing relevance.</p>
          <p>When this scheme is mapped to a practical implementation of a user interface, the sequence can be described as:<list list-type="bullet"><list-item><p>select the atoms or bonds of interest</p></list-item><list-item><p>pick the action from a menu</p></list-item><list-item><p>if there is more than one result, and the best suggestion is not the desired one, pick from the list of possibilities</p></list-item></list></p>
          <p>The remainder of this section describes a minimal set of primitive classes which provide enough functionality to assemble a fully-featured molecular drawing package.</p>
        </sec>
        <sec id="Sec3">
          <title>Atoms</title>
          <p>Atom modification primitives are mostly straightforward and unambiguous, such as changing an element label, or altering atom-centred properties such as charge or radical count. The number of primitives required depends on the number of editable atom properties used to describe the molecular structure. The following primitive classes are representative.</p>
          <sec id="Sec4">
            <title>Add Atom</title>
            <p>A new atom is created. Its position is determined automatically. If the structure already contains one or more atoms, it is along the top and to the right of the existing atoms.</p>
            <p>One primitive is required for each element of the periodic table. The new atom will have the corresponding label, with default values for all other properties, and no bonds.</p>
          </sec>
          <sec id="Sec5">
            <title>Set Element Label</title>
            <p>The subject atoms have their atomic symbol changed. One primitive is required for each element of the periodic table. If there is no subject, then this primitive should be mapped to the corresponding <italic>Add Atom</italic> primitive.</p>
            <p>Variations on this primitive should allow arbitrary values to be entered via an input dialog, for symbols which are not atomic elements, such as abbreviations or Markush structures.</p>
          </sec>
          <sec id="Sec6">
            <title>Set Ionic Charge</title>
            <p>The subject atoms have their ionic charge set to a specific value, such as 0, -1, +1, etc. The primitives in this class can either specify exact values for the charge, or they can be increment/decrement operations.</p>
          </sec>
          <sec id="Sec7">
            <title>Set Unpaired Electrons</title>
            <p>The subject atoms have the number of unpaired electrons (also known as <italic>radical count</italic>) set to a specific value, where 0 is for diamagnetic atoms, 1 is for radicals, 2 is for carbene-like species, etc. One primitive is needed for each available value.</p>
          </sec>
          <sec id="Sec8">
            <title>Set Hydrogen Count</title>
            <p>Some molecular structure formats allow the number of implicit hydrogens to be specified [<xref ref-type="bibr" rid="CR14">14</xref>]. The default value should be <italic>automatic</italic>, whereby the number of implied hydrogens is calculated from the atomic element, charge, unpaired electron count and immediate bonding environment. A value of 0 implies that no additional hydrogens are attached, and a value of greater than zero specifies exactly how many are present. One primitive is needed for each possible value.</p>
          </sec>
          <sec id="Sec9">
            <title>Set Isotope</title>
            <p>The molecular mass of an atom defaults to the statistical average of its natural abundance. An atom can alternatively be defined to be a specific isotope. One primitive is required for each possible isotope of a given element.</p>
          </sec>
        </sec>
        <sec id="Sec10">
          <title>Bonds</title>
          <p>Modification of the properties of existing bonds is straightforward. Some interpretation is required in order to interpret the meaning of the incoming selection, but all changes can be applied in a straightforward way to the molecule connection table. Connecting or disconnecting atoms which already exist can be done explicitly with a different primitive class.</p>
          <sec id="Sec11">
            <title>Set Bond Order</title>
            <p>This class contains one primitive for each bond order supported by the molecular datastructure (e.g. 0, 1, 2, 3 and 4).</p>
            <p>If the subject contains a single atom, this primitive is mapped to <italic>New Bond with Order</italic>, in the <italic>Geometry</italic> section, which creates a new atom and a new bond.</p>
            <p>If the subject contains two atoms, and they are not currently bonded to each other, a new bond with the requested order is added between them.</p>
            <p>Otherwise, all bonds between any two atoms within the subject set are set to the indicated bond order. Any of these bonds which previously had a specific stereo style is reset to the default non-stereochemical bond type.</p>
          </sec>
          <sec id="Sec12">
            <title>Set Stereo Style</title>
            <p>This class contains one primitive for each explicit bond stereo-style supported by the molecular datastructure, which includes: inclined bonds (upward wedge); declined bonds (hashed wedge); and unknown stereochemistry (often drawn as a wavy line). When used correctly, these types are sufficient to unambiguously resolve most kinds of stereoisomerism.</p>
            <p>Similarly to the <italic>Set Bond Order</italic> class, if the subject contains a single atom, this primitive is mapped to <italic>New Bond with Stereo Style</italic>, in the <italic>Geometry</italic> section.</p>
            <p>If the subject contains two atoms which are not currently bonded to each other, a new bond of order 1 and the indicated stereo style is created. In the case of inclined or declined wedge bonds, the direction is arbitrary, and is defined by the current atom order.</p>
            <p>Otherwise, all bonds between any two atoms within the subject set become the focus of the operation: the bond stereo style is set to the indicated type. If the indicated type is inclined or declined, then any of the affected bonds which are already of this type have their [from, to] order reversed, which inverts the meaning of the wedge, potentially altering the stereochemistry.</p>
          </sec>
          <sec id="Sec13">
            <title>Connect Atoms</title>
            <p>Of all the subject atoms, any pairwise combination of two atoms which are not already bonded is considered. If there are any such atom pairs whose bond distances are approximately within the default bond distance (see Appendix 1) then all of these pairs are joined by adding a single bond between each pair.</p>
            <p>If there are unbonded pairs, but none of them are close enough to the default bond distance, then only the closest pair of atoms is connected.</p>
          </sec>
          <sec id="Sec14">
            <title>Disconnect Atoms</title>
            <p>Any bond for which both the participating atoms are a part of the subject is deleted. The atoms themselves are not otherwise modified.</p>
          </sec>
        </sec>
        <sec id="Sec15">
          <title>Deletion</title>
          <p>Removal of atoms and bonds is straightforward, and requires only a small amount of logic to interpret the subject and apply the action to the molecule connection table.</p>
          <sec id="Sec16">
            <title>Delete Atoms</title>
            <p>All of the atoms in the subject set are deleted, as are any bonds which are connected to them.</p>
          </sec>
          <sec id="Sec17">
            <title>Delete Bonds</title>
            <p>Any bond which is between two atoms within the subject set is deleted. The atoms themselves are not modified.</p>
          </sec>
          <sec id="Sec18">
            <title>Delete All</title>
            <p>All atoms and bonds are deleted.</p>
          </sec>
          <sec id="Sec19">
            <title>Merge Atoms</title>
            <p>Each atom in the subject set is examined to see if it is particularly close to any other atom in the structure, typically set to a tolerance level which is significantly shorter than the default bond distance (see Appendix 1). For each of the subject atoms, a list is made of all other atoms to which the distance falls within the tolerance. From this list, one atom is selected to be retained, using the merging rules described in Appendix 2. The coordinates of the retained atom are set to the average position of the atoms in the list.</p>
          </sec>
        </sec>
        <sec id="Sec20">
          <title>Movement</title>
          <p>While the unit primitives for grafting new fragments onto an existing molecular sketch are entirely sufficient for building up many complex molecules, there will always be structures which need to be fine tuned, or drawn with nonstandard parameters. This is often the case around heavily congested atoms for which there is no non-overlapping planar layout that adheres to common conventions.</p>
          <p>Detailed control over individual atom positions is straightforward to implement, but care is needed to ensure that the primitives accomplish common tasks with a minimal number of invocations.</p>
          <sec id="Sec21">
            <title>Move Atoms</title>
            <p>The subject atoms are moved in a specific direction. There are twelve primitives in this class: four directions (left, right, up, down) by three extents (small nudge, large nudge, move to furthest extent).</p>
            <p>The small and large nudges offset the X or Y coordinates of the subject atoms in the given direction by an offset, such as 0.1 or 0.5 Å.</p>
            <p>When moving to the furthest extent, the distance needed to move the subject atoms 1 Å beyond any of the other atoms in the molecule is calculated, and used as the offset.</p>
          </sec>
          <sec id="Sec22">
            <title>Scale Atoms</title>
            <p>Two primitives are defined for this class: grow and shrink, which correspond to scaling factors of 1.25 and 0.8, respectively.</p>
            <p>If the subject contains any selected atoms, then a central point is determined from the average positions of the selected atoms, unless there is also a current atom or bond, in which case its central position is used instead. Each of the subject atoms has its position recalculated by scaling its distance from the central point by the scaling factor associated with the primitive.</p>
            <p>If there are no selected atoms, but there is a current bond, then this primitive is mapped to the corresponding <italic>Scale Bond</italic> primitive.</p>
          </sec>
          <sec id="Sec23">
            <title>Scale Bond</title>
            <p>As for the <italic>Scale Atoms</italic> class, two primitives are defined: grow and shrink, which correspond to scaling factors of 1.25 and 0.8, respectively.</p>
            <p>The subject must include two atoms which are bonded to each other. Each side of the bond is assigned a weighting of 0, 0.5 or 1.</p>
            <p>If the bond is acyclic, then the atoms of the connected components on either side of the bond are counted. If one side forms a component with more atoms than the other, then the smaller side is assigned a weighting of 1 and the larger side a weighting of 0. If both sides have the same size, or the bond is cyclic, then both sides are assigned a weighting of 0.5.</p>
            <p>The bond length is scaled according to the scaling factor assigned to the primitive, and the weights that are assigned to both sides, i.e. if a side has a weighting of 0 it does not move. For acyclic bonds, when moving one side of the bond, all other atoms associated with that side are moved as well. For cyclic bonds, only the two atoms that make up the bond are extended.</p>
            <p>Figure <xref rid="Fig1" ref-type="fig">1</xref> illustrates increasing a bond length under three circumstances: unequal sides, equal sides, and a ring bond. The initial structures are shown on top, and the modified structures underneath.<fig id="Fig1"><label>Figure 1</label><caption xml:lang="en"><p><bold>Three examples of bond scaling</bold>. The selected bond is outlined. The bonds are elongated in the directions indicated by the arrows.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_112_Fig1_HTML.jpg" /></fig></p>
          </sec>
          <sec id="Sec24">
            <title>Flip Atoms</title>
            <p>Two primitives are defined for this class: horizontal and vertical flip.</p>
            <p>If the subject contains some number of selected atoms, then these atoms are flipped about the indicated axis. The origin of the axis is calculated as the average position of the selected atoms, unless there is also a current atom or bond, in which case its central position is used instead.</p>
            <p>If the subject only contains a current atom or bond, then the whole connected component is used as the subject. If the subject is empty, then all atoms are used as the subject.</p>
          </sec>
          <sec id="Sec25">
            <title>Rotate Atoms</title>
            <p>Primitives in this class are defined to be common rotation increments, such as ± 1°, ± 5°, ± 15° and ± 30°.</p>
            <p>The position of the rotation centre is determined by the average position of the selected atoms, unless there is also a current atom or bond, in which case its central position is used instead. A further special case is defined: if there are no selected atoms, but there is a current bond, and one end of the bond is terminal, then the terminal atom is rotated about the position defined by the non-terminal end of the bond.</p>
          </sec>
        </sec>
        <sec id="Sec26">
          <title>Geometry</title>
          <p>Because the information provided to the unit primitives cannot include spatial information such as bond direction, a crucial part of the design of the primitives is based on perception of atom geometry.</p>
          <p>One of the most important sketching primitives is the ability to create a new atom which is bonded to an existing atom. With a traditional user interface this is done by using the mouse to drag a bond line in a particular direction, thus specifying bond angle and distance. Lacking such input, it is necessary for algorithms to be able to estimate the geometry of the atom, and from it, the most likely directions for a new bond.</p>
          <p>Fortunately there are only a handful of geometry templates which are commonly observed in molecular diagrams, for atoms in environments which are not constrained by rings or heavy congestion. In this work, seven geometry templates are used. These are shown in Figure <xref rid="Fig2" ref-type="fig">2</xref>.<fig id="Fig2"><label>Figure 2</label><caption xml:lang="en"><p><bold>Common geometries found in molecular sketches</bold>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_112_Fig2_HTML.jpg" /></fig></p>
          <p>Most atom environments, when unconstrained, are drawn with complete or partial occupancy of one of these geometries. By examining the immediate bonding environment of an atom, it is often possible to make a reasonable estimate as to which of these geometry templates is most appropriate - and more importantly, which would be most appropriate in the context of adding an additional bond to a new atom. The process of assigning probable geometry based on topology and partial geometry is explained in Appendix 3.</p>
          <sec id="Sec27">
            <title>New Bond with Order</title>
            <p>When creating a new bond with a known bond order, the first step is to consider the subject atom with an additional bond with the requested order, connected to a newly created neutral carbon atom. In its new circumstances, the subject atom may have some number of preferred geometries. Consider the following cases shown in Figure <xref rid="Fig3" ref-type="fig">3</xref>: in each of these instances, the likely angles for the new bonds, indicated using dotted lines, are strongly suggested by the atom topology and the preexisting bond geometry.<fig id="Fig3"><label>Figure 3</label><caption xml:lang="en"><p><bold>Reasonable new bond geometries, based on existing layout and new bond order</bold>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_112_Fig3_HTML.jpg" /></fig></p>
            <p>In the examples shown in Figure <xref rid="Fig4" ref-type="fig">4</xref>, the geometry for the new bond is less clear, either because the incoming geometry is irregular or the valence is full. New bond positions are instead defined by the set of interior angles of adjacent neighbours.<fig id="Fig4"><label>Figure 4</label><caption xml:lang="en"><p><bold>Potential new bond geometries for atom centres which do not match a common template</bold>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_112_Fig4_HTML.jpg" /></fig></p>
            <p>Appendix 3 describes in detail the process of determining potential new bond angles. Once the list of angles has been generated, it is necessary to select one. For each of the angles, a point position is calculated by extending to the default bond length. The molecular congestion at each of these points is calculated (see Appendix 4), and the point which has the lowest congestion is used. A new carbon atom is created at this position, and a bond is created between the subject atom and the new atom.</p>
          </sec>
          <sec id="Sec28">
            <title>New Bond with Style</title>
            <p>The new atom position is determined using the same method as for <italic>New Bond with Order</italic>, given that the bond order is 1. The newly created bond has the indicated stereochemical style, e.g. inclined, declined or unknown. For wedge bonds, the atom direction emanates <italic>from</italic> the subject atom.</p>
          </sec>
          <sec id="Sec29">
            <title>New Bond with Geometry</title>
            <p>This class has one primitive for each of the 7 available geometries, which are shown in Figure <xref rid="Fig2" ref-type="fig">2</xref>. An attempt is made to create a new carbon atom and connect it to the subject atom via a single bond, using the indicated geometry.</p>
            <p>The implementation is related to that of <italic>New Bond with Order</italic>, but more specific: if the current geometry about the subject atom does not match the indicated geometry with one angle missing, then the operation will instead be mapped to the corresponding <italic>Set Geometry</italic> primitive. If it does match, then all of the angles which are implied by matching the partial geometry are scored by calculating the congestion at the point of the implied new atom (see Appendix 4). The angle which corresponds to an atom with the least congestion is used to create the new atom and bond.</p>
          </sec>
          <sec id="Sec30">
            <title>Set Geometry</title>
            <p>This class has one primitive for each of the 7 available geometries, as shown in Figure <xref rid="Fig2" ref-type="fig">2</xref>.</p>
            <p>Each of the subject atoms is examined in the context of the requested geometry type. If the current geometry about the atom matches the requested geometry, with some number of missing bonds, then this primitive has no effect. If a partial match is not possible, the geometry about the atom will be refitted, if possible, in order to make it compliant with the requested geometry.</p>
            <p>This primitive class is complementary with <italic>New Bond with Geometry</italic>. In Figure <xref rid="Fig5" ref-type="fig">5</xref>, for the top two examples, the existing bonds are able to be mapped in at least one way to the specified geometry, and so possible new bond angles are implied at the unoccupied positions. In the lower two examples, the geometries do not match, and the neighbours need to be refitted to the requested geometry.<fig id="Fig5"><label>Figure 5</label><caption xml:lang="en"><p><bold>Reconciling current geometry with a requested geometry</bold>. Existing bonds are indicated by solid lines and proposed positions by dotted lines.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_112_Fig5_HTML.jpg" /></fig></p>
            <p>For each pairwise combination of an existing bond and a bond from the geometry template, the template is rotated so that the two angles match. Of the remaining existing bonds, the angles are rotated so that they align with the closest angle from the rotated geometry template.</p>
            <p>Cases which require moving of a bond which is part of a ring system are disallowed. If there are multiple ways to refit the geometry, that with the smallest overall angular displacement is chosen. If the geometry template is asymmetric, the process is repeated with its mirror image.</p>
          </sec>
          <sec id="Sec31">
            <title>Switch Geometry</title>
            <p>One of the caveats of the methods by which the primitives select a new bond geometry is that there are often multiple choices which are quite similarly valid. Selecting the least congested position is the desired result more often than chance, but it is not uncommon for a more congested position to be preferred.</p>
            <p>For this primitive, the subject must indicate a bond, and only one side of the bond must be terminal. The non-terminal end of the bond is examined, and its most likely bond geometry is estimated, as if the selected bond were not present (see Appendix 3). If no compatible geometry is found, or the only compatible geometry contains no available positions, this operation is not carried out.</p>
            <p>Any missing angles, which are non-degenerate and differ from the original bond angle, are considered to be viable new angles for the selected bond. Two examples are shown in Figure <xref rid="Fig6" ref-type="fig">6</xref>. In the first case, the bent ether fits the trigonal geometry, and a single distinct alternate position is available. In the second case, the metal centre fits the regular octahedral geometry, which presents 4 alternate positions to which the bond can be rotated. When there are multiple possibilities, the bond is rotated to the position with the smallest angular increment in the anti-clockwise direction, which ensures that repeated use of this primitive will rotate the bond through all of the available positions.<fig id="Fig6"><label>Figure 6</label><caption xml:lang="en"><p><bold>Shifting a bond to a different position within the current geometry</bold>. Existing bonds are indicated by solid lines and proposed positions by dotted lines. The current bond is outlined, and each of the possible rotations is indicated.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_112_Fig6_HTML.jpg" /></fig></p>
          </sec>
        </sec>
        <sec id="Sec32">
          <title>Templates</title>
          <p>The grafting of predefined template fragments onto an existing molecular structure is a vital part of the sketching process. Chemical structures include a number of diagram motifs which occur throughout the field, e.g. small rings of sizes 3 through 6 are all but ubiquitous, and rings which are neither square nor hexagonal are difficult to draw precisely. Besides rings and fused ring systems, there are a number of chains, branched chains, larger rings and functional groups which are particularly common. Almost all molecule structure drawing software has some number of predrawn templates, which can be added to the structure as a separate component, or attached to an existing component. Suggested default templates can be found in the Supplementary Information.</p>
          <p>With a few exceptions, the algorithms needed for fusing an arbitrary structure with an arbitrary template fragment are non-trivial. Given the information allocated to the unit primitives described in this work, it is possible to specify information about the attachment site on the current structure, but not any information about which part of the template itself should be involved in the joining process.</p>
          <p>Because practicing chemists often work on a series of projects for which particular structural motifs are frequently encountered, but not all of them are common throughout chemistry as a whole, it is also important to ensure that the list of available templates can be extended easily.</p>
          <p>A standard convenience feature made available by almost all molecular drawing programs is the ability to copy portions of the current molecule onto a temporary container, often referred to as the clipboard, then paste them back later. For the purposes of this work, the clipboard should be considered as a single temporary template, i.e. the <italic>copy</italic> and <italic>cut</italic> actions that have become a standard part of the desktop metaphor place a single template onto the clipboard, and <italic>paste</italic> reads the template back out and applies it, using the same algorithm as is used for grafting predefined templates. The clipboard therefore shares the same primitive classes as the template functionality.</p>
          <sec id="Sec33">
            <title>Composing Templates</title>
            <sec id="Sec34">
              <title>Create Template</title>
              <p>This primitive class describes two operations: copying a molecular fragment to a temporary container, such as the system clipboard, and copying a molecular fragment to a persistent collection of fragments, such as a group of templates.</p>
              <p>The template fragment itself is generated by considering the subject atoms to define a substructure, which is excised from the current structure.</p>
              <p>If the subject atoms make up whole connected components, i.e. they are not bonded to any atoms which are not part of the subject, then the template fragment is taken to be the substructure in its entirety.</p>
              <p>Otherwise, all atoms which are immediately connected to one or more of the subject atoms are also included in the template fragment, but have their atom type converted into a placeholder atom label. In the examples shown in Figure <xref rid="Fig7" ref-type="fig">7</xref>, the placeholder atoms are denoted by the "*" symbol. These placeholder atoms are used as <italic>guide atoms</italic> for the primitive classes which make use of them, which is described below.<fig id="Fig7"><label>Figure 7</label><caption xml:lang="en"><p><bold>Examples of excising template fragments</bold>. The initial structure is shown on the left, with selected atoms outlined. The implied template is shown on the right, with guide atoms indicated by an asterisk.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_112_Fig7_HTML.jpg" /></fig></p>
            </sec>
          </sec>
          <sec id="Sec35">
            <title>Grafting Templates</title>
            <p>A logical primitive is defined for each template that is available to the user, including the clipboard, if it contains a suitable molecular structure. The template fragment is an implicit parameter of the primitive. When the operation is instigated, several classes of behaviour will be investigated, depending on the nature of the template fragment and the subject.</p>
            <p>The objective of the grafting procedure is to produce a list of putative new structures, each of which is a plausible way in which the template might be appended to the existing structure. Each of the following primitive classes is given an opportunity to generate some number of potential new structures, if appropriate.</p>
            <p>As described previously, templates may have special <italic>guide atoms</italic>. The presence of these atoms introduces opportunities for special behaviour. Using guide atoms is a way to reduce the degrees of freedom when it comes to the possible types of outcomes, which is useful when a template was designed with the intention of using a specific attachment mode. It is also necessary when the attachment modes favour nonstandard bond distances or angles, which would not ordinarily be generated by the geometry perception algorithms.</p>
            <sec id="Sec36">
              <title>Graft with No Connections</title>
              <p>When there are no subject atoms, adding a template to the current structure is straightforward. It needs to be placed in an area where its atoms and bonds do not interfere with any that already exist, e.g. to the right and centre of the current structure.</p>
              <p>All possible rotations of increments of 30° and 45° are included in the list of output structures. If the template contains guide atoms, they are stripped out.</p>
            </sec>
            <sec id="Sec37">
              <title>Graft with Atom Connection</title>
              <p>If there is one subject atom, this primitive applies. If the template contains guide atoms, they are stripped out.</p>
              <p>New structures are generated using the following overall sequence:<list list-type="order"><list-item><p>Define <italic>Mirror</italic> to be the mirror image equivalent of the <italic>Template</italic>.</p></list-item><list-item><p>Loop over each atom, <italic>N</italic>, in the template fragment.</p></list-item><list-item><p>Direct Connect {<italic>Template</italic>, <italic>N</italic>}.</p></list-item><list-item><p>Direct Connect {<italic>Mirror</italic>, <italic>N</italic>}.</p></list-item><list-item><p>Bridge Connect {<italic>Template</italic>, N}.</p></list-item><list-item><p>Bridge Connect {<italic>Mirror</italic>, N}.</p></list-item></list></p>
              <p>The connections are repeated with the mirror image of the template structure, in case it is not symmetrical. Generation of the mirror image is done by inverting one of the axes, e.g. <italic>let x</italic> = -<italic>x</italic>. If there are any bonds with <italic>inclined</italic> or <italic>declined</italic> stereochemistry, these are interchanged.</p>
              <p>There are two main methods used for grafting templates using a single atom as the frame of reference. Direct connection involves overlaying the subject atom of the initial structure with the iterated atom (<italic>N</italic>) of the template fragment, and finding suitable angles by which to rotate the fragment. Bridge connection involves creating a new bond between the two atoms, rather than mapping them onto each other.</p>
              <p>The direct connection algorithm starts by generating likely bond vectors for both sides, which is illustrated in the first row of Figure <xref rid="Fig8" ref-type="fig">8</xref>. The list of vectors on each side is composed from the same algorithms as used for determining the possible positions for a new single bond, as described for the <italic>New Bond with Order</italic> primitive class.<fig id="Fig8"><label>Figure 8</label><caption xml:lang="en"><p><bold>Grafting two templates by direct atom-to-atom connection</bold>. The input structures are shown with potential bond directions drawn as dotted lines. The unique set of grafted structures is shown underneath.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_112_Fig8_HTML.jpg" /></fig></p>
              <p>Both sets of angles are iterated over (θ<sub>1</sub> and θ<sub>2</sub>). The template fragment is translated so that atom <italic>N</italic> is superimposed on top of the subject atom from the starting structure. The template fragment is rotated by θ<sub>1</sub>-θ<sub>2</sub>+180°, about the atom <italic>N</italic>. The two fragments are then combined, and the result recorded.</p>
              <p>The bridge connection method involves essentially the same procedure, except that the template fragment is translated so that atom <italic>N</italic> is superimposed on top of a bond projecting from the subject atom with the angle θ<sub>1</sub> and an extent equal to the default bond length. Rather than merging the two reference atoms together, a single bond is used to connect them. The results of this grafting are shown in Figure <xref rid="Fig9" ref-type="fig">9</xref>, which use the same input structure and template fragment as for Figure <xref rid="Fig8" ref-type="fig">8</xref>.<fig id="Fig9"><label>Figure 9</label><caption xml:lang="en"><p><bold>Grafting two templates by bridged atom-to-atom connection</bold>. The superimposed bonds are shown as dotted lines.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_112_Fig9_HTML.jpg" /></fig></p>
              <p>For both connection methods, and for all of the other primitives described in this section, the combination of the initial structure and a template structure can require some additional cleanup, since atoms and bonds can overlap. Overlapping atoms, and redundant bonds, are merged together, as described in Appendix 2.</p>
            </sec>
            <sec id="Sec38">
              <title>Graft with Bond Connection</title>
              <p>If there are two subject atoms, and they are bonded to each other, this primitive applies. If the template contains guide atoms, they are stripped out.</p>
              <p>New structures are generated using the following overall sequence:<list list-type="order"><list-item><p>Define <italic>Mirror</italic> to be the mirror image equivalent of the <italic>Template</italic>.</p></list-item><list-item><p>Loop over each bond, <italic>N</italic>, in the template fragment.</p></list-item><list-item><p>Align Bonds Parallel {<italic>Template</italic>, <italic>N</italic>}.</p></list-item><list-item><p>Align Bonds Parallel {<italic>Mirror</italic>, <italic>N</italic>}.</p></list-item><list-item><p>Align Bonds Anti-Parallel {<italic>Template</italic>, <italic>N</italic>}.</p></list-item><list-item><p>Align Bonds Anti-Parallel {<italic>Mirror</italic>, <italic>N</italic>}.</p></list-item></list></p>
              <p>Alignment steps are done by first translating the fragment so that the centroid of the bond, <italic>N</italic>, is superimposed on top of the centroid of the subject bond. The template fragment is then rotated so that the matched bonds are parallel or anti-parallel, which is illustrated in Figure <xref rid="Fig10" ref-type="fig">10</xref>.<fig id="Fig10"><label>Figure 10</label><caption xml:lang="en"><p><bold>Grafting two templates by aligning onto matched bonds</bold>. The existing bonds that are superimposed are outlined.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_112_Fig10_HTML.jpg" /></fig></p>
              <p>In each case, the atoms associated with the matched bonds are merged together, using the method described in Appendix 2, except that the coordinates of the atoms from the input structure are always retained, which is relevant in cases where the bonds are of different lengths. Any remaining atoms which happen to overlap are merged as described in the appendix.</p>
            </sec>
            <sec id="Sec39">
              <title>Graft with Multiple Connections</title>
              <p>If there are more than two subject atoms, or there are two subject atoms and they are not bonded to one another, this primitive applies. If the template contains guide atoms, they are stripped out.</p>
              <p>New structures are generated using the following overall sequence. The same steps are repeated with the mirror image of the template fragment.<list list-type="order"><list-item><p>Loop over each atom, <italic>N</italic><sub><italic>1</italic></sub> , in the template fragment.</p></list-item><list-item><p>Translate the atom <italic>N</italic><sub><italic>1</italic></sub> onto the first subject atom.</p></list-item><list-item><p>Loop over each atom, <italic>N</italic><sub><italic>2</italic></sub> , in the template fragment (<italic>N</italic><sub><italic>1</italic></sub> ≠ <italic>N</italic><sub><italic>2</italic></sub> ).</p></list-item><list-item><p>Rotate the template fragment about <italic>N</italic><sub><italic>1</italic></sub> so that the direction of the <italic>N</italic><sub><italic>1</italic></sub><italic>N</italic><sub><italic>2</italic></sub> vector matches that of the first two subject atoms.</p></list-item><list-item><p>Match all remaining atoms.</p></list-item></list></p>
              <p>In step 4, the position of the first subject atom is used as the axis of rotation, so that the directions of the first two atoms are aligned. In the example shown in Figure <xref rid="Fig11" ref-type="fig">11</xref>, the subject consists of 4 selected atoms, which are labelled S1 through S4, while the two template fragment atoms of iteration are labelled N1 and N2.<fig id="Fig11"><label>Figure 11</label><caption xml:lang="en"><p><bold>Grafting two templates by matching multiple atoms</bold>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_112_Fig11_HTML.jpg" /></fig></p>
              <p>If the position of the atom <italic>N</italic><sub><italic>2</italic></sub> from the template fragment does not now overlap the position of the second subject atom, then the graft is rejected. Once the first two atoms are aligned and matched, the remaining subject atoms are each required to overlap with one of the template atoms. If any of them do not, the graft is rejected.</p>
              <p>Once all of the atoms are matched, the fragments are merged, as described in Appendix 2, and a new structure is added to the list.</p>
            </sec>
            <sec id="Sec40">
              <title>Graft with One Guide Atom</title>
              <p>If there is one subject atom, and the template contains one guide atom, and the guide atom has one adjacent neighbour, this primitive applies.</p>
              <p>Grafting a template containing a single guide atom to a single subject atom has a similar effect to the <italic>bridge connect</italic> variant of the <italic>Graft with Atom Connection</italic> primitive, except with less degrees of freedom, because there is only one applicable template atom, and the projection direction and magnitude is defined by the guide atom.</p>
              <p>The list of projection angles emerging from the subject atom is calculated. These angles are matched against the angle formed from the guide to its neighbour. In the example shown in Figure <xref rid="Fig12" ref-type="fig">12</xref>, the input structure is benzene, with a single subject atom. The template is triisopropylsiloxy, where the geometry about the oxygen is drawn in a linear fashion, rather than the more commonly used bent orientation, due to congestion.<fig id="Fig12"><label>Figure 12</label><caption xml:lang="en"><p><bold>Grafting of a template with a single guide atom</bold>. The calculated new bond position for the substrate is indicated with a dotted line, and the guide atom of the template is indicated by an asterisk.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_112_Fig12_HTML.jpg" /></fig></p>
              <p>The bond distance is taken from the distance between the guide atom and its neighbour, rather than using the default bond distance. As with the other grafting primitives, the process is repeated with the mirror image of the template fragment. Once the grafting is complete, the bond connecting the guide atom to the rest of the template fragment is attached to the subject atom, and the guide atom is deleted. The remaining atoms are merged together if there is any overlap.</p>
              <p>The main benefit of this primitive arises when a template is to be affixed using an irregular or non-obvious geometry, but it is also a way to ensure that a specific template connection point is used preferentially.</p>
            </sec>
            <sec id="Sec41">
              <title>Graft with One Guide Bond</title>
              <p>If there are two subject atoms, and they are bonded to each other, and the template contains one guide atom, and the guide atom has one adjacent neighbour, this primitive applies.</p>
              <p>The template grafting is done by mapping the subject bond and the template fragment bond to each other. There are 4 base permutations, obtained by using the template fragment vs. its mirror image, and aligning the matched bonds in both parallel and anti-parallel fashion.</p>
              <p>There is a further bifurcation if the two bonds differ in length: in one case the guide atom is mapped onto the first subject atom, and in the other case the atom adjacent to the guide atom is mapped onto the second subject atom, which is illustrated in Figure <xref rid="Fig13" ref-type="fig">13</xref>. On the left are the input structure (below) and the template fragment (above). On the right are the two distinct possible results, one for each of the two possible bond lengths. For each of the permutations, the mapping atoms and bonds are merged, as are any atoms which coincidentally overlap.<fig id="Fig13"><label>Figure 13</label><caption xml:lang="en"><p><bold>Grafting of a template by matching a bond with a template atom connected to a single guide atom</bold>. The bonds used to superimpose the structures are outlined. The grafted structure is shown underneath.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_112_Fig13_HTML.jpg" /></fig></p>
              <p>This primitive is useful as a constrained case of the <italic>Graft with One Guide Atom</italic> primitive, because both of the connection angles and the bond distance can be defined prior to the grafting process, which is particularly useful if the subject contains an irregular geometry or nondefault bond distance.</p>
            </sec>
            <sec id="Sec42">
              <title>Graft with Multiple Guide Atoms</title>
              <p>If there is at least one subject atom, and the template contains at least one guide atom, this primitive applies in the following cases:<list list-type="order"><list-item><p>There is one subject atom and one guide atom, and the guide atom has more than one neighbour.</p></list-item><list-item><p>There are 2 or more subject atoms, and the number of guide atoms is equal to the number of subject atoms.</p></list-item></list></p>
              <p>The first case is dealt with in a similar way to the <italic>Graft with One Guide Atom</italic> primitive. Bond angle projections are generated from the source atom. For the template fragment, a median angle is generated, by considering the angles between the guide atom and the atoms adjacent to it. In the example shown in Figure <xref rid="Fig14" ref-type="fig">14</xref>, the subject is a ruthenium centre which has three substituents already, with a geometry that is compatible with a regularly drawn octahedral centre. One of the three possible projected bond angles emanating from the ruthenium atom is shown. The template is a tridentate ligand, in which the guide atom indicates the position of the chelated metal. The median angle between the guide atom and its neighbours is aligned anti-parallel to the substrate vector, to produce the result shown.<fig id="Fig14"><label>Figure 14</label><caption xml:lang="en"><p><bold>Grafting of a template by matching an atom to a guide atom with multiple neighbours</bold>. The input structure shows one of the possible bond directions as a dotted line. The template fragment is annotated by a dotted line showing the composite direction implied by the orientation of the guide atom.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_112_Fig14_HTML.jpg" /></fig></p>
              <p>The second case is handled using the same technique as for <italic>Graft with Multiple Connections</italic>, except that the guide atoms are used to map the template fragment. As shown in Figure <xref rid="Fig15" ref-type="fig">15</xref>, the two guide atoms are aligned onto the two subject atoms.<fig id="Fig15"><label>Figure 15</label><caption xml:lang="en"><p><bold>Grafting of a template by matching multiple atoms to multiple guide atoms</bold>. The selected atoms of the input structure are outlined, while the guide atoms are indicated using asterisks.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_112_Fig15_HTML.jpg" /></fig></p>
              <p>When any successful matches are found, in which all of the guide atoms can be mapped onto a subject atom, the structures are merged together and the guide atoms are deleted.</p>
            </sec>
          </sec>
          <sec id="Sec43">
            <title>Applying Grafted Templates</title>
            <p>After each of the primitives described above has had its chance to generate some number of putative new structures, the result list is processed. First, the list is trimmed such that whenever any two structures are found to be equivalent, one of the structures is removed from the list. The method used to decide whether two structures are equivalent is described in Appendix 5.</p>
            <p>Once the unique set of structures is obtained, they must then be scored. The objective of scoring is to present the most feasible fused structures first, such that the user is most likely to see the desired result presented first and foremost. In cases where it is clear that some structures are significantly more reasonable than others (e.g. some of the results obey the Lewis octet rule, while the others feature pentavalent carbon atoms), then some of the results can be omitted.</p>
            <p>The score for each grafted template result is computed by adding the following terms, where lower is better:<list list-type="order"><list-item><p>The total congestion of the molecule (see Appendix 4).</p></list-item><list-item><p>+1 for each atom that was merged with another atom due to positional overlap.</p></list-item><list-item><p>+50 for each atom of element type C, N, O, P or S which is clearly sp<sup>3</sup>, sp<sup>2</sup> or sp hybridised, and received a new bond which was not positioned at an angle 120° (sp<sup>3</sup> and sp<sup>2</sup>) or 180° (sp) from its neighbours, with a tolerance of 5°.</p></list-item><list-item><p>+1000 for every carbon or nitrogen atom with a total bond order of 5 or more.</p></list-item><list-item><p>-1 for every guide atom involved in the grafting process.</p></list-item></list></p>
            <p>The scoring system heavily favours regular bond angles, prefers to add new atoms in less congested orientations, and encourages avoidance of certain types of impossible structures.</p>
            <p>If the best available structure has a score of less than 1000, then all structures with a score of 1000 or more are excluded.</p>
            <p>Once the scoring is complete, the structures are ordered so that the results with the lowest scores are shown first. For user interface purposes, it is appropriate to allow the user to traverse the list of potential structures, and select the desired result, if there is more than one. The best scoring result is frequently the intended result of the operation.</p>
          </sec>
        </sec>
        <sec id="Sec44" sec-type="results">
          <title>Results</title>
          <p>The unit primitives which have been described thus far provide a way to draw or modify structure diagrams with a small number of steps and a much lower input bandwidth than would be required from a conventional software package which relies on a pixel-perfect pointing device, such as a mouse or trackpad. The following examples illustrate the steps required in order to draw three molecules from scratch, using the primitives described in this work.</p>
          <sec id="Sec45">
            <title>Example 1: Aspirin</title>
            <p>The first example, shown in Figure <xref rid="Fig16" ref-type="fig">16</xref>, illustrates the steps required to draw a simple organic molecule: acetyl salicylic acid (aspirin) [<xref ref-type="bibr" rid="CR15">15</xref>]. Starting with an empty molecule, the 9 steps are shown below.<fig id="Fig16"><label>Figure 16</label><caption xml:lang="en"><p><bold>Drawing aspirin by applying a stepwise sequence of primitives</bold>. The selected or current atoms/bonds are shown as dotted outlines on the structure immediately preceding the primitive operation.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_112_Fig16_HTML.jpg" /></fig></p>
            <p>
              <list list-type="alpha-lower">
                <list-item>
                  <p><italic>Graft with No Connections</italic>: benzene</p>
                </list-item>
                <list-item>
                  <p><italic>New Bond with Order</italic>: 1</p>
                </list-item>
                <list-item>
                  <p><italic>New Bond with Order</italic>: 2</p>
                </list-item>
                <list-item>
                  <p>
                    <italic>Switch Geometry</italic>
                  </p>
                </list-item>
                <list-item>
                  <p><italic>New Bond with Order</italic>: 1</p>
                </list-item>
                <list-item>
                  <p><italic>Set Element Label</italic>: O</p>
                </list-item>
                <list-item>
                  <p><italic>New Bond with Order</italic>: 1</p>
                </list-item>
                <list-item>
                  <p><italic>Set Element Label</italic>: O</p>
                </list-item>
                <list-item>
                  <p><italic>Graft with Atom Connection</italic>: acetyl</p>
                </list-item>
              </list>
            </p>
          </sec>
          <sec id="Sec46">
            <title>Example 2: Ingenol</title>
            <p>The natural product <italic>ingenol</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] can be drawn using the steps shown below, illustrated in Figure <xref rid="Fig17" ref-type="fig">17</xref>.<fig id="Fig17"><label>Figure 17</label><caption xml:lang="en"><p><bold>Drawing ingenol by applying a stepwise sequence of primitives</bold>. The selected or current atoms/bonds are shown as dotted outlines on the structure immediately preceding the primitive operation.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_112_Fig17_HTML.jpg" /></fig></p>
            <p>
              <list list-type="alpha-lower">
                <list-item>
                  <p><italic>Graft with No Connections</italic>: cycloheptane</p>
                </list-item>
                <list-item>
                  <p><italic>Graft with Multiple Connections</italic>: cycloheptane</p>
                </list-item>
                <list-item>
                  <p>
                    <italic>Delete Atoms</italic>
                  </p>
                </list-item>
                <list-item>
                  <p><italic>Graft with Bond Connection</italic>: cyclopentane</p>
                </list-item>
                <list-item>
                  <p><italic>Graft with Bond Connection</italic>: cyclopropane</p>
                </list-item>
                <list-item>
                  <p><italic>New Bond with Order</italic>: 2</p>
                </list-item>
                <list-item>
                  <p><italic>Flip Atoms</italic>: vertical. Note that the two atoms making up the double bond are <italic>selected</italic>, while the source of the terminal bond is the <italic>current atom</italic>.</p>
                </list-item>
                <list-item>
                  <p><italic>Set Stereo Style</italic>: inclined</p>
                </list-item>
                <list-item>
                  <p><italic>Set Stereo Style</italic>: inclined. Note that this reverses the direction of the already extant wedge.</p>
                </list-item>
                <list-item>
                  <p><italic>Set Bond Order</italic>: 2</p>
                </list-item>
                <list-item>
                  <p><italic>New Bond with Order</italic>: 1</p>
                </list-item>
                <list-item>
                  <p><italic>New Bond with Stereo Style</italic>: inclined</p>
                </list-item>
                <list-item>
                  <p><italic>New Bond with Stereo Style</italic>: declined</p>
                </list-item>
                <list-item>
                  <p><italic>New Bond with Geometry</italic>: tetrahedral (variant #1). Note this primitive is issued twice, in order to create two new bonds.</p>
                </list-item>
                <list-item>
                  <p><italic>New Bond with Order</italic>: 1</p>
                </list-item>
                <list-item>
                  <p><italic>Set Element Label</italic>: O</p>
                </list-item>
                <list-item>
                  <p><italic>Set Element Label</italic>: H</p>
                </list-item>
              </list>
            </p>
          </sec>
          <sec id="Sec47">
            <title>Example 3: Organometallic catalytic intermediate</title>
            <p>The gold-based catalytic intermediate for a carboxylation reaction [<xref ref-type="bibr" rid="CR17">17</xref>] is drawn using the steps listed below, starting from a single gold atom, and illustrated in Figure <xref rid="Fig18" ref-type="fig">18</xref>.<fig id="Fig18"><label>Figure 18</label><caption xml:lang="en"><p><bold>Drawing an organometallic catalytic intermediate by applying a stepwise sequence of primitives</bold>. The selected or current atoms/bonds are shown as dotted outlines on the structure immediately preceding the primitive operation.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2010_Article_112_Fig18_HTML.jpg" /></fig></p>
            <p>
              <list list-type="alpha-lower">
                <list-item>
                  <p><italic>Graft with Atom Connection</italic>: cyclopropane</p>
                </list-item>
                <list-item>
                  <p><italic>Set Bond Order</italic>: 2</p>
                </list-item>
                <list-item>
                  <p><italic>Set Element Label</italic>: N</p>
                </list-item>
                <list-item>
                  <p><italic>New Bond with Order</italic>: 1</p>
                </list-item>
                <list-item>
                  <p><italic>Graft with Atom Connection</italic>: benzene</p>
                </list-item>
                <list-item>
                  <p><italic>New Bond with Stereo Style</italic>: declined</p>
                </list-item>
                <list-item>
                  <p><italic>New Bond with Stereo Style</italic>: inclined</p>
                </list-item>
                <list-item>
                  <p><italic>New Bond with Order</italic>: 1. Note this primitive is issued twice, in order to create two new bonds for each of the selected atoms.</p>
                </list-item>
                <list-item>
                  <p><italic>Create Template</italic>: copy to clipboard.</p>
                </list-item>
                <list-item>
                  <p><italic>Graft with One Guide Atom</italic>: paste from clipboard.</p>
                </list-item>
                <list-item>
                  <p><italic>Scale Atoms</italic>: grow</p>
                </list-item>
                <list-item>
                  <p><italic>New Bond with Geometry</italic>: linear</p>
                </list-item>
                <list-item>
                  <p><italic>Set Element Label</italic>: O</p>
                </list-item>
                <list-item>
                  <p><italic>New Bond with Geometry</italic>: linear</p>
                </list-item>
                <list-item>
                  <p><italic>Graft with Bond Connection</italic>: acetyl</p>
                </list-item>
                <list-item>
                  <p><italic>Graft with Atom Connection</italic>: cyclopentadiene</p>
                </list-item>
                <list-item>
                  <p><italic>Set Element Label</italic>: N</p>
                </list-item>
                <list-item>
                  <p><italic>Set Element Label</italic>: O</p>
                </list-item>
              </list>
            </p>
          </sec>
        </sec>
        <sec id="Sec48" sec-type="conclusions">
          <title>Conclusions</title>
          <p>A collection of unit primitives for sketching molecular diagrams has been described. It is complete, such that complex molecules can be drawn by stringing together a series of these primitives. It is efficient, insofar as the more regular components of a chemical structure can be drawn using a small number of primitives, since only a very small amount of information must be transmitted from the user in order for the algorithms to infer the intent. Less regular features can be created by manipulating atom positions or angles using a variety of low level primitives, but a number of implicit shortcuts can be exploited to keep repetitive actions to a minimum.</p>
          <p>Several representative examples have been shown, which illustrate the relatively small number of steps and low information content necessary to draw complex molecular geometries, and obtain publication-quality depiction layout coordinates.</p>
          <p>The primitives described in this work provide the tools needed to build a user interface in which input is limited to selecting atoms and picking from menu choices. The interface can expose the primitives by several means, such as menu bars, icon toolbars, keyboard shortcuts, etc. As long as all of the primitives are conveniently available, the user interface will provide a complete and efficient molecule drawing tool.</p>
          <p>These primitives have been implemented in a commercial software product called the Mobile Molecular DataSheet (MMDS), which is available for BlackBerry smartphones and iPhone/iPod/iPad devices [<xref ref-type="bibr" rid="CR18">18</xref>]. Both versions offer access to the same basic primitives, but with different input techniques due to the differences between the devices.</p>
          <p>While the motivation for this work arose from the need to provide molecular sketching capabilities on mobile devices with tiny screens and lack of accurate pointing devices, the set of primitives has applicability outside of this niche.</p>
          <p>One analogous situation is found in web-based applications where the capabilities of the browser must be assumed to be a lowest common denominator, which requires that the web server do most of the work [<xref ref-type="bibr" rid="CR19">19</xref>]. Under these circumstances, each user action can require a round trip to and from the server, which creates a low input bandwidth constraint, making the challenges quite similar to those faced by a mobile application. At the other end of the scale, sketcher applications being used on workstations or laptop computers with a mouse or trackpad could in some cases be improved by implementing a subset of these primitives, especially the template grafting algorithms, and providing them as additional tools.</p>
          <p>The primitives described in this work were designed for the purpose of using them to compose a user interface, but they may find applicability as part of scripted processes. For example, when producing a series of chemical structures as part of a combinatorial library [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>] or some other <italic>de novo</italic> series [<xref ref-type="bibr" rid="CR22">22</xref>–<xref ref-type="bibr" rid="CR24">24</xref>], it may be desirable to apply additional functionalisation, e.g. adding a new atom bonded to an existing atom, or joining two fragments to each other with some number of shared atoms. If the structural modifications were to be expressed in terms of these primitives, for a single substrate or an analogous series of them, the process of searching for a well arranged and aesthetically viable result could be significantly simplified.</p>
        </sec>
        <sec id="Sec49">
          <title>Appendices</title>
          <sec id="Sec50">
            <title>Appendix 1: Coordinates</title>
            <p>Because a molecular sketch does not correspond to a physical model, the 2 D coordinates of the atoms are chosen so that they can be presented on a screen or a piece of paper, in such a way that chemists can quickly perceive the structural features and be able to ascertain stereochemistry from the layout and additional annotations.</p>
            <p>The choice of units for the coordinates is arbitrary, but in this work, Angstroms are used. The default unit of distance between any two atoms is 1.5 Å, which applies regardless of atom and bond type.</p>
            <p>Any two atoms that are closer than 0.2 Å are considered to be <italic>overlapping</italic>. Some of the algorithms described in this work consider overlapping atoms as a cue to merge two atoms together. Otherwise, the presence of overlapping atoms is generally considered to be an error state, since this makes visual perception of a diagram difficult.</p>
          </sec>
          <sec id="Sec51">
            <title>Appendix 2: Merging atoms and bonds</title>
            <p>The template grafting algorithms described in this work mostly operate by joining specific atoms together. While these atoms are merged, bonded or deleted according to the algorithm, there is also the possibility for additional atoms to overlap. This situation is dealt with according to the following steps.</p>
            <p>The composite structure is partitioned into its two sources, i.e. atoms that originated from the starting structure, and atoms that originated from the grafted fragment. Pairwise combinations of these atoms are examined to see if they overlap. When an overlap is found, one atom must be retained, and the other atom deleted. Before the other atom is deleted, its bonds must be reassigned to the retained atom.</p>
            <p>The decision as to which atom to retain is made based on how <italic>exotic</italic> each atom is, which is calculated by assigning one point for each condition that applies:<list list-type="bullet"><list-item><p>Having an element label other than carbon</p></list-item><list-item><p>Non-zero charge</p></list-item><list-item><p>Any unpaired electrons</p></list-item><list-item><p>Non-default isotope abundance</p></list-item><list-item><p>Specific non-automatic hydrogen count</p></list-item></list></p>
            <p>The most exotic atom is retained, or the first one, if they are equally so.</p>
            <p>During the merging process, it is possible to create duplicate bonds. A similar process is used to decide which bond to keep. The <italic>exoticness</italic> of a bond is assigned by one point for each of:<list list-type="bullet"><list-item><p>Bond order other than 1</p></list-item><list-item><p>Any stereochemical assignment</p></list-item></list></p>
            <p>As for atoms, the first bond is retained in the event of a draw.</p>
            <p>Other primitives besides template grafting also have need to merge together atoms which happen to overlap. In these cases the same procedure is used, but without the partitioning.</p>
          </sec>
          <sec id="Sec52">
            <title>Appendix 3</title>
            <p>For many of the primitives described in this work, it is necessary to produce a list of potential angles for a new bond that will be created with a particular source atom and bond order in mind. When the list of angles produced contains the result which is desired by the user, the amount of effort required to draw the structure is considerably reduced.</p>
            <p>The following sequence is used to obtain a list of potential new bond angles:<list list-type="order"><list-item><p>If the atom is isolated, return four angles, aligned on the X and Y axes.</p></list-item><list-item><p>Match the atom's bond topology to likely geometry templates (see Figure <xref rid="Fig2" ref-type="fig">2</xref>), and if any matches are possible, these are used.</p></list-item><list-item><p>Otherwise, return a series of median-cut angles.</p></list-item></list></p>
            <p>Bond geometries are enumerated by considering the element, existing bond orders and the order of the new bond to be created. From this information, some number of plausible bond geometry templates may be produced, using the following sequence:<list list-type="order"><list-item><p>If the atom is terminal:<list list-type="alpha-lower"><list-item><p>a. If the atom is either carbon or nitrogen, and the future bonding pattern is either alkyne-like or allene-like, classify as <italic>linear</italic>.</p></list-item><list-item><p>If the atom is not in the <italic>s-</italic>block or the <italic>p</italic>-block, classify as being either of the two <italic>octahedral</italic> geometries. These are versatile, as they form a superset of most of the other geometry templates.</p></list-item><list-item><p>If the atom is carbon, nitrogen or oxygen, classify as <italic>trigonal</italic>.</p></list-item><list-item><p>Otherwise, classify as either <italic>trigonal</italic> or <italic>linear</italic>.</p></list-item></list></p></list-item><list-item><p>If the atom is divalent, and the two current bonds are linear:<list list-type="alpha-lower"><list-item><p>a. If the atom is in the <italic>s</italic>-block or the <italic>p</italic>-block, classify as <italic>square planar</italic>.</p></list-item><list-item><p>Otherwise, classify either of the two <italic>octahedral</italic> geometries.</p></list-item></list></p></list-item><list-item><p>Produce a list of geometries, depending on the element's position in the periodic table:<list list-type="alpha-lower"><list-item><p>a. For non-element symbols (e.g. "E" or "X"), classify as either <italic>trigonal</italic> or <italic>square planar</italic>.</p></list-item><list-item><p>For <italic>s</italic>-block atoms, classify as either <italic>trigonal</italic>, <italic>square planar</italic> or either of the <italic>octahedral</italic> geometries.</p></list-item><list-item><p>If the atom is carbon, and the bonds are all single, classify as either <italic>trigonal</italic>, <italic>square planar</italic> or either of the <italic>tetrahedral</italic> geometries.</p></list-item><list-item><p>If the atom is carbon, and the bonds are not all single, classify as <italic>trigonal</italic>.</p></list-item><list-item><p>If the atom is in the <italic>p</italic>-block, and in the first 3 rows, classify as being <italic>trigonal</italic>, either of the <italic>tetrahedral</italic> geometries, or <italic>square planar</italic>.</p></list-item><list-item><p>If the atom is in the <italic>p</italic>-block, but not in the first 3 rows, classify as being any of the available geometries.</p></list-item><list-item><p>Otherwise, classify as either of the two <italic>octahedral</italic> geometries.</p></list-item></list></p></list-item></list></p>
            <p>Once the possible classifications have been enumerated, each of them is checked to see if there is any way the current geometry can match it, within a tolerance of 2°. The first postulated geometry to achieve a match is given precedence. All of the nondegenerate vacant bond directions implied by the ways in which it can match the input structure are returned as the resulting list of possible new bond geometries.</p>
            <p>If no matches were found, the list of current bond angles are sorted by bond angle. For each bond, the angle directly in between itself and the next angle in the list (or the first one, if already at the end) is calculated and added to the result list.</p>
          </sec>
          <sec id="Sec53">
            <title>Appendix 4: Congestion function</title>
            <p>A number of the primitives use <italic>congestion</italic> to make decisions about where to place a new atom, bond or fragment, when an otherwise degenerate choice is available. The position which places new atoms as far away as possible from existing atoms is frequently preferable to the alternatives.</p>
            <p>The congestion at a specific point is calculated by:<disp-formula id="Equ1"><alternatives><mml:math id="Equ1_Math"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow></mml:math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2010_Article_112_Equa_HTML.gif" /></alternatives></disp-formula></p>
            <p>where <italic>i</italic> iterates over each atom in the structure, and <italic>x</italic> and <italic>y</italic> denote the atomic position, where the subscripted variables are the positions of existing atoms.</p>
            <p>The total congestion of a molecule is calculated by:<disp-formula id="Equ2"><alternatives><mml:math id="Equ2_Math"><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow></mml:math><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2010_Article_112_Equb_HTML.gif" /></alternatives></disp-formula></p>
            <p>where <italic>i</italic> and <italic>j</italic> iterate over all unique pairs of atoms.</p>
          </sec>
          <sec id="Sec54">
            <title>Appendix 5</title>
            <p>Two structures A and B are considered equivalent or not according to the following algorithm:<list list-type="order"><list-item><p>If the number of atoms or bonds is different, the structures are different.</p></list-item><list-item><p>The structures are translated so that their centre positions are the same. Each atom in structure A is mapped uniquely to the closest atom in structure B, which must be within 0.2 Å.</p></list-item><list-item><p>If any atoms are not successfully mapped, the structures are different.</p></list-item><list-item><p>Every atom in structure A must be mapped to an atom in structure B which has the same element label, charge, unpaired electron count, etc. If any mapped pair of atoms are not the same, the structures are different.</p></list-item><list-item><p>For every bond in structure A, between atoms <italic>a1</italic> and <italic>a2</italic>, there must be a corresponding bond in structure B, between atoms <italic>b1</italic> and <italic>b2</italic>, where <italic>a1</italic>:<italic>b1</italic> and <italic>a2</italic>:<italic>b2</italic> are mapped to each other. If the bond stereochemistry type is not a wedge bond (inclined or declined), the inverse mapping, <italic>a1</italic>:<italic>b2</italic> and <italic>a2</italic>:<italic>b1</italic>, is also permitted. If no such pair can be found, the structures are different. The matched bonds must have the same order and stereochemistry type. If not, the structures are different.</p></list-item><list-item><p>If no differences were found, the two structures are equivalent.</p></list-item></list></p>
            <p>This comparison considers alternate tautomers and Kekulé resonance forms to be different species, which is desirable for sketching purposes. The determination of the equivalence of two sketches, as described above, should not be confused with methods used to determine whether two connection tables represent the same molecule, such as unique SMILES [<xref ref-type="bibr" rid="CR25">25</xref>] or InChI [<xref ref-type="bibr" rid="CR26">26</xref>].</p>
          </sec>
        </sec>
        <sec id="Sec55">
          <title>Supplementary information</title>
          <p>A list of template fragments grouped into categories is provided [Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>]. It is assumed that these templates are available as a minimum set, each as an individual primitive. These fragments are by no means comprehensive, but they provide a starting point for further customisation. The template fragments are also available as a collection of SD files [Additional file <xref ref-type="supplementary-material" rid="MOESM2">2</xref>].</p>
          <p>Additional examples of diagram drawing using the primitives described in this work can be found online [<xref ref-type="bibr" rid="CR27">27</xref>].</p>
        </sec>
      </body>
      <back>
        <ref-list id="Bib1">
          <title>References</title>
          <ref-list>
            <ref id="CR1">
              <label>1.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Goodwin</surname>
                    <given-names>WM</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Structural formulas and explanation in organic chemistry</article-title>
                <source>Found Chem</source>
                <year>2008</year>
                <volume>10</volume>
                <fpage>117</fpage>
                <lpage>127</lpage>
                <pub-id pub-id-type="doi">10.1007/s10698-007-9033-2</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1cXos1Wmtbc%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR2">
              <label>2.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Degtyarenko</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Ennis</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Garavelli</surname>
                    <given-names>JS</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">"Good annotation practice" for chemical data in biology</article-title>
                <source>In Silico Biol</source>
                <year>2007</year>
                <volume>7</volume>
                <fpage>45</fpage>
                <lpage>56</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR3">
              <label>3.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Harré</surname>
                    <given-names>R</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Structural Explanation in Chemistry and Its Evolving Forms</article-title>
                <source>Ann N Y Acad Sci</source>
                <year>2003</year>
                <volume>988</volume>
                <fpage>1</fpage>
                <lpage>15</lpage>
                <pub-id pub-id-type="doi">10.1111/j.1749-6632.2003.tb06080.x</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR4">
              <label>4.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Wright</surname>
                    <given-names>JM</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Make it better but don't change anything</article-title>
                <source>Autom Exp</source>
                <year>2009</year>
                <volume>1</volume>
                <fpage>5</fpage>
                <pub-id pub-id-type="doi">10.1186/1759-4499-1-5</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR5">
              <label>5.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Ertl</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Molecular structure input on the web</article-title>
                <source>J Cheminf</source>
                <year>2010</year>
                <volume>2</volume>
                <fpage>1</fpage>
                <pub-id pub-id-type="doi">10.1186/1758-2946-2-1</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR6">
              <label>6.</label>
              <mixed-citation publication-type="other">Wikipedia: Molecule editor. [<ext-link xlink:href="http://en.wikipedia.org/wiki/Molecule_editor" ext-link-type="uri">http://en.wikipedia.org/wiki/Molecule_editor</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR7">
              <label>7.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Clark</surname>
                    <given-names>AM</given-names>
                  </name>
                  <name>
                    <surname>Labute</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Santavy</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">2 D Structure Depiction</article-title>
                <source>J Chem Inf Model</source>
                <year>2006</year>
                <volume>46</volume>
                <fpage>1107</fpage>
                <lpage>1123</lpage>
                <pub-id pub-id-type="doi">10.1021/ci050550m</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD28XjsVajt7Y%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR8">
              <label>8.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Helson</surname>
                    <given-names>HE</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Structure Diagram Generation</article-title>
                <source>Rev Comput Chem</source>
                <year>1999</year>
                <volume>13</volume>
                <fpage>313</fpage>
                <lpage>398</lpage>
                <pub-id pub-id-type="doi">10.1002/9780470125908.ch6</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK1MXnvValtr4%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR9">
              <label>9.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Weininger</surname>
                    <given-names>D</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Depict. Graphical Depiction of Chemical Structures</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>1990</year>
                <volume>30</volume>
                <fpage>237</fpage>
                <lpage>243</lpage>
                <pub-id pub-id-type="doi">10.1021/ci00067a005</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK3cXkvFKlsbo%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR10">
              <label>10.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Fricker</surname>
                    <given-names>PC</given-names>
                  </name>
                  <name>
                    <surname>Gastreich</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Rarey</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Automated Drawing of Structural Molecular Formulas under Constraints</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>2004</year>
                <volume>44</volume>
                <fpage>1065</fpage>
                <lpage>1078</lpage>
                <pub-id pub-id-type="doi">10.1021/ci049958u</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2cXjtVyrtLk%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR11">
              <label>11.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Engel</surname>
                    <given-names>T</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Basic Overview of Chemoinformatics</article-title>
                <source>J Chem Inf Model</source>
                <year>2006</year>
                <volume>46</volume>
                <fpage>2267</fpage>
                <lpage>2277</lpage>
                <pub-id pub-id-type="doi">10.1021/ci600234z</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD28XhtF2it7fI</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR12">
              <label>12.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Chen</surname>
                    <given-names>WL</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Chemoinformatics: Past, Present and Future</article-title>
                <source>J Chem Inf Model</source>
                <year>2006</year>
                <volume>46</volume>
                <fpage>2230</fpage>
                <lpage>2255</lpage>
                <pub-id pub-id-type="doi">10.1021/ci060016u</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD28Xlt1ehs7w%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR13">
              <label>13.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Dalby</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Nourse</surname>
                    <given-names>JG</given-names>
                  </name>
                  <name>
                    <surname>Hounshell</surname>
                    <given-names>WD</given-names>
                  </name>
                  <name>
                    <surname>Gushurst</surname>
                    <given-names>AKI</given-names>
                  </name>
                  <name>
                    <surname>Grier</surname>
                    <given-names>DL</given-names>
                  </name>
                  <name>
                    <surname>Leland</surname>
                    <given-names>BA</given-names>
                  </name>
                  <name>
                    <surname>Laufer</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Description of several chemical structure file formats used by computer programs developed at Molecular Design Limited</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>1992</year>
                <volume>32</volume>
                <fpage>244</fpage>
                <lpage>255</lpage>
                <pub-id pub-id-type="doi">10.1021/ci00007a012</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK38XisFCrtbo%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR14">
              <label>14.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Murray-Rust</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Rzepa</surname>
                    <given-names>HS</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Chemical Markup, XML, and the World Wide Web. 4. Schema</article-title>
                <source>J Chem Inf Model</source>
                <year>2003</year>
                <volume>43</volume>
                <fpage>757</fpage>
                <lpage>772</lpage>
                <pub-id pub-id-type="doi">10.1021/ci0256541</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3sXivVaqsLk%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR15">
              <label>15.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Patrono</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Rocca</surname>
                    <given-names>B</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Aspirin, 110 years later</article-title>
                <source>J Thromb Haemost</source>
                <year>2009</year>
                <volume>7</volume>
                <fpage>258</fpage>
                <lpage>61</lpage>
                <pub-id pub-id-type="doi">10.1111/j.1538-7836.2009.03391.x</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXpvV2isLg%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR16">
              <label>16.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Dancik</surname>
                    <given-names>V</given-names>
                  </name>
                  <name>
                    <surname>Seiler</surname>
                    <given-names>KP</given-names>
                  </name>
                  <name>
                    <surname>Young</surname>
                    <given-names>DW</given-names>
                  </name>
                  <name>
                    <surname>Schreiber</surname>
                    <given-names>SL</given-names>
                  </name>
                  <name>
                    <surname>Clemons</surname>
                    <given-names>PA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Distinct Biological Network Properties between the Targets of Natural Products and Disease Genes</article-title>
                <source>J Am Chem Soc</source>
                <year>2010</year>
                <volume>132</volume>
                <fpage>9259</fpage>
                <lpage>9261</lpage>
                <pub-id pub-id-type="doi">10.1021/ja102798t</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3cXnvVaqtbo%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR17">
              <label>17.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Boogaerts</surname>
                    <given-names>IIF</given-names>
                  </name>
                  <name>
                    <surname>Nolan</surname>
                    <given-names>SP</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Carboxylation of C-H Bonds Using N-Heterocyclic Carbene Gold(I) Complexes</article-title>
                <source>J Am Chem Soc</source>
                <year>2010</year>
                <volume>132</volume>
                <fpage>8858</fpage>
                <lpage>8859</lpage>
                <pub-id pub-id-type="doi">10.1021/ja103429q</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3cXntlWrur4%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR18">
              <label>18.</label>
              <mixed-citation publication-type="other">Molecular Materials Informatics, Inc. [<ext-link xlink:href="http://molmatinf.com" ext-link-type="uri">http://molmatinf.com</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR19">
              <label>19.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Ihlenfeldt</surname>
                    <given-names>WD</given-names>
                  </name>
                  <name>
                    <surname>Bolton</surname>
                    <given-names>EE</given-names>
                  </name>
                  <name>
                    <surname>Bryant</surname>
                    <given-names>SH</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The PubChem chemical structure sketcher</article-title>
                <source>J Cheminf</source>
                <year>2009</year>
                <volume>1</volume>
                <fpage>20</fpage>
                <pub-id pub-id-type="doi">10.1186/1758-2946-1-20</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR20">
              <label>20.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Clark</surname>
                    <given-names>AM</given-names>
                  </name>
                  <name>
                    <surname>Labute</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Detection and Assignment of Common Scaffolds in Project Databases of Lead Molecules</article-title>
                <source>J Med Chem</source>
                <year>2009</year>
                <volume>52</volume>
                <fpage>469</fpage>
                <lpage>483</lpage>
                <pub-id pub-id-type="doi">10.1021/jm801098a</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1cXhsFWnsL7L</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR21">
              <label>21.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Clark</surname>
                    <given-names>AM</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">2 D Depiction of Fragment Hierarchies</article-title>
                <source>J Chem Inf Model</source>
                <year>2010</year>
                <volume>50</volume>
                <fpage>37</fpage>
                <lpage>46</lpage>
                <pub-id pub-id-type="doi">10.1021/ci900350h</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXhs1Wgs7zP</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR22">
              <label>22.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Stewart</surname>
                    <given-names>KD</given-names>
                  </name>
                  <name>
                    <surname>Shiroda</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>James</surname>
                    <given-names>CA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Drug Guru: A computer software program for drug design using medicinal chemistry rules</article-title>
                <source>Bioorg Med Chem</source>
                <year>2006</year>
                <volume>14</volume>
                <fpage>7011</fpage>
                <lpage>7022</lpage>
                <pub-id pub-id-type="doi">10.1016/j.bmc.2006.06.024</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD28XptFSksbw%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR23">
              <label>23.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>White</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Wilson</surname>
                    <given-names>RC</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Generative models for chemical structures</article-title>
                <source>J Chem Inf Model</source>
                <year>2010</year>
                <volume>50</volume>
                <fpage>1257</fpage>
                <lpage>1274</lpage>
                <pub-id pub-id-type="doi">10.1021/ci9004089</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3cXos1ersr4%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR24">
              <label>24.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Mauser</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Stahl</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Chemical Fragment Spaces for de novo Design</article-title>
                <source>J Chem Inf Model</source>
                <year>2007</year>
                <volume>47</volume>
                <fpage>318</fpage>
                <lpage>324</lpage>
                <pub-id pub-id-type="doi">10.1021/ci6003652</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2sXhs1Ggsbk%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR25">
              <label>25.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Weininger</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Weininger</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Weininger</surname>
                    <given-names>JL</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">SMILES. 2. Algorithm for Generation of Unique SMILES Notation</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>1989</year>
                <volume>29</volume>
                <fpage>97</fpage>
                <lpage>101</lpage>
                <pub-id pub-id-type="doi">10.1021/ci00062a008</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaL1MXitFWlt7s%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR26">
              <label>26.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Coles</surname>
                    <given-names>SJ</given-names>
                  </name>
                  <name>
                    <surname>Day</surname>
                    <given-names>NE</given-names>
                  </name>
                  <name>
                    <surname>Murray-Rust</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Rzepa</surname>
                    <given-names>HS</given-names>
                  </name>
                  <name>
                    <surname>Zhang</surname>
                    <given-names>Y</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Enhancement of the chemical semantic web through the use of InChI identifiers</article-title>
                <source>Org Biomol Chem</source>
                <year>2005</year>
                <volume>3</volume>
                <fpage>1832</fpage>
                <lpage>1834</lpage>
                <pub-id pub-id-type="doi">10.1039/b502828k</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2MXktFWlur0%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR27">
              <label>27.</label>
              <mixed-citation publication-type="other">Mobile Molecular DataSheet demo videos:. [<ext-link xlink:href="http://molmatinf.com/demos.html" ext-link-type="uri">http://molmatinf.com/demos.html</ext-link>]</mixed-citation>
            </ref>
          </ref-list>
        </ref-list>
        <app-group>
          <app id="App1">
            <sec id="Sec56">
              <title>Electronic supplementary material</title>
              <p>
                <supplementary-material content-type="local-data" id="MOESM1" xlink:title="Electronic supplementary material">
                  <media mimetype="application" mime-subtype="pdf" xlink:href="MediaObjects/13321_2010_112_MOESM1_ESM.PDF" position="anchor">
                    <caption xml:lang="en">
                      <p>Additional file 1: Suggested default template fragments. A printable document containing diagrams of template fragments. (PDF 253 KB)</p>
                    </caption>
                  </media>
                </supplementary-material>
                <supplementary-material content-type="local-data" id="MOESM2" xlink:title="Electronic supplementary material">
                  <media mimetype="application" mime-subtype="x-zip-compressed" xlink:href="MediaObjects/13321_2010_112_MOESM2_ESM.ZIP" position="anchor">
                    <caption xml:lang="en">
                      <p>Additional file 2: Suggested default template fragments (SD files). A collection of MDL SD files, one per group, containing machine-readable data for each of the template fragments. (ZIP 19 KB)</p>
                    </caption>
                  </media>
                </supplementary-material>
              </p>
            </sec>
            <sec id="Sec57">
              <title>Authors’ original submitted files for images</title>
              <p>Below are the links to the authors’ original submitted files for images.<supplementary-material content-type="local-data" id="MOESM3" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="postscript" xlink:href="MediaObjects/13321_2010_112_MOESM3_ESM.eps" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 1</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM4" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="postscript" xlink:href="MediaObjects/13321_2010_112_MOESM4_ESM.eps" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 2</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM5" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="postscript" xlink:href="MediaObjects/13321_2010_112_MOESM5_ESM.eps" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 3</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM6" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="postscript" xlink:href="MediaObjects/13321_2010_112_MOESM6_ESM.eps" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 4</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM7" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="postscript" xlink:href="MediaObjects/13321_2010_112_MOESM7_ESM.eps" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 5</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM8" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="postscript" xlink:href="MediaObjects/13321_2010_112_MOESM8_ESM.eps" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 6</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM9" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="postscript" xlink:href="MediaObjects/13321_2010_112_MOESM9_ESM.eps" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 7</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM10" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="postscript" xlink:href="MediaObjects/13321_2010_112_MOESM10_ESM.eps" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 8</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM11" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="postscript" xlink:href="MediaObjects/13321_2010_112_MOESM11_ESM.eps" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 9</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM12" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="postscript" xlink:href="MediaObjects/13321_2010_112_MOESM12_ESM.eps" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 10</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM13" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="postscript" xlink:href="MediaObjects/13321_2010_112_MOESM13_ESM.eps" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 11</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM14" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="postscript" xlink:href="MediaObjects/13321_2010_112_MOESM14_ESM.eps" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 12</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM15" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="postscript" xlink:href="MediaObjects/13321_2010_112_MOESM15_ESM.eps" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 13</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM16" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="postscript" xlink:href="MediaObjects/13321_2010_112_MOESM16_ESM.eps" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 14</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM17" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="postscript" xlink:href="MediaObjects/13321_2010_112_MOESM17_ESM.eps" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 15</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM18" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="postscript" xlink:href="MediaObjects/13321_2010_112_MOESM18_ESM.eps" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 16</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM19" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="postscript" xlink:href="MediaObjects/13321_2010_112_MOESM19_ESM.eps" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 17</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM20" xlink:title="Authors’ original submitted files for images"><media mimetype="application" mime-subtype="postscript" xlink:href="MediaObjects/13321_2010_112_MOESM20_ESM.eps" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 18</p></caption></media></supplementary-material></p>
            </sec>
          </app>
        </app-group>
        <notes notes-type="Misc">
          <title>Competing interests</title>
          <p>The author is the founder and president of Molecular Materials Informatics, Inc., which produces the Mobile Molecular DataSheet, a working implementation of the primitives described in this manuscript. This publication is a disclosure of the algorithms that form the basis of a commercial product.</p>
        </notes>
      </back>
    </article>
