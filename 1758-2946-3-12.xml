<?xml version="1.0"?>
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="research-article" xml:lang="en">
      <?properties open_access?>
      <front>
        <journal-meta>
          <journal-id journal-id-type="publisher-id">13321</journal-id>
          <journal-title-group>
            <journal-title>Journal of Cheminformatics</journal-title>
            <abbrev-journal-title abbrev-type="publisher">J Cheminform</abbrev-journal-title>
          </journal-title-group>
          <issn pub-type="epub">1758-2946</issn>
          <publisher>
            <publisher-name>Springer International Publishing</publisher-name>
            <publisher-loc>Cham</publisher-loc>
          </publisher>
        </journal-meta>
        <article-meta>
          <article-id pub-id-type="publisher-id">BMC1758-2946-3-12</article-id>
          <article-id pub-id-type="manuscript">195</article-id>
          <article-id pub-id-type="doi">10.1186/1758-2946-3-12</article-id>
          <article-categories>
            <subj-group subj-group-type="heading">
              <subject>Software</subject>
            </subj-group>
          </article-categories>
          <title-group>
            <article-title xml:lang="en">Multilevel Parallelization of AutoDock 4.2</article-title>
          </title-group>
          <contrib-group>
            <contrib contrib-type="author">
              <name>
                <surname>Norgan</surname>
                <given-names>Andrew P</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Coffman</surname>
                <given-names>Paul K</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff2">2</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Kocher</surname>
                <given-names>Jean-Pierre A</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff3">3</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Katzmann</surname>
                <given-names>David J</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author" corresp="yes">
              <name>
                <surname>Sosa</surname>
                <given-names>Carlos P</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff2">2</xref>
              <xref ref-type="aff" rid="Aff4">4</xref>
              <xref ref-type="corresp" rid="IDBMC17582946312_cor5">e</xref>
            </contrib>
            <aff id="Aff1">
              <label>1</label>
              <institution-wrap>
                <institution-id institution-id-type="GRID">grid.66875.3a</institution-id>
                <institution-id institution-id-type="ISNI">000000040459167X</institution-id>
                <institution content-type="org-division">Department of Biochemistry and Molecular Biology</institution>
                <institution content-type="org-name">Mayo Clinic</institution>
              </institution-wrap>
              <addr-line content-type="city">Rochester</addr-line>
              <addr-line content-type="state">MN</addr-line>
              <country country="US">USA</country>
            </aff>
            <aff id="Aff2">
              <label>2</label>
              <institution-wrap>
                <institution-id institution-id-type="GRID">grid.410484.d</institution-id>
                <institution-id institution-id-type="ISNI">0000000404002468</institution-id>
                <institution content-type="org-name">IBM</institution>
              </institution-wrap>
              <addr-line content-type="city">Rochester</addr-line>
              <addr-line content-type="state">MN</addr-line>
              <country country="US">USA</country>
            </aff>
            <aff id="Aff3">
              <label>3</label>
              <institution-wrap>
                <institution-id institution-id-type="GRID">grid.66875.3a</institution-id>
                <institution-id institution-id-type="ISNI">000000040459167X</institution-id>
                <institution content-type="org-division">Division of Biomedical Statistics &amp; Informatics</institution>
                <institution content-type="org-name">Mayo Clinic</institution>
              </institution-wrap>
              <addr-line content-type="city">Rochester</addr-line>
              <addr-line content-type="state">MN</addr-line>
              <country country="US">USA</country>
            </aff>
            <aff id="Aff4">
              <label>4</label>
              <institution-wrap>
                <institution-id institution-id-type="GRID">grid.17635.36</institution-id>
                <institution-id institution-id-type="ISNI">0000000419368657</institution-id>
                <institution content-type="org-division">Biomedical Informatics and Computational Biology Program</institution>
                <institution content-type="org-name">University of Minnesota</institution>
              </institution-wrap>
              <addr-line content-type="city">Rochester</addr-line>
              <addr-line content-type="state">MN</addr-line>
              <country country="US">USA</country>
            </aff>
          </contrib-group>
          <author-notes>
            <corresp id="IDBMC17582946312_cor5">
              <label>e</label>
              <email>HIDDEN</email>
            </corresp>
          </author-notes>
          <pub-date date-type="pub" publication-format="electronic">
            <day>28</day>
            <month>4</month>
            <year>2011</year>
          </pub-date>
          <pub-date date-type="collection" publication-format="electronic">
            <month>12</month>
            <year>2011</year>
          </pub-date>
          <volume>3</volume>
          <issue seq="12">1</issue>
          <elocation-id>12</elocation-id>
          <history>
            <date date-type="registration">
              <day>18</day>
              <month>1</month>
              <year>2011</year>
            </date>
            <date date-type="received">
              <day>18</day>
              <month>1</month>
              <year>2011</year>
            </date>
            <date date-type="accepted">
              <day>28</day>
              <month>4</month>
              <year>2011</year>
            </date>
            <date date-type="online">
              <day>28</day>
              <month>4</month>
              <year>2011</year>
            </date>
          </history>
          <permissions>
            <copyright-statement content-type="compact">© Norgan et al; licensee Chemistry Central Ltd. 2011</copyright-statement>
            <copyright-statement content-type="comment">This article is published under license to BioMed Central Ltd. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link xlink:href="http://creativecommons.org/licenses/by/2.0" ext-link-type="url">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</copyright-statement>
            <copyright-year>2011</copyright-year>
            <copyright-holder>Norgan et al; licensee Chemistry Central Ltd.</copyright-holder>
            <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by-nc/2/">
              <license-p><bold>Open Access</bold> This is an open access article distributed under the terms of the Creative Commons Attribution Noncommercial License ( 
    <ext-link xlink:href="https://creativecommons.org/licenses/by-nc/2.0" ext-link-type="url">https://creativecommons.org/licenses/by-nc/2.0</ext-link> 
    ), which permits any noncommercial use, distribution, and reproduction in any medium, provided the original author(s) and source are credited. 
</license-p>
            </license>
          </permissions>
          <abstract id="Abs1" xml:lang="en">
            <title>Abstract</title>
            <sec id="ASec1">
              <title>Background</title>
              <p>Virtual (computational) screening is an increasingly important tool for drug discovery. AutoDock is a popular open-source application for performing molecular docking, the prediction of ligand-receptor interactions. AutoDock is a serial application, though several previous efforts have parallelized various aspects of the program. In this paper, we report on a multi-level parallelization of AutoDock 4.2 (mpAD4).</p>
            </sec>
            <sec id="ASec2">
              <title>Results</title>
              <p>Using MPI and OpenMP, AutoDock 4.2 was parallelized for use on MPI-enabled systems and to multithread the execution of individual docking jobs. In addition, code was implemented to reduce input/output (I/O) traffic by reusing grid maps at each node from docking to docking. Performance of mpAD4 was examined on two multiprocessor computers.</p>
            </sec>
            <sec id="ASec3">
              <title>Conclusions</title>
              <p>Using MPI with OpenMP multithreading, mpAD4 scales with near linearity on the multiprocessor systems tested. In situations where I/O is limiting, reuse of grid maps reduces both system I/O and overall screening time. Multithreading of AutoDock's Lamarkian Genetic Algorithm with OpenMP increases the speed of execution of individual docking jobs, and when combined with MPI parallelization can significantly reduce the execution time of virtual screens. This work is significant in that mpAD4 speeds the execution of certain molecular docking workloads and allows the user to optimize the degree of system-level (MPI) and node-level (OpenMP) parallelization to best fit both workloads and computational resources.</p>
            </sec>
          </abstract>
          <kwd-group xml:lang="en">
            <title>Keywords</title>
            <kwd>Virtual Screening</kwd>
            <kwd>Indinavir</kwd>
            <kwd>Virtual Node</kwd>
            <kwd>Slave Node</kwd>
            <kwd>Virtual Screen</kwd>
          </kwd-group>
          <custom-meta-group>
            <custom-meta>
              <meta-name>publisher-imprint-name</meta-name>
              <meta-value>Chemistry Central</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-issue-count</meta-name>
              <meta-value>1</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-article-count</meta-name>
              <meta-value>54</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-holder</meta-name>
              <meta-value>The Author(s)</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-year</meta-name>
              <meta-value>2011</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-contains-esm</meta-name>
              <meta-value>Yes</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-year</meta-name>
              <meta-value>2011</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-month</meta-name>
              <meta-value>1</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-day</meta-name>
              <meta-value>18</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-product</meta-name>
              <meta-value>ArchiveJournal</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-grants-type</meta-name>
              <meta-value>OpenChoice</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>metadata-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>abstract-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodypdf-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodyhtml-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bibliography-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>esm-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>online-first</meta-name>
              <meta-value>false</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-file-reference</meta-name>
              <meta-value>BodyRef/PDF/13321_2011_Article_195.pdf</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-type</meta-name>
              <meta-value>Typeset</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>target-type</meta-name>
              <meta-value>OnlinePDF</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-type</meta-name>
              <meta-value>OriginalPaper</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-primary</meta-name>
              <meta-value>Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computer Applications in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Documentation and Information in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Theoretical and Computational Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computational Biology/Bioinformatics</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-collection</meta-name>
              <meta-value>Chemistry and Materials Science</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>open-access</meta-name>
              <meta-value>true</meta-value>
            </custom-meta>
          </custom-meta-group>
        </article-meta>
        <notes notes-type="ESMHint">
          <title>Electronic supplementary material</title>
          <p>The online version of this article (doi:<ext-link xlink:href="https://doi.org/10.1186/1758-2946-3-12" ext-link-type="doi">10.1186/1758-2946-3-12</ext-link>) contains supplementary material, which is available to authorized users.</p>
        </notes>
        <notes notes-type="Misc">
          <p>Andrew P Norgan, Paul K Coffman contributed equally to this work.</p>
        </notes>
      </front>
      <body>
        <sec id="Sec1">
          <title>Background</title>
          <p>Virtual screening, the use of computers to predict the binding of libraries of small molecules to known target structures, is an increasingly important component of the drug discovery process [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Although high-throughput biochemical screening is still the predominant technique for lead compound discovery, the success of <italic>in silico</italic> screening in identifying drug leads has led to the growing use of virtual screening as a complement to traditional empirical methods [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>]. There are a large number of software packages for conducting the molecular docking simulations used in virtual screening, with the open-source packages AutoDock and DOCK, and the commercial packages GOLD, FlexX and ICM, among the most popular [<xref ref-type="bibr" rid="CR5">5</xref>]. Of those five packages the most widely cited is AutoDock, which has been successfully used in a number of virtual screens and in the development of the HIV integrase inhibitor raltegravir [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. This work is focused on AutoDock's most recent major version, AutoDock 4.2 [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
          <p>In its current iteration, AutoDock 4.2's (AD4) default search function is a Lamarkian Genetic Algorithm (LGA), a hybrid genetic algorithm with local optimization that uses a parameterized free-energy scoring function to estimate binding energy [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. To perform a ligand-receptor docking experiment, the software accepts as inputs ligand and macromolecule coordinates, and then utilizes the LGA to generate ligand positions and minimize binding energies using precalculated pairwise potential grid maps [<xref ref-type="bibr" rid="CR10">10</xref>]. Each <italic>docking</italic> is comprised of multiple independent executions of the LGA, limited to a user specified number of energy evaluations (ga_evals) or generations (ga_num_generations). The individual LGA executions (ga_runs) are clustered and ranked to generate the final docking result.</p>
          <p>While AD4 has been widely used for virtual screening, one limitation to its usefulness is its docking speed [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. A potential way to increase AD4 performance is to parallelize aspects of its execution. Trends in processor architecture (multicore and multithreaded), and the increasing importance of highly parallel hardware such as graphics cards in scientific computation, underscore the importance of optimizing applications for parallel workloads. AD4 is a serial application not originally designed for computational clusters or to take advantage of parallel processing. There have been several previous efforts to parallelize aspects of AD4 and enable its use on high performance clusters, including: DOVIS and DOVIS 2.0 (Linux/UNIX clusters), Dockres (Linux/UNIX clusters), VSDocker (Windows clusters), and recently Autodock4.lga.MPI (an MPI implementation of Autodock4) [<xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR17">17</xref>]. In general, these programs either encapsulate AutoDock in code wrappers or supply scripts that automate aspects of the preparation, distribution, execution and load balancing of AutoDock on clusters. DOVIS 2.0 uses multithreading or SSH for cluster execution, while VSDocker utilizes MPICH2 or MSMPI for cluster communication [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. Dockres runs in conjunction with several different cluster queuing systems, as does DOVIS 2.0 [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. One challenge in parallelizing AutoDock for a cluster environment is that the program can generate significant network I/O during the loading of grid maps at the beginning of each docking, and when writing log files as dockings finish. Though log file writing can not easily be avoided, reuse of grid maps is a possibility as the majority of grid maps will be the same in each docking. One potential solution, if sufficient RAM is available, is to keep the grid maps in memory. This approach was used in both DOVIS and Autodock4.lga.MPI (with maps repackaged into an efficient binary format), with significant decreases in I/O observed when grid maps are loaded only once for each node [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR17">17</xref>].</p>
          <p>In addition to optimizing AutoDock's execution on clusters, several previous efforts parallelized individual dockings. In a standard docking, the most time intensive task is the repeated execution of AutoDock's LGA, which is run tens or hundreds of times with identical structure files, grid maps and parameters. The LGA was the focus of parallelization efforts by Thormann and Pons, who parallelized the LGA of AutoDock 3.0 using OpenMP, and Khodade <italic>et al</italic>., who parallelized AutoDock 3.0 and a beta version of AutoDock 4.0 using MPI [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. These approaches both resulted in a significant increase in AD4 execution speed, with Thormann and Pons reporting an approximately 95% × <italic>N</italic>(where N = 8) speedup, and Khodade <italic>et al</italic>. observing near linear speed increases on a 96-core POWER5 system [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>].</p>
          <p>Extending on these previous approaches, we had three goals for parallelization of AD4: 1) enable parallel execution of AD4 across multiple HPC architectures, 2) reduce I/O, and 3) parallelize the execution of individual docking jobs. Accordingly, we parallelized AD4 at multiple levels by: 1) utilizing MPI to distribute AD4 docking jobs across a system, 2) developing a grid map reuse scheme (conceptually similar to that implemented in DOVIS) to reduce I/O, and 3) implementing OpenMP parallelization of the LGA to achieve node-level parallelization. This standards-based parallelization scheme is significant in that it results in a highly portable parallel implementation of AD4 with user customizability in the balance between system-level and node-level parallel execution.</p>
        </sec>
        <sec id="Sec2">
          <title>Implementation</title>
          <p>AutoDock 4.2 (AD4) was parallelized at multiple levels using the MPICH2 implementation of the MPI standard and OpenMP application programming interface, resulting in the parallel code mpAutoDock 4.2 (mpAD4). The implementation of MPI and OpenMP in mpAD4 is standards compliant and portable to any architecture with a suitable compiler. MPI was used to parallelize the main() function of AD4 to facilitate virtual screening on MPI-enabled clusters, while OpenMP was used to implement multi-threading of the AD4 LGA. Scaling of the mpAD4 code in multithreaded and serial operation was evaluated using an IBM BlueGene/P system and a 32-core IBM POWER7 server.</p>
          <sec id="Sec3">
            <title>MPI Parallelization</title>
            <p>To facilitate system-level parallelization, the mpAD4 main() function was rewritten as a function call from the MPI driver. In this context, mpAD4 is executed within a master-slave scheme in which node-0 is the master node and all other nodes are slave nodes. The master node coordinates all docking activities by reading a list of docking directories from an ASCII file and then assigns individual dockings to specific slave nodes via MPI_Send(). Once the docking assignment has been received via MPI_Recv(), the slave nodes perform the docking work by loading necessary files, calling the mpAD4 main() function to dock the ligand that the master node has assigned to it, and writing the docking log file. To allow the user to monitor progress, the master writes three log files to track submitted dockings (MPI_Send() call from the master), successful dockings (MPI Send() call from a slave with data indicating docking success received by the master via MPI_Recv()) and failed dockings (MPI Send() call from a slave with data indicating docking failure received by the master via MPI_Recv()).</p>
          </sec>
          <sec id="Sec4">
            <title>I/O Optimization</title>
            <p>AD4 requires the precalculation of one electrostatic map, one desolvation map, and individual atomic affinity grid maps for each AD4 atom type found in the ligand(s). The default AD4 behavior is to load all grid maps required for a specific docking into memory from the file system and to release that memory at the end of the docking. Thus, when the next docking begins many of the same grid maps are reloaded. In addition to the time required to load the grid maps, this behavior generates significant I/O that is unnecessary given that different dockings utilize the same electrostatic and desolvation maps, and often atomic affinity maps. Therefore, a parameter has been added to the mpAD4 executable to control grid maps persistence from one docking to another on the slave nodes. With mpAD4, as the main() function begins execution on the slave the default behavior is to load all grid maps required to dock the first ligand into compute node memory. Any remaining atomic affinity maps are loaded for subsequent dockings at the node only when required by a ligand with a previously unused atom type. Once loaded, a map persists in node memory until program termination (Figure <xref rid="Fig1" ref-type="fig">1</xref>). To accomplish this, the scope of the multi-dimensional array holding the grid map data changed from local (in the main() function) to global, allowing the grid map data to persist from docking to docking on a slave node. In addition, the code that manages and references this grid map array was modified to initially load only atomic affinity maps required for the first docking, and then subsequently load appropriate atomic affinity maps when required. This approach minimizes startup I/O by loading the smallest possible amount of initial data onto the compute nodes. The user can specify grid map persistence at runtime using the flags (reload_maps or reuse_maps). Except were otherwise indicated, benchmarks were run with grid map reuse (gm = reuse).<fig id="Fig1"><label>Figure 1</label><caption xml:lang="en"><p><bold>Workflow of mpAutoDock</bold>. mpAD4 uses an MPI-driver to distribute work to individual nodes. With grid map reuse enabled, the precomputed grid maps, receptor and docking parameter files are loaded at the node level and reused for each additional docking. An individual docking on each node can be parallelized by running multiple instances of Lamarkian Genetic Algorithm in parallel using OpenMP threads.</p></caption><p><graphic specific-use="HTML" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2011_Article_195_Fig1_HTML.jpg" /></p></fig></p>
          </sec>
          <sec id="Sec5">
            <title>OpenMP Parallelization</title>
            <p>The majority of an AD4 docking is spent within the search and scoring routines, making them appealing targets for parallelization. AD4 includes several search functions, including simulated annealing (SA), genetic algorithm (GA), local search (LS) and a hybrid GA/LS (LGA). The LGA was chosen for parallelization as it was previously demonstrated to outperform either the SA or GA alone, and the LS is useful primarily for minimizing already docked structures [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]. To parallelize the LGA with OpenMP, modifications to the input seed value generation and docking output handling code were required. The AD4 random number generator (RNG) utilizes a deterministic IGNLGI algorithm to generate a time-based random number seed for each LGA run. Thus, when OpenMP threads were created simultaneously with an unmodified RNG, each thread would receive an identical seed value. Therefore, the mpAD4 RNG was changed to include thread ID in the time-based seed passed to the RNG to generate unique seeds for each thread. The other code change required was related to how log information about each iteration of the LGA is written to the docking log. In the AD4, the LGA writes information to the docking log piecewise for each iteration. When the code was multithreaded, log information appeared scrambled as different threads simultaneously wrote LGA outputs. To resolve this issue in mpAD4, LGA outputs are buffered and then written en bloc after thread completion, thereby keeping the output of each ga_run contiguous within the docking log.</p>
          </sec>
          <sec id="Sec6">
            <title>Performance Profiling</title>
            <p>In addition to the parallelization code, performance profiling has been added to mpAD4. Profiling can be turned on or off at compile time with a compiler directive. When profiling is enabled, a .csv file is updated as each docking finishes, so a user can monitor the progress of individual docking jobs and be made aware of any performance issues while the program is running. The profiling records calculation and communication start/stop times and durations from the moment the master sends the MPI message to the slave to the moment the master receives the return message from the slave with the docking status, and writes the values to a single comma delimited entry in the profiling log. Profiling outputs may be of interest to users of mpAD4 for characterizing performance bottlenecks on their system and for future developers of mpAD4. When not otherwise indicated, benchmarks were run with profiling enabled.</p>
          </sec>
          <sec id="Sec7">
            <title>Blue Gene/P and POWER7 architectures</title>
            <p>In this study two architectures were used to test mpAD4 performance, an IBM Blue Gene/P (BG/P) system and a shared-memory 32-core POWER7 p755 server [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. The BG/P system is composed of dense racks of IBM PowerPC 450 processors running at 850 MHz with 4 cores and 4 GB RAM per compute node connected by a high performance interconnect to a storage array running the General Parallel File System (GPFS). BG/P can be configured in several different modes, including symmetric multi-processing (SMP) and virtual node (VN) [<xref ref-type="bibr" rid="CR21">21</xref>]. In SMP mode, each compute node executes a single task with a maximum of four threads, with node resources including memory and network bandwidth shared by all processes. In VN mode, four single-threaded tasks are run on each node, one task per core, with each task having access to 1/4 of the total node memory. Thus, in comparing VN and SMP mode, VN mode will run four times the number of simultaneous independent MPI tasks as SMP mode, but the same number of total CPU cores will are utilized in each mode. The SMP and VN modes were used to examine differences in mpAD4 scaling and performance using MPI with multithreading SMP(OMP = 4) or MPI alone VN(OMP = 1). BG/P compute nodes do not have local disk storage, and I/O requests to the storage array are handled by dedicated I/O nodes that communicate with the network file system. Compute nodes connect to I/O nodes via a high-bandwidth "global collective network" that moves process and application data to and from the I/O nodes [<xref ref-type="bibr" rid="CR21">21</xref>]. Each compute and I/O Node has three bidirectional links to the global collective network at 850 MBps per link, for a total of 5.1 GBps bandwidth per node. I/O nodes, in turn, are connected to the external file filesystem by a 10 Gb ethernet link. A BG/P system can be configured to run with a variable number of I/O nodes to model I/O replete or I/O poor systems.</p>
            <p>In this study we tested two configurations, I/O poor (1 I/O node per 512 CPU cores) and I/O replete (1 I/O node per 64 CPU cores). When not otherwise indicated, an I/O replete configuration was used. The p755 system is a POWER7 3.3 GHz server with 32 cores and 128 GB of RAM, running the AIX 6.1 operating system. Multiparallel AD4 was compiled for BG/P with the XL C++ thread-safe cross-compiler v9.0 (bgxlC_r) and for POWER7 using the AIX XL C++ thread-safe v11.1 (xlC_r). For both POWER7 and BG/P, compiler optimization flag -O3 was used and the -qsmp = omp OpenMP option was specified, unless otherwise indicated. For POWER7 the -q64 flag was also used.</p>
          </sec>
          <sec id="Sec8">
            <title>Ligand Libraries and Parameters</title>
            <p>The receptor-ligand complex 1HPV (indivinavir and HIV protease), and subsets of a diverse set of 34,841 compounds from the ZINC8 drug-like subset, were used to evaluate mpAD4 performance [<xref ref-type="bibr" rid="CR22">22</xref>]. For the 1HPV, AutoDockTools (from MGLTools) was used to prepare the receptor and ligand [<xref ref-type="bibr" rid="CR23">23</xref>]. Polar hydrogen atoms were added to the ligand and receptor .pdb files, and Gasteiger charges assigned. Indinavir libraries were then created with 4,000 copies (4 k indinavir), 8,000 copies (8 k indinavir), and 32,000 copies (32 k indinavir). The ZINC8 library ligands were prepared using the python scripts included in MGLTools package. To generate the 34,841 compound ZINC library (34 k ZINC), the 70% diversity subset of the <italic>drug</italic>-<italic>like</italic> subset was downloaded and compounds that failed any preparation step were discarded. A 9,000 compound subset of this library (9 k ZINC) was generated from the first 9,000 members of the 34 k ZINC library. To generate grid maps, grid box centers were defined as the center of the bound indinavir (1HPV), extending 60 grid points (0.375 Å per point) on each side. Unless otherwise specified, LGA runs were set at 20 (ga_runs), with population size (ga_popsize) of 150, energy evaluations (ga_num_evals) 250,000 and maximum number of generations (ga_num_generations) 27,000. All other parameter values were default for AutoDock 4.2. Except where indicated, the reuse_maps (gm = reuse) option was used in all benchmarks.</p>
          </sec>
        </sec>
        <sec id="Sec9">
          <title>Results and Discussion</title>
          <p>To assess the performance characteristics of the hybrid parallelization and grid map reuse code, the 32 k indinavir library was docked on a 2,048(8,192) node(core) Blue Gene/P system with intermediate I/O settings (1 I/O node per 128 cores). Figure <xref rid="Fig2" ref-type="fig">2a</xref> shows the relative docking time in 4 different modes: VN(OMP = 1, gm = reload), VN(OMP = 1, gm = reuse), SMP(OMP = 4, gm = reload) and SMP(OMP = 4, gm = reuse). Grid map reuse reduced single-threaded execution time by approximately 17.5% due to reductions in I/O (Figure <xref rid="Fig2" ref-type="fig">2a</xref>). Multithreaded execution in SMP mode further reduced docking time by 10%, for an overall improvement of 25% over VN(OMP = 1, gm = reload) (Figure <xref rid="Fig2" ref-type="fig">2a</xref>). The improvement in docking speed observed with multithreading was due to system I/O bottlenecks experienced with single-threaded execution, as in VN mode each compute node CPU core receives an independent MPI task (8,192 in this instance), while in SMP mode only physical compute nodes (2,048 in this instance) receive a task, so that one fourth as many tasks run concurrently.<fig id="Fig2"><label>Figure 2</label><caption xml:lang="en"><p><bold>Impact of grid map reuse, OpenMP multithreading, and I/O on mpAD4 execution speed</bold>. (A) A 32,000 copy indinavir library was docked with mpAD4 on a 2,048(8,192) node(core) BG/P system in VN node mode (MPI + OpenMP with 1 OpenMP thread/node, 4× virtual nodes) with either grid map reloading or reuse and SMP mode (MPI + OpenMP with 4 OpenMP threads/node) with grid map reloading or reuse. The system was configured with 64 I/O nodes (1 I/O node per 128 cores). Runtimes were normalized to the fastest case (SMP, gm = reuse). (B) An 8,000 copy indinavir library was docked on a 1,024(4,096) node(core) BG/P system in VN mode (gm = reload or gm = reuse) and SMP mode (gm = reuse) configured with either 8 I/O nodes (I/O poor) or 64 I/O nodes (I/O replete). Runtimes were normalized to the fastest case (SMP, gm = reuse, I/O = 64).</p></caption><p><graphic specific-use="HTML" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2011_Article_195_Fig2_HTML.jpg" /></p></fig></p>
          <p>We examined the impact of system I/O on docking using I/O times recorded by the profiling code. The major sources of I/O when running mpAD4 were the loading of grid maps and the writing of log files, while MPI communication was a negligible percentage of network traffic. I/O saturation was most apparent at the end of the initial wave of docking jobs when multiple log files are simultaneously written to disk and grid maps for the next docking jobs are loaded. In our testing with the 32 k indinavir library, instituting grid map reuse diminished VN mode average file loading time by 77%, while SMP mode (OMP = 4, gm = reuse) file loading time was 1% that of VN mode (OMP = 1, gm = reload) (Table <xref rid="Tab1" ref-type="table">1</xref>). Similarly, average log file writing time was reduced by 92% with grid map reuse, and over 99% in SMP mode (Table <xref rid="Tab1" ref-type="table">1</xref>). Though grid map reuse significantly reduced I/O times in our tests, the impact on overall docking times was variable.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Impact of grid map reuse and OpenMP multithreading on I/O.</p></caption><table frame="hsides" rules="groups"><thead><tr><th /><th align="center" colspan="4"><p>VN (gm = reload)</p></th><th align="center" colspan="4"><p>VN (gm = reuse)</p></th><th align="center" colspan="4"><p>SMP (gm = reuse)</p></th></tr><tr><th /><th align="right"><p>FLD</p></th><th align="right"><p>MAP</p></th><th align="right"><p>LIG</p></th><th align="right"><p>LOG</p></th><th align="right"><p>FLD</p></th><th align="right"><p>MAP</p></th><th align="right"><p>LIG</p></th><th align="right"><p>LOG</p></th><th align="right"><p>FLD</p></th><th align="right"><p>MAP</p></th><th align="right"><p>LIG</p></th><th align="right"><p>LOG</p></th></tr></thead><tbody><tr><td align="center"><p>ave</p></td><td align="right"><p>2.5</p></td><td align="right"><p>25.9</p></td><td align="right"><p>90.0</p></td><td align="right"><p>150.5</p></td><td align="right"><p>0.3</p></td><td align="right"><p>5.1</p></td><td align="right"><p>21.2</p></td><td align="right"><p>12.0</p></td><td align="right"><p>0.0</p></td><td align="right"><p>0.6</p></td><td align="right"><p>0.3</p></td><td align="right"><p>0.3</p></td></tr><tr><td align="center"><p>rms</p></td><td align="right"><p>8.0</p></td><td align="right"><p>50.8</p></td><td align="right"><p>335.8</p></td><td align="right"><p>584.1</p></td><td align="right"><p>1.5</p></td><td align="right"><p>13.8</p></td><td align="right"><p>40.8</p></td><td align="right"><p>55.4</p></td><td align="right"><p>0.1</p></td><td align="right"><p>2.4</p></td><td align="right"><p>0.3</p></td><td align="right"><p>0.3</p></td></tr><tr><td align="center"><p>med</p></td><td align="right"><p>0.3</p></td><td align="right"><p>13.4</p></td><td align="right"><p>1.9</p></td><td align="right"><p>0.2</p></td><td align="right"><p>0.0</p></td><td align="right"><p>0.0</p></td><td align="right"><p>1.5</p></td><td align="right"><p>0.3</p></td><td align="right"><p>0.0</p></td><td align="right"><p>0.0</p></td><td align="right"><p>0.2</p></td><td align="right"><p>0.2</p></td></tr><tr><td align="center"><p>max</p></td><td align="right"><p>247.2</p></td><td align="right"><p>542.3</p></td><td align="right"><p>3567.5</p></td><td align="right"><p>3630.0</p></td><td align="right"><p>54.6</p></td><td align="right"><p>187.9</p></td><td align="right"><p>469.6</p></td><td align="right"><p>546.8</p></td><td align="right"><p>1.7</p></td><td align="right"><p>14.0</p></td><td align="right"><p>2.9</p></td><td align="right"><p>3.2</p></td></tr><tr><td align="center"><p>%</p></td><td /><td /><td /><td /><td align="right"><p>14.6</p></td><td align="right"><p>19.7</p></td><td align="right"><p>23.6</p></td><td align="right"><p>8.0</p></td><td align="right"><p>1.1</p></td><td align="right"><p>2.5</p></td><td align="right"><p>0.4</p></td><td align="right"><p>0.3</p></td></tr></tbody></table><table-wrap-foot><p>A 32,000 copy indinavir library was docked with mpAD4 on a 2,048(8,192) node(core) BG/P system in VN node mode (MPI + OpenMP with 1 OpenMP thread/node, 4× virtual nodes) with either grid map reloading or reuse, and SMP mode (MPI + OpenMP with 4 OpenMP threads/node) with grid map reloading or reuse. Statistics for total duration (in seconds) of .fld map load time (FLD), atomic affinity map load time (MAP), ligand load time (LIG), and docking log write time (LOG) are shown for VN (gm = reload), VN (gm = reuse) and SMP (gm = reuse). Pairwise comparisons of average I/O times (seconds) between VN (gm = reload) and VN (gm = reuse) or SMP (gm = reuse) were calculated, and are shown as percent of VN (gm = reload) times. I/O differences between SMP (gm = reload) and (gm = reuse) were negligible, and are not shown.</p></table-wrap-foot></table-wrap></p>
          <sec id="Sec10">
            <title>I/O and Performance</title>
            <p>To further examine the contribution of I/O to the performance we observed, we docked an 8 k indinavir library on 1,024(4,096) node(core) BG/P system configured to be I/O poor (8 I/O nodes) or I/O replete (64 I/O nodes). In the I/O poor setting, VN mode with grid map reuse resulted in only a small increase in execution speed over VN(OMP = 1, gm = reload), while SMP mode (OMP = 4, gm = reuse) execution time was decreased by 33% (Figure <xref rid="Fig2" ref-type="fig">2b</xref>). Such differences were largely unapparent in an I/O replete configuration, where grid map reuse showed no benefit in overall docking speed, and SMP-mode gains were only 3% (Figure <xref rid="Fig2" ref-type="fig">2b</xref>). When I/O was sufficiently limited (e.g., 1,024(i8)), grid map reuse had limited impact on overall performance, likely because the I/O generated by the slave nodes writing log files was still sufficient to saturate the I/O poor system. Similarly, grid map reuse did not greatly improve performance in an I/O replete setting, as sufficient I/O capacity was available for simultaneous grid map loading and log file writing. Thus, grid map reuse greatly reduces I/O activity and can significantly improve docking performance in some settings, allowing larger systems to be effectively used for a given I/O capacity. Similarly, 4-way OpenMP multithreading reduces I/O by 75% for a given system size and I/O times by 90%, again allowing larger systems to be employed than with MPI alone.</p>
          </sec>
          <sec id="Sec11">
            <title>Hybrid Scalability</title>
            <p>To test mpAD4 scalability, small molecule libraries including a 34 k ZINC, 9 k ZINC and 4 k indinavir were run on 512(2,048), 1,024(4,096), 2,048(8,192), and 4,096(16,384) node(core) BG/P systems. Figure <xref rid="Fig3" ref-type="fig">3a</xref> shows the speedup observed with the 34 k ZINC library in SMP and VN modes (gm = reuse). SMP mode scaling was nearly linear at approximately 92% ideal speed on the 16,384 core system. VN mode deviated to a greater degree at 72% ideal on the 16,384 core system, a 22% decrease from SMP-mode performance (Figure <xref rid="Fig3" ref-type="fig">3a</xref>). Interestingly, this performance decrease was not due to I/O differences, but instead reflected improved system utilization efficiency in the multithreaded execution mode. For both SMP and VN mode, deviations from ideal occur on larger systems as a virtual screen comes to the end and fewer ligands remain to be docked than capacity of the system, resulting in portions of the system remaining idle while the remaining active jobs finish. Multithreaded execution helps to alleviate this inefficiency in two ways: 1) when using multithreading there are fewer MPI nodes in the system and a virtual screen proceeds closer to completion before nodes become idle, and 2) individual dockings are executed more quickly when multithreaded, reducing time spent with idle nodes. For very large screening libraries, node utilization efficiency differences at the end of screening are unlikely to contribute to significant difference overall docking time. However, the opposite is true as library size shrinks in comparison to system size, as demonstrated in the scaling of the 9 K ZINC library where node utilization inefficiencies are apparent in both VN and SMP mode, though SMP mode is less effected (Figure <xref rid="Fig3" ref-type="fig">3b</xref>).<fig id="Fig3"><label>Figure 3</label><caption xml:lang="en"><p><bold>Scaling of MPI alone versus MPI with OpenMP multithreading</bold>. Virtual compound libraries were docked in VN and SMP modes on BG/P systems of 512(2,048), 1,024(4,096), 2,048(8,192) and 4,096(16,384) nodes(cores). (A) A 34,841 compound ZINC library was docked on variable BG/P systems sizes. Ideal speedup was calculated from the fastest 512 node result (SMP), and the relative speedup SMP and VN mode results were plotted. (B) A 9,000 compound subset ZINC library was docked on variable BG/P systems sizes, and ideal speedup was calculated from the fastest 512 node result (SMP). (C) A 4,000 copy indinavir library was docked on variable BG/P systems sizes, and an ideal speedup line was calculated from the fastest 512 node result (SMP). (D) Relative execution times for the 4,000 copy indinavir library were calculated for SMP and VN modes at each system size.</p></caption><p><graphic specific-use="HTML" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2011_Article_195_Fig3_HTML.jpg" /></p></fig></p>
            <p>In addition to multithreading, node utilization can be improved by pre-ordering ligands to be docked by complexity (descending number of torsional angles). For a sorted 9 k indinavir library docked in VN mode on a 2,048 core system, sorting improved docking speed by 10%, though it was still 9% slower than SMP mode (data not shown). In cases where the availably of CPUs greatly exceeds the number of molecules to be screened, multithreading is particularly useful for increasing the usefully employable system size. For example, a 4 k indinavir library in single-threaded execution (VN, OMP = 1) is unable to take advantage of more than 4,000 cores (Figure <xref rid="Fig3" ref-type="fig">3c</xref>). In contrast, multithreading (SMP, OMP = 4) allows up to 16,000 cores to be employed, decreasing the docking time by over 70% (Figure <xref rid="Fig3" ref-type="fig">3c</xref> and Figure <xref rid="Fig3" ref-type="fig">3d</xref>). For larger systems, combining OpenMP multithreading with MPI allows for more efficient utilization of system resources at the end of screens. For smaller screens, multithreading has a clear advantages over serial execution when the number of available cores exceeds the number of ligand-receptor complexes to be docked.</p>
          </sec>
          <sec id="Sec12">
            <title>OpenMP Scalability</title>
            <p>To test the scalability of the OpenMP implementation, a 1HPV complex was docked with mpAD4 on POWER7 p755 32-core server. Docking parameters were modified as follows: ga_runs = 128, ga_num_evals = 5,000,000. Table <xref rid="Tab2" ref-type="table">2</xref> shows apparent speedups and percent of ideal runtimes for a single docking of the 1HPV complex run as <italic>serial</italic> mpAD4 code (compiled without OpenMP) or utilizing from 1 to 32 OpenMP threads. On the POWER7 system, single-threaded OpenMP incurred a 12% overhead versus serial code. Overhead increased with thread number; with an apparent speedup of 1.5× for 2 threads to 22.3× for 32 threads (Table <xref rid="Tab2" ref-type="table">2</xref>). Our testing on BG/P showed an overhead of approximately 10% for either OMP = 1 or OMP = 4, with little or no additional cost for 4 threads over 1 (data not shown). Due to the overhead incurred with OMP = 1 vs. serial, a user intending to use mpAD4 only in single-threaded applications may benefit from compiling mpAD4 without OpenMP. We anticipate the specific OpenMP overhead will vary with both system characteristics and compiler options. Though here we have only demonstrated multithreading up to 32 cores, the code is currently implemented to allow up to 128 simultaneous threads, which we expect will allow further improvements total in docking speed.<table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>OpenMP Multithreading Speedup</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="center"><p>Threads</p></th><th align="right"><p>Speedup</p></th><th align="right"><p>% Ideal</p></th></tr></thead><tbody><tr><td align="center"><p>serial</p></td><td align="right"><p>1.0×</p></td><td align="right"><p>100</p></td></tr><tr><td align="center"><p>1</p></td><td align="right"><p>0.9×</p></td><td align="right"><p>88</p></td></tr><tr><td align="center"><p>2</p></td><td align="right"><p>1.5×</p></td><td align="right"><p>75</p></td></tr><tr><td align="center"><p>4</p></td><td align="right"><p>3.0×</p></td><td align="right"><p>74</p></td></tr><tr><td align="center"><p>8</p></td><td align="right"><p>5.8×</p></td><td align="right"><p>72</p></td></tr><tr><td align="center"><p>16</p></td><td align="right"><p>11.3×</p></td><td align="right"><p>71</p></td></tr><tr><td align="center"><p>32</p></td><td align="right"><p>22.3×</p></td><td align="right"><p>70</p></td></tr></tbody></table><table-wrap-foot><p>The speedup using OpenMP threads was calculated for 1 to 32 threads on a 3.3 GHz POWER7 p755 32-core server. A reference speed was calculated using mpAD4 compiled without OpenMP (serial). The numbers are scaled to a single serial docking run with the default benchmark parameters with modifications: ga_runs = 128, ga_num_evals = 5,000,000.</p></table-wrap-foot></table-wrap></p>
          </sec>
          <sec id="Sec13">
            <title>Output Comparison</title>
            <p>The binding modes generated by single or multithreaded execution of mpAD4 were determined for a set of 76 crystallographically determined ligand-protein complexes using a BG/P system size of 512 cores in SMP(OMP = 4) and VN(OMP = 1 or serial) modes [<xref ref-type="bibr" rid="CR24">24</xref>]. For each docked complex, pairwise RMSDs were calculated for the overall lowest energy ligand and lowest energy member of largest ligand cluster. When the lowest energy ligand was not also a member of the largest ligand cluster, the lesser pairwise RMSD value was used. The RMSDs from VN(serial) to VN(OMP = 1) or SMP(OMP = 4), and between VN(OMP = 1) and SMP(OMP = 4) were calculated (Table <xref rid="Tab3" ref-type="table">3</xref>). The mean RMSD values in all three comparisons were less than 1.0, with median values less than 0.2 (Table <xref rid="Tab3" ref-type="table">3</xref>). We therefore consider the outputs to be substantially similar.<table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p>Parallel and Serial Docking of 76 Receptor-Ligand complexes</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="center" colspan="4"><p>RMSD Comparisons</p></th></tr><tr><th /><th align="center"><p>s vs 1</p></th><th align="center"><p>s vs 4</p></th><th align="center"><p>1 vs 4</p></th></tr></thead><tbody><tr><td align="center"><p>ave</p></td><td align="center"><p>0.414</p></td><td align="center"><p>0.439</p></td><td align="center"><p>0.366</p></td></tr><tr><td align="center"><p>rms</p></td><td align="center"><p>0.525</p></td><td align="center"><p>0.667</p></td><td align="center"><p>0.510</p></td></tr><tr><td align="center"><p>med</p></td><td align="center"><p>0.168</p></td><td align="center"><p>0.170</p></td><td align="center"><p>0.139</p></td></tr><tr><td align="center"><p>min</p></td><td align="center"><p>0.005</p></td><td align="center"><p>0.008</p></td><td align="center"><p>0.003</p></td></tr><tr><td align="center"><p>max</p></td><td align="center"><p>2.526</p></td><td align="center"><p>4.332</p></td><td align="center"><p>3.255</p></td></tr></tbody></table><table-wrap-foot><p>76 Receptor-Ligand complexes were docked using a 128 node (512 core) BG/P system using the benchmark parameters with modifications: ga_runs = 70, ga_num_evals = 5,000,000. Pairwise RMSD values between VN (serial) and VN (OMP = 1), VN (serial) and SMP (OMP = 4), and VN (OMP = 1) and SMP (OMP = 4) for both the lowest energy docked ligands and the lowest energy member of the largest ligand cluster were calculated. When the pairwise RMSD between lowest energy-lowest energy and largest cluster-largest cluster were not equal, the lesser RMSD value was used (approximately 20% of comparisons). Statistics for the three comparisons were calculated.</p></table-wrap-foot></table-wrap></p>
          </sec>
          <sec id="Sec14">
            <title>Performance Expectations</title>
            <p>The implementation of MPI and OpenMP in mpAD4 is portable to systems with a suitable compiler and the required libraries. In the case of distributed-memory architectures using either Intel or AMD ×86 microprocessors, we expect similar trends in terms of performance. Environmental factors that may have a large impact on performance are network bandwidth, compute node microprocessor speed, memory and the availability of node local disk storage (potentially ameliorating I/O issues associated with writing log files). Multiparallel AD4 generates little MPI communication, and we therefore anticipate that it will scale well even on clusters with limited I/O bandwidth if they possess node local disk storage and sufficient RAM to store grid maps in memory. Similarly, we would predict that the OpenMP multithreading will generate performance gains on any modern multicore microprocessor, though overhead and absolute scalability may vary with compilers, compiler options and microprocessor architecture.</p>
          </sec>
        </sec>
        <sec id="Sec15" sec-type="conclusions">
          <title>Conclusions</title>
          <p>We have parallelized AutoDock 4.2 using MPI and OpenMP to create mpAD4, a standards compliant and portable parallel implementation of AutoDock, with user customizability in the balance between serial and parallel execution, a capability to reuse grid maps, and extensive profiling features for performance monitoring. In our tests, grid maps reuse drastically reduced system I/O, allowing for nearly linear scaling of mpAD4 on system sizes of up to 16,384 CPU cores. OpenMP multithreading scaled up to 32 threads, resulting in a maximum speedup of 22× over single-threaded execution. We propose three potential use cases for mpAD4: 1) combining MPI and OpenMP parallelization on large systems to balance system-level and node-level parallelization to manage I/O and achieve the best possible throughput, 2) enabling larger systems to be used for screening small libraries, and to improve system utilization at all library sizes, 3) facilitating the rapid docking of one or a small number of ligand-recepor complexes on shared memory systems.</p>
        </sec>
        <sec id="Sec16">
          <title>Availability and Requirements</title>
          <p>Project name: mpAutoDock 4.2</p>
          <p>Project home page: <ext-link xlink:href="http://autodock.scripps.edu/downloads/multilevel-parallel-autodock4.2" ext-link-type="url">http://autodock.scripps.edu/downloads/multilevel-parallel-autodock4.2</ext-link></p>
          <p>Operating system(s): Platform independent</p>
          <p>Programming language: C++</p>
          <p>Other requirements: MPI (MPICH2), OpenMP</p>
          <p>License: GNU GPL v3</p>
        </sec>
      </body>
      <back>
        <ack>
          <title>Acknowledgements</title>
          <p>We thank Cindy Mestad and Steven Westerbeck at IBM Rochester, David Singer and Fred Mintzer at IBM Watson and Sharon Selzo at IBM Poughkeepsie for technical assistance, and IBM corporation for providing access to the Blue Gene/P and POWER7 systems used in this study. We acknowledge the Minnesota Supercomputing Institute for providing technical support and computational resources for this study. We are grateful to Michael Pique for thoughtful discussions and reviewing this manuscript. This work was supported by an American Heart Association Predoctoral Fellowship 09PRE2220147 (APN), NIH Predoctoral Fellowship F30DA26762 (APN), and University of Minnesota-Rochester, Bioinformatics and Computational Biology (BICB) Program Seed Grant (DJK, CPS, JPK). The distribution of the mpAD4 software is supported by NIH Grant R01 GM069832 (A. Olson, The Scripps Research Institute).</p>
        </ack>
        <ref-list id="Bib1">
          <title>References</title>
          <ref-list>
            <ref id="CR1">
              <label>1.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Shoichet</surname>
                    <given-names>BK</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Virtual screening of chemical libraries</article-title>
                <source>Nature</source>
                <year>2004</year>
                <volume>432</volume>
                <issue>7019</issue>
                <fpage>862</fpage>
                <lpage>5</lpage>
                <pub-id pub-id-type="doi">10.1038/nature03197</pub-id>
                <pub-id pub-id-type="coi">1:CAS:528:DC%2BD2cXhtVOht7jK</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR2">
              <label>2.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Köppen</surname>
                    <given-names>H</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Virtual screening - what does it give us?</article-title>
                <source>Curr Opin Drug Discov Devel</source>
                <year>2009</year>
                <volume>12</volume>
                <issue>3</issue>
                <fpage>397</fpage>
                <lpage>407</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR3">
              <label>3.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>McInnes</surname>
                    <given-names>C</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Virtual screening strategies in drug discovery</article-title>
                <source>Curr Opin Chem Biol</source>
                <year>2007</year>
                <volume>11</volume>
                <issue>5</issue>
                <fpage>494</fpage>
                <lpage>502</lpage>
                <pub-id pub-id-type="doi">10.1016/j.cbpa.2007.08.033</pub-id>
                <pub-id pub-id-type="coi">1:CAS:528:DC%2BD2sXhtF2rsbrN</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR4">
              <label>4.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Kolb</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Ferreira</surname>
                    <given-names>RS</given-names>
                  </name>
                  <name>
                    <surname>Irwin</surname>
                    <given-names>JJ</given-names>
                  </name>
                  <name>
                    <surname>Shoichet</surname>
                    <given-names>BK</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Docking and chemoinformatic screens for new ligands and targets</article-title>
                <source>Curr Opin Biotechnol</source>
                <year>2009</year>
                <volume>20</volume>
                <issue>4</issue>
                <fpage>429</fpage>
                <lpage>36</lpage>
                <pub-id pub-id-type="doi">10.1016/j.copbio.2009.08.003</pub-id>
                <pub-id pub-id-type="coi">1:CAS:528:DC%2BD1MXht1OrtLbL</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR5">
              <label>5.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Sousa</surname>
                    <given-names>SF</given-names>
                  </name>
                  <name>
                    <surname>Fernandes</surname>
                    <given-names>PA</given-names>
                  </name>
                  <name>
                    <surname>Ramos</surname>
                    <given-names>MJ</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Protein-ligand docking: current status and future challenges</article-title>
                <source>Proteins</source>
                <year>2006</year>
                <volume>65</volume>
                <fpage>15</fpage>
                <lpage>26</lpage>
                <pub-id pub-id-type="doi">10.1002/prot.21082</pub-id>
                <pub-id pub-id-type="coi">1:CAS:528:DC%2BD28Xpt1Cmuro%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR6">
              <label>6.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Schames</surname>
                    <given-names>JR</given-names>
                  </name>
                  <name>
                    <surname>Henchman</surname>
                    <given-names>RH</given-names>
                  </name>
                  <name>
                    <surname>Siegel</surname>
                    <given-names>JS</given-names>
                  </name>
                  <name>
                    <surname>Sotriffer</surname>
                    <given-names>CA</given-names>
                  </name>
                  <name>
                    <surname>Ni</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>McCammon</surname>
                    <given-names>JA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Discovery of a novel binding trench in HIV integrase</article-title>
                <source>J Med Chem</source>
                <year>2004</year>
                <volume>47</volume>
                <issue>8</issue>
                <fpage>1879</fpage>
                <lpage>81</lpage>
                <pub-id pub-id-type="doi">10.1021/jm0341913</pub-id>
                <pub-id pub-id-type="coi">1:CAS:528:DC%2BD2cXhvV2js74%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR7">
              <label>7.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Cosconati</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Forli</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Perryman</surname>
                    <given-names>AL</given-names>
                  </name>
                  <name>
                    <surname>Harris</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Goodsell</surname>
                    <given-names>DS</given-names>
                  </name>
                  <name>
                    <surname>Olson</surname>
                    <given-names>AJ</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Virtual screening with AutoDock: theory and practice</article-title>
                <source>Expert Opin Drug Dis</source>
                <year>2010</year>
                <volume>5</volume>
                <issue>6</issue>
                <fpage>597</fpage>
                <lpage>607</lpage>
                <pub-id pub-id-type="doi">10.1517/17460441.2010.484460</pub-id>
                <pub-id pub-id-type="coi">1:CAS:528:DC%2BC3cXmtlKhtL0%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR8">
              <label>8.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Morris</surname>
                    <given-names>GM</given-names>
                  </name>
                  <name>
                    <surname>Huey</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Lindstrom</surname>
                    <given-names>W</given-names>
                  </name>
                  <name>
                    <surname>Sanner</surname>
                    <given-names>MF</given-names>
                  </name>
                  <name>
                    <surname>Belew</surname>
                    <given-names>RK</given-names>
                  </name>
                  <name>
                    <surname>Goodsell</surname>
                    <given-names>DS</given-names>
                  </name>
                  <name>
                    <surname>Olson</surname>
                    <given-names>AJ</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">AutoDock4 and AutoDockTools4: Automated docking with selective receptor flexibility</article-title>
                <source>Journal of Computational Chemistry</source>
                <year>2009</year>
                <volume>30</volume>
                <issue>16</issue>
                <fpage>2785</fpage>
                <lpage>91</lpage>
                <pub-id pub-id-type="doi">10.1002/jcc.21256</pub-id>
                <pub-id pub-id-type="coi">1:CAS:528:DC%2BD1MXht1GitrnK</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR9">
              <label>9.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Goodsell</surname>
                    <given-names>DS</given-names>
                  </name>
                  <name>
                    <surname>Morris</surname>
                    <given-names>GM</given-names>
                  </name>
                  <name>
                    <surname>Olson</surname>
                    <given-names>AJ</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Automated docking of flexible ligands: applications of AutoDock</article-title>
                <source>J Mol Recognit</source>
                <year>1996</year>
                <volume>9</volume>
                <fpage>1</fpage>
                <lpage>5</lpage>
                <pub-id pub-id-type="doi">10.1002/(SICI)1099-1352(199601)9:1&lt;1::AID-JMR241>3.0.CO;2-6</pub-id>
                <pub-id pub-id-type="coi">1:CAS:528:DyaK28Xis1SqtrY%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR10">
              <label>10.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Morris</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Goodsell</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Halliday</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Huey</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Hart</surname>
                    <given-names>W</given-names>
                  </name>
                  <name>
                    <surname>Belew</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Olson</surname>
                    <given-names>A</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Automated docking using a Lamarckian genetic algorithm and an empirical binding free energy function</article-title>
                <source>Journal of Computational Chemistry</source>
                <year>1998</year>
                <volume>19</volume>
                <issue>14</issue>
                <fpage>1639</fpage>
                <lpage>1662</lpage>
                <pub-id pub-id-type="doi">10.1002/(SICI)1096-987X(19981115)19:14&lt;1639::AID-JCC10>3.0.CO;2-B</pub-id>
                <pub-id pub-id-type="coi">1:CAS:528:DyaK1cXntFemur4%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR11">
              <label>11.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Park</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Lee</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Lee</surname>
                    <given-names>S</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Critical assessment of the automated AutoDock as a new docking tool for virtual screening</article-title>
                <source>Proteins</source>
                <year>2006</year>
                <volume>65</volume>
                <issue>3</issue>
                <fpage>549</fpage>
                <lpage>54</lpage>
                <pub-id pub-id-type="doi">10.1002/prot.21183</pub-id>
                <pub-id pub-id-type="coi">1:CAS:528:DC%2BD28XhtFWqt7nK</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR12">
              <label>12.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Chang</surname>
                    <given-names>MW</given-names>
                  </name>
                  <name>
                    <surname>Ayeni</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Breuer</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Torbett</surname>
                    <given-names>BE</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Virtual screening for HIV protease inhibitors: a comparison of AutoDock 4 and Vina</article-title>
                <source>PLoS ONE</source>
                <year>2010</year>
                <volume>5</volume>
                <issue>8</issue>
                <fpage>e11955</fpage>
                <pub-id pub-id-type="doi">10.1371/journal.pone.0011955</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR13">
              <label>13.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Zhang</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Kumar</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Jiang</surname>
                    <given-names>X</given-names>
                  </name>
                  <name>
                    <surname>Wallqvist</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Reifman</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">DOVIS: an implementation for high-throughput virtual screening using AutoDock</article-title>
                <source>BMC Bioinformatics</source>
                <year>2008</year>
                <volume>9</volume>
                <fpage>126</fpage>
                <pub-id pub-id-type="doi">10.1186/1471-2105-9-126</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR14">
              <label>14.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Prakhov</surname>
                    <given-names>ND</given-names>
                  </name>
                  <name>
                    <surname>Chernorudskiy</surname>
                    <given-names>AL</given-names>
                  </name>
                  <name>
                    <surname>Gainullin</surname>
                    <given-names>MR</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">VSDocker: a tool for parallel high-throughput virtual screening using AutoDock on Windows-based computer clusters</article-title>
                <source>Bioinformatics</source>
                <year>2010</year>
                <volume>26</volume>
                <issue>10</issue>
                <fpage>1374</fpage>
                <lpage>5</lpage>
                <pub-id pub-id-type="doi">10.1093/bioinformatics/btq149</pub-id>
                <pub-id pub-id-type="coi">1:CAS:528:DC%2BC3cXlvVWqt78%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR15">
              <label>15.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Mezei</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Zhou</surname>
                    <given-names>MM</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Dockres: a computer program that analyzes the output of virtual screening of small molecules</article-title>
                <source>Source Code Biol Med</source>
                <year>2010</year>
                <volume>5</volume>
                <fpage>2</fpage>
                <pub-id pub-id-type="doi">10.1186/1751-0473-5-2</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR16">
              <label>16.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Jiang</surname>
                    <given-names>X</given-names>
                  </name>
                  <name>
                    <surname>Kumar</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Hu</surname>
                    <given-names>X</given-names>
                  </name>
                  <name>
                    <surname>Wallqvist</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Reifman</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">DOVIS 2.0: an efficient and easy to use parallel virtual screening tool based on AutoDock 4.0</article-title>
                <source>Chem Cent J</source>
                <year>2008</year>
                <volume>2</volume>
                <fpage>18</fpage>
                <pub-id pub-id-type="doi">10.1186/1752-153X-2-18</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR17">
              <label>17.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Collignon</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>Schulz</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Smith</surname>
                    <given-names>JC</given-names>
                  </name>
                  <name>
                    <surname>Baudry</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Task-parallel message passing interface implementation of Autodock4 for docking of very large databases of compounds using high-performance super-computers</article-title>
                <source>Journal of Computational Chemistry</source>
                <year>2011</year>
                <volume>32</volume>
                <issue>6</issue>
                <fpage>1202</fpage>
                <lpage>9</lpage>
                <pub-id pub-id-type="doi">10.1002/jcc.21696</pub-id>
                <pub-id pub-id-type="coi">1:CAS:528:DC%2BC3MXivVGjsL8%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR18">
              <label>18.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Thormann</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Pons</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Massive docking of flexible ligands using environmental niches in parallelized genetic algorithms</article-title>
                <source>Journal of Computational Chemistry</source>
                <year>2001</year>
                <volume>22</volume>
                <issue>16</issue>
                <fpage>1971</fpage>
                <lpage>1982</lpage>
                <pub-id pub-id-type="doi">10.1002/jcc.1146</pub-id>
                <pub-id pub-id-type="coi">1:CAS:528:DC%2BD3MXotlCntr4%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR19">
              <label>19.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Khodade</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Prabhu</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Chandra</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Raha</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Govindarajan</surname>
                    <given-names>R</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Parallel implementation of AutoDock</article-title>
                <source>Journal of Applied Crystallography</source>
                <year>2007</year>
                <volume>40</volume>
                <issue>3</issue>
                <fpage>598</fpage>
                <lpage>599</lpage>
                <pub-id pub-id-type="doi">10.1107/S0021889807011053</pub-id>
                <pub-id pub-id-type="coi">1:CAS:528:DC%2BD2sXltlKqurc%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR20">
              <label>20.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Vetter</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Anselmi</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Blanchard</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>Cho</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Hales</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Quezada</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">IBM Power 750 and 755 Technical Overview and Introduction</article-title>
                <source>RedBook REDP-4638-00</source>
                <year>2010</year>
              </mixed-citation>
            </ref>
            <ref id="CR21">
              <label>21.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Sosa</surname>
                    <given-names>CP</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">IBM System Blue Gene Solution: Blue Gene/P Application Development</article-title>
                <source>RedBook SG24-7287</source>
                <year>2008</year>
              </mixed-citation>
            </ref>
            <ref id="CR22">
              <label>22.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Irwin</surname>
                    <given-names>JJ</given-names>
                  </name>
                  <name>
                    <surname>Shoichet</surname>
                    <given-names>BK</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">ZINC-a free database of commercially available compounds for virtual screening</article-title>
                <source>Journal of chemical information and modeling</source>
                <year>2005</year>
                <volume>45</volume>
                <fpage>177</fpage>
                <lpage>82</lpage>
                <pub-id pub-id-type="doi">10.1021/ci049714+</pub-id>
                <pub-id pub-id-type="coi">1:CAS:528:DC%2BD2cXhtVOjt77J</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR23">
              <label>23.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Sanner</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Python: a programming language for software integration and development</article-title>
                <source>J Mol Graphics Mod</source>
                <year>1999</year>
                <volume>17</volume>
                <fpage>57</fpage>
                <lpage>61</lpage>
                <pub-id pub-id-type="coi">1:CAS:528:DC%2BD3cXhtV2rsA%3D%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR24">
              <label>24.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Moustakas</surname>
                    <given-names>DT</given-names>
                  </name>
                  <name>
                    <surname>Lang</surname>
                    <given-names>PT</given-names>
                  </name>
                  <name>
                    <surname>Pegg</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Pettersen</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Kuntz</surname>
                    <given-names>ID</given-names>
                  </name>
                  <name>
                    <surname>Brooijmans</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Rizzo</surname>
                    <given-names>RC</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Development and validation of a modular, extensible docking program: DOCK 5</article-title>
                <source>J Comput Aided Mol Des</source>
                <year>2006</year>
                <volume>20</volume>
                <issue>10-11</issue>
                <fpage>601</fpage>
                <lpage>19</lpage>
                <pub-id pub-id-type="doi">10.1007/s10822-006-9060-4</pub-id>
                <pub-id pub-id-type="coi">1:CAS:528:DC%2BD28XhtlCksbjM</pub-id>
              </mixed-citation>
            </ref>
          </ref-list>
        </ref-list>
        <app-group>
          <app id="App1">
            <sec id="Sec17">
              <title>Authors’ original submitted files for images</title>
              <p>Below are the links to the authors’ original submitted files for images.<supplementary-material content-type="local-data" id="MOESM1" xlink:title="Authors’ original submitted files for images"><media xlink:href="MediaObjects/13321_2011_195_MOESM1_ESM.pdf" mimetype="application" mime-subtype="pdf"><caption xml:lang="en"><p>Authors’ original file for figure 1</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM2" xlink:title="Authors’ original submitted files for images"><media xlink:href="MediaObjects/13321_2011_195_MOESM2_ESM.pdf" mimetype="application" mime-subtype="pdf"><caption xml:lang="en"><p>Authors’ original file for figure 2</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM3" xlink:title="Authors’ original submitted files for images"><media xlink:href="MediaObjects/13321_2011_195_MOESM3_ESM.pdf" mimetype="application" mime-subtype="pdf"><caption xml:lang="en"><p>Authors’ original file for figure 3</p></caption></media></supplementary-material></p>
            </sec>
          </app>
        </app-group>
        <notes notes-type="Misc">
          <title>Competing interests</title>
          <p>The authors declare that they have no competing interests.</p>
        </notes>
        <notes notes-type="Misc">
          <title>Authors' contributions</title>
          <p>APN participated in the design of this work, performed validation and benchmarking of the parallel code, and wrote this manuscript. PKC parallelized the AutoDock code, and assisted in drafting this manuscript. JPK participated in the design of this work, and in revising this manuscript for publication. DJK assisted in the analysis of the data, and in revising this manuscript for publication. CPS conceived this study, participated in the design of this work, coordinated its execution, and helped to revise this manuscript for publication. All authors read and approved the final manuscript.</p>
        </notes>
      </back>
    </article>
