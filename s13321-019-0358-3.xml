<?xml version="1.0"?>
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="research-article" xml:lang="en">
      <front>
        <journal-meta>
          <journal-id journal-id-type="publisher-id">13321</journal-id>
          <journal-title-group>
            <journal-title>Journal of Cheminformatics</journal-title>
            <abbrev-journal-title abbrev-type="publisher">J Cheminform</abbrev-journal-title>
          </journal-title-group>
          <issn pub-type="epub">1758-2946</issn>
          <publisher>
            <publisher-name>Springer International Publishing</publisher-name>
            <publisher-loc>Cham</publisher-loc>
          </publisher>
        </journal-meta>
        <article-meta>
          <article-id pub-id-type="publisher-id">s13321-019-0358-3</article-id>
          <article-id pub-id-type="manuscript">358</article-id>
          <article-id pub-id-type="doi">10.1186/s13321-019-0358-3</article-id>
          <article-categories>
            <subj-group subj-group-type="heading">
              <subject>Software</subject>
            </subj-group>
          </article-categories>
          <title-group>
            <article-title xml:lang="en">Gypsum-DL: an open-source program for preparing small-molecule libraries for structure-based virtual screening</article-title>
          </title-group>
          <contrib-group>
            <contrib contrib-type="author" id="Au1">
              <name>
                <surname>Ropp</surname>
                <given-names>Patrick J.</given-names>
              </name>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author" id="Au2">
              <name>
                <surname>Spiegel</surname>
                <given-names>Jacob O.</given-names>
              </name>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author" id="Au3">
              <name>
                <surname>Walker</surname>
                <given-names>Jennifer L.</given-names>
              </name>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author" id="Au4">
              <name>
                <surname>Green</surname>
                <given-names>Harrison</given-names>
              </name>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author" id="Au5">
              <name>
                <surname>Morales</surname>
                <given-names>Guillermo A.</given-names>
              </name>
              <xref ref-type="aff" rid="Aff2">2</xref>
              <xref ref-type="aff" rid="Aff3">3</xref>
            </contrib>
            <contrib contrib-type="author" id="Au6">
              <name>
                <surname>Milliken</surname>
                <given-names>Katherine A.</given-names>
              </name>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author" id="Au7">
              <name>
                <surname>Ringe</surname>
                <given-names>John J.</given-names>
              </name>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author" corresp="yes" id="Au8">
              <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5808-4097</contrib-id>
              <name>
                <surname>Durrant</surname>
                <given-names>Jacob D.</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="corresp" rid="IDs1332101903583_cor8">h</xref>
            </contrib>
            <aff id="Aff1">
              <label>1</label>
              <institution-wrap>
                <institution-id institution-id-type="ISNI">0000 0004 1936 9000</institution-id>
                <institution-id institution-id-type="GRID">grid.21925.3d</institution-id>
                <institution content-type="org-division">Department of Biological Sciences</institution>
                <institution content-type="org-name">University of Pittsburgh</institution>
              </institution-wrap>
              <addr-line content-type="postcode">15260</addr-line>
              <addr-line content-type="city">Pittsburgh</addr-line>
              <addr-line content-type="state">PA</addr-line>
              <country country="US">USA</country>
            </aff>
            <aff id="Aff2">
              <label>2</label>
              <institution-wrap>
                <institution-id institution-id-type="ISNI">0000 0001 2287 3919</institution-id>
                <institution-id institution-id-type="GRID">grid.257413.6</institution-id>
                <institution content-type="org-division">Department of Chemistry and Chemical Biology</institution>
                <institution content-type="org-name">Indiana University-Purdue University Indianapolis</institution>
              </institution-wrap>
              <addr-line content-type="postcode">46202</addr-line>
              <addr-line content-type="city">Indianapolis</addr-line>
              <addr-line content-type="state">IN</addr-line>
              <country country="US">USA</country>
            </aff>
            <aff id="Aff3">
              <label>3</label>
              <institution-wrap>
                <institution content-type="org-name">Innoventyx, LLC</institution>
              </institution-wrap>
              <addr-line content-type="postcode">85737</addr-line>
              <addr-line content-type="city">Oro Valley</addr-line>
              <addr-line content-type="state">AZ</addr-line>
              <country country="US">USA</country>
            </aff>
          </contrib-group>
          <author-notes>
            <fn fn-type="con">
              <p>Patrick J. Ropp and Jacob O. Spiegel should be regarded as joint first authors.</p>
            </fn>
            <corresp id="IDs1332101903583_cor8">
              <label>h</label>
              <email>HIDDEN</email>
            </corresp>
          </author-notes>
          <pub-date date-type="pub" publication-format="electronic">
            <day>24</day>
            <month>5</month>
            <year>2019</year>
          </pub-date>
          <pub-date date-type="collection" publication-format="electronic">
            <month>12</month>
            <year>2019</year>
          </pub-date>
          <volume>11</volume>
          <issue seq="34">1</issue>
          <elocation-id>34</elocation-id>
          <history>
            <date date-type="registration">
              <day>15</day>
              <month>5</month>
              <year>2019</year>
            </date>
            <date date-type="received">
              <day>18</day>
              <month>3</month>
              <year>2019</year>
            </date>
            <date date-type="accepted">
              <day>15</day>
              <month>5</month>
              <year>2019</year>
            </date>
            <date date-type="online">
              <day>24</day>
              <month>5</month>
              <year>2019</year>
            </date>
          </history>
          <permissions>
            <copyright-statement content-type="compact">© The Author(s) 2019</copyright-statement>
            <copyright-year>2019</copyright-year>
            <copyright-holder>The Author(s)</copyright-holder>
            <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
              <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link xlink:href="http://creativecommons.org/publicdomain/zero/1.0/" ext-link-type="uri">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
            </license>
          </permissions>
          <abstract xml:lang="en" id="Abs1">
            <title>Abstract</title>
            <p id="Par1">Computational techniques such as structure-based virtual screening require carefully prepared 3D models of potential small-molecule ligands. Though powerful, existing commercial programs for virtual-library preparation have restrictive and/or expensive licenses. Freely available alternatives, though often effective, do not fully account for all possible ionization, tautomeric, and ring-conformational variants. We here present Gypsum-DL, a free, robust open-source program that addresses these challenges. As input, Gypsum-DL accepts virtual compound libraries in SMILES or flat SDF formats. For each molecule in the virtual library, it enumerates appropriate ionization, tautomeric, chiral, cis/trans isomeric, and ring-conformational forms. As output, Gypsum-DL produces an SDF file containing each molecular form, with 3D coordinates assigned. To demonstrate its utility, we processed 1558 molecules taken from the NCI Diversity Set VI and 56,608 molecules taken from a Distributed Drug Discovery (D3) combinatorial virtual library. We also used 4463 high-quality protein–ligand complexes from the PDBBind database to show that Gypsum-DL processing can improve virtual-screening pose prediction. Gypsum-DL is available free of charge under the terms of the Apache License, Version 2.0.<fig id="Figa" position="anchor"><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_358_Figa_HTML.png" position="anchor" id="MO1000" /></fig></p>
          </abstract>
          <kwd-group xml:lang="en">
            <title>Keywords</title>
            <kwd>Small-molecule libraries</kwd>
            <kwd>Virtual screening</kwd>
            <kwd>Chemical biology</kwd>
            <kwd>Computer-aided drug discovery</kwd>
            <kwd>Computational biology</kwd>
            <kwd>3D structure generation</kwd>
          </kwd-group>
          <custom-meta-group>
            <custom-meta>
              <meta-name>publisher-imprint-name</meta-name>
              <meta-value>Springer</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-issue-count</meta-name>
              <meta-value>1</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-article-count</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-pricelist-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-holder</meta-name>
              <meta-value>The Author(s)</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-contains-esm</meta-name>
              <meta-value>No</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-month</meta-name>
              <meta-value>5</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-day</meta-name>
              <meta-value>15</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-product</meta-name>
              <meta-value>ArchiveJournal</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-grants-type</meta-name>
              <meta-value>OpenChoice</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>metadata-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>abstract-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodypdf-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodyhtml-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bibliography-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>esm-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>online-first</meta-name>
              <meta-value>false</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-file-reference</meta-name>
              <meta-value>BodyRef/PDF/13321_2019_Article_358.pdf</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>target-type</meta-name>
              <meta-value>OnlinePDF</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-type</meta-name>
              <meta-value>OriginalPaper</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-primary</meta-name>
              <meta-value>Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computer Applications in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Documentation and Information in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Theoretical and Computational Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computational Biology/Bioinformatics</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-collection</meta-name>
              <meta-value>Chemistry and Materials Science</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>open-access</meta-name>
              <meta-value>true</meta-value>
            </custom-meta>
          </custom-meta-group>
        </article-meta>
      </front>
      <body>
        <sec id="Sec1">
          <title>Introduction</title>
          <p id="Par2">Structure-based virtual screening (VS) is a powerful tool for pharmacological and basic-science research [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. In a successful VS campaign, a docking program poses small-molecule models within a protein binding pocket, and a scoring function estimates binding affinities. Experimentalists then test the top-scoring compounds to verify binding. Hit rates are often better than those obtained through high-throughput screening alone [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
          <p id="Par3">The first and foundational step in a VS workflow is pose prediction. Accurate prediction depends on high-quality 3D models of both protein receptor(s) and potential small-molecule ligands. Small-molecule databases often store compounds in formats that include only atom-type and bond information (e.g., SMILES). Furthermore, database entries typically describe only one ionization or tautomeric state per molecule, and they may lack information about chirality and cis/trans isomerization.</p>
          <p id="Par4">Though effective, available commercial and open-source programs for processing and converting these simple representations into fully enumerated 3D models have their drawbacks. Commercial programs such as OpenEye’s OMEGA/QUACPAC [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>] and Schrödinger’s LigPrep (Schrödinger, LLC) have restrictive licenses and can be expensive. While OpenEye does offer a free academic license, that license imposes substantial commercialization and intellectual-property restrictions. License eligibility is also regularly re-evaluated, making long-term access uncertain. And workflows that incorporate commercial tools cannot typically be freely distributed.</p>
          <p id="Par5">Free alternatives include Frog2 [<xref ref-type="bibr" rid="CR5">5</xref>] and Balloon [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. Frog2 [<xref ref-type="bibr" rid="CR5">5</xref>] is an open-source, web-based program that requires no installation. Users must first upload their compounds in SMILES format to the RPBS Web portal (<ext-link xlink:href="http://bioserv.rpbs.univ-paris-diderot.fr/services/Frog2/" ext-link-type="uri">http://bioserv.rpbs.univ-paris-diderot.fr/services/Frog2/</ext-link>) [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. The Frog2 server then assigns 3D coordinates and provides a downloadable file containing the results. In contrast, Balloon [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>] is a command-line program that can be easily and freely incorporated into larger workflows. Though Balloon is free, the source code is not publicly available, and the program does not account for alternate chiral and cis/trans isomeric forms. Additionally, Frog2 and Balloon ignore alternate ionization and tautomeric forms; sometimes miss low-energy, non-aromatic ring conformations; and generate excess rotamers beyond those needed for flexible-ligand docking.</p>
          <p id="Par6">The popular open-source cheminformatics package Open Babel [<xref ref-type="bibr" rid="CR10">10</xref>] also includes several executable files that can perform key small-molecule preparation steps. For example, the <italic>obabel</italic> executable accepts a -<italic>p</italic> (pH) parameter that ionizes molecules as appropriate for a user-specified pH. The <italic>obabel</italic> –<italic>gen3D</italic> (generate 3D coordinates) parameter also converts molecular representations to 3D models that can be further optimized with <italic>obminimize</italic>. But it is difficult to generate alternate tautomeric, chiral, and cis/trans isomeric forms using Open Babel’s command-line interface. Advanced users/programmers must implement these features separately using Open Babel’s programming API. Open Babel is also released under a copyleft license (GNU General Public License, version 2), which requires that any derivate works also be copyleft.</p>
          <p id="Par7">To address the limitations of existing commercial and open-source packages, we here present Gypsum-DL, a free, open-source program for preparing small-molecule libraries. Beyond simply assigning 3D coordinates, Gypsum-DL outputs molecular models with varying ionization, tautomeric, and isomeric states. Protein binding pockets often stabilize these alternate forms, even if their prevalence is low in bulk solution. Gypsum-DL also generates models with alternate non-aromatic ring conformations. Considering alternate ring conformations is critical given that most flexible-ligand docking programs (e.g., AutoDock Vina [<xref ref-type="bibr" rid="CR12">12</xref>]) do not account for all possible ligand ring geometries during the docking process itself.</p>
          <p id="Par8">We use 4463 high-quality protein–ligand complexes from the PDBBind database (<ext-link xlink:href="http://www.pdbbind.org.cn/" ext-link-type="uri">http://www.pdbbind.org.cn/</ext-link>) [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>] to show that Gypsum-DL processing can improve VS pose prediction. To further show utility, we also use Gypsum-DL to process two virtual molecular libraries: (1) the NCI Diversity Set VI, a set of freely available compounds provided by the National Cancer Institute (1558 molecules); and N-acylated unnatural amino acids enumerated using the accessible chemical reaction schemes developed by the Distributed Drug Discovery (D3) initiative (56,608 molecules) [<xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR18">18</xref>]. These virtual libraries are available free of charge for use in VS projects.</p>
          <p id="Par9">Gypsum-DL will be a helpful tool for those engaged in both basic-science and drug-discovery research. A copy is available at <ext-link xlink:href="http://durrantlab.com/gypsum-dl/" ext-link-type="uri">http://durrantlab.com/gypsum-dl/</ext-link>, released under the terms of the Apache License, Version 2.0.</p>
        </sec>
        <sec id="Sec2">
          <title>Implementation</title>
          <sec id="Sec3">
            <title>The Gypsum-DL algorithm</title>
            <p id="Par10">Gypsum-DL uses RDKit (<ext-link xlink:href="http://www.rdkit.org" ext-link-type="uri">http://www.rdkit.org</ext-link>), MolVS 0.1.1 (<ext-link xlink:href="https://molvs.readthedocs.io" ext-link-type="uri">https://molvs.readthedocs.io</ext-link>), and Dimorphite-DL 1.0 [<xref ref-type="bibr" rid="CR11">11</xref>] to convert small-molecule representations (SMILES strings or flat SDF files) into 3D models (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) [<xref ref-type="bibr" rid="CR19">19</xref>]. Each output SDF file includes fields that describe the steps used to generate the corresponding model. Gypsum-DL also leverages multiple processors, if available, to speed the conversion of large virtual libraries. Command-line flags allow the user to precisely control all aspects of the program, though the default parameters should serve most use cases.<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>The Gypsum workflow. <bold>a</bold> Gypsum prepares a virtual small-molecule library by desalting the input compounds and considering alternate ionization, tautomeric, chiral, and cis/trans isomeric states. It then converts all variants to 3D, accounting for alternate ring conformations where appropriate. <bold>b</bold> Illustrative examples of each Gypsum step</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_358_Fig1_HTML.png" id="MO1" /></fig></p>
            <sec id="Sec4">
              <title>Desalting</title>
              <p id="Par11">Gypsum-DL first removes any salts present in the user-specified virtual compound library. Molecular representations (e.g., SMILES) often include the primary molecule together with accompanying counterions. Gypsum-DL retains only the largest fragment, the presumed compound of interest.</p>
            </sec>
            <sec id="Sec5">
              <title>Ionization</title>
              <p id="Par12">Gypsum-DL uses the Dimorphite-DL 1.0 algorithm [<xref ref-type="bibr" rid="CR11">11</xref>] to generate models with different ionization states. It considers a user-defined range of pH values (6.4–8.4 by default) rather than a single (e.g., physiological) pH. Separate models are created for each identified state.</p>
              <p id="Par13">Given the computational demands of high-throughput VS, it is important to limit the number of ionization forms considered. To eliminate highly charged forms that are unlikely to be physiologically relevant, Gypsum-DL first identifies the generated ionization form with a formal charge that is closest to zero. It eliminates any additional ionization forms whose formal charges deviate from that baseline by 3 <italic>e</italic> or more.</p>
            </sec>
            <sec id="Sec6">
              <title>Tautomeric forms</title>
              <p id="Par14">Many compounds readily interconvert between tautomeric states as protons and electrons shift among atoms. Gypsum-DL uses MolVS 0.1.1 to enumerate all possible tautomers. It discards tautomers that alter the number of aromatic rings (i.e., by breaking ring aromaticity) or the number of chiral centers. Separate models are created for each identified tautomeric form.</p>
              <p id="Par15">MolVS occasionally produces particularly improbable tautomeric forms. Gypsum-DL maintains a list of substructures associated with these forms and automatically eliminates any matching models. For example, though Gypsum-DL does consider keto–enol tautomerism, it does not permit enol forms that result in terminal alkenes. It also eliminates compounds with geminal vinyl diols, which are improbable tautomers of carboxylic acids. Any form with a carbanion is also eliminated, as are tautomers that disrupt existing aromaticity.</p>
            </sec>
            <sec id="Sec7">
              <title>Unspecified chiral centers and cis/trans double-bond isomerization</title>
              <p id="Par16">Many virtual-library databases do not fully specify all compound chiral centers. Gypsum-DL thoroughly generates alternate chiral species by varying each of the unspecified chiral centers in each input molecule. Specifically defined chiral centers remain unchanged. Similarly, virtual-library databases often include compounds with unspecified double-bond isomerization. Gypsum-DL systematically and thoroughly generates alternate cis/trans isomers as needed.</p>
              <p id="Par17">We note that MolVS removes double-bond cis/trans stereochemistry if any derived tautomeric form changes the double bond to a single bond. Some compounds may thus end up with unspecified double bonds, even if the input molecular representation explicitly specifies isomerization. This behavior is intentional, though it may surprise some users. Gypsum-DL enumerates both the cis and trans isomers in such cases.</p>
            </sec>
            <sec id="Sec8">
              <title>Alternate conformations of non-aromatic rings</title>
              <p id="Par18">To sample different small-molecule conformers, flexible-ligand docking programs permit virtual rotations about single bonds during the docking process. But they often treat rings as rigid, even if those rings include single bonds. Transitions between different ring conformations (e.g., the boat and chair conformations of cyclohexane) are thus ignored. Gypsum-DL addresses this shortcoming by generating separate models with distinct low-energy ring conformations.</p>
              <p id="Par19">Gypsum-DL first generates multiple 3D models of each input molecule using the Experimental Torsion with Knowledge Distance Geometry (ETKDG) method (version 2 if available, or version 1 otherwise) [<xref ref-type="bibr" rid="CR20">20</xref>]. These initial models are then optimized using the Universal Force Field (UFF) [<xref ref-type="bibr" rid="CR21">21</xref>]. Though this optimization step is computationally expensive, it encourages 3D ring conformers that closely correspond to discrete energy minima. For a given compound with <italic>R</italic> non-aromatic rings, there are thus <italic>M</italic> optimized 3D models (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, where <italic>R</italic> = 2 and <italic>M </italic>= 4).<fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>A schematic of the Gypsum-DL algorithm for generating ring-conformational forms. <bold>a</bold> Create multiple 3D variants using ETKDG and UFF optimization. <bold>b</bold> Extract the rings. <bold>c</bold> Collect the coordinates of the ring atoms. <bold>d</bold> Construct ring fingerprints by calculating the RMSD between each ring and the corresponding ring of the first model. <bold>e</bold>, <bold>f</bold> Use <italic>k</italic>-means clustering to identify unique ring fingerprints. The small circles on the graphs represent fingerprints, the larger dashed circles represent clusters, and the black circles represent the most central fingerprint of each cluster. <bold>g</bold> The central fingerprints correspond to geometrically unique models</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_358_Fig2_HTML.png" id="MO2" /></fig></p>
              <p id="Par20">For reference, we assign an index, <italic>m</italic>, to each of the <italic>M</italic> models. We also assign an index, <italic>r</italic>, to each of the <italic>R</italic> non-aromatic rings, and we say that the <italic>r</italic>th ring contains <italic>A</italic><sub><italic>r</italic></sub> atoms (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). There are thus <italic>M</italic> total conformations of the <italic>r</italic>th ring, one corresponding to each modeled compound. The <italic>r</italic>th ring of the <italic>m</italic>th model refers to a specific ring. To describe the geometry of that ring, Gypsum-DL places the 3D coordinates, (<italic>a</italic><sub><italic>x</italic></sub>, <italic>a</italic><sub><italic>y</italic></sub>, <italic>a</italic><sub><italic>z</italic></sub>), of its <italic>A</italic><sub><italic>r</italic></sub> constituent atoms into an ordered list, <italic>c</italic><sub><italic>m</italic>,<italic>r</italic></sub> (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c), where<disp-formula id="Equa"><alternatives><mml:math display="block" id="Equa_Math"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">N</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.333333em" /><mml:mi>a</mml:mi><mml:mo>≤</mml:mo></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equa_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{m,r} = \left\{ {\left( {a_{x} ,a_{y} ,a_{z} } \right) |a \in {\mathbb{N}},\text{ }a \le A_{r} } \right\}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_358_Article_Equa.gif" /></alternatives></disp-formula>To describe the collective ring-conformational geometry of the <italic>m</italic>th model, Gypsum-DL collects the geometries of the <italic>R</italic> associated rings, <italic>c</italic><sub><italic>m</italic>,<italic>r</italic></sub>, into another ordered list, <italic>s</italic><sub><italic>m</italic></sub> (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c):<disp-formula id="Equb"><alternatives><mml:math display="block" id="Equb_Math"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">N</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.333333em" /><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equb_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_{m} = \left\{ {c_{m,r} |r \in {\mathbb{N}},\text{ }r \le R} \right\}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_358_Article_Equb.gif" /></alternatives></disp-formula>To quantify how much a given 3D models’ ring conformations collectively differ from those of the first model, Gypsum-DL generates an <italic>R</italic>-dimensional “ring-conformation fingerprint,” <italic>f</italic><sub><italic>m</italic></sub> (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d), for each of the <italic>s</italic><sub><italic>m</italic></sub> lists:<disp-formula id="Equc"><alternatives><mml:math display="block" id="Equc_Math"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">N</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.333333em" /><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:math><tex-math id="Equc_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_{m} = \left\{ {RMSD\left( {c_{m,r} , c_{1,r} } \right) |r \in {\mathbb{N}},\text{ }r \le R} \right\}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_358_Article_Equc.gif" /></alternatives></disp-formula>where the function RMSD(<italic>c</italic><sub>1</sub>, <italic>c</italic><sub>2</sub>) is the minimum root-mean-square deviation (RMSD) between coordinate set <italic>c</italic><sub>1</sub> and coordinate set <italic>c</italic><sub>2</sub> when <italic>c</italic><sub>1</sub> is allowed to freely rotate and translate.</p>
              <p id="Par21">The first fingerprint (<italic>f</italic><sub>1</sub>) is thus an <italic>R</italic>-dimensional zero vector because the conformations of the first-model rings are identical to themselves. Subsequent <italic>f</italic><sub><italic>m</italic></sub> are <italic>R</italic>-dimensional vectors whose entries represent the extent to which the conformation of the corresponding ring differs from that of the same ring in the first model.</p>
              <p id="Par22">Among the <italic>M</italic> models generated, some may have very similar ring conformational states. To eliminate this redundancy, Gypsum-DL uses <italic>k</italic>-means clustering [<xref ref-type="bibr" rid="CR22">22</xref>] to cluster the set of all <italic>f</italic><sub><italic>m</italic></sub> into at most <italic>max_variants_per_compound</italic> groups, where <italic>max_variants_per_compound</italic> is a user parameter (default: 5; Fig. <xref rid="Fig2" ref-type="fig">2</xref>e, f). Only the 3D models corresponding to the most central <italic>f</italic><sub><italic>m</italic></sub> of each cluster are retained (Fig. <xref rid="Fig2" ref-type="fig">2</xref>g).</p>
            </sec>
            <sec id="Sec9">
              <title>Controlling the combinatorial explosion</title>
              <p id="Par23">Gypsum-DL accounts for alternate ionization, tautomeric, chiral, isomeric, and ring-conformational states. From an algorithmic perspective, each of these five states is independent. It is thus possible to generate an intractable number of models per input molecule. For example, consider a molecule with two variants for each state. Accounting for all possible forms would require 2<sup>5</sup> = 32 models per molecule. Performing a VS of 10,000 compounds would thus require 320,000 separate dockings.</p>
              <p id="Par24">To prevent this combinatorial explosion, after each step Gypsum-DL prunes the growing set of enumerated forms associated with each input molecule. It first randomly selects <italic>m</italic> x <italic>t</italic> variants from all the forms generated, where <italic>m</italic> is the <italic>max_variants_per_compound</italic> user parameter (default: 5) and <italic>t</italic> is the <italic>thoroughness</italic> user parameter (a scaling factor, default: 3). It then uses ETKDG [<xref ref-type="bibr" rid="CR20">20</xref>] to generate a 3D conformer for each of the selected <italic>m</italic> × <italic>t</italic> variants. The energies of these conformers are evaluated using the UFF [<xref ref-type="bibr" rid="CR21">21</xref>]. To reduce computational cost, Gypsum-DL generally performs this evaluation without geometry optimization (except for compounds with non-aromatic rings, see above). It ultimately retains only the <italic>m</italic> compounds from the <italic>m</italic> x <italic>t</italic> variants with the best predicted energies.</p>
            </sec>
            <sec id="Sec10">
              <title>Final geometry optimization and output</title>
              <p id="Par25">As a final step, Gypsum-DL uses the UFF to optimize the geometries of any remaining compounds that have not already been optimized (i.e., any compound that was not already optimized in the ring-conformation step). It saves the resulting 3D models to SDF file(s) in a user-specified directory. The user can also instruct the program to additionally save conformers in the PDB format. Optional output to an HTML file allows the user to quickly visualize the generated structures in 2D.</p>
            </sec>
          </sec>
          <sec id="Sec11">
            <title>Gypsum-DL and VS pose prediction</title>
            <p id="Par26">To assess the impact of Gypsum-DL processing on VS pose prediction, we compiled a benchmark library of protein–ligand complexes. We first downloaded the 4463 high-quality complexes included in PDBBind refined set [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. We removed those complexes with ligands that had molecular weights greater than 500 Daltons, contained amino acids, contained multiple residues (e.g., peptides), included improper atom names (e.g., “furan”), and/or had ligand files that did not match the corresponding entries in the Protein Data Bank (<ext-link xlink:href="https://www.rcsb.org/" ext-link-type="uri">https://www.rcsb.org/</ext-link>) [<xref ref-type="bibr" rid="CR23">23</xref>]. After filtering, 3177 complexes containing 2438 unique ligands remained.</p>
            <p id="Par27">For each ligand, we downloaded the corresponding SMILES string from the Protein Data Bank [<xref ref-type="bibr" rid="CR23">23</xref>]. We neutralized the charge of each SMILES representation to the extent possible and removed all information about chirality and cis/trans isomerism. We converted these processed SMILES strings to 3D models using both Open Babel 2.3.2 and a late-stage beta version of Gypsum-DL that did not differ substantially from the final published version. For Open Babel, we used only the -<italic>d</italic> (delete hydrogens), -<italic>h</italic> (add hydrogens), and –<italic>gen3D</italic> (generate 3D coordinates) flags, in that order, to standardize hydrogen atoms and generate 3D coordinates. For Gypsum-DL, we used the following ligand-processing parameters: <italic>min_ph</italic> 6.4, <italic>max_ph</italic> 8.4, <italic>pka_precision</italic> 1.0, <italic>thoroughness</italic> 3, and <italic>max_variants_per_compound</italic> 5. We then converted all protein-receptor and small-molecule models to the PDBQT format using MGLTools 1.5.6 [<xref ref-type="bibr" rid="CR24">24</xref>].</p>
            <p id="Par28">For each complex, we defined a docking box that entirely encompassed the corresponding crystallographic ligand, with 5 Å margins in all directions. We then used AutoDock Vina 1.1.2 [<xref ref-type="bibr" rid="CR12">12</xref>] to dock the Open-Babel and Gypsum-DL small-molecule models into the corresponding docking boxes. The default AutoDock Vina parameters were used, except we increased the exhaustiveness parameter to 100.</p>
            <p id="Par29">To judge pose-prediction accuracy, we first used our Scoria Python library [<xref ref-type="bibr" rid="CR25">25</xref>] to remove the hydrogen atoms from all docked compounds. We then used <italic>obrms</italic> [<xref ref-type="bibr" rid="CR10">10</xref>], an Open-Babel utility program, to calculate the RMSDs between the non-hydrogen atom positions of each top-scoring Vina pose and those of the corresponding crystallographic ligand. The <italic>obrms</italic> approach accounts for equivalent moiety conformations (e.g., symmetric ring flips) by considering atom connectivity. We discarded an additional 26 protein–ligand complexes because <italic>obrms</italic> determined inconsistent connectivities for the crystallographic pose versus the docked Open-Babel and/or Gypsum-DL poses. The size of the final benchmark library of protein–ligand complexes was thus 3151.</p>
            <p id="Par30">Unlike Open Babel, Gypsum-DL often generates multiple variants of each compound with differing ionization, tautomeric, chiral, cis/trans isomeric, and ring-conformational states. For comparison purposes, we selected the Gypsum-DL variant with the lowest RMSD to the crystallographic pose.</p>
          </sec>
          <sec id="Sec12">
            <title>Enumerating the distributed drug discovery (D3) library for Gypsum-DL testing</title>
            <p id="Par31">To test Gypsum-DL’s ability to process a large virtual molecular library, we enumerated 56,608 N-acylated unnatural amino acids. We first used ChemDraw Ultra 12.0 (CambridgeSoft, 2010) to create 2D representations of the 84 alkyl-halide, 16 Michael-acceptor, and 100 carboxylic-acid building blocks described in Ref. [<xref ref-type="bibr" rid="CR16">16</xref>]. Some building blocks were racemic, so we expanded this initial set to include all associated enantiomers. We then used MarvinSketch 16.6.13, 2016, ChemAxon (<ext-link xlink:href="http://www.chemaxon.com" ext-link-type="uri">http://www.chemaxon.com</ext-link>) to create the multi-step reaction schemes required to enumerate a 2D virtual library from these building blocks.</p>
            <p id="Par32">A detailed description of the reactions has been published previously [<xref ref-type="bibr" rid="CR16">16</xref>]. We selected them in part because they are central to the highly successful undergraduate curriculum developed by the Distributed Drug Discovery (D3) initiative [<xref ref-type="bibr" rid="CR16">16</xref>]. In brief, we first created reaction schemes to alkylate polymer-bound benzophenone-imine glycine at the carbonyl ɑ-carbon. For alkylation using alkyl halides, we created two reaction schemes to generate products with (<italic>S</italic>) and (<italic>R</italic>) stereochemistry, respectively (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). For alkylation using Michael acceptors, we created eight reaction schemes to enumerate all possible diastereomers (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). We used Reactor 16.6.13, 2016, ChemAxon (<ext-link xlink:href="http://www.chemaxon.com" ext-link-type="uri">http://www.chemaxon.com</ext-link>) to apply these reaction schemes to our library of alkyl-halide and Michael-acceptor building blocks.<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>Simplified representations of the reaction schemes used to enumerate the D3 library. The spheres represent the bound polymer. <bold>a</bold> Alkylation of the polymer-bound benzophenone-imine glycine using the alkyl-halide building blocks. <bold>b</bold> Alkylation using the Michael-acceptor building blocks. <bold>c</bold> Deprotecting the benzophenone protecting group. <bold>d</bold> Acylation using the carboxylic-acid building blocks. <bold>e</bold> Cleaving the polymer</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_358_Fig3_HTML.png" id="MO6" /></fig></p>
            <p id="Par33">We next created a reaction scheme to deprotect the benzophenone protecting groups of the alkyl-halide- and Michael-reaction products, yielding amino-free intermediates (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). These intermediates were then subjected to an acylation scheme (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d), which reacted the free amino groups with each of our carboxylic-acid building blocks. This reaction added another point of diversity, ultimately yielding polymer-bound alkylated-acylated glycine products. An additional reaction scheme served to cleave the polymer (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e). We also used reaction schemes to remove additional protecting groups (e.g., Fmoc, tert-butyl, Boc), which the final products had inherited from some of the original building blocks (not shown).</p>
          </sec>
          <sec id="Sec13">
            <title>Using Gypsum-DL to process the D3 and NCI molecular libraries</title>
            <p id="Par34">We used Gypsum-DL to process both the enumerated D3 library and the NCI Diversity Set VI, a set of freely available compounds provided by the National Cancer Institute. We used the following Gypsum-DL parameters to process these libraries: <italic>min_ph</italic> 7.4, <italic>max_ph</italic> 7.4, <italic>pka_precision</italic> 1.0, <italic>thoroughness</italic> 3, and <italic>max_variants_per_compound</italic> 5. In the case of the D3 library, we additionally set the <italic>skip_making_tautomers</italic> parameter to true. Both libraries are available free of charge in the SDF format from <ext-link xlink:href="http://durrantlab.com/gypsum-dl/" ext-link-type="uri">http://durrantlab.com/gypsum-dl/</ext-link> for use in VS projects.</p>
          </sec>
        </sec>
        <sec id="Sec14">
          <title>Results and discussion</title>
          <sec id="Sec15">
            <title>Installation</title>
            <p id="Par35">Gypsum-DL is an open-source Python program. It requires the third-party Python libraries RDKit, NumPy [<xref ref-type="bibr" rid="CR26">26</xref>], and SciPy [<xref ref-type="bibr" rid="CR27">27</xref>], which must be installed separately. To ease installation, we recommend the popular Anaconda Python platform with its convenient <italic>conda</italic> package manager. Users who wish to run Gypsum-DL using the Message Passing Interface (MPI) standard must also install the mpi4py package [<xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref>]. Gypsum-DL also relies on the MolVS library (MIT License). We have included a copy of MolVS 0.1.1 with the Gypsum-DL source code, so no additional installation is needed.</p>
          </sec>
          <sec id="Sec16">
            <title>Platform testing</title>
            <p id="Par36">We have tested Gypsum-DL on several operating systems, using several versions of Python, RDKit, NumPy, SciPy, and mpi4py (Table <xref rid="Tab1" ref-type="table">1</xref>). We expect it will run in many other environments as well. We note that the multiprocessing feature is not available on Microsoft Windows.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Computational environments used for Gypsum-DL testing</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Operating system</p></th><th align="left"><p>Python</p></th><th align="left"><p>RDKit</p></th><th align="left"><p>NumPy</p></th><th align="left"><p>SciPy</p></th><th align="left"><p>Mpi4py</p></th></tr></thead><tbody><tr><td align="left"><p>macOS Mojave 10.14.1</p></td><td align="left"><p>2.7.13</p></td><td align="left"><p>2016.09.2</p></td><td align="left"><p>1.11.3</p></td><td align="left"><p>0.19.0</p></td><td align="left"><p>N/A</p></td></tr><tr><td align="left"><p>macOS Mojave 10.14.1</p></td><td align="left"><p>3.6.3</p></td><td align="left"><p>2018.03.4</p></td><td align="left"><p>1.13.1</p></td><td align="left"><p>0.19.1</p></td><td align="left"><p>N/A</p></td></tr><tr><td align="left"><p>Ubuntu 18.04.1 LTS</p></td><td align="left"><p>3.7.1</p></td><td align="left"><p>2018.03.1</p></td><td align="left"><p>1.15.4</p></td><td align="left"><p>1.0.0</p></td><td align="left"><p>N/A</p></td></tr><tr><td align="left"><p>Ubuntu 18.04.1 LTS</p></td><td align="left"><p>3.6.6</p></td><td align="left"><p>2018.03.1</p></td><td align="left"><p>1.15.4</p></td><td align="left"><p>1.0.0</p></td><td align="left"><p>N/A</p></td></tr><tr><td align="left"><p>Ubuntu 18.04.1 LTS</p></td><td align="left"><p>2.7.1</p></td><td align="left"><p>2018.03.1</p></td><td align="left"><p>1.15.4</p></td><td align="left"><p>1.0.0</p></td><td align="left"><p>N/A</p></td></tr><tr><td align="left"><p>Windows 10 (serial mode)</p></td><td align="left"><p>3.7.1</p></td><td align="left"><p>2018.03.1</p></td><td align="left"><p>1.15.4</p></td><td align="left"><p>1.0.0</p></td><td align="left"><p>N/A</p></td></tr><tr><td align="left"><p>Windows 10 (serial mode)</p></td><td align="left"><p>2.7.1</p></td><td align="left"><p>2018.03.1</p></td><td align="left"><p>1.15.4</p></td><td align="left"><p>1.0.0</p></td><td align="left"><p>N/A</p></td></tr><tr><td align="left"><p>Red Hat Enterprise Linux Server 7.3</p></td><td align="left"><p>3.5.3</p></td><td align="left"><p>2018.03.1</p></td><td align="left"><p>1.12.1</p></td><td align="left"><p>1.0.0</p></td><td align="left"><p>N/A</p></td></tr><tr><td align="left"><p>Red Hat Enterprise Linux Server 7.3</p></td><td align="left"><p>2.7.13</p></td><td align="left"><p>2018.03.1</p></td><td align="left"><p>1.12.1</p></td><td align="left"><p>1.0.0</p></td><td align="left"><p>3.0.1</p></td></tr></tbody></table></table-wrap></p>
          </sec>
          <sec id="Sec17">
            <title>Benchmarks</title>
            <p id="Par37">Gypsum-DL can take advantage of multiple processors, if available. The user-defined <italic>job_manager</italic> parameter determines whether the program runs in “serial,” “multiprocessing,” or “mpi” mode. In serial mode, Gypsum-DL uses only one processor to prepare each small molecule sequentially. This mode is ideal when processing only a few compounds or when using Gypsum-DL in low-resource environments. It is also the only mode available on the Windows operating system.</p>
            <p id="Par38">In multiprocessing mode, Gypsum-DL uses multiple processors on the same computer to speed small-molecule preparation. Its dynamic load-balancing approach distributes small-molecule representations (e.g., SMILES strings) to various processors as they become available. Running in parallel, each processor independently prepares its assigned representations. Figure <xref rid="Fig4" ref-type="fig">4</xref>a shows benchmark run times performed on a 24-core Skylake processor using a late-stage beta version of Gypsum-DL that did not differ substantially from our final published version.<fig id="Fig4"><label>Fig. 4</label><caption xml:lang="en"><p>Gypsum-DL benchmarks. <bold>a</bold> Run times on a single compute node, using multiprocessing mode (1000 input SMILES strings). <bold>b</bold> Run times on multiple compute nodes, using mpi mode (20,000 input SMILES strings). All benchmarks were performed in triplicate. Errors bars represent standard deviations</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_358_Fig4_HTML.png" id="MO7" /></fig></p>
            <p id="Par39">In mpi mode, Gypsum-DL distributes small-molecule preparation across multiple computers. Its static load-balancing approach splits the array of input small molecules into chunks that can each be handled concurrently on a different computer (i.e., node). This mode is ideal for use on high-performance computing clusters, where separate computers are networked together to enable calculations on a much larger scale. To leverage this setup, Gypsum-DL uses the Message Passing Interface (MPI) to control parallel communications between nodes. The user must separately install the mpi4py Python package [<xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref>] to use Gypsum-DL in mpi mode. We benchmarked the same beta version of Gypsum-DL on a computing cluster provided by the University of Pittsburgh’s Center for Research Computing (CRC, Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). The CRC provides MPI-enabled compute nodes with 28-core Broadwell Processors, networked using Intel’s Omni-Path communication architecture. Note that the benchmarks shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>b were run on 20,000 input SMILES strings, vs. 1000 in Fig. <xref rid="Fig4" ref-type="fig">4</xref>a.</p>
          </sec>
          <sec id="Sec18">
            <title>Comments on scalability</title>
            <p id="Par40">In theory, processing an entire virtual library should be embarrassingly parallel. But in practice two factors prevent perfectly linear scalability. First, in mpi mode Gypsum-DL uses static rather than dynamic load balancing. It assigns each input representation (e.g., SMILES string) to a processor before execution begins. If the number of inputs is divisible by the number of processors, each processor is tasked with handling the same number of inputs. Otherwise, Gypsum-DL distributes the inputs as evenly as possible. Each processor then independently and concurrently prepares its portion of the input virtual library, without requiring synchronization or memory sharing. Once all processors have finished, the main process collects the results. Static load balancing minimizes the required communication between nodes, but it can lead to computational inefficiency. If by random chance a given processor is assigned many time-consuming molecular representations, other processors may run idle while waiting for it to finish. Increasing the number of representations assigned to each processor can reduce the chances of highly unbalanced assignments.</p>
            <p id="Par41">Second, in both multiprocessing and mpi mode, some tasks cannot be parallelized. For example, the main process must send input data to each processor/node and collect the results when finished. Furthermore, Gypsum-DL also spawns a separate Python interpreter on each processor to handle the assigned input. The fixed time required to start and shutdown each interpreter also impacts scalability. Increasing the time spent processing molecular representations relative to the communication/startup/shutdown times (again, by increasing the number of representations assigned to each processor) thus improves scaling.</p>
            <p id="Par42">In summary, using more processors can drastically reduce the total run time (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). But as the input data is divided among more and more processors, the number of molecular representations handled per processor begins to drop. As with most large-scale parallel calculations, users must strike a balance between short run times and computational efficiency.</p>
          </sec>
          <sec id="Sec19">
            <title>Gypsum-DL improves pose-prediction accuracy</title>
            <p id="Par43">To test Gypsum-DL’s impact on the accuracy of VS pose prediction, we considered 3151 protein–ligand complexes taken from the PDBBind database [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. Both Gypsum-DL and Open Babel 2.3.2 were separately used to prepare 3D models of the 3151 ligands from the corresponding SMILES strings. In the case of Open Babel, we intentionally generated electrically neutral models (i.e., we omitted the Open-Babel -<italic>p</italic> flag) so as to better judge the impact of Gypsum-DL’s ionization feature on pose accuracy [<xref ref-type="bibr" rid="CR11">11</xref>]. We docked both the Gypsum-DL-prepared and Open-Babel-prepared molecules into their corresponding protein receptors using AutoDock Vina 1.1.2 [<xref ref-type="bibr" rid="CR12">12</xref>].</p>
            <p id="Par44">When we used Gypsum-DL, 71.4% of the 3151 ligands had RMSDs from the crystallographic pose that were less than 3.0 Å (mean: 2.37 Å; standard deviation: 2.03 Å). The same was true of 53.0% of the Open-Babel-processed molecules (mean: 3.40 Å; standard deviation: 2.51 Å). An F-test led us to reject the hypothesis that the variances of the Gypsum-DL and Open-Babel RMSDs were equal (<italic>p</italic> = 0.00). A subsequent two-tailed <italic>t</italic> test (assuming unequal variances) led us to reject the hypothesis that the Gypsum-DL and Open-Babel RMSDs had the same mean (<italic>p</italic> = 0.00). These results suggest that accounting for multiple ionization, tautomeric, chiral, cis/trans isomeric, and ring-conformational forms can improve pose-prediction accuracy.</p>
            <p id="Par45">As an example of the advantages of Gypsum-DL processing, consider folic acid bound to the human folate receptor beta (PDB ID: 4KMZ [<xref ref-type="bibr" rid="CR31">31</xref>]; Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). In this test case, the RMSD between the Gypsum-DL-prepared and crystallographic poses was only 0.76 Å (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, c). In contrast, the RMSD between the Open-Babel-prepared and crystallographic poses was 11.42 Å (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). Visual inspection of the docked molecules, together with structural analysis using BINANA 1.2.0, a program that automates the detection of key protein/ligand interactions [<xref ref-type="bibr" rid="CR32">32</xref>], provides insight into why Gypsum-DL performed better. Gypsum-DL deprotonated the two folate carboxylate groups, allowing them to form strong electrostatic interactions with R152. In contrast, we did not instruct Open Babel to consider pH, so it protonated these carboxylate groups (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a).<fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p>An illustration of the crystallographic and docked poses of folic acid bound to the human folate receptor beta. The carbon atoms of the protein, the crystallographic ligand, the docked Gypsum-DL compound, and the docked Open-Babel compound are shown in green, yellow, gray, and pink, respectively. <bold>a</bold> The region of the pocket near R152. <bold>b</bold> The Gypsum-DL-prepared compound forms additional interactions with other protein residues (in green). Possible hydrogen bonds are shown as dotted lines. <bold>c</bold> The crystallographic pose, shown for reference. Image generated using BlendMol [<xref ref-type="bibr" rid="CR33">33</xref>]</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_358_Fig5_HTML.png" id="MO8" /></fig></p>
            <p id="Par46">The input SMILES string represented folate in the favored 2-aminopteridin-4(1<italic>H</italic>)-one (keto) form. Open Babel does not generate alternate tautomeric states and so used this same form. Interestingly, Gypsum-DL selected the enol tautomer, 2-aminopteridin-4-ol. And yet in the accurate Gypsum-DL pose, the enol hydroxyl group may form hydrogen bonds with S190 and/or R119 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b, dotted lines).</p>
            <p id="Par47">Gypsum-DL also protonated one of the 2-aminopteridin-4-ol nitrogen atoms. While unusual, the resulting positive charge enables electrostatic interactions with D97 and may further strengthen the π-π stacking with W187 and Y101 by adding a cation-π interaction. Gypsum-DL’s protonated secondary amine may also form cation-π interactions with W187 and Y76 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). It is admittedly unclear to what extent the Gypsum-DL enol tautomer and protonated amines are physiologically relevant, but these states may have contributed to the improved pose prediction in this case.</p>
          </sec>
          <sec id="Sec20">
            <title>Sample libraries for download</title>
            <p id="Par48">We used Gypsum-DL to process two small-molecule libraries. Both are available free of charge from <ext-link xlink:href="http://durrantlab.com/gypsum-dl/" ext-link-type="uri">http://durrantlab.com/gypsum-dl/</ext-link> for use in VS projects. We first obtained a copy of the NCI Diversity Set VI in flat SDF format from the National Cancer Institute (NCI). This library includes compounds that have been carefully selected so as to have diverse pharmacophores and favorable chemical properties (e.g., high molecular rigidity, few rotatable bonds, limited chiral centers, etc.). The NCI provides relatively pure samples (≥ 90% by LC/Mass Spectrometry) free of charge upon request. Gypsum-DL produced 5996 3D models from 1558 input NCI structures (pH 7.4, 3.8 models per input molecule). Eight bridged compounds could not be processed. We confirmed that alternate ionization, tautomeric, isomeric, and ring-conformer forms were among the output structures.</p>
            <p id="Par49">We also processed a large library of 56,608 N-acylated unnatural amino acids. We first generated 2D representations of these molecules by reacting alkyl-halide, Michael-acceptor, and carboxylic-acid building blocks in silico, using chemical reactions developed by the Distributed Drug Discovery (D3) initiative [<xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR34">34</xref>]. D3 is an educational program started at Indiana University–Purdue University Indianapolis in 2003. Its well-documented, combinatorial solid-phase synthetic procedures enable students—including undergraduates—to synthesize diverse compounds in a classroom-laboratory setting. Candidate ligands identified in VS of these compounds can thus be easily synthesized and experimentally tested. Gypsum-DL successfully processed all 56,608 input compounds, producing 148,240 3D models (pH 7.4, 2.6 models per input molecule).</p>
            <p id="Par50">To avoid amide-iminol tautomerization, we intentionally instructed Gypsum-DL to skip tautomer enumeration for the D3 compound set. The iminol form is rare in solution, though it is occasionally chemically relevant [<xref ref-type="bibr" rid="CR35">35</xref>]. It is reasonable to consider the iminol tautomer if virtual-library compounds contain only occasional amide moieties (e.g., the NCI set). But every compound in the D3 library contains an amide moiety. Modelling the iminol tautomer would have needlessly expanded the library’s size, adding to the computational cost of any subsequent VS.</p>
          </sec>
          <sec id="Sec21">
            <title>Comparison with other programs</title>
            <p id="Par51"><italic>Frog2</italic> [<xref ref-type="bibr" rid="CR5">5</xref>]<italic> is another open-source program for preparing small-molecule libraries</italic>. Its easy-to-use web interface is among its many strengths. This web-based approach arguably makes Frog2 more user friendly than Gypsum-DL. However, Gypsum-DL does offer some key capabilities that Frog2 lacks (Table <xref rid="Tab2" ref-type="table">2</xref>). For example, Frog2 uses the Open Babel cheminformatics toolkit [<xref ref-type="bibr" rid="CR10">10</xref>] to add hydrogen atoms to input molecules, but it does not consider alternate ionization states per a user-specified pH range. In contrast, Gypsum-DL uses the Dimorphite-DL algorithm [<xref ref-type="bibr" rid="CR11">11</xref>] to predict ionization states. To illustrate the usefulness of this feature, we submitted oseltamivir carboxylate, an influenza neuraminidase inhibitor, to the Frog2 (v2.14) server (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a). Frog2 protonated the carboxylic-acid moiety, despite the fact that it is largely deprotonated at physiological pH. In contrast, Gypsum-DL appropriately deprotonated the carboxylate group. Deprotonation is critical in this case, as neuraminidase-oseltamivir binding is governed largely by arginine-carboxylate electrostatic interactions that require a charged (deprotonated) carboxylate moiety [<xref ref-type="bibr" rid="CR36">36</xref>].<table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>The available features of several stand-alone programs for converting molecular representations into 3D models</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><p>Program</p></th><th align="left"><p>Ionize</p></th><th align="left"><p>Tautomers</p></th><th align="left"><p>Chiral</p></th><th align="left"><p>cis/trans</p></th><th align="left"><p>Rings</p></th><th align="left"><p>Optimize</p></th><th align="left"><p>Free</p></th><th align="left"><p>Open Source</p></th><th align="left"><p>Web</p></th></tr></thead><tbody><tr><td align="left"><p>Gypsum-DL</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left" /></tr><tr><td align="left"><p>OpenEye</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left" /><td align="left" /><td align="left" /></tr><tr><td align="left"><p>LigPrep</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left" /><td align="left" /><td align="left" /></tr><tr><td align="left"><p>Frog2</p></td><td align="left" /><td align="left" /><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left" /><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td></tr><tr><td align="left"><p>Balloon</p></td><td align="left" /><td align="left" /><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left"><p>✓</p></td><td align="left" /><td align="left" /></tr></tbody></table><table-wrap-foot><p>OpenEye’s OMEGA/QUACPAC and Schrödinger’s LigPrep are commercial programs mentioned in the Introduction. Frog2 and Balloon are freely available</p></table-wrap-foot></table-wrap><fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><p>Example program output. Gypsum-DL outputs <bold>a</bold> deprotonated oseltamivir carboxylate, <bold>b</bold> both the ketone and enol forms of butan-2-one, <bold>c</bold> both the (<italic>R</italic>) and (<italic>S</italic>) enantiomers of bromochlorofluoroiodomethane, <bold>d</bold> both the <italic>E</italic> and <italic>Z</italic> isomers of 1-bromo-2-chloro-2-fluoro-1-iodoethene, <bold>e</bold> the twist-boat conformation of <italic>cis</italic>-1,4-di-<italic>tert</italic>-butylcyclohexane, and <bold>f</bold> only one rotomer of propan-1-ol. Image generated using BlendMol [<xref ref-type="bibr" rid="CR33">33</xref>]</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_358_Fig6_HTML.png" id="MO9" /></fig></p>
            <p id="Par52">Frog2 is similarly limited in its ability to generate alternate tautomeric forms. To illustrate, we submitted butan-2-one, a ketone, to the Frog2 server (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b). The server correctly returned a 3D model of the ketone, but it did not identify the alternate enol form, but-2-en-2-ol. In contrast, both the keto and enol form were present among the Gypsum-DL-generated 3D models.</p>
            <p id="Par53">Both Frog2 and Gypsum-DL performed comparably at enumerating unspecified chiral centers and cis/trans isomers. Both generated (<italic>R</italic>) and (<italic>S</italic>) enantiomers of bromochlorofluoroiodomethane when the input SMILES did not specify chirality (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c). And both generated the <italic>E</italic> and <italic>Z</italic> isomers of 1-bromo-2-chloro-2-fluoro-1-iodoethene when given an ambiguous SMILES as input (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d).</p>
            <p id="Par54">Gypsum-DL takes a more thorough albeit computationally expensive approach when generating alternate non-aromatic-ring conformations. Frog2 initially uses DG-AMMOS [<xref ref-type="bibr" rid="CR37">37</xref>] to generate ring conformations, but the algorithm ultimately maintains rings rigid and considers only dihedral variations [<xref ref-type="bibr" rid="CR5">5</xref>]. In contrast, Gypsum-DL uses geometry optimization and clustering to identify distinct ring conformations. To illustrate the advantages of the Gypsum-DL approach, consider <italic>cis</italic>-1,4-di-<italic>tert</italic>-butylcyclohexane (Fig. <xref rid="Fig6" ref-type="fig">6</xref>e). In the twist-boat conformation, both of the <italic>tert</italic>-butyl groups assume equatorial positions. The energy difference between the chair and twist-boat conformations of this compound are thus unusually small [<xref ref-type="bibr" rid="CR38">38</xref>]. Frog2 generated models in only the chair conformation. Gypsum-DL generated models in the more stable twist-boat conformation.</p>
            <p id="Par55">An additional Gypsum-DL feature is advantageous in some VS contexts. Recall that many docking programs sample non-ring, single-bond torsions during the docking process itself. It is therefore computationally inefficient to dock otherwise identical models that differ only in their non-ring torsions. Frog2 generates these redundant models, but Gypsum-DL does not. As an illustration, consider propan-1-ol (Fig. <xref rid="Fig6" ref-type="fig">6</xref>f). Frog2 generated three redundant conformational isomers of propan-1-ol. In contrast, Gypsum-DL generated only one. We recommend Frog2 in those cases that require a more complete torsion library (e.g., 3D- or 4D-QSAR [<xref ref-type="bibr" rid="CR39">39</xref>], pharmacophore modelling [<xref ref-type="bibr" rid="CR40">40</xref>], etc.). Gypsum-DL is arguably better suited for use with flexible-ligand docking programs such as AutoDock Vina [<xref ref-type="bibr" rid="CR12">12</xref>].</p>
            <p id="Par56"><italic>Balloon</italic> [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]<italic> is a free command-line program that targets more advanced users</italic>. We tested Balloon on the Linux platform only, as we could not run any of the provided binaries on macOS Mojave. Balloon 1.6.7 is in many ways similar to Frog2 (Table <xref rid="Tab2" ref-type="table">2</xref>). We applied the program to the same test molecules described above. Like Frog2, Balloon does not consider alternate ionization or tautomeric states (e.g., it protonated the oseltamivir carboxylate group and failed to identify the enol form of butan-2-one; Fig. <xref rid="Fig6" ref-type="fig">6</xref>a, b). While Balloon’s ring-generation algorithm produced the correct twist-boat conformation of <italic>cis</italic>-1,4-di-<italic>tert</italic>-butylcyclohexane (Fig. <xref rid="Fig6" ref-type="fig">6</xref>e), the <italic>tert</italic>-butyl moieties were not quite as equatorial as those of the Gypsum-DL model. Balloon also tends to generate redundant conformational isomers (e.g., it produced two propan-1-ol models; Fig. <xref rid="Fig6" ref-type="fig">6</xref>f). On the other hand, like Gypsum-DL and Frog2, Balloon does successfully enumerate unspecified chiral centers (e.g., bromochlorofluoroiodomethane; Fig. <xref rid="Fig6" ref-type="fig">6</xref>c) and cis/trans isomers (e.g., 1-bromo-2-chloro-2-fluoro-1-iodoethene; Fig. <xref rid="Fig6" ref-type="fig">6</xref>d).</p>
            <p id="Par57"><italic>Free and open-source cheminformatics toolkits such as RDKit and Open Babe</italic>l [<xref ref-type="bibr" rid="CR10">10</xref>]<italic> target the most advanced users</italic>. These toolkits provide building blocks that programmers can assemble into more complex cheminformatics workflows. The RDKit and Open-Babel Python bindings are particularly useful for this purpose. Gypsum-DL is built on RDKit and RDKit-powered software (Dimorphite-DL 1.0 [<xref ref-type="bibr" rid="CR11">11</xref>] and MolVS 0.1.1).</p>
            <p id="Par58">We built Gypsum-DL on RDKit, MolVS, and Dimorphite-DL rather than Open Babel in part because these packages have more permissive software licenses (BSD, MIT, and Apache version 2, respectively). Permissive licenses encourage broad adoption by allowing users to incorporate software into their own projects without having to adopt the same license. In contrast, Open Babel is released under a copyleft license (GNU General Public License, version 2), which requires that any derivate works also be copyleft. We note also that Gypsum-DL’s use of the Dimorphite-DL algorithm has several advantages over Open Babel’s approach (see Ref. [<xref ref-type="bibr" rid="CR11">11</xref>] for details).</p>
          </sec>
        </sec>
        <sec id="Sec25" sec-type="conclusions">
          <title>Conclusion</title>
          <p id="Par59">Given the role that structure-based VS plays in modern drug discovery, effective techniques for generating 3D small-molecule structures are critical. Gypsum-DL is a free, open-source program that performs this important conversion to 3D. To minimize computational costs without sacrificing accuracy, we have designed Gypsum-DL to be highly parallel and computationally efficient. It can be easily incorporated into cheminformatic and drug-discovery workflows. Gypsum-DL’s easy-to-use command-line interface and default parameters make it accessible to intermediate users. Additional functionality and customizability allow advanced users to control more nuanced program parameters such as the thoroughness of conformer sampling, the pH range, and the output-file format.</p>
          <p id="Par60">Though a powerful tool, Gypsum-DL does have its limitations. For example, it often fails to identify low-energy conformations for large macrocycles. Gypsum-DL uses the ETKDG algorithm [<xref ref-type="bibr" rid="CR20">20</xref>] to generate initial 3D models for subsequent UFF-based geometry optimization. ETKDG assigns macrocycle torsions based on acyclic-bond torsion patterns derived from experiment. We expect that future versions of the ETKDG algorithm will assign macrocycle torsions using the proper experimentally derived macrocycle torsion patterns. In the meantime, Gypsum-DL still generates valid, geometry-optimized macrocycle models, though the output conformations sometimes differ substantially from the most energetically favorable minima.</p>
          <p id="Par61">Future efforts will also include building a graphical user interface and/or web application to better accommodate the needs of researchers who are less familiar with the command line. We also hope to enable Windows multiprocessing in a future release. These current limitations aside, we believe Gypsum-DL will be a useful tool for researchers interested in structure-based, computer-aided drug discovery. A copy can be downloaded free of charge from <ext-link xlink:href="http://durrantlab.com/gypsum-dl/" ext-link-type="uri">http://durrantlab.com/gypsum-dl/</ext-link>.</p>
        </sec>
        <sec id="Sec123">
          <title>Availability and requirements</title>
          <p>Project name: Gypsum-DL.</p>
          <p>Project home page: <ext-link xlink:href="http://durrantlab.com/gypsum-dl/" ext-link-type="uri">http://durrantlab.com/gypsum-dl/</ext-link>.</p>
          <p>Operating systems: Windows, macOS, Linux.</p>
          <p>Programming language: Python 2/3.</p>
          <p>Other requirements: RDKit, NumPy, SciPy, Mpi4py (optional).</p>
          <p>License: Apache License, Version 2.0.</p>
        </sec>
      </body>
      <back>
        <ack>
          <title>Acknowledgements</title>
          <p>We thank professors William L. Scott and Martin J. O’Donnell of the Distributed Drug Discovery (D3) Program for helpful discussions.</p>
        </ack>
        <sec sec-type="author-contribution">
          <title>Authors’ contributions</title>
          <p>PJR, JOS, GAM, and JDD designed the study. PJR, JOS, HG, and JDD contributed to the Gypsum-DL codebase. JOS, JLW, HG, GAM, KAM, JJR, and JDD contributed to the text, tables, and/or figures. All authors read and approved the final manuscript.</p>
        </sec>
        <sec>
          <title>Funding</title>
          <p>This work was supported by a computer-allocation grant from the University of Pittsburgh’s Center for Research Computing (CRC) to JDD. The CRC played no role in the design of this study; the collection, analysis, and interpretation of the data; or the writing of the manuscript.</p>
        </sec>
        <sec sec-type="data-availability">
          <title>Availability of data and materials</title>
          <p>Not applicable.</p>
        </sec>
        <sec sec-type="ethics-statement">
          <sec id="FPar2" sec-type="COI-statement">
            <title>Competing interests</title>
            <p id="Par63">The authors declare that they have no competing interests.</p>
          </sec>
        </sec>
        <ref-list id="Bib1">
          <title>References</title>
          <ref-list>
            <ref id="CR1">
              <label>1.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Lionta</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Spyrou</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Vassilatis</surname>
                    <given-names>DK</given-names>
                  </name>
                  <name>
                    <surname>Cournia</surname>
                    <given-names>Z</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Structure-based virtual screening for drug discovery: principles, applications and recent advances</article-title>
                <source>Curr Top Med Chem</source>
                <year>2014</year>
                <volume>14</volume>
                <fpage>1923</fpage>
                <lpage>1938</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2cXhvVGgt7fJ</pub-id>
                <pub-id pub-id-type="doi">10.2174/1568026614666140929124445</pub-id>
                <pub-id pub-id-type="pmid">25262799</pub-id>
                <pub-id pub-id-type="pmcid">4443793</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR2">
              <label>2.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Tanrikulu</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Kruger</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>Proschak</surname>
                    <given-names>E</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The holistic integration of virtual screening in drug discovery</article-title>
                <source>Drug Discov Today</source>
                <year>2013</year>
                <volume>18</volume>
                <fpage>358</fpage>
                <lpage>364</lpage>
                <pub-id pub-id-type="doi">10.1016/j.drudis.2013.01.007</pub-id>
                <pub-id pub-id-type="pmid">23340112</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR3">
              <label>3.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Hawkins</surname>
                    <given-names>PC</given-names>
                  </name>
                  <name>
                    <surname>Nicholls</surname>
                    <given-names>A</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Conformer generation with OMEGA: learning from the data set and the analysis of failures</article-title>
                <source>J Chem Inf Model</source>
                <year>2012</year>
                <volume>52</volume>
                <fpage>2919</fpage>
                <lpage>2936</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC38XhsFekurzN</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci300314k</pub-id>
                <pub-id pub-id-type="pmid">23082786</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR4">
              <label>4.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Hawkins</surname>
                    <given-names>PC</given-names>
                  </name>
                  <name>
                    <surname>Skillman</surname>
                    <given-names>AG</given-names>
                  </name>
                  <name>
                    <surname>Warren</surname>
                    <given-names>GL</given-names>
                  </name>
                  <name>
                    <surname>Ellingson</surname>
                    <given-names>BA</given-names>
                  </name>
                  <name>
                    <surname>Stahl</surname>
                    <given-names>MT</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Conformer generation with OMEGA: algorithm and validation using high quality structures from the Protein Databank and Cambridge Structural Database</article-title>
                <source>J Chem Inf Model</source>
                <year>2010</year>
                <volume>50</volume>
                <fpage>572</fpage>
                <lpage>584</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3cXjtlaisrY%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci100031x</pub-id>
                <pub-id pub-id-type="pmid">20235588</pub-id>
                <pub-id pub-id-type="pmcid">2859685</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR5">
              <label>5.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Miteva</surname>
                    <given-names>MA</given-names>
                  </name>
                  <name>
                    <surname>Guyon</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Tuffery</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Frog2: efficient 3D conformation ensemble generator for small compounds</article-title>
                <source>Nucleic Acids Res</source>
                <year>2010</year>
                <volume>38</volume>
                <fpage>W622</fpage>
                <lpage>W627</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3cXotVSqsr8%3D</pub-id>
                <pub-id pub-id-type="doi">10.1093/nar/gkq325</pub-id>
                <pub-id pub-id-type="pmid">20444874</pub-id>
                <pub-id pub-id-type="pmcid">2896087</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR6">
              <label>6.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Vainio</surname>
                    <given-names>MJ</given-names>
                  </name>
                  <name>
                    <surname>Johnson</surname>
                    <given-names>MS</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Generating conformer ensembles using a multiobjective genetic algorithm</article-title>
                <source>J Chem Inf Model</source>
                <year>2007</year>
                <volume>47</volume>
                <fpage>2462</fpage>
                <lpage>2474</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2sXhtVOnsL7L</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci6005646</pub-id>
                <pub-id pub-id-type="pmid">17892278</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR7">
              <label>7.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Puranen</surname>
                    <given-names>JS</given-names>
                  </name>
                  <name>
                    <surname>Vainio</surname>
                    <given-names>MJ</given-names>
                  </name>
                  <name>
                    <surname>Johnson</surname>
                    <given-names>MS</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Accurate conformation-dependent molecular electrostatic potentials for high-throughput in silico drug discovery</article-title>
                <source>J Comput Chem</source>
                <year>2010</year>
                <volume>31</volume>
                <fpage>1722</fpage>
                <lpage>1732</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3cXkslSks70%3D</pub-id>
                <pub-id pub-id-type="doi">10.1002/jcc.21460</pub-id>
                <pub-id pub-id-type="pmid">20020481</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR8">
              <label>8.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Alland</surname>
                    <given-names>C</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">RPBS: a web resource for structural bioinformatics</article-title>
                <source>Nucleic Acids Res</source>
                <year>2005</year>
                <volume>33</volume>
                <fpage>W44</fpage>
                <lpage>W49</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2MXlslyqtb4%3D</pub-id>
                <pub-id pub-id-type="doi">10.1093/nar/gki477</pub-id>
                <pub-id pub-id-type="pmid">15980507</pub-id>
                <pub-id pub-id-type="pmcid">1160237</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR9">
              <label>9.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Neron</surname>
                    <given-names>B</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Mobyle: a new full web bioinformatics framework</article-title>
                <source>Bioinformatics</source>
                <year>2009</year>
                <volume>25</volume>
                <fpage>3005</fpage>
                <lpage>3011</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXhtl2jt7vL</pub-id>
                <pub-id pub-id-type="doi">10.1093/bioinformatics/btp493</pub-id>
                <pub-id pub-id-type="pmid">19689959</pub-id>
                <pub-id pub-id-type="pmcid">2773253</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR10">
              <label>10.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>O’Boyle</surname>
                    <given-names>NM</given-names>
                  </name>
                  <name>
                    <surname>Banck</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>James</surname>
                    <given-names>CA</given-names>
                  </name>
                  <name>
                    <surname>Morley</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Vandermeersch</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Hutchison</surname>
                    <given-names>GR</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Open Babel: an open chemical toolbox</article-title>
                <source>J Cheminf</source>
                <year>2011</year>
                <volume>3</volume>
                <fpage>33</fpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXhsVWjurbF</pub-id>
                <pub-id pub-id-type="doi">10.1186/1758-2946-3-33</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR11">
              <label>11.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Ropp</surname>
                    <given-names>PJ</given-names>
                  </name>
                  <name>
                    <surname>Kaminsky</surname>
                    <given-names>JC</given-names>
                  </name>
                  <name>
                    <surname>Yablonski</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Durrant</surname>
                    <given-names>JD</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Dimorphite-DL: an open-source program for enumerating the ionization states of drug-like small molecules</article-title>
                <source>J Cheminform</source>
                <year>2019</year>
                <volume>11</volume>
                <fpage>14</fpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXpslajt7g%3D</pub-id>
                <pub-id pub-id-type="doi">10.1186/s13321-019-0336-9</pub-id>
                <pub-id pub-id-type="pmid">30767086</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR12">
              <label>12.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Trott</surname>
                    <given-names>O</given-names>
                  </name>
                  <name>
                    <surname>Olson</surname>
                    <given-names>AJ</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">AutoDock Vina: improving the speed and accuracy of docking with a new scoring function, efficient optimization, and multithreading</article-title>
                <source>J Comput Chem</source>
                <year>2009</year>
                <volume>31</volume>
                <fpage>455</fpage>
                <lpage>461</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXhsFGnur3O</pub-id>
                <pub-id pub-id-type="doi">10.1002/jcc.21334</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR13">
              <label>13.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Wang</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Fang</surname>
                    <given-names>X</given-names>
                  </name>
                  <name>
                    <surname>Lu</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Wang</surname>
                    <given-names>S</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The PDBbind database: collection of binding affinities for protein-ligand complexes with known three-dimensional structures</article-title>
                <source>J Med Chem</source>
                <year>2004</year>
                <volume>47</volume>
                <fpage>2977</fpage>
                <lpage>2980</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2cXjs1Sjs74%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/jm030580l</pub-id>
                <pub-id pub-id-type="pmid">15163179</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR14">
              <label>14.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Wang</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Fang</surname>
                    <given-names>X</given-names>
                  </name>
                  <name>
                    <surname>Lu</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Yang</surname>
                    <given-names>CY</given-names>
                  </name>
                  <name>
                    <surname>Wang</surname>
                    <given-names>S</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The PDBbind database: methodologies and updates</article-title>
                <source>J Med Chem</source>
                <year>2005</year>
                <volume>48</volume>
                <fpage>4111</fpage>
                <lpage>4119</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2MXktlKisbg%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/jm048957q</pub-id>
                <pub-id pub-id-type="pmid">15943484</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR15">
              <label>15.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Scott</surname>
                    <given-names>WL</given-names>
                  </name>
                  <name>
                    <surname>O’Donnell</surname>
                    <given-names>MJ</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Distributed drug discovery, part 1: linking academia and combinatorial chemistry to find drug leads for developing world diseases</article-title>
                <source>J Comb Chem</source>
                <year>2009</year>
                <volume>11</volume>
                <fpage>3</fpage>
                <lpage>13</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1cXhsFelsL3M</pub-id>
                <pub-id pub-id-type="doi">10.1021/cc800183m</pub-id>
                <pub-id pub-id-type="pmid">19105724</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR16">
              <label>16.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Scott</surname>
                    <given-names>WL</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Distributed drug discovery, part 2: global rehearsal of alkylating agents for the synthesis of resin-bound unnatural amino acids and virtual D(3) catalog construction</article-title>
                <source>J Comb Chem</source>
                <year>2009</year>
                <volume>11</volume>
                <fpage>14</fpage>
                <lpage>33</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1cXhsFelsLrL</pub-id>
                <pub-id pub-id-type="doi">10.1021/cc800184v</pub-id>
                <pub-id pub-id-type="pmid">19105725</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR17">
              <label>17.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Scott</surname>
                    <given-names>WL</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Distributed drug discovery, part 3: using D(3) methodology to synthesize analogs of an anti-melanoma compound</article-title>
                <source>J Comb Chem</source>
                <year>2009</year>
                <volume>11</volume>
                <fpage>34</fpage>
                <lpage>43</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1cXhsFelsL%2FN</pub-id>
                <pub-id pub-id-type="doi">10.1021/cc800185z</pub-id>
                <pub-id pub-id-type="pmid">19105723</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR18">
              <label>18.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Abraham</surname>
                    <given-names>MM</given-names>
                  </name>
                  <name>
                    <surname>Denton</surname>
                    <given-names>RE</given-names>
                  </name>
                  <name>
                    <surname>Harper</surname>
                    <given-names>RW</given-names>
                  </name>
                  <name>
                    <surname>Scott</surname>
                    <given-names>WL</given-names>
                  </name>
                  <name>
                    <surname>O’Donnell</surname>
                    <given-names>MJ</given-names>
                  </name>
                  <name>
                    <surname>Durrant</surname>
                    <given-names>JD</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Documenting and harnessing the biological potential of molecules in distributed drug discovery (D3) virtual catalogs</article-title>
                <source>Chem Biol Drug Des</source>
                <year>2017</year>
                <volume>90</volume>
                <fpage>909</fpage>
                <lpage>918</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2sXps1GrtLY%3D</pub-id>
                <pub-id pub-id-type="doi">10.1111/cbdd.13012</pub-id>
                <pub-id pub-id-type="pmid">28453915</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR19">
              <label>19.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Ghosh</surname>
                    <given-names>AK</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Design and development of highly potent HIV-1 protease inhibitors with a crown-like oxotricyclic core as the P2-ligand to combat multidrug-resistant HIV variants</article-title>
                <source>J Med Chem</source>
                <year>2017</year>
                <volume>60</volume>
                <fpage>4267</fpage>
                <lpage>4278</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2sXmtFKlsLw%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/acs.jmedchem.7b00172</pub-id>
                <pub-id pub-id-type="pmid">28418652</pub-id>
                <pub-id pub-id-type="pmcid">5605781</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR20">
              <label>20.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Riniker</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Landrum</surname>
                    <given-names>GA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Better informed distance geometry: using what we know to improve conformation generation</article-title>
                <source>J Chem Inf Model</source>
                <year>2015</year>
                <volume>55</volume>
                <fpage>2562</fpage>
                <lpage>2574</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2MXhvVeqsrjP</pub-id>
                <pub-id pub-id-type="doi">10.1021/acs.jcim.5b00654</pub-id>
                <pub-id pub-id-type="pmid">26575315</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR21">
              <label>21.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Rappé</surname>
                    <given-names>AK</given-names>
                  </name>
                  <name>
                    <surname>Casewit</surname>
                    <given-names>CJ</given-names>
                  </name>
                  <name>
                    <surname>Colwell</surname>
                    <given-names>KS</given-names>
                  </name>
                  <name>
                    <surname>Goddard Iii</surname>
                    <given-names>WA</given-names>
                  </name>
                  <name>
                    <surname>Skiff</surname>
                    <given-names>WM</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">UFF, a full periodic table force field for molecular mechanics and molecular dynamics simulations</article-title>
                <source>J Am Chem Soc</source>
                <year>1992</year>
                <volume>114</volume>
                <fpage>10024</fpage>
                <lpage>10035</lpage>
                <pub-id pub-id-type="doi">10.1021/ja00051a040</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR22">
              <label>22.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Hartigan</surname>
                    <given-names>JA</given-names>
                  </name>
                  <name>
                    <surname>Wong</surname>
                    <given-names>MA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Algorithm AS 136: a k-means clustering algorithm</article-title>
                <source>J R Stat Soc Ser C (Appl Stat)</source>
                <year>1979</year>
                <volume>28</volume>
                <fpage>100</fpage>
                <lpage>108</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR23">
              <label>23.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Berman</surname>
                    <given-names>HM</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">The Protein Data Bank</article-title>
                <source>Nucleic Acids Res</source>
                <year>2000</year>
                <volume>28</volume>
                <fpage>235</fpage>
                <lpage>242</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3cXhvVKjt7w%3D</pub-id>
                <pub-id pub-id-type="doi">10.1093/nar/28.1.235</pub-id>
                <pub-id pub-id-type="pmid">10592235</pub-id>
                <pub-id pub-id-type="pmcid">102472</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR24">
              <label>24.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Morris</surname>
                    <given-names>GM</given-names>
                  </name>
                  <name>
                    <surname>Huey</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Lindstrom</surname>
                    <given-names>W</given-names>
                  </name>
                  <name>
                    <surname>Sanner</surname>
                    <given-names>MF</given-names>
                  </name>
                  <name>
                    <surname>Belew</surname>
                    <given-names>RK</given-names>
                  </name>
                  <name>
                    <surname>Goodsell</surname>
                    <given-names>DS</given-names>
                  </name>
                  <name>
                    <surname>Olson</surname>
                    <given-names>AJ</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">AutoDock4 and AutoDockTools4: automated docking with selective receptor flexibility</article-title>
                <source>J Comput Chem</source>
                <year>2009</year>
                <volume>30</volume>
                <fpage>2785</fpage>
                <lpage>2791</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXht1GitrnK</pub-id>
                <pub-id pub-id-type="doi">10.1002/jcc.21256</pub-id>
                <pub-id pub-id-type="pmid">19399780</pub-id>
                <pub-id pub-id-type="pmcid">2760638</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR25">
              <label>25.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Ropp</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Friedman</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Durrant</surname>
                    <given-names>JD</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Scoria: a Python module for manipulating 3D molecular data</article-title>
                <source>J Cheminform</source>
                <year>2017</year>
                <volume>9</volume>
                <fpage>52</fpage>
                <lpage>58</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXls12lu78%3D</pub-id>
                <pub-id pub-id-type="doi">10.1186/s13321-017-0237-8</pub-id>
                <pub-id pub-id-type="pmid">29086076</pub-id>
                <pub-id pub-id-type="pmcid">5603467</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR26">
              <label>26.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Oliphant</surname>
                    <given-names>TE</given-names>
                  </name>
                </person-group>
                <source>Guide to NumPy</source>
                <year>2006</year>
                <publisher-loc>Provo</publisher-loc>
                <publisher-name>Brigham Young University</publisher-name>
              </mixed-citation>
            </ref>
            <ref id="CR27">
              <label>27.</label>
              <mixed-citation publication-type="other">Jones E, Oliphant T, Peterson P et al (2001) SciPy: Open Source Scientific Tools for Python, 0.11.0 edn</mixed-citation>
            </ref>
            <ref id="CR28">
              <label>28.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Dalcin</surname>
                    <given-names>LD</given-names>
                  </name>
                  <name>
                    <surname>Paz</surname>
                    <given-names>RR</given-names>
                  </name>
                  <name>
                    <surname>Kler</surname>
                    <given-names>PA</given-names>
                  </name>
                  <name>
                    <surname>Cosimo</surname>
                    <given-names>A</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Parallel distributed computing using Python</article-title>
                <source>Adv Water Resour</source>
                <year>2011</year>
                <volume>34</volume>
                <fpage>1124</fpage>
                <lpage>1139</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXht1WksLzF</pub-id>
                <pub-id pub-id-type="doi">10.1016/j.advwatres.2011.04.013</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR29">
              <label>29.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Dalcin</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Paz</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Storti</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>D’Elia</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">MPI for Python: performance improvements and MPI-2 extensions</article-title>
                <source>J Parallel Distrib Comput</source>
                <year>2008</year>
                <volume>68</volume>
                <fpage>655</fpage>
                <lpage>662</lpage>
                <pub-id pub-id-type="doi">10.1016/j.jpdc.2007.09.005</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR30">
              <label>30.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Dalcin</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Paz</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Storti</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">MPI for Python</article-title>
                <source>J Parallel Distrib Comput</source>
                <year>2005</year>
                <volume>65</volume>
                <fpage>1108</fpage>
                <lpage>1115</lpage>
                <pub-id pub-id-type="doi">10.1016/j.jpdc.2005.03.010</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR31">
              <label>31.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Wibowo</surname>
                    <given-names>AS</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Structures of human folate receptors reveal biological trafficking states and diversity in folate and antifolate recognition</article-title>
                <source>Proc Natl Acad Sci USA</source>
                <year>2013</year>
                <volume>110</volume>
                <fpage>15180</fpage>
                <lpage>15188</lpage>
                <pub-id pub-id-type="doi">10.1073/pnas.1308827110</pub-id>
                <pub-id pub-id-type="pmid">23934049</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR32">
              <label>32.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Durrant</surname>
                    <given-names>JD</given-names>
                  </name>
                  <name>
                    <surname>McCammon</surname>
                    <given-names>JA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">BINANA: a novel algorithm for ligand-binding characterization</article-title>
                <source>J Mol Graph Model</source>
                <year>2011</year>
                <volume>29</volume>
                <fpage>888</fpage>
                <lpage>893</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXjvFSltr8%3D</pub-id>
                <pub-id pub-id-type="doi">10.1016/j.jmgm.2011.01.004</pub-id>
                <pub-id pub-id-type="pmid">21310640</pub-id>
                <pub-id pub-id-type="pmcid">3099006</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR33">
              <label>33.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Durrant</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Blendmol: advanced macromolecular visualization in blender</article-title>
                <source>Bioinformatics</source>
                <year>2018</year>
                <pub-id pub-id-type="doi">10.1093/bioinformatics/bty968</pub-id>
                <pub-id pub-id-type="pmid">30481283</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR34">
              <label>34.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Scott</surname>
                    <given-names>WL</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Distributed drug discovery: advancing chemical education through contextualized combinatorial solid-phase organic laboratories</article-title>
                <source>J Chem Educ</source>
                <year>2015</year>
                <volume>92</volume>
                <fpage>819</fpage>
                <lpage>826</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2MXlslaqsrk%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ed500135n</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR35">
              <label>35.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Fairlie</surname>
                    <given-names>DP</given-names>
                  </name>
                  <name>
                    <surname>Woon</surname>
                    <given-names>TC</given-names>
                  </name>
                  <name>
                    <surname>Wickramasinghe</surname>
                    <given-names>WA</given-names>
                  </name>
                  <name>
                    <surname>Willis</surname>
                    <given-names>AC</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Amide-iminol tautomerism: effect of metalation</article-title>
                <source>Inorg Chem</source>
                <year>1994</year>
                <volume>33</volume>
                <fpage>6425</fpage>
                <lpage>6428</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK2MXitFCisLc%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ic00104a067</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR36">
              <label>36.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Armstrong</surname>
                    <given-names>KA</given-names>
                  </name>
                  <name>
                    <surname>Tidor</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>Cheng</surname>
                    <given-names>AC</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Optimal charges in lead progression: a structure-based neuraminidase case study</article-title>
                <source>J Med Chem</source>
                <year>2006</year>
                <volume>49</volume>
                <fpage>2470</fpage>
                <lpage>2477</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD28XivVemu7c%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/jm051105l</pub-id>
                <pub-id pub-id-type="pmid">16610790</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR37">
              <label>37.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Lagorce</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Pencheva</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Villoutreix</surname>
                    <given-names>BO</given-names>
                  </name>
                  <name>
                    <surname>Miteva</surname>
                    <given-names>MA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">DG-AMMOS: a new tool to generate 3d conformation of small molecules using distance geometry and automated molecular mechanics optimization for in silico screening</article-title>
                <source>BMC Chem Biol</source>
                <year>2009</year>
                <volume>9</volume>
                <fpage>6</fpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXhsVGhs7nL</pub-id>
                <pub-id pub-id-type="doi">10.1186/1472-6769-9-6</pub-id>
                <pub-id pub-id-type="pmid">19912625</pub-id>
                <pub-id pub-id-type="pmcid">2781789</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR38">
              <label>38.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Gill</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Pawar</surname>
                    <given-names>DM</given-names>
                  </name>
                  <name>
                    <surname>Noe</surname>
                    <given-names>EA</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Conformational study of cis-1,4-di-tert-butylcyclohexane by dynamic NMR spectroscopy and computational methods. Observation of chair and twist-boat conformations</article-title>
                <source>J Org Chem</source>
                <year>2005</year>
                <volume>70</volume>
                <fpage>10726</fpage>
                <lpage>10731</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2MXht1Gju7fF</pub-id>
                <pub-id pub-id-type="doi">10.1021/jo051654z</pub-id>
                <pub-id pub-id-type="pmid">16355992</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR39">
              <label>39.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Shim</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Mackerell</surname>
                    <given-names>AD</given-names>
                    <suffix>Jr</suffix>
                  </name>
                </person-group>
                <article-title xml:lang="en">Computational ligand-based rational design: role of conformational sampling and force fields in model development</article-title>
                <source>MedChemComm</source>
                <year>2011</year>
                <volume>2</volume>
                <fpage>356</fpage>
                <lpage>370</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXls1Kht7c%3D</pub-id>
                <pub-id pub-id-type="doi">10.1039/C1MD00044F</pub-id>
                <pub-id pub-id-type="pmid">21716805</pub-id>
                <pub-id pub-id-type="pmcid">3123535</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR40">
              <label>40.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Sen</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Chatterjee</surname>
                    <given-names>TK</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Pharmacophore modeling and 3D quantitative structure-activity relationship analysis of febrifugine analogues as potent antimalarial agent</article-title>
                <source>J Adv Pharm Technol Res</source>
                <year>2013</year>
                <volume>4</volume>
                <fpage>50</fpage>
                <lpage>60</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3sXktV2htrk%3D</pub-id>
                <pub-id pub-id-type="doi">10.4103/2231-4040.107501</pub-id>
                <pub-id pub-id-type="pmid">23662282</pub-id>
                <pub-id pub-id-type="pmcid">3645363</pub-id>
              </mixed-citation>
            </ref>
          </ref-list>
        </ref-list>
        <notes notes-type="Misc">
          <title>Publisher's Note</title>
          <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
        </notes>
      </back>
    </article>
