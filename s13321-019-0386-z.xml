<?xml version="1.0"?>
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="research-article" xml:lang="en">
      <front>
        <journal-meta>
          <journal-id journal-id-type="publisher-id">13321</journal-id>
          <journal-title-group>
            <journal-title>Journal of Cheminformatics</journal-title>
            <abbrev-journal-title abbrev-type="publisher">J Cheminform</abbrev-journal-title>
          </journal-title-group>
          <issn pub-type="epub">1758-2946</issn>
          <publisher>
            <publisher-name>Springer International Publishing</publisher-name>
            <publisher-loc>Cham</publisher-loc>
          </publisher>
        </journal-meta>
        <article-meta>
          <article-id pub-id-type="publisher-id">s13321-019-0386-z</article-id>
          <article-id pub-id-type="manuscript">386</article-id>
          <article-id pub-id-type="doi">10.1186/s13321-019-0386-z</article-id>
          <article-categories>
            <subj-group subj-group-type="heading">
              <subject>Research Article</subject>
            </subj-group>
            <subj-group subj-group-type="article-collection" specific-use="">
              <subject>Proceedings of the 11th International Conference on Chemical Structures</subject>
            </subj-group>
          </article-categories>
          <title-group>
            <article-title xml:lang="en">A visual approach for analysis and inference of molecular activity spaces</article-title>
          </title-group>
          <contrib-group>
            <contrib contrib-type="author" id="Au1">
              <name>
                <surname>Kausar</surname>
                <given-names>Samina</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="aff" rid="Aff2">2</xref>
            </contrib>
            <contrib contrib-type="author" corresp="yes" id="Au2">
              <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3588-8746</contrib-id>
              <name>
                <surname>Falcao</surname>
                <given-names>Andre O.</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="aff" rid="Aff2">2</xref>
              <xref ref-type="corresp" rid="IDs133210190386z_cor2">b</xref>
            </contrib>
            <aff id="Aff1">
              <label>1</label>
              <institution-wrap>
                <institution-id institution-id-type="ISNI">0000 0001 2181 4263</institution-id>
                <institution-id institution-id-type="GRID">grid.9983.b</institution-id>
                <institution content-type="org-division">LaSIGE, Departamento de Informática, Faculdade de Ciências</institution>
                <institution content-type="org-name">Universidade de Lisboa</institution>
              </institution-wrap>
              <addr-line content-type="postcode">1749-016</addr-line>
              <addr-line content-type="city">Lisboa</addr-line>
              <country country="PT">Portugal</country>
            </aff>
            <aff id="Aff2">
              <label>2</label>
              <institution-wrap>
                <institution-id institution-id-type="ISNI">0000 0001 2181 4263</institution-id>
                <institution-id institution-id-type="GRID">grid.9983.b</institution-id>
                <institution content-type="org-division">BioISI: Biosystems &amp; Integrative Sciences Institute, Faculdade de Ciencias</institution>
                <institution content-type="org-name">Universidade de Lisboa</institution>
              </institution-wrap>
              <addr-line content-type="postcode">1749-016</addr-line>
              <addr-line content-type="city">Lisboa</addr-line>
              <country country="PT">Portugal</country>
            </aff>
          </contrib-group>
          <author-notes>
            <corresp id="IDs133210190386z_cor2">
              <label>b</label>
              <email>HIDDEN</email>
            </corresp>
          </author-notes>
          <pub-date date-type="pub" publication-format="electronic">
            <day>22</day>
            <month>10</month>
            <year>2019</year>
          </pub-date>
          <pub-date date-type="collection" publication-format="electronic">
            <month>12</month>
            <year>2019</year>
          </pub-date>
          <volume>11</volume>
          <issue seq="63">1</issue>
          <elocation-id>63</elocation-id>
          <history>
            <date date-type="registration">
              <day>9</day>
              <month>10</month>
              <year>2019</year>
            </date>
            <date date-type="received">
              <day>1</day>
              <month>10</month>
              <year>2018</year>
            </date>
            <date date-type="accepted">
              <day>5</day>
              <month>10</month>
              <year>2019</year>
            </date>
            <date date-type="online">
              <day>22</day>
              <month>10</month>
              <year>2019</year>
            </date>
          </history>
          <permissions>
            <copyright-statement content-type="compact">© The Author(s) 2019</copyright-statement>
            <copyright-year>2019</copyright-year>
            <copyright-holder>The Author(s)</copyright-holder>
            <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
              <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link xlink:href="http://creativecommons.org/licenses/by/4.0/" ext-link-type="uri">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (http://creativecommons.org/publicdomain/zero/1.0/) applies to the data made available in this article, unless otherwise stated.</license-p>
            </license>
          </permissions>
          <abstract xml:lang="en" id="Abs1">
            <title>Abstract</title>
            <sec id="ASec1">
              <title>Background</title>
              <p id="Par1">Molecular space visualization can help to explore the diversity of large heterogeneous chemical data, which ultimately may increase the understanding of structure-activity relationships (SAR) in drug discovery projects. Visual SAR analysis can therefore be useful for library design, chemical classification for their biological evaluation and virtual screening for the selection of compounds for synthesis or in vitro testing. As such, computational approaches for molecular space visualization have become an important issue in cheminformatics research. The proposed approach uses molecular similarity as the sole input for computing a probabilistic surface of molecular activity (PSMA). This similarity matrix is transformed in 2D using different dimension reduction algorithms (Principal Coordinates Analysis ( PCooA), Kruskal multidimensional scaling, Sammon mapping and t-SNE). From this projection, a kernel density function is applied to compute the probability of activity for each coordinate in the new projected space.</p>
            </sec>
            <sec id="ASec2">
              <title>Results</title>
              <p id="Par2">This methodology was tested over four different quantitative structure-activity relationship (QSAR) binary classification data sets and the PSMAs were computed for each. The generated maps showed internal consistency with active molecules grouped together for all data sets and all dimensionality reduction algorithms. To validate the quality of the generated maps, the 2D coordinates of test molecules were computed into the new reference space using a data transformation matrix. In total sixteen PSMAs were built, and their performance was assessed using the Area Under Curve (AUC) and the Matthews Coefficient Correlation (MCC). For the best projections for each data set, AUC testing results ranged from 0.87 to 0.98 and the MCC scores ranged from 0.33 to 0.77, suggesting this methodology can validly capture the complexities of the molecular activity space. All four mapping functions provided generally good results yet the overall performance of PCooA and t-SNE was slightly better than Sammon mapping and Kruskal multidimensional scaling.</p>
            </sec>
            <sec id="ASec3">
              <title>Conclusions</title>
              <p id="Par3">Our result showed that by using an appropriate combination of metric space representation and dimensionality reduction applied over metric spaces it is possible to produce a visual PSMA for which its consistency has been validated by using this map as a classification model. The produced maps can be used as prediction tools as it is simple to project any molecule into this new reference space as long as the similarities to the molecules used to compute the initial similarity matrix can be computed.</p>
            </sec>
          </abstract>
          <kwd-group xml:lang="en">
            <title>Keywords</title>
            <kwd>Structure activity relationship (SAR)</kwd>
            <kwd>Molecular/chemical space</kwd>
            <kwd>Two dimensional kernel density estimation</kwd>
            <kwd>Noncontiguous atom matching structural similarity function (NAMS)</kwd>
            <kwd>t-SNE</kwd>
            <kwd>PCooA</kwd>
            <kwd>Non-metric MDS</kwd>
            <kwd>Sammon mapping</kwd>
          </kwd-group>
          <funding-group>
            <award-group>
              <funding-source>
                <institution-wrap>
                  <institution>Fundação para a Ciência e a Tecnologia</institution>
                  <institution-id institution-id-type="doi" vocab="open-funder-registry">http://dx.doi.org/10.13039/501100001871</institution-id>
                </institution-wrap>
              </funding-source>
              <award-id award-type="FundRef grant">PTDC/EEI-ESS/4923/2014</award-id>
              <award-id award-type="FundRef grant">SFRH/BD/111654/2015</award-id>
              <principal-award-recipient>
                <name>
                  <surname>Falcao</surname>
                  <given-names>Andre O.</given-names>
                </name>
              </principal-award-recipient>
              <principal-award-recipient>
                <name>
                  <surname>Kausar</surname>
                  <given-names>Samina</given-names>
                </name>
              </principal-award-recipient>
            </award-group>
          </funding-group>
          <custom-meta-group>
            <custom-meta>
              <meta-name>publisher-imprint-name</meta-name>
              <meta-value>Springer</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-issue-count</meta-name>
              <meta-value>1</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-article-count</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-pricelist-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-holder</meta-name>
              <meta-value>The Author(s)</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-contains-esm</meta-name>
              <meta-value>Yes</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-year</meta-name>
              <meta-value>2019</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-month</meta-name>
              <meta-value>10</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-day</meta-name>
              <meta-value>9</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-product</meta-name>
              <meta-value>ArchiveJournal</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-collection-editor</meta-name>
              <meta-value>Gerard van Westen, Markus Wagener</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-grants-type</meta-name>
              <meta-value>OpenChoice</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>metadata-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>abstract-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodypdf-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodyhtml-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bibliography-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>esm-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>online-first</meta-name>
              <meta-value>false</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-file-reference</meta-name>
              <meta-value>BodyRef/PDF/13321_2019_Article_386.pdf</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-type</meta-name>
              <meta-value>Typeset</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>target-type</meta-name>
              <meta-value>OnlinePDF</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-type</meta-name>
              <meta-value>OriginalPaper</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-primary</meta-name>
              <meta-value>Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computer Applications in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Documentation and Information in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Theoretical and Computational Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computational Biology/Bioinformatics</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-collection</meta-name>
              <meta-value>Chemistry and Materials Science</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>open-access</meta-name>
              <meta-value>true</meta-value>
            </custom-meta>
          </custom-meta-group>
        </article-meta>
      </front>
      <body>
        <sec id="Sec1">
          <title>Introduction</title>
          <p id="Par4">Chemical/molecular space reflects high dimensional conceptual spaces that describe the structural diversity of all possible potential pharmacologically active molecules. The size of molecular space is not well defined, yet a fraction of it ranging from thousands to millions of compounds is stored in small molecule databases. Consequently, a part of the huge molecular space is mainly focused to explore the complexity of a relevant small set of chemical structures in many different problems during drug design [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. Nonetheless, molecular space interactive analysis and visualization can serve as a strong tool to explore the diversity of millions of compounds stored in public databases and can increase the performance of drug discovery process. For example, nearest neighbour searches in various defined property regions in molecular space (activity space map) can identify interesting similar molecules (potent analogues) with similar properties [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>].</p>
          <p id="Par5">Molecular space visualization methods require that molecules are projected into a reduced set of dimensions (most of the times, two or three) in such a way that the relative distances between molecules are better preserved in this new projected space. As distances should be preserved, molecules with similar activity profiles should appear clustered together [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. Thus, molecular space visual analysis combines the concept of molecular structure and activity similarity [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. Since molecular dis/similarity is defined through pairwise distances between projected molecules in reference space, an appropriate choice of a molecular metric space (spatial) representation is crucial for reliable application of molecular spacial analysis. A molecule in metric space is defined as a set of distances computed from the similarity between that molecule to all the other molecules in a given chemical data set. For this purpose, many methods are available in literature to compute dis/similarity. A variety of methods uses either molecular descriptors or fingerprints, which represent different physico-chemical or structural characteristics [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR16">16</xref>]. These approaches entail that each molecule is initially reduced into a vector space by computing a set of attributes, that can be used to infer distance, yet this is not always required as other independent approaches like molecular graph matching approaches can also be used for a direct assessment of structural similarity [<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR20">20</xref>].</p>
          <p id="Par6">In metric space representation, a set of <italic>M</italic> molecules is represented in <italic>M</italic> dimensions, as the distance to all the other elements of the set (including itself) must be present. As such, the visualization of this <italic>M</italic>-dimensional metric space in reduced spatial dimensionality is a challenge in data diversity analysis [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. To address this issue many linear and non-linear approaches have been developed to reduce the dimensionality and complexity of molecular space [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]. In all dimension reduction (DR) methods, the most important characteristic is the optimization of the criterion that guides dimensionality reduction. Since the concept of DR is mainly based on data geometrical representation where data is interpreted as discrete points/objects, the main objective to explore or analyze such geometrical spaces is to discover the relationships between the points within this complex structure of data (manifold) [<xref ref-type="bibr" rid="CR22">22</xref>]. The main criterion that needs to be optimized in DR algorithms for metric space data is the approximation of the original intermolecular distances (proximity relationships) in the new projection space; DR approaches that are based on optimization of this dimensionality reduction criterion in a linear/non-linear way are collectively referred as distance-preserving approaches [<xref ref-type="bibr" rid="CR22">22</xref>]. Principal component analysis (PCA) [<xref ref-type="bibr" rid="CR24">24</xref>], is by far the most common method [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>] used in DR, yet it does not fall into this category, as the main purpose of PCA is to represent in less dimensions the linear components that maximize the data variance, not necessarily preserving the distances between data. On the other hand Principal Coordinates Analysis (PCooA) [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>], Sammon mapping [<xref ref-type="bibr" rid="CR29">29</xref>], stochastic neighbor embedding [<xref ref-type="bibr" rid="CR30">30</xref>] or stochastic proximity embedding [<xref ref-type="bibr" rid="CR31">31</xref>], to name but a few are distance-preserving DR algorithms and some topology-preserving methods like self-organizing maps [<xref ref-type="bibr" rid="CR32">32</xref>] or generative topographic mapping (GTM) [<xref ref-type="bibr" rid="CR33">33</xref>] have been used in cheminformatics [<xref ref-type="bibr" rid="CR23">23</xref>]. The latter method appears as an interesting approach to reduce dimensions while producing a kernel based probabilistic map, nonetheless it is not as accurate for preserving distances and requires a set of descriptors selected beforehand for data processing [<xref ref-type="bibr" rid="CR33">33</xref>]. Most of the times, non-linear methods are usually preferred because linear algorithms may be limited to linear projection functions and therefore may not adequately handle complex associations that may be present in such problems [<xref ref-type="bibr" rid="CR22">22</xref>].</p>
          <p id="Par7">Distance preserving DR methods can then make it possible to project molecules into a 2D reduced molecular space while preserving the original proximity (distances) of molecules as best as possible, assuming that there is always going to be a loss of information as the original molecular space should have a much higher dimensionality. To establish a structure-activity relationship, molecular activity surface maps mostly referred as “activity landscapes” are generated from 2D projected space (reference space) of molecules by adding a property of each molecule as a third dimension [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR34">34</xref>]. In such projections, the activity of molecules added as third dimension in the projected molecular space is the basis for fitting a generated surface that represents the activity magnitude. Since data is largely scattered in projected space, an interpolation algorithm [<xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR36">36</xref>] is required to make a coherent surface onto this 2D projected map. Ideally, structurally similar molecules should appear grouped together in well-separated clusters and each group should have similar properties. This property may not always hold, and that is the case of “activity cliffs”, projected regions that exhibit similar molecules with largely varying activity very close together [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]. Despite these challenges, such analysis may provide a global picture of the spatial characteristics of a given data set.</p>
          <p id="Par8">The descriptive and predictive accuracy of molecular space visualization approaches largely depends upon three main issues, including a) a choice of a molecular space representation, b) the accuracy of DR methods and c) the performance of the interpolation algorithm to generate well estimated activity surface from sparsely projected molecules. To this end, in our approach for visual characterization of molecules in conceptual spaces, a reliable pipeline is generated that can efficiently be used to build a probabilistic surface of molecular activity (PSMA), which can help to understand SAR in different situations. We have thus integrated the advantages of the following different methods in the proposed molecular space mapping approach:<list list-type="bullet"><list-item><p id="Par9">Choice of molecular space representation: Molecular pairwise similarity was quantified using a graph matching algorithm: The Non-contiguous Atom Matching Structural similarity (NAMS) [<xref ref-type="bibr" rid="CR17">17</xref>], which is a robust metric space representation method. This algorithm has a higher discriminative power for very similar molecules over other structural or graph matching approaches [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]. However, any other similarity computation method can be used.</p></list-item><list-item><p id="Par10">DR methods: We applied four non-linear DR methods including Principal Coordinates Analysis (PCooA) [<xref ref-type="bibr" rid="CR27">27</xref>], Kruskal Multidimensional Scaling (KMDS) [<xref ref-type="bibr" rid="CR28">28</xref>], Sammon mapping (SM), [<xref ref-type="bibr" rid="CR29">29</xref>] and t-Distributed Stochastic Neighbor Embedding (t-SNE) [<xref ref-type="bibr" rid="CR39">39</xref>].</p></list-item><list-item><p id="Par11">PSMA: Non-parametric 2D kernel density estimation (KDE) function [<xref ref-type="bibr" rid="CR40">40</xref>] created within a Bayesian framework was used to map the most likely activity regions (activity surfaces) from sparsely distributed active and inactive compounds.</p></list-item></list>This approach is, to our knowledge, new and allows building a non-parametric model out of raw similarity data, which is useful for visualization and has clear predictive properties. This model does not make any assumptions on its form and, due to its construction process, its resulting surface is independent of the coordinate axes. Furthermore, t-SNE applications in molecular space diversity analysis are not a common practice in cheminformatics. A survey of recent literature showed only one work to visualize molecular space using this algorithm [<xref ref-type="bibr" rid="CR41">41</xref>]. However, under this particular domain, this is a first effort to build activity spatial classification model using this algorithm by comparing its performance with other commonly used tools. Another novel point the present approach tried to address was the use of 2 dimensional KDE for model making. KDE is considered a powerful tool in statistics for truthful assessment of data actual distribution/characteristics [<xref ref-type="bibr" rid="CR40">40</xref>]. In cheminformatics literature KDE has been used as a robust method to define applicability domains of quantitative structure-activity relationship (QSAR) predictive models [<xref ref-type="bibr" rid="CR42">42</xref>–<xref ref-type="bibr" rid="CR44">44</xref>]. Applicability domains are used to define a boundaries in molecular space within which new predictions of QSAR models are considered reliable [<xref ref-type="bibr" rid="CR45">45</xref>]. We extended the same concept to computing probability density function for active and inactive molecules within 2D projected space and surface was generated from the 2D map containing high promising regions of active molecules. In the presented methodology, integration of KDE in SAR spatial visualization is a new addition in the efforts of molecular space analysis. It must be made clear that, despite the fact that we are using a Bayesian approach to compute the PSMA, our method does not assume independence of the projected coordinates, thus being closer to a full Bayesian classifier than to a naive-Bayes approach. We are thus computing the full 2D probability map and not the individual probability distribution functions of each coordinate axis.</p>
        </sec>
        <sec id="Sec2" sec-type="methods">
          <title>Methodology</title>
          <sec id="Sec3">
            <title>Overview of the methodology</title>
            <p id="Par12">The basic idea of this study is to capture the measured molecular distances according to any proven method and try to represent those molecules in a reduced reference space for analysis and visualization. Many dimensionality reduction methods are extant, [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] and some of the more popular are PCooA, KMDS, SM, and t-SNE [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR41">41</xref>]. The procedure to create a PSMA can summarily be described in the following steps. First, a full similarity matrix of a molecular data set is computed. Secondly, similarities are transformed into distances and projected into a 2-Dimensional (2D) space using one of the above mapping functions. Finally, the probabilities of this reduced space are computed using a 2D KDE function within a Bayesian perspective [<xref ref-type="bibr" rid="CR46">46</xref>] to produce a probability map of a projected molecule for all classes. The generated 2D probability map should show the density distribution of training data by mapping the locations of the most likely activity regions of the projected molecular space. Such interactive class probability topographical map (A PSMA) can serve as classification model. To project new molecules into the new reference space, a data transformation matrix can be used for embedding test molecules in the reference activity space. To classify each new projected molecule the generated PSMA is used to calculate their probability of belonging to either class. Models performance was assessed using test molecules predictions (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).<fig id="Fig1"><label>Fig. 1</label><caption xml:lang="en"><p>Overview of the methodology</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_386_Fig1_HTML.png" id="MO1" /></fig></p>
          </sec>
          <sec id="Sec4">
            <title>Molecular dis/similarity quantification</title>
            <p id="Par13">Chemical space analysis based on nearest neighbour searches in which molecular similarity analysis is a central task that is based on <italic>Similar Property Principle</italic> [<xref ref-type="bibr" rid="CR7">7</xref>]. According to this similarity principle, globally similar compounds should have similar properties [<xref ref-type="bibr" rid="CR9">9</xref>]. Since intermolecular distances between projected molecules are a measure of their molecular similarity or dissimilarity, its quantification must be robust for meaningful spatial/metric space representations, so that they may be able to map similar compounds in contiguous regions, a fundamental aspect for reliable property prediction [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>].</p>
            <p id="Par14">For similarity quantification, molecules are translated into numeric data using various molecular representations including structural descriptors and molecular fingerprints [<xref ref-type="bibr" rid="CR47">47</xref>–<xref ref-type="bibr" rid="CR49">49</xref>]. Molecular descriptors contain information of structural relevant features of molecules at different levels including constitutional (1D), topological (2D), geometrical (3D) and physico-chemical properties-based (4D) [<xref ref-type="bibr" rid="CR47">47</xref>, <xref ref-type="bibr" rid="CR48">48</xref>]. Molecular fingerprints encode molecular structural information in a bit-string where each bit represents the presence (1) or absence (0) of a structural feature (e.g., chemical substructure, sub-graph, or 2D or 3D pharmacophore). 2D fingerprints are commonly used molecular representations for dis/similarity quantification because comparing bit-string is fast and easy [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR50">50</xref>–<xref ref-type="bibr" rid="CR52">52</xref>].</p>
            <p id="Par15">There are some conventional distance metrics like Euclidean, Hamming, Manhattan distance that measure the distance between compounds represented by using descriptors/fingerprints [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR53">53</xref>]. Some other similarity coefficients are available for binary data (e.g. Tanimoto, Sorensen-Dice, cosine or Tversky) [<xref ref-type="bibr" rid="CR54">54</xref>, <xref ref-type="bibr" rid="CR55">55</xref>]. Of those, the Tanimoto coefficient (Tc) is extensively applied in literature to compute similarity between molecules using molecular fingerprints [<xref ref-type="bibr" rid="CR53">53</xref>, <xref ref-type="bibr" rid="CR56">56</xref>]. Tc compares two fingerprints and counts the number of on-bits (1) common in both with respect to the total number of on-bits (1) in each fingerprint. There are several other approaches that assess similarity using different algorithms based on superposition, molecular graph representations [<xref ref-type="bibr" rid="CR57">57</xref>] histogram comparisons [<xref ref-type="bibr" rid="CR58">58</xref>, <xref ref-type="bibr" rid="CR59">59</xref>] and Brownian processing of molecules [<xref ref-type="bibr" rid="CR60">60</xref>]. In this study, we used for molecular similarity assessment a graph matching algorithm, the Non-contiguous Atom Matching Structural similarity (NAMS) [<xref ref-type="bibr" rid="CR17">17</xref>]. This algorithm uses an atom alignment method to adequately quantify the structural similarity and has a high discriminative power for very similar molecules over other structural or graph matching approaches. NAMS breaks complex molecular structures into simpler parts to reduce molecule to atoms and calculates global structural similarity score from the best alignment between the atoms of compared molecules. NAMS follows an atom matching methodology, which is able to consider the important characteristics of the atoms and bonds such as the chirality and the double bond stereoisomerism. These features are usually ignored in other approaches.</p>
            <p id="Par16">It is important to notice that this approach as it uses a full distance matrix as the basis for its representation, may present some computational challenges over very large data sets. Currently with common lab workstations with 16–32 Gib of RAM, it should be possible to use this methodology with datasets of up to 10,000–15,000 molecules.</p>
          </sec>
          <sec id="Sec5">
            <title>From similarity to distance</title>
            <p id="Par17">As stated above, since molecular similarity is measured by a distance between a pair of molecules in the chosen reference space, a distance function known as metric is mainly required to calculate distances between molecules in metric space representation. A dissimilarity function or a distance function <italic>d</italic>(<italic>x</italic>, <italic>y</italic>) between tho instances <italic>x</italic> and <italic>y</italic> must satisfy the following three basic properties:<list list-type="bullet"><list-item><p id="Par18">(Property 1) <inline-formula id="IEq1"><alternatives><mml:math id="IEq1_Math"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d(x, x) = 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq1.gif" /></alternatives></inline-formula></p></list-item><list-item><p id="Par19">(Property 2) <inline-formula id="IEq2"><alternatives><mml:math id="IEq2_Math"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><tex-math id="IEq2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d(x, y) \ge 0$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq2.gif" /></alternatives></inline-formula></p></list-item><list-item><p id="Par20">(Property 3) <inline-formula id="IEq3"><alternatives><mml:math id="IEq3_Math"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≤</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d(x, z) \le d(x, y) + d(y, z) $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq3.gif" /></alternatives></inline-formula></p></list-item></list>Which essentially state that a distance between an instance and itself should always be zero, any distance between any instances should never be negative and that the distance between 2 points should respect the triangle inequality. A function that transforms similarity into distance should accordingly be monotonically decreasing and intersect the X-axis precisely at <inline-formula id="IEq4"><alternatives><mml:math id="IEq4_Math"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq4.gif" /></alternatives></inline-formula>. Using these principles similarities and distances can be inter-converted i.e. every similarity metric correspond to a distance metric and vice versa. If similarity function s(x, y) is normalized 0 <inline-formula id="IEq5"><alternatives><mml:math id="IEq5_Math"><mml:mo>≤</mml:mo></mml:math><tex-math id="IEq5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq5.gif" /></alternatives></inline-formula> s(x, y) <inline-formula id="IEq6"><alternatives><mml:math id="IEq6_Math"><mml:mo>≤</mml:mo></mml:math><tex-math id="IEq6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq6.gif" /></alternatives></inline-formula> 1 and s(x, x) = 1 for all x, y <inline-formula id="IEq7"><alternatives><mml:math id="IEq7_Math"><mml:mo>∈</mml:mo></mml:math><tex-math id="IEq7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\in $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq7.gif" /></alternatives></inline-formula> X then similarity matrix can be transform into distance matrix with a simple distance functions (see Eqs. <xref rid="Equ1" ref-type="disp-formula">1</xref> [<xref ref-type="bibr" rid="CR61">61</xref>] and <xref rid="Equ2" ref-type="disp-formula">2</xref> [<xref ref-type="bibr" rid="CR62">62</xref>])<disp-formula id="Equ1"><label>1</label><alternatives><mml:math display="block" id="Equ1_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mspace width="0.166667em" /></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow /><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ1_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} d(x,y)=\, &amp; {} 1- s(x,y) \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_Equ1.gif" /></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><mml:math display="block" id="Equ2_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mspace width="0.166667em" /></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow /><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>⟺</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ2_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} s(x,y)=\, &amp; {} \frac{1}{1+d(x,y)} \iff {d(x,y)} = \frac{1}{s(x,y)}-1 \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_Equ2.gif" /></alternatives></disp-formula>Other complying transformations can also be applied like the negative of the natural logarithm (Eq. <xref rid="Equ2" ref-type="disp-formula">2</xref>) [<xref ref-type="bibr" rid="CR36">36</xref>].<disp-formula id="Equ3"><label>3</label><alternatives><mml:math display="block" id="Equ3_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mo>ln</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ3_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} d(x,y) = -\ln (s(x,y)) \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_Equ3.gif" /></alternatives></disp-formula>These last two equations show the property that similarity values of zero imply an infinite distance, so, for those extreme values, some clamping to a maximum distance may be necessary.</p>
            <p id="Par21">Within the molecular space a distance function should be modulated to set a particular meaning out of similarity measures. It can be rapidly observed that the last two functions appear concave (Fig. <xref rid="Fig2" ref-type="fig">2</xref>), meaning that near the regions that have the lowest similarity, the impact on the resulting distance is the highest, which is counter-intuitive, as typically the conservation of activity for similar molecules is only verified at the highest levels of structural similarity. Such transformation functions may further increase the projection distortion, as most algorithms will tend to minimize the error between the projected distances and the actual distances. A convex curve may solve this problem, by inflating the distances of very similar molecules but, on the other hand, if two molecules are very unrelated, the impact on the transformed distance will appear small. As such we propose the use of the following transformation which uses a parameter <italic>k</italic> that controls the convexity.<disp-formula id="Equ4"><label>4</label><alternatives><mml:math display="block" id="Equ4_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:mo>×</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ4_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} d(x, y) = 1-\frac{k\times s(x, y)}{1+k- s(x, y)} \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_Equ4.gif" /></alternatives></disp-formula><fig id="Fig2"><label>Fig. 2</label><caption xml:lang="en"><p>Distance functions for similarity to distance transformations</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_386_Fig2_HTML.png" id="MO6" /></fig></p>
            <p id="Par22">In Eq. <xref rid="Equ4" ref-type="disp-formula">4</xref>, small positive values of <italic>k</italic> entail extremely convex functions, while on the other hand, very high values approach <inline-formula id="IEq8"><alternatives><mml:math id="IEq8_Math"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d(x,y)=1-s(x,y)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq8.gif" /></alternatives></inline-formula> (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Empirically and visually we have determined that values of k ranging from 0.3 to 0.5 provide not too abrupt transitions, and a value of 0.382 was used in all problems (<inline-formula id="IEq9"><alternatives><mml:math id="IEq9_Math"><mml:mrow><mml:mn>0.382</mml:mn><mml:mo>≈</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><tex-math id="IEq9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.382\approx \phi -1$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq9.gif" /></alternatives></inline-formula>, where <inline-formula id="IEq10"><alternatives><mml:math id="IEq10_Math"><mml:mi>ϕ</mml:mi></mml:math><tex-math id="IEq10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq10.gif" /></alternatives></inline-formula> is the Golden Ratio)</p>
          </sec>
          <sec id="Sec6">
            <title>Dimensionality reduction</title>
            <p id="Par23">As stated, the visualization of metric space data is a difficult challenge in many different domains of data analysis, as it demands efficient and robust techniques to adequately represent in 2 or 3 dimensions the data variability present in an intrinsic multidimensional problem [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. The objective of metric space visualization is to generate a topographical map, which should be able to present a visual characterization of molecules by grouping them together on the basis of their structural similarity. As referred, a metric space is an <inline-formula id="IEq11"><alternatives><mml:math id="IEq11_Math"><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><tex-math id="IEq11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M\times M$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq11.gif" /></alternatives></inline-formula> dimensional distance matrix where <italic>M</italic> compounds are represented each by <italic>M</italic> intermolecular distances. However, it is not trivial to graph the diversity of such high dimensional metric space. As referred, the main objective of dimensionality reduction (DR) in metric spaces is the distance-preservation in original high dimensional space to reduce dimensions. These transformations can be linear or non-linear. The distance-preservation criteria is that any manifold complex geometrical structure of data can be projected into reduced number of dimensions, and the quality of such transformation can be measured by the difference between the original and the projected distances in the new space. A large number of nonlinear DR approaches are available that aim to preserve the local structure of data [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. In this work we used four of the most widely used DR distance-preserving techniques, namely, Principal Coordinates Analysis (PCooA), Kruskal Multidimensional Scaling (KMDS), Sammon mapping (SM), and t-Distributed Stochastic Neighbor Embedding (t-SNE), for reducing the molecules’ distance matrix in 2D and allow the visualization of the data. After DR, the newly projected instances were divided according to their activity class and a probability function assigned by using a kernel density function to each element of each class.</p>
            <sec id="Sec7">
              <title>Principal Coordinates Analysis (PCooA)</title>
              <p id="Par24">Principal Coordinates Analysis (PCooA) [<xref ref-type="bibr" rid="CR27">27</xref>] also known as metric multidimensional scaling (MDS). PCooA relies on a simple generative model possessing all the advantages and drawbacks of Principal components analysis, although its goal is to preserve distances, while PCA aims at preserving the data variance. However, differently from PCA which generally is performed by computing the eigenstructure of the covariance matrix of the data, in PCooA, the basic input is the distance matrix. To the squared of the distance matrix, each element is double centered and, to the resulting matrix, an eigendecomposition is performed. The eigenscaled coordinates of the first <italic>N</italic> eigenvectors are the projected coordinates resulting from this transformation. There are no tuning parameters for PCooA, however, results may vary depending on the distance function used for data metric space representation. It is important to notice that PCooA is only guaranteed to provide an optimal solution if the distances computed between instances are Euclidean, which is clearly not the case. Nonetheless this linear projection into a reduced dimension space has been used in other studies (e.g. [<xref ref-type="bibr" rid="CR36">36</xref>]). It would have been possible to transform the existing distances into Euclidean distances, but as to make a direct comparison between projection heuristics, it was opted to use the exact same data for all methods without any further processing. Many implementations of KMDS or SM use the results of PCooA transformation as a starting point, which were also used non-transformed.</p>
            </sec>
            <sec id="Sec8">
              <title>Kruskal Multidimensional Scaling (KMDS)</title>
              <p id="Par25">Non-metric multidimensional scaling was developed by Kruskal [<xref ref-type="bibr" rid="CR28">28</xref>] for resolving problems related to the linear multidimensional scaling algorithms, like PCooA. The KMDS is based on numerical optimization methods. This method uses ordinal information (i.e., proximity ranks) and then calculates the scaled proximities using monotonic transformation to determine the high-dimensional structure of data set. Finally, to visualize data in low dimensional features space, KMDS finds the best possible projections with minimum squared differences between the initial distances and the scaled ranking of the distances. Thus, in contrast to PCooA, KMDS does not attempt to directly preserve distances between the data points in the initial space but rather its order, or ranking, of the distances between objects [<xref ref-type="bibr" rid="CR22">22</xref>]. KMDS optimizes the following stress function or error function (Eq. <xref rid="Equ5" ref-type="disp-formula">5</xref>) to estimate the preservation of the pairwise distances (goodness of fit).<disp-formula id="Equ5"><label>5</label><alternatives><mml:math display="block" id="Equ5_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mspace width="0.333333em" /><mml:mtext>Kruskal's stress</mml:mtext><mml:mspace width="0.333333em" /></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo></mml:mrow><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:msqrt></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ5_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} {\displaystyle {\text { Kruskal's stress }}={\sqrt{\frac{\sum _{i,j} (d(i,j) - \widehat{d}(i,j)^2}{\sum _{i,j}d^2(i,j)} }}} \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_Equ5.gif" /></alternatives></disp-formula>where <italic>d</italic>(<italic>i</italic>, <italic>j</italic>) are the collected proximities and <inline-formula id="IEq12"><alternatives><mml:math id="IEq12_Math"><mml:mrow><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{d}(i,j)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq12.gif" /></alternatives></inline-formula> is the distance measured between the <inline-formula id="IEq13"><alternatives><mml:math id="IEq13_Math"><mml:mrow><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:mrow></mml:math><tex-math id="IEq13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i{\text {th}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq13.gif" /></alternatives></inline-formula> and <inline-formula id="IEq14"><alternatives><mml:math id="IEq14_Math"><mml:mrow><mml:mi>j</mml:mi><mml:mtext>th</mml:mtext></mml:mrow></mml:math><tex-math id="IEq14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j{\text {th}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq14.gif" /></alternatives></inline-formula> objects in low-dimensional representations</p>
            </sec>
            <sec id="Sec9">
              <title>Sammon mapping</title>
              <p id="Par26">In 1969 Sammon [<xref ref-type="bibr" rid="CR29">29</xref>] developed a non-linear variant of MDS, which is referred as Sammon mapping, Sammon’s nonlinear mapping and NLM (Non-Linear Mapping). The word “mapping” used to represent the main objective of the method, which was to establish a mapping between a high-dimensional metric space and a lower-dimensional feature space. But, to some extent the ’mapping’ word is misleading as it does not exactly generate a continuous mapping between these two spatial representations. The main goal of Sammon’s algorithm is a dimensionality reduction of a finite set of objects/points by following the same basic principle of MDS algorithm. The main modification is its efficient optimization technique to minimize the Sammon’s stress function (Eq. <xref rid="Equ6" ref-type="disp-formula">6</xref>) by calculating its normalized value by the initial space distances. Sammon’s algorithm does not require any parameter optimization, but results may vary depending on the chosen different dissimilarity measures.<disp-formula id="Equ6"><label>6</label><alternatives><mml:math display="block" id="Equ6_Math"><mml:mrow><mml:mtext>Sammon's</mml:mtext><mml:mspace width="0.166667em" /><mml:mtext>stress</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>d</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em" /><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mfrac><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>d</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em" /><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em" /><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced><mml:mrow><mml:mi>d</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em" /><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><tex-math id="Equ6_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{Sammon's}}\,{\text{stress}} = \frac{1}{{\sum\nolimits_{i &lt; j} {d\left( {i,\,j} \right)} }}\sum\limits_{i &lt; j} {\frac{{\left( {d\left( {i,\,j} \right) - \widehat d{{\left( {i,\,j} \right)}^2}} \right)}}{{d\left( {i,\,j} \right)}}} $$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_Equ6.gif" /></alternatives></disp-formula>where <italic>d</italic>(<italic>i</italic>, <italic>j</italic>) are orignal distances and <inline-formula id="IEq15"><alternatives><mml:math id="IEq15_Math"><mml:mrow><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><tex-math id="IEq15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{d}(i,j)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq15.gif" /></alternatives></inline-formula> are distances between the <inline-formula id="IEq16"><alternatives><mml:math id="IEq16_Math"><mml:mrow><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:mrow></mml:math><tex-math id="IEq16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i{\text {th}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq16.gif" /></alternatives></inline-formula> and <inline-formula id="IEq17"><alternatives><mml:math id="IEq17_Math"><mml:mrow><mml:mi>j</mml:mi><mml:mtext>th</mml:mtext></mml:mrow></mml:math><tex-math id="IEq17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j{\text {th}}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq17.gif" /></alternatives></inline-formula> objects in reduced space.</p>
            </sec>
            <sec id="Sec10">
              <title>t-Distributed Stochastic Neighbor Embedding (t-SNE)</title>
              <p id="Par27">t-Distributed Stochastic Neighbor Embedding (t-SNE) [<xref ref-type="bibr" rid="CR39">39</xref>] is a variant of Stochastic Neighbor Embedding (SNE) and was developed to solve two basic problems of the SNE algorithm including difficult optimization of a cost function and a problem referred as “crowding problem”. The main objective of both methods SNE and t-SNE is similar to MDS to projected objects in reduced space, such that the pairwise distances between projected objects reflect the original distances between objects as good as possible; although this distance preservation is achieved in a non-linear way. t-SNE algorithm focuses on local data structures, to generate well-separated clusters. One of the key characteristics of this method is that the new distances of objects in the reduced feature space are determined probabilistically with close objects having a much higher probability of staying together in the new space than distant objects. In contrast to SNE, t-SNE does not compute Gaussian “induced” probabilities between each pair of points in embedded space, instead it uses a heavy-tailed Student’s t-distribution for the same purpose so as to avoid the projection of points to the same place (crowding effect). This method consequently allows efficient visualization of moderate distances in the initial space by larger distances in graphical configuration of projected space. Differently from the other methods, t-SNE is a probabilistic approach, thus different runs may produce different maps.</p>
            </sec>
          </sec>
          <sec id="Sec11">
            <title>Probabilities density estimation</title>
            <p id="Par28">The probability density function (PDF) is an informal way to explore and analyse the properties of any given quantitative variable. The PDF gives a natural description of the distribution of any random variable by specifying its probability for all values of its range. Since robust estimation of the probability density can be used to solve regression and classification problems, the PDF is a fundamental concept in data analysis [<xref ref-type="bibr" rid="CR40">40</xref>, <xref ref-type="bibr" rid="CR46">46</xref>]</p>
            <p id="Par29">The PDF for any given variable can be estimated using either parametric methods that assume the density function has a standard distribution function. As an example, if we assume a continuous variable has a normal distribution, then it is possible to compute the full PDF of this variable if the mean and the variance of the data are known and confidently mirror that of the original population. Non-parametric methods, on the other hand, are free of any assumptions and estimate probability density solely from data. One of the most common methods in one dimensional variables is to use a gaussian kernel function applied to each observation, and using the scaled sum of each kernel for each point within the defined range of the data. Non-parametric PDF estimation is an extensive research area in field of data exploration [<xref ref-type="bibr" rid="CR40">40</xref>, <xref ref-type="bibr" rid="CR46">46</xref>]. Most of the existing techniques focus on low dimensional densities estimation (1 to 3D) because uni/bivariate PDF is relatively easy; however investigating PDF of data in higher dimensions (multivariate) is difficult and computational expensive. In lower dimensions histograms can be constructed that generate a non smooth representation of the PDF. But for smooth PDF estimation, the usage of kernel density estimation (KDE) is a common method, used in visual data exploration [<xref ref-type="bibr" rid="CR40">40</xref>, <xref ref-type="bibr" rid="CR46">46</xref>]. The multivariate KDE algorithm has been introduced to deal with high dimensional data with improved accuracy and speed [<xref ref-type="bibr" rid="CR46">46</xref>, <xref ref-type="bibr" rid="CR63">63</xref>]. In our analysis we have used a bivariate KDE applied to the chemical data projected in 2D.</p>
            <sec id="Sec12">
              <title>2D kernel density estimation</title>
              <p id="Par30">A kernel density estimation function generates an actual distribution of the data by calculating the probability of each data point in the given data without using any reference point [<xref ref-type="bibr" rid="CR42">42</xref>] or prior assumptions. Kernel probability density function computes the PDF of the projected 2D space by summing up M-dimensional kernels placed on every projected coordinate. The basic kernel estimator can be expressed as<disp-formula id="Equ7"><label>7</label><alternatives><mml:math display="block" id="Equ7_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="italic">nh</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi>K</mml:mi><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mi>h</mml:mi></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ7_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} \widehat{f}(x)= \frac{1}{nh}\sum _{j=1}^{n}K\Big (\frac{x-x_j}{h}\Big ) \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_Equ7.gif" /></alternatives></disp-formula>where <bold>K</bold> is a fixed kernel and <italic>h</italic> is the calculated bandwidth for sample <inline-formula id="IEq18"><alternatives><mml:math id="IEq18_Math"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math><tex-math id="IEq18_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_1, \ldots , x_n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq18.gif" /></alternatives></inline-formula>. Commonly available kernel functions are Gaussian (normal), uniform, cosine, triangle, Epanechnikov, quartic (biweight), and tricube (triweight). The bandwidth, <italic>h</italic>, is a smoothing parameter that influences the width of PDF estimates. Choosing a bandwidth is a compromise between very smooth estimates (large <italic>h</italic> values) to remove insignificant bumps and wiggly estimates to find out real peaks (small <italic>h</italic> values). In this study, we applied a two-dimensional KDE with a Gaussian kernel [<xref ref-type="bibr" rid="CR46">46</xref>] to calculate densities in the two-dimensional reduced space. It is defined as<disp-formula id="Equ8"><label>8</label><alternatives><mml:math display="block" id="Equ8_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>s</mml:mi></mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:msub><mml:mi>h</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msub><mml:mi>h</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ8_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} f(x,y)= \frac{\sum _{s}\phi \Big (\frac{(x-x_s)}{h_x}\Big ) \phi \Big (\frac{(y-y_s)}{h_y}\Big ) }{nh_xh_y} \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_Equ8.gif" /></alternatives></disp-formula>For determining the bandwidth (<inline-formula id="IEq19"><alternatives><mml:math id="IEq19_Math"><mml:msub><mml:mi>h</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq19_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h_n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq19.gif" /></alternatives></inline-formula>), we used Silverman’s heuristic approach [<xref ref-type="bibr" rid="CR40">40</xref>] (<inline-formula id="IEq20"><alternatives><mml:math id="IEq20_Math"><mml:msub><mml:mi>h</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><tex-math id="IEq20_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h_n$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq20.gif" /></alternatives></inline-formula>) for the Gaussian kernel function (Eq. <xref rid="Equ6" ref-type="disp-formula">6</xref>) [<xref ref-type="bibr" rid="CR46">46</xref>].<disp-formula id="Equ9"><label>9</label><alternatives><mml:math display="block" id="Equ9_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mn>1.06</mml:mn><mml:mo movablelimits="true">min</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mfrac><mml:mi>R</mml:mi><mml:mrow><mml:mn>1.34</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow><mml:mi>M</mml:mi><mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>5</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ9_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} h_n\approx 1.06\min \Big (\widehat{\sigma }, \frac{R}{1.34}\Big )M,^{-\frac{1}{5}} \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_Equ9.gif" /></alternatives></disp-formula>where <inline-formula id="IEq21"><alternatives><mml:math id="IEq21_Math"><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><tex-math id="IEq21_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\sigma }$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq21.gif" /></alternatives></inline-formula> is the standard deviation of the reference coordinate, <italic>R</italic>, the difference between the 2nd and 3rd quartile and <italic>M</italic> the number of projected points.</p>
              <p id="Par31">In QSAR modelling, KDE is usually explored as an interpolation method to define the applicability domain of generated classification models [<xref ref-type="bibr" rid="CR45">45</xref>]. Among the most widely used multivariate (high dimensional metric space) interpolation approaches (e.g., range-based, distance-based, geometrical), KDE is considered as one of the more advanced and accurate methods for calculating the applicability domain [<xref ref-type="bibr" rid="CR42">42</xref>–<xref ref-type="bibr" rid="CR44">44</xref>]. However, to the best of our knowledge, KDE is not used for visualization nor data classification over 2D activity landscapes.</p>
            </sec>
          </sec>
          <sec id="Sec13">
            <title>Defining active probability regions</title>
            <p id="Par32">In the available literature, several other methods have been used for data visualization of the molecular space. Yet, in all cases each projected point is associated with its measured activity value and surfaces are generated according to the activity magnitude of each molecule or colour codes are used to differentiate different activities [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR35">35</xref>]. In all these approaches, along with all referred issues in data visualizing methods most implemented interpolation methods are not adequate as classification tools.</p>
            <p id="Par33">To clearly identify the spatial regions where is a higher probability of finding active compounds, to the 2D projected molecules, training data was divided into two classes of active and inactive molecules according to a predefined activity threshold. For both partitions a kernel density map (KDM) is computed, using a common bandwidth, previously computed with all the data. Each KDM can be seen as a measure of the likelihood of a molecule being a negative or a positive depending on its position on the 2D space, as each KDM is an actual probability function, with an integral summing to one. To compute the posteriors of both KDMs it is necessary to accommodate the data priors. Following Bayes’ theorem [<xref ref-type="bibr" rid="CR64">64</xref>], the posterior probability density (likelihood/probability of a randomly projected new molecule to be in positive class) can be calculated by normalizing the product of the conditional density probability (projected KDM) with the prior probability density of the given partition (positive or negative). Thus to identify whether or not a molecule in (<italic>x</italic>, <italic>y</italic>) coordinates being active it is necessary to evaluate each of both Eqs. (<xref rid="Equ10" ref-type="disp-formula">10</xref> and <xref rid="Equ11" ref-type="disp-formula">11</xref>)<disp-formula id="Equ10"><label>10</label><alternatives><mml:math display="block" id="Equ10_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd /><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>∣</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ10_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;P(m_+\mid (x,y) ) = \frac{P((x,y) \mid m_+) P(m_+)}{P((x,y))} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_Equ10.gif" /></alternatives></disp-formula><disp-formula id="Equ11"><label>11</label><alternatives><mml:math display="block" id="Equ11_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd /><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>∣</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ11_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;P(m_- \mid (x,y) ) = \frac{P((x,y) \mid m_-) P(m_-)}{P((x,y))} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_Equ11.gif" /></alternatives></disp-formula>where <inline-formula id="IEq22"><alternatives><mml:math id="IEq22_Math"><mml:msub><mml:mi>m</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math><tex-math id="IEq22_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_+$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq22.gif" /></alternatives></inline-formula> and <inline-formula id="IEq23"><alternatives><mml:math id="IEq23_Math"><mml:msub><mml:mi>m</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math><tex-math id="IEq23_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_-$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq23.gif" /></alternatives></inline-formula>, stand for active (positive) and non-active (negative) molecules. <inline-formula id="IEq24"><alternatives><mml:math id="IEq24_Math"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq24_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P((x,y) \mid m_+)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq24.gif" /></alternatives></inline-formula> is the actual value of the KDM of positive molecules (the likelihood of being positive) and <inline-formula id="IEq25"><alternatives><mml:math id="IEq25_Math"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq25_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(m_+)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq25.gif" /></alternatives></inline-formula> the prior probability of the molecule being active. This illustrates that in the end it should be possible to compute the posterior probability <inline-formula id="IEq26"><alternatives><mml:math id="IEq26_Math"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>∣</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq26_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(m_+\mid (x,y) )$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq26.gif" /></alternatives></inline-formula>. The corresponding meanings stand for Eq. <xref rid="Equ11" ref-type="disp-formula">11</xref> that quantify the likelihood, prior and posterior probabilities for the inactive molecules</p>
            <p id="Par34">These observations show that it is possible to compute an activity probability surface using the 2D coordinates of the projected molecules. This surface can therefore be visualized and it should be able to capture the more promising activity regions in the chemical landscape. Furthermore as this surface corresponds to an actual activity posterior map, this visualization tool could be used as a classifier, an actual spatial classification model that approximates a 2D Bayes classifier.</p>
          </sec>
          <sec id="Sec14">
            <title>Test set embedding and model validation</title>
            <p id="Par35">The creation of 2D surfaces from the original data will necessarily cause some loss of information. It is thus required to verify if the activity maps constructed are valid in the face of new observations. Therefore to assess model quality, each data set was randomly split into training and test sets. The training set was used to create the model surface and the test set molecules were later embedded, using a linear projection function. If we assume that the original distance matrix is <italic>D</italic> (an <italic>M</italic><inline-formula id="IEq27"><alternatives><mml:math id="IEq27_Math"><mml:mo>×</mml:mo></mml:math><tex-math id="IEq27_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq27.gif" /></alternatives></inline-formula><italic>M</italic> matrix) that we are going to project into a reduced subspace of <italic>P</italic> dimensions, which we will call <italic>C</italic> (an <italic>M</italic><inline-formula id="IEq28"><alternatives><mml:math id="IEq28_Math"><mml:mo>×</mml:mo></mml:math><tex-math id="IEq28_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq28.gif" /></alternatives></inline-formula><italic>P</italic> matrix with one row for each instance and <italic>P</italic> columns) corresponding to the molecule coordinates in the new space. As, in the present case, we are transforming into a 2D space, <italic>P</italic> must be equal to 2. We can then assume that there is a transformation <italic>f</italic>() that transforms <italic>D</italic> into <italic>C</italic>: <inline-formula id="IEq29"><alternatives><mml:math id="IEq29_Math"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:math><tex-math id="IEq29_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(D)=C$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq29.gif" /></alternatives></inline-formula>. The purpose of any multidimensional scaling algorithm is getting the best <italic>f</italic>() for translating <italic>D</italic> into <italic>C</italic>, according to different stress measures and criteria. A very simple way to model this <italic>f</italic>() function is to assume it as a linear transformation of <italic>D</italic> into <italic>C</italic>. As any linear transformation can be thought as a matrix, which we will call <italic>T</italic>, we can then think of such a transformation as:<disp-formula id="Equ12"><label>12</label><alternatives><mml:math display="block" id="Equ12_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>D</mml:mi><mml:mo>·</mml:mo><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ12_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} D\cdot T = C \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_Equ12.gif" /></alternatives></disp-formula>The matrix <italic>D</italic> is the original training set distance matrix. After the multidimensional scaling heuristic has been processed we have the projected coordinates of the training set into the new space (<italic>C</italic>). With these, <italic>T</italic> can then be computed by pre-multiplying each part of the equation by the inverse of <italic>D</italic> (<inline-formula id="IEq30"><alternatives><mml:math id="IEq30_Math"><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><tex-math id="IEq30_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D^{-1}$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq30.gif" /></alternatives></inline-formula>): Thus<disp-formula id="Equ13"><label>13</label><alternatives><mml:math display="block" id="Equ13_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:mi>D</mml:mi><mml:mo>·</mml:mo><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ13_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} D^{-1} \cdot D \cdot T = D^{-1} \cdot C \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_Equ13.gif" /></alternatives></disp-formula>Which simplifies into<disp-formula id="Equ14"><label>14</label><alternatives><mml:math display="block" id="Equ14_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ14_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} T = D^{-1} \cdot C \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_Equ14.gif" /></alternatives></disp-formula>The <italic>T</italic> transformation can then be computed by multiplying the inverse of the training set distance matrix with the matrix of the projected coordinates. This approach is applicable to all projections and, as long as the new instances are close to the training set, this projection should provide an adequate (but not exact) transformation. It is obvious that the projections of the training set Distance matrix(<italic>D</italic>) using <italic>T</italic> will coincide exactly with <italic>C</italic>. To project any new molecule into the new reference space it is only necessary to compute its distances to the molecules of the training set, which will then be transformed by multiplying the transpose of that vector with matrix <italic>T</italic>.</p>
            <p id="Par36">As the projected coordinates of each molecule into the new reference space, it should be easy to compute its activity probability (Eqs. <xref rid="Equ10" ref-type="disp-formula">10</xref> and <xref rid="Equ11" ref-type="disp-formula">11</xref>). As the result is a probability function, the model’s performance was assessed using AUC, which measures the entire two-dimensional area underneath the entire receiver operating characteristic (ROC) curve created by plotting the sensitivity/recall/true positive rate (TPR) against the false positive rate (FPR)  (Eqs. <xref rid="Equ15" ref-type="disp-formula">15</xref> and <xref rid="Equ16" ref-type="disp-formula">16</xref>).<disp-formula id="Equ15"><label>15</label><alternatives><mml:math display="block" id="Equ15_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd /><mml:mtd columnalign="left"><mml:mrow><mml:mtext>Sensitivity</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TP</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ15_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\text {Sensitivity} = \frac{TP}{TP+FN} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_Equ15.gif" /></alternatives></disp-formula><disp-formula id="Equ16"><label>16</label><alternatives><mml:math display="block" id="Equ16_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd /><mml:mtd columnalign="left"><mml:mrow><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mtext>Specificity</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">TN</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ16_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;FPR= 1 -\text {Specificity} = 1 - \frac{TN}{TN+FP} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_Equ16.gif" /></alternatives></disp-formula>where, for both eqs., TP are the true positives, TN, the true negatives, FP the false positives and FN, the false negatives. For AUC computation, the positive accepting threshold is changed, and thus the values of these quantities will change accordingly. and provide the data for building the ROC curve.</p>
            <p id="Par37">A second, more stringent criterion is the use of the Matthews Correlation Criterion (MCC) [<xref ref-type="bibr" rid="CR65">65</xref>], which encompasses the quantities defined above into one statistic that has been widely used for assessing the quality of binary classification models (Eq. <xref rid="Equ17" ref-type="disp-formula">17</xref>). Differently from the AUC, the MCC will consider as positives only the instances where <inline-formula id="IEq31"><alternatives><mml:math id="IEq31_Math"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>∣</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>></mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>∣</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq31_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(M_+\mid (x,y) > P(M_-\mid (x,y) ))$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq31.gif" /></alternatives></inline-formula><disp-formula id="Equ17"><label>17</label><alternatives><mml:math display="block" id="Equ17_Math"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>MCC</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>×</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo>×</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:msqrt><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><tex-math id="Equ17_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} {\displaystyle {\text {MCC}}={\frac{TP\times TN-FP\times FN}{\sqrt{(TP+FP)(TP+FN)(TN+FP)(TN+FN)}}}} \end{aligned} \end{aligned}$$\end{document}</tex-math><graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_Equ17.gif" /></alternatives></disp-formula></p>
          </sec>
        </sec>
        <sec id="Sec15">
          <title>Data</title>
          <p id="Par38">The designed methodology was tested over four human protein targets (Table <xref rid="Tab1" ref-type="table">1</xref>), retrieved from ChEMBL23 [<xref ref-type="bibr" rid="CR66">66</xref>]. We have looked for data sets for which biological activity was measured as <inline-formula id="IEq32"><alternatives><mml:math id="IEq32_Math"><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq32_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq32.gif" /></alternatives></inline-formula> as it quantifies a ligand-receptor interaction based on the equilibrium dissociation constant (<italic>K</italic>) where smaller value corresponds higher ligand-receptor binding affinities and vice versa [<xref ref-type="bibr" rid="CR67">67</xref>]. The selected data sets were curated using an automated QSAR modelling workflow [<xref ref-type="bibr" rid="CR68">68</xref>] which essentially removed duplicates and curated the structures by removing salt groups and complex compounds. Of the four data sets selected, only was further trimmed, as we were looking for a data set where the experimental conditions were similar. As such, for the Sigma 1 receptor only molecules for which <inline-formula id="IEq33"><alternatives><mml:math id="IEq33_Math"><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq33_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq33.gif" /></alternatives></inline-formula> resulted from the displacement of [3H]-pentazocine were considered. All data sets were divided into two classes using a cut-off activity value to discriminate highly active molecules (<inline-formula id="IEq34"><alternatives><mml:math id="IEq34_Math"><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq34_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq34.gif" /></alternatives></inline-formula><inline-formula id="IEq35"><alternatives><mml:math id="IEq35_Math"><mml:mo>≤</mml:mo></mml:math><tex-math id="IEq35_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq35.gif" /></alternatives></inline-formula> 10.0 nM) as positives and less active and non-active molecules (<inline-formula id="IEq36"><alternatives><mml:math id="IEq36_Math"><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq36_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq36.gif" /></alternatives></inline-formula> > 10.0 nM) as negatives. This low cut-off value was selected to counter the positive bias in public repositories such as ChEMBL, which is an unrealistic assumption in actual drug development scenarios, where the active/non-active ratio is typically much lower. Such stringent threshold resulted in purposely unbalanced data sets with a much larger number of negatives than positives, which is a known characteristic of most problem sets in real world in-silico drug development. Such unbalance is an hindrance in model learning, and makes the fitting process typically much harder.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Data set description—data set sizes discriminated by positives and negatives within training/testing data split</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"><p>Target protein name</p></th><th align="left" rowspan="2"><p>Uniprot ID</p></th><th align="left" colspan="2"><p>Training set</p></th><th align="left" colspan="2"><p>Test set</p></th><th align="left" rowspan="2"><p>Mean distance</p></th><th align="left" rowspan="2"><p>Distance std. dev.</p></th></tr><tr><th align="left"><p>Positives</p></th><th align="left"><p>Negatives</p></th><th align="left"><p>Positives</p></th><th align="left"><p>Negatives</p></th></tr></thead><tbody><tr><td align="left"><p>Sigma non-opioid intracellular receptor 1 (SIGMAR1)</p></td><td align="left"><p>Q99720</p></td><td char="." align="char"><p>46</p></td><td char="." align="char"><p>135</p></td><td char="." align="char"><p>10</p></td><td char="." align="char"><p>35</p></td><td char="." align="char"><p>0.79</p></td><td char="." align="char"><p>0.13</p></td></tr><tr><td align="left"><p>Histamine H1 receptor (HRH1)</p></td><td align="left"><p>P35367</p></td><td char="." align="char"><p>184</p></td><td char="." align="char"><p>783</p></td><td char="." align="char"><p>46</p></td><td char="." align="char"><p>195</p></td><td char="." align="char"><p>0.83</p></td><td char="." align="char"><p>0.08</p></td></tr><tr><td align="left"><p>Potassium voltage-gated channel subfamily H member 2 (HERG)</p></td><td align="left"><p>Q12809</p></td><td char="." align="char"><p>39</p></td><td char="." align="char"><p>1142</p></td><td char="." align="char"><p>12</p></td><td char="." align="char"><p>283</p></td><td char="." align="char"><p>0.84</p></td><td char="." align="char"><p>0.06</p></td></tr><tr><td align="left"><p>D(1B) dopamine receptor (DRD5)</p></td><td align="left"><p>P21918</p></td><td char="." align="char"><p>41</p></td><td char="." align="char"><p>231</p></td><td char="." align="char"><p>5</p></td><td char="." align="char"><p>62</p></td><td char="." align="char"><p>0.80</p></td><td char="." align="char"><p>0.10</p></td></tr></tbody></table><table-wrap-foot><p>Includes the average computational distance between compounds of each data set and its respective standard deviation</p></table-wrap-foot></table-wrap></p>
          <p id="Par39">To assess the structural diversity of of each data set the average distance between all pairs of molecules was computed. For all data sets the average distance was about 0.8, with a low standard deviation <inline-formula id="IEq37"><alternatives><mml:math id="IEq37_Math"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>∼</mml:mo><mml:mn>0.09</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><tex-math id="IEq37_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\sim 0.09)$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq37.gif" /></alternatives></inline-formula> which indicates that these data sets are very diverse with a large majority of molecules with virtually no ascertainable similarity to most of the others in each data set.</p>
        </sec>
        <sec id="Sec16">
          <title>Implementation</title>
          <p id="Par40">All analysis was implemented using R software (version 3.4.4) [<xref ref-type="bibr" rid="CR69">69</xref>] on a PC desktop with a Core i7 Processor (3.41 GHz) and 16 GB RAM. Data sets of all selected problems were divided into a training set and test set using a random partition with (20/80)% ratio. Similarity matrices (<italic>M</italic><inline-formula id="IEq38"><alternatives><mml:math id="IEq38_Math"><mml:mo>×</mml:mo></mml:math><tex-math id="IEq38_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times $$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq38.gif" /></alternatives></inline-formula><italic>M</italic> matrix containing intermolecular similarities) of all data sets were computed using NAMS [<xref ref-type="bibr" rid="CR17">17</xref>] that allows for the computation of pairwise similarities between all molecules within a database. All the other NAMS parameters were left as default. Similarity matrices were converted into dissimilarity matrices (metric space representation) using Eq. <xref rid="Equ4" ref-type="disp-formula">4</xref>, with <inline-formula id="IEq39"><alternatives><mml:math id="IEq39_Math"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0.382</mml:mn></mml:mrow></mml:math><tex-math id="IEq39_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k = 0.382$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq39.gif" /></alternatives></inline-formula> for all data sets. For the DR processes, R cmdscale function [<xref ref-type="bibr" rid="CR70">70</xref>] was used for PCooA, two functions from R package MASS [<xref ref-type="bibr" rid="CR46">46</xref>] including isoMDS and sammon was used for KMDS and SM respectively. We used the t-SNE implementation from R library Rtsne [<xref ref-type="bibr" rid="CR39">39</xref>]. Finally, for computing the kernel desnity map in 2D, the kde2d function from R package MASS [<xref ref-type="bibr" rid="CR46">46</xref>] was used. The bandwidths for the positive and negative maps were calculated beforehand using the bandwidth.nrd function (see Eq. <xref rid="Equ9" ref-type="disp-formula">9</xref>).</p>
        </sec>
        <sec id="Sec17">
          <title>Results and discussion
</title>
          <p id="Par42">We generated the activity (<inline-formula id="IEq40"><alternatives><mml:math id="IEq40_Math"><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq40_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq40.gif" /></alternatives></inline-formula>) probability maps (PSMA) for four different problems (<italic>SIGMAR1, HRH1, HERG,</italic> and <italic>DRD5</italic>) using 4 different DR methods: PCooa, KMDS, SM, and t-SNE. For each we have produced the probability of activity surface maps. These PSMAs typically show consistency, and the regions with the highest probability of activity appear most of the times well differentiated from the negative regions. Figure <xref rid="Fig3" ref-type="fig">3</xref> shows the results of PCooA projection for the 4 data sets, computed solely from the 80% training data. The PSMA for all projection functions appears on supplementary material (Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>: Figure S1a, S1b, S1c). In these probability maps, surface height mirrors the kernel density distribution of active molecules (positive class) and the colour represents higher probability locations (most likely activity regions). It is interesting to verify that the visual complexity and asymmetry of the resulting maps clearly shows that a naive-Bayes approach would be inadequate for this type of modeling, where the data clustering patterns make obvious the interdependence of the data in the projection axes.<fig id="Fig3"><label>Fig. 3</label><caption xml:lang="en"><p>Test set projection over map surface (PSMA) with PCooA. Surfaces represents higher probability locations. red – circles are ground truth positives, white are ground truth negatives</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_386_Fig3_HTML.png" id="MO20" /></fig></p>
          <p id="Par43">To check the quality of the produced probability surface maps, the test set molecules were projected into the new reference plane. The performance of all sixteen generated PSMAs was assessed using AUC and MCC. AUC testing results range from 0.77 to 0.98 and MCC score ranges between 0.18 to 0.77 (Table <xref rid="Tab2" ref-type="table">2</xref>). In two data sets (<italic>SIGMAR1</italic> and <italic>DRD5</italic>), PCooA performance was better than the other DR methods while for <italic>HRH1</italic> and <italic>HERG</italic> t-SNE outperformed the others. All DR approaches provided generally good AUC results. The overall performance of PCooA and t-SNE was roughly the same (average AUC = 0.86) in all four problems with a slightly (and not statistically significant) more positive outcome for PCooA with the MCC score. The test set projections over the best PSMAs for each data set shows ground truth active molecules (as red circles) typically within the highest probability of activity regions (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). In the present analysis is several cases, the MCC was low, albeit always showing clear discriminant power. On the other hand, the AUC score was consistently high.<table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>Results on validation set</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"><p>Target protein name</p></th><th align="left" colspan="2"><p>PCooA</p></th><th align="left" colspan="2"><p>KMDS</p></th><th align="left" colspan="2"><p>SM</p></th><th align="left" colspan="2"><p>t-SNE</p></th></tr><tr><th align="left"><p>AUC</p></th><th align="left"><p>MCC</p></th><th align="left"><p>AUC</p></th><th align="left"><p>MCC</p></th><th align="left"><p>AUC</p></th><th align="left"><p>MCC</p></th><th align="left"><p>AUC</p></th><th align="left"><p>MCC</p></th></tr></thead><tbody><tr><td align="left"><p>Sigma non-opioid intracellular receptor 1 (Sigma1R)</p></td><td align="left"><p>0.87(*)</p></td><td align="left"><p>0.63</p></td><td align="left"><p>0.80</p></td><td align="left"><p>0.60</p></td><td align="left"><p>0.79</p></td><td align="left"><p>0.55</p></td><td align="left"><p>0.79</p></td><td align="left"><p>0.47</p></td></tr><tr><td align="left"><p>Histamine H1 receptor (HRH1)</p></td><td align="left"><p>0.80</p></td><td align="left"><p>0.45</p></td><td align="left"><p>0.83</p></td><td align="left"><p>0.43</p></td><td align="left"><p>0.78</p></td><td align="left"><p>0.36</p></td><td align="left"><p>0.87(*)</p></td><td align="left"><p>0.54</p></td></tr><tr><td align="left"><p>Potassium voltage-gated channel subfamily H member 2 (HERG)</p></td><td align="left"><p>0.80</p></td><td align="left"><p>0.18</p></td><td align="left"><p>0.77</p></td><td align="left"><p>0.24</p></td><td align="left"><p>0.80</p></td><td align="left"><p>0.25</p></td><td align="left"><p>0.89(*)</p></td><td align="left"><p>0.33</p></td></tr><tr><td align="left"><p>D(1B) dopamine receptor (DRD5)</p></td><td align="left"><p>0.98(*)</p></td><td align="left"><p>0.77</p></td><td align="left"><p>0.86</p></td><td align="left"><p>0.32</p></td><td align="left"><p>0.80</p></td><td align="left"><p>0.42</p></td><td align="left"><p>0.90</p></td><td align="left"><p>0.41</p></td></tr><tr><td align="left"><p>Overall performance (average score)</p></td><td align="left"><p>0.86</p></td><td align="left"><p>0.51</p></td><td align="left"><p>0.82</p></td><td align="left"><p>0.40</p></td><td align="left"><p>0.79</p></td><td align="left"><p>0.40</p></td><td align="left"><p>0.86</p></td><td align="left"><p>0.44</p></td></tr></tbody></table><table-wrap-foot><p><italic>PCooA</italic> Principal co-ordinates analysis,<italic> KMDS</italic> Kruskal Multidimensional Scaling,<italic> SM</italic> Sammon mapping,<italic> t-SNE</italic> t-distributed stochastic neighbor em-bedding</p><p>(*)—best model</p></table-wrap-foot></table-wrap></p>
          <p id="Par44">
            <fig id="Fig4">
              <label>Fig. 4</label>
              <caption xml:lang="en">
                <p>Test set projection over map surface of selected PSMAs with highest performance. Surfaces represents higher probability locations. red-circles are ground truth positives, white are ground truth negatives</p>
              </caption>
              <graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_386_Fig4_HTML.png" id="MO21" />
            </fig>
          </p>
          <p id="Par45">Since dimensionality reduction is one of the important task in data visualization where it is really necessary to capture the maximum original data information in the new reduced space, Shepard plots [<xref ref-type="bibr" rid="CR46">46</xref>] were generated to analyze how much molecular initial proximity relationship remained intact. In Shepard plots the original distances are plotted against the projected distances and, ideally, the points (both distances) should lie on a straight line, which would indicate zero distortion in the projection function. The Shepard plot for the hERG data set, for all projection functions is shown (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). The remaining three data set Shepard plots can be seen in supplementary material (Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>: Figures S2a–c). The 2D projections, for all approaches, showed a similar pattern, in which it can be seen that many large distances in the initial space fail to maintain that separation in the projected space, however, in all cases, very close molecules will always appear close, which shows that locality factors were preserved in all projections, which contributes to explain the quality of the classification models. The projection of dissimilar molecules in the vicinity of similar molecules can generate noise in visualization of the real pattern of the data distribution. This is probably the cause for having low MCC scores in some data sets.<fig id="Fig5"><label>Fig. 5</label><caption xml:lang="en"><p>HERG shepard plot for PCooA, KMDS, SM and t-SNE</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_386_Fig5_HTML.png" id="MO22" /></fig></p>
          <p id="Par46">To verify whether the quality of the projection influences the classification results, the <inline-formula id="IEq41"><alternatives><mml:math id="IEq41_Math"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><tex-math id="IEq41_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R^2$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq41.gif" /></alternatives></inline-formula> coefficient that measures how the projected distances measure against the original distances was calculated (Fig. <xref rid="Fig5" ref-type="fig">5</xref> and Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>: Figure S2). It is apparent that KMDS shows the highest scores while Sammon mapping features the lowest values for all 4 test cases. It is therefore striking that KMDS although always able to produce consistently good models was never the projection that yielded the best results. This may suggest that, on this reduced dimension space, other factors rather than stricter distance preservation may be relevant for accurate model building, and the nonlinear optimization performed by KMDS actually hampers the projection quality for classification purposes.</p>
          <p id="Par47">To have a more detailed appraisal of the quality of the test set projections, the 2D molecular structures of top 6 test molecules with higher probability of being actives (predicted positives) are shown within the 2D probability map of the best 2D projections for each data set (Table <xref rid="Tab2" ref-type="table">2</xref>.), along with their ChEMBL IDs (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). It can be seen that, with only one exception, in all 4 data sets, all molecules were strong actives, although some not within the strict activity criterion (<inline-formula id="IEq42"><alternatives><mml:math id="IEq42_Math"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mn>10</mml:mn><mml:mi>n</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:math><tex-math id="IEq42_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_i\le 10 nM$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq42.gif" /></alternatives></inline-formula>). For the Sigma 1 Receptor, there were 3 correctly predicted positives, and the three negatives incorrectly predicted had in fact very low <inline-formula id="IEq43"><alternatives><mml:math id="IEq43_Math"><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><tex-math id="IEq43_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_i$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq43.gif" /></alternatives></inline-formula> values, all of them below 30 nM. For the Histamine 1 receptor, the 5 more likely molecules to be active were all correctly predicted as positives, which is striking as this data set is one of the hardest, with low classification results. The only miss is one molecule (CHEMBL1767152) with a <inline-formula id="IEq44"><alternatives><mml:math id="IEq44_Math"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>31.62</mml:mn><mml:mi>n</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:math><tex-math id="IEq44_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_i= 31.62 nM$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq44.gif" /></alternatives></inline-formula>, therefore with strong activity as well. The humean hERG is the hardest problem, as the number of negative molecules largely outnumbers the positives, nonetheless for the 6 molecules with highest probability, 4 were correctly predicted only two were misses. As in the previous cases, both molecules (CHEMBL1086480 and CHEMBL1085091) are also strong actives, with <inline-formula id="IEq45"><alternatives><mml:math id="IEq45_Math"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mn>50</mml:mn><mml:mi>n</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:math><tex-math id="IEq45_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_i \le 50 nM$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq45.gif" /></alternatives></inline-formula>. The last test set (Dopamine 5 receptor), is the one with the more striking situation, as this was the data set that had the highest classification performance. The two misses, the first molecule had a <inline-formula id="IEq46"><alternatives><mml:math id="IEq46_Math"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>10.4</mml:mn><mml:mi>n</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:math><tex-math id="IEq46_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_i=10.4 nM$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq46.gif" /></alternatives></inline-formula>, thus clearly a borderline molecule. The compound CHEMBL595720, was the only one that on ChEMBL was a clear inactive with a measured <inline-formula id="IEq47"><alternatives><mml:math id="IEq47_Math"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn><mml:mi>n</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:math><tex-math id="IEq47_TeX">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym}
				\usepackage{amsfonts}
				\usepackage{amssymb}
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_i \ge 10,000 nM$$\end{document}</tex-math><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="13321_2019_386_Article_IEq47.gif" /></alternatives></inline-formula>. It can be pointed out that, on this specific problem, that molecule is outside the most active region which appears clearly marked on the upper region of the map, with an activity cliff crossing the full surface, identifying the most promising region for finding very active molecules.<fig id="Fig6"><label>Fig. 6</label><caption xml:lang="en"><p>Test set projection over 2D probability map of selected models with highest performance. Contour lines represent 2D kernel density distribution of active molecules (positive class) and the colour other than green represents higher probability locations. Red-circles are ground truth positives, white are ground truth negatives. ChEMBL IDs. in red color text (2D structures within red lined box) are true positives and other are false positives (2D structures within white lined box)</p></caption><graphic specific-use="web" mime-subtype="PNG" xlink:href="MediaObjects/13321_2019_386_Fig6_HTML.png" id="MO23" /></fig></p>
        </sec>
        <sec id="Sec18" sec-type="conclusions">
          <title>Conclusion</title>
          <p id="Par48">This study aimed initially at presenting a visualization method that is able to capture the highest probability regions for molecules being active. To reach this goal, the molecular spaces of four data sets, captured as similarity matrices that were computed using NAMS, a graph matching algorithm. In a previous study NAMS-based molecular metric space representation was found a reliable approach to establish molecular similarity-activity relationship in QSAR modeling [<xref ref-type="bibr" rid="CR38">38</xref>]. Accordingly NAMS-based molecular spaces for the selected data sets were reduced into a new reference space in 2D using four different algorithms. The X, Y coordinates generated from each DR methods were used by a 2D kernel density function to generate their corresponding activity probability maps (PSMAs). These PSMAs were able to depict the most likely activity regions, and appear consistent, with active molecules clearly grouping together. The analysis of the produced PSMAs from the 4 data sets showed the reliability of the proposed methodology as it can efficiently produce visual cues as to where the more promising regions of the molecular space are located. The presented approach allows for the projection of new molecules into the new projected space, thus allowing for model assessment with external data. Accordingly, to validate the quality of this 2D representation as a classification model, independent validation sets were projected over the generated PSMAs, and the results were consistently good with AUC values, for the highest scoring projections, ranging from 0.87 to 0.98 and MCC scores ranging from 0.33 to 0.77. Although the followed approach did not aim at optimizing models for getting high classification accuracies, these results are strongly suggestive that it actually is capturing a large part of the modelable aspects of these SAR problems. This approach therefore uses only the 2D structural similarity between molecules to produce a non-parametric model that is both visually informative and shows demonstrable quality as a classification model.</p>
          <p id="Par49">The predictability of the presented spatial classification model (PSMA) is thus an attractive feature for virtual screening using only structural similarity of molecules. The applicability domain of such visual approaches can be vastly increased using larger data sets for any single or multiple targets. Comparatively to traditional QSAR models with a limited applicability domain, this activity space visualization directly uses structural similarity and thus may enhance SAR visualization within large activity spaces.</p>
        </sec>
        <sec id="Sec19">
          <title>Availability and requirements</title>
          <p id="Par50">All data sets and R source code (PSMA.Rmd and PSMA.html) for analysis and inference of molecular activity spaces is available in supplementary material (Additional file <xref ref-type="supplementary-material" rid="MOESM2">2</xref>).</p>
        </sec>
      </body>
      <back>
        <ack>
          <title>Acknowledgements</title>
          <p>The authors gratefully acknowledge Fundação para a Ciência e Tecnologia for a doctoral Grant (SFRH/BD/111654/2015), MIMED project funding (PTDC/EEI-ESS/4923/2014) and UID/CEC/00408/2013 (LaSIGE) for providing the infrastructure.</p>
        </ack>
        <sec sec-type="author-contribution">
          <title>Authors' contributions</title>
          <p>AOF designed and supervised the study. SK under the guidance and support of AOF performed all analysis of the results. All authors contributed to the manuscript writing and approved its final version.</p>
        </sec>
        <sec sec-type="ethics-statement">
          <sec sec-type="COI-statement">
            <title>Competing interests</title>
            <p>The authors declare that they have no competing interests.</p>
          </sec>
        </sec>
        <ref-list id="Bib1">
          <title>References</title>
          <ref-list>
            <ref id="CR1">
              <label>1.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Awale</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Visini</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Probst</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Arús-Pous</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Reymond</surname>
                    <given-names>J-L</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Chemical space: big data challenge for molecular diversity</article-title>
                <source>CHIMIA Int J Chem</source>
                <year>2017</year>
                <volume>71</volume>
                <issue>10</issue>
                <fpage>661</fpage>
                <lpage>666</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXhsFeiu7s%3D</pub-id>
                <pub-id pub-id-type="doi">10.2533/chimia.2017.661</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR2">
              <label>2.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Reymond</surname>
                    <given-names>JL</given-names>
                  </name>
                  <name>
                    <surname>Van Deursen</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Blum</surname>
                    <given-names>LC</given-names>
                  </name>
                  <name>
                    <surname>Ruddigkeit</surname>
                    <given-names>L</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Chemical space as a source for new drugs</article-title>
                <source>Med Chem Comm</source>
                <year>2010</year>
                <volume>1</volume>
                <issue>1</issue>
                <fpage>30</fpage>
                <lpage>38</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3cXhtVeju7rF</pub-id>
                <pub-id pub-id-type="doi">10.1039/c0md00020e</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR3">
              <label>3.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Dobson</surname>
                    <given-names>CM</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Chemical space and biology</article-title>
                <source>Nature</source>
                <year>2004</year>
                <volume>432</volume>
                <issue>7019</issue>
                <fpage>824</fpage>
                <lpage>828</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2cXhtVOht7jN</pub-id>
                <pub-id pub-id-type="doi">10.1038/nature03192</pub-id>
                <pub-id pub-id-type="pmid">15602547</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR4">
              <label>4.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Sidorov</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Viira</surname>
                    <given-names>B</given-names>
                  </name>
                  <name>
                    <surname>Davioud-Charvet</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Maran</surname>
                    <given-names>U</given-names>
                  </name>
                  <name>
                    <surname>Marcou</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Horvath</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Varnek</surname>
                    <given-names>A</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">QSAR modeling and chemical space analysis of antimalarial compounds</article-title>
                <source>J Comput Aided Mol Design</source>
                <year>2017</year>
                <volume>31</volume>
                <issue>5</issue>
                <fpage>441</fpage>
                <lpage>451</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2sXlsFOjt7o%3D</pub-id>
                <pub-id pub-id-type="doi">10.1007/s10822-017-0019-4</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR5">
              <label>5.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Ash</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Fourches</surname>
                    <given-names>D</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Characterizing the chemical space of ERK2 kinase inhibitors using descriptors computed from molecular dynamics trajectories</article-title>
                <source>J Chem Inf Model</source>
                <year>2017</year>
                <volume>57</volume>
                <issue>6</issue>
                <fpage>1286</fpage>
                <lpage>1299</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2sXntVOmur4%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/acs.jcim.7b00048</pub-id>
                <pub-id pub-id-type="pmid">28471171</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR6">
              <label>6.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Vogt</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Progress with modeling activity landscapes in drug discovery</article-title>
                <source>Expert Opin Drug Discov</source>
                <year>2018</year>
                <volume>13</volume>
                <issue>7</issue>
                <fpage>605</fpage>
                <lpage>615</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXotVSns7g%3D</pub-id>
                <pub-id pub-id-type="doi">10.1080/17460441.2018.1465926</pub-id>
                <pub-id pub-id-type="pmid">29656681</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR7">
              <label>7.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="editor">
                  <name>
                    <surname>Varnek</surname>
                    <given-names>Alexandre</given-names>
                  </name>
                  <name>
                    <surname>Tropsha</surname>
                    <given-names>Alex</given-names>
                  </name>
                </person-group>
                <source>Chemoinformatics Approaches to Virtual Screening</source>
                <year>2008</year>
                <publisher-loc>Cambridge</publisher-loc>
                <publisher-name>Royal Society of Chemistry</publisher-name>
              </mixed-citation>
            </ref>
            <ref id="CR8">
              <label>8.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Nikolova</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Jaworska</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Approaches to measure chemical similarity—a review</article-title>
                <source>QSAR Comb Sci</source>
                <year>2003</year>
                <volume>22</volume>
                <issue>910</issue>
                <fpage>1006</fpage>
                <lpage>1026</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2cXhtlKitL8%3D</pub-id>
                <pub-id pub-id-type="doi">10.1002/qsar.200330831</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR9">
              <label>9.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Johnson</surname>
                    <given-names>MA</given-names>
                  </name>
                  <name>
                    <surname>Maggiora</surname>
                    <given-names>GM</given-names>
                  </name>
                </person-group>
                <source>Concepts and applications of molecular similarity</source>
                <year>1990</year>
                <publisher-loc>New York</publisher-loc>
                <publisher-name>Wiley</publisher-name>
              </mixed-citation>
            </ref>
            <ref id="CR10">
              <label>10.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Willett</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Barnard</surname>
                    <given-names>JM</given-names>
                  </name>
                  <name>
                    <surname>Downs</surname>
                    <given-names>GM</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Chemical similarity searching</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>1998</year>
                <volume>38</volume>
                <issue>6</issue>
                <fpage>983</fpage>
                <lpage>996</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK1cXks1ynu74%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci9800211</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR11">
              <label>11.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Bender</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Glen</surname>
                    <given-names>RC</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Molecular similarity: a key technique in molecular informatics</article-title>
                <source>Org Biomol Chem</source>
                <year>2004</year>
                <volume>2</volume>
                <issue>22</issue>
                <fpage>3204</fpage>
                <lpage>3218</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2cXpsVOqt74%3D</pub-id>
                <pub-id pub-id-type="doi">10.1039/b409813g</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR12">
              <label>12.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Maggiora</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Vogt</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Stumpfe</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Bajorath</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Molecular similarity in medicinal chemistry</article-title>
                <source>J Med Chem</source>
                <year>2014</year>
                <volume>57</volume>
                <issue>8</issue>
                <fpage>3186</fpage>
                <lpage>3204</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3sXhs1Kktb3E</pub-id>
                <pub-id pub-id-type="doi">10.1021/jm401411z</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR13">
              <label>13.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Eckert</surname>
                    <given-names>H</given-names>
                  </name>
                  <name>
                    <surname>Bajorath</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Molecular similarity analysis in virtual screening: foundations, limitations and novel approaches</article-title>
                <source>Drug Discov Today</source>
                <year>2007</year>
                <volume>12</volume>
                <issue>5–6</issue>
                <fpage>225</fpage>
                <lpage>233</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2sXitl2htLw%3D</pub-id>
                <pub-id pub-id-type="doi">10.1016/j.drudis.2007.01.011</pub-id>
                <pub-id pub-id-type="pmid">17331887</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR14">
              <label>14.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Stumpfe</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Bajorath</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Similarity searching</article-title>
                <source>Wiley Interdiscip Rev Comput Mol Sci</source>
                <year>2011</year>
                <volume>1</volume>
                <issue>2</issue>
                <fpage>260</fpage>
                <lpage>282</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXksVGlu7s%3D</pub-id>
                <pub-id pub-id-type="doi">10.1002/wcms.23</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR15">
              <label>15.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Maggiora</surname>
                    <given-names>GM</given-names>
                  </name>
                  <name>
                    <surname>Shanmugasundaram</surname>
                    <given-names>V</given-names>
                  </name>
                </person-group>
                <person-group person-group-type="editor">
                  <name>
                    <surname>Bajorath</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Molecular similarity measures</article-title>
                <source>Chemoinformatics</source>
                <year>2004</year>
                <publisher-loc>Totowa, NJ</publisher-loc>
                <publisher-name>Humana Press</publisher-name>
                <fpage>1</fpage>
                <lpage>50</lpage>
                <pub-id pub-id-type="doi">10.1385/1-59259-802-1:001</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR16">
              <label>16.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Bajorath</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <person-group person-group-type="editor">
                  <name>
                    <surname>Keith</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Molecular Similarity Concepts for Informatics Applications</article-title>
                <source>Bioinformatics</source>
                <year>2017</year>
                <publisher-loc>New York, NY</publisher-loc>
                <publisher-name>Humana Press</publisher-name>
                <fpage>231</fpage>
                <lpage>245</lpage>
                <pub-id pub-id-type="doi">10.1007/978-1-4939-6613-4_13</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR17">
              <label>17.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Teixeira</surname>
                    <given-names>AL</given-names>
                  </name>
                  <name>
                    <surname>Falcao</surname>
                    <given-names>AO</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Noncontiguous atom matching structural similarity function</article-title>
                <source>J Chem Inf Model</source>
                <year>2013</year>
                <volume>53</volume>
                <issue>10</issue>
                <fpage>2511</fpage>
                <lpage>2524</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3sXhsVGjt7nP</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci400324u</pub-id>
                <pub-id pub-id-type="pmid">24044748</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR18">
              <label>18.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Ehrlich</surname>
                    <given-names>H-C</given-names>
                  </name>
                  <name>
                    <surname>Rarey</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Maximum common subgraph isomorphism algorithms and their applications in molecular science: a review</article-title>
                <source>Wiley Interdiscip Rev Comput Mol Sci</source>
                <year>2011</year>
                <volume>1</volume>
                <issue>1</issue>
                <fpage>68</fpage>
                <lpage>79</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXksVKjsLY%3D</pub-id>
                <pub-id pub-id-type="doi">10.1002/wcms.5</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR19">
              <label>19.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Raymond</surname>
                    <given-names>JW</given-names>
                  </name>
                  <name>
                    <surname>Willett</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Maximum common subgraph isomorphism algorithms for the matching of chemical structures</article-title>
                <source>J Comput Aided Mol Des</source>
                <year>2002</year>
                <volume>16</volume>
                <issue>7</issue>
                <fpage>521</fpage>
                <lpage>33</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD38XovF2jsrc%3D</pub-id>
                <pub-id pub-id-type="doi">10.1023/A:1021271615909</pub-id>
                <pub-id pub-id-type="pmid">12510884</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR20">
              <label>20.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Barnard</surname>
                    <given-names>JM</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Substructure searching methods: old and new</article-title>
                <source>J Chem Inf Model</source>
                <year>1993</year>
                <volume>33</volume>
                <issue>4</issue>
                <fpage>532</fpage>
                <lpage>538</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK3sXkslWrurY%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci00014a001</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR21">
              <label>21.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Gaspar</surname>
                    <given-names>Héléna A.</given-names>
                  </name>
                  <name>
                    <surname>Baskin</surname>
                    <given-names>Igor I.</given-names>
                  </name>
                  <name>
                    <surname>Varnek</surname>
                    <given-names>Alexandre</given-names>
                  </name>
                </person-group>
                <article-title>Visualization of a Multidimensional Descriptor Space</article-title>
                <source>Frontiers in Molecular Design and Chemical Information Science - Herman Skolnik Award Symposium 2015: Jürgen Bajorath</source>
                <year>2016</year>
                <publisher-loc>Washington, DC</publisher-loc>
                <publisher-name>American Chemical Society</publisher-name>
                <fpage>243</fpage>
                <lpage>267</lpage>
                <pub-id pub-id-type="doi">10.1021/bk-2016-1222.ch012</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR22">
              <label>22.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Verleysen</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Lee</surname>
                    <given-names>JA</given-names>
                  </name>
                </person-group>
                <person-group person-group-type="editor">
                  <name>
                    <surname>Lee</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Hirose</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Hou</surname>
                    <given-names>ZG</given-names>
                  </name>
                  <name>
                    <surname>Kil</surname>
                    <given-names>RM</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Nonlinear Dimensionality Reduction for Visualization</article-title>
                <source> Neural Information Processing. ICONIP 2013</source>
                <year>2013</year>
                <publisher-loc>Berlin, Heidelberg</publisher-loc>
                <publisher-name>Springer</publisher-name>
                <fpage>617</fpage>
                <lpage>622</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR23">
              <label>23.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Stumpfe</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Bajorath</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Recent developments in SAR visualization</article-title>
                <source>Med Chem Comm</source>
                <year>2016</year>
                <volume>7</volume>
                <issue>6</issue>
                <fpage>1045</fpage>
                <lpage>1055</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC28XmsF2ksro%3D</pub-id>
                <pub-id pub-id-type="doi">10.1039/c6md00108d</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR24">
              <label>24.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Goodall</surname>
                    <given-names>Colin</given-names>
                  </name>
                  <name>
                    <surname>Jolliffe</surname>
                    <given-names>I. T.</given-names>
                  </name>
                </person-group>
                <article-title>Principal Component Analysis</article-title>
                <source>Technometrics</source>
                <year>1988</year>
                <volume>30</volume>
                <issue>3</issue>
                <fpage>351</fpage>
                <pub-id pub-id-type="doi">10.1080/00401706.1988.10488412</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR25">
              <label>25.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Ruddigkeit</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Blum</surname>
                    <given-names>LC</given-names>
                  </name>
                  <name>
                    <surname>Reymond</surname>
                    <given-names>J-L</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Visualization and virtual screening of the chemical universe database GDB-17</article-title>
                <source>J Chem Inf Model</source>
                <year>2013</year>
                <volume>53</volume>
                <issue>1</issue>
                <fpage>56</fpage>
                <lpage>65</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC38XhvVygu77J</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci300535x</pub-id>
                <pub-id pub-id-type="pmid">23259841</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR26">
              <label>26.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Awale</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>van Deursen</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Reymond</surname>
                    <given-names>J-L</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">MQN-mapplet: visualization of chemical space with interactive maps of drugbank, ChEMBL, PubChem, GDB-11, and GDB-13</article-title>
                <source>J Chem Inf Model</source>
                <year>2013</year>
                <volume>53</volume>
                <issue>2</issue>
                <fpage>509</fpage>
                <lpage>518</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3sXkt1ylsw%3D%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci300513m</pub-id>
                <pub-id pub-id-type="pmid">23297797</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR27">
              <label>27.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Torgerson</surname>
                    <given-names>WS</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Multidimensional scaling: I. Theory and method</article-title>
                <source>Psychometrika</source>
                <year>1952</year>
                <volume>17</volume>
                <issue>4</issue>
                <fpage>401</fpage>
                <lpage>419</lpage>
                <pub-id pub-id-type="doi">10.1007/BF02288916</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR28">
              <label>28.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Kruskal</surname>
                    <given-names>JB</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Multidimensional scaling by optimizing goodness of fit to a nonmetric hypothesis</article-title>
                <source>Psychometrika</source>
                <year>1964</year>
                <volume>29</volume>
                <issue>1</issue>
                <fpage>1</fpage>
                <lpage>27</lpage>
                <pub-id pub-id-type="doi">10.1007/BF02289565</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR29">
              <label>29.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Sammon</surname>
                    <given-names>JW</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">A nonlinear mapping for data structure analysis</article-title>
                <source>IEEE Trans Comput</source>
                <year>1969</year>
                <volume>C–18</volume>
                <issue>5</issue>
                <fpage>401</fpage>
                <lpage>409</lpage>
                <pub-id pub-id-type="doi">10.1109/T-C.1969.222678</pub-id>
                <comment>arXiv: 1011.1669</comment>
              </mixed-citation>
            </ref>
            <ref id="CR30">
              <label>30.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Hinton</surname>
                    <given-names>GE</given-names>
                  </name>
                  <name>
                    <surname>Roweis</surname>
                    <given-names>ST</given-names>
                  </name>
                </person-group>
                <person-group person-group-type="editor">
                  <name>
                    <surname>Becker</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Thrun</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Obermayer</surname>
                    <given-names>K</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Stochastic neighbor embedding</article-title>
                <source>Advances in neural information processing systems 15</source>
                <year>2003</year>
                <publisher-loc>Cambridge</publisher-loc>
                <publisher-name>MIT Press</publisher-name>
                <fpage>857</fpage>
                <lpage>864</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR31">
              <label>31.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Agrafiotis</surname>
                    <given-names>DK</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Stochastic proximity embedding</article-title>
                <source>J Comput Chem</source>
                <year>2003</year>
                <volume>24</volume>
                <issue>10</issue>
                <fpage>1215</fpage>
                <lpage>1221</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3sXlsVeqtr4%3D</pub-id>
                <pub-id pub-id-type="doi">10.1002/jcc.10234</pub-id>
                <pub-id pub-id-type="pmid">12820129</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR32">
              <label>32.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Kohonen</surname>
                    <given-names>T</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The self-organizing map</article-title>
                <source>Proc IEEE</source>
                <year>1990</year>
                <volume>78</volume>
                <issue>9</issue>
                <fpage>1464</fpage>
                <lpage>1480</lpage>
                <pub-id pub-id-type="doi">10.1109/5.58325</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR33">
              <label>33.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Kireeva</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Baskin</surname>
                    <given-names>II</given-names>
                  </name>
                  <name>
                    <surname>Gaspar</surname>
                    <given-names>HA</given-names>
                  </name>
                  <name>
                    <surname>Horvath</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Marcou</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Varnek</surname>
                    <given-names>A</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Generative topographic mapping (gtm): Universal tool for data visualization, structure-activity modeling and dataset comparison</article-title>
                <source>Mol Inform</source>
                <year>2012</year>
                <volume>31</volume>
                <issue>3–4</issue>
                <fpage>301</fpage>
                <lpage>312</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC38XkvFWgsrY%3D</pub-id>
                <pub-id pub-id-type="doi">10.1002/minf.201100163</pub-id>
                <pub-id pub-id-type="pmid">27477099</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR34">
              <label>34.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Wassermann</surname>
                    <given-names>AM</given-names>
                  </name>
                  <name>
                    <surname>Wawer</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Bajorath</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Activity landscape representations for structure-activity relationship analysis</article-title>
                <source>J Med Chem</source>
                <year>2010</year>
                <volume>53</volume>
                <issue>23</issue>
                <fpage>8209</fpage>
                <lpage>8223</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3cXhtFKmt7bF</pub-id>
                <pub-id pub-id-type="doi">10.1021/jm100933w</pub-id>
                <pub-id pub-id-type="pmid">20845971</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR35">
              <label>35.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Peltason</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Iyer</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Bajorath</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Rationalizing three-dimensional activity landscapes and the influence of molecular representations on landscape topology and the formation of activity cliffs</article-title>
                <source>J Chem Inf Model</source>
                <year>2010</year>
                <volume>50</volume>
                <issue>6</issue>
                <fpage>1021</fpage>
                <lpage>1033</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3cXls1Shurk%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci100091e</pub-id>
                <pub-id pub-id-type="pmid">20443603</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR36">
              <label>36.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Teixeira</surname>
                    <given-names>AL</given-names>
                  </name>
                  <name>
                    <surname>Falcao</surname>
                    <given-names>AO</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Structural similarity based kriging for quantitative structure activity and property relationship modeling</article-title>
                <source>J Chem Inf Model</source>
                <year>2014</year>
                <volume>54</volume>
                <issue>7</issue>
                <fpage>1833</fpage>
                <lpage>1849</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2cXpt1SrtLo%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci500110v</pub-id>
                <pub-id pub-id-type="pmid">24897621</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR37">
              <label>37.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Stumpfe</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Hu</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Dimova</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Bajorath</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Recent progress in understanding activity cliffs and their utility in medicinal chemistry</article-title>
                <source>J Med Chem</source>
                <year>2014</year>
                <volume>57</volume>
                <issue>1</issue>
                <fpage>18</fpage>
                <lpage>28</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3sXhtlCht7bI</pub-id>
                <pub-id pub-id-type="doi">10.1021/jm401120g</pub-id>
                <pub-id pub-id-type="pmid">23981118</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR38">
              <label>38.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Kausar</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Falcao</surname>
                    <given-names>AO</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Analysis and comparison of vector space and metric space representations in QSAR modeling</article-title>
                <source>Molecules</source>
                <year>2019</year>
                <volume>24</volume>
                <issue>9</issue>
                <fpage>1</fpage>
                <lpage>22</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1MXpvF2mtrk%3D</pub-id>
                <pub-id pub-id-type="doi">10.3390/molecules24091698</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR39">
              <label>39.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>van der Maaten</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Hinton</surname>
                    <given-names>G</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Visualizing data using t-SNE</article-title>
                <source>J Mach Learn Res</source>
                <year>2008</year>
                <volume>9</volume>
                <fpage>2579</fpage>
                <lpage>2605</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR40">
              <label>40.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Green</surname>
                    <given-names>P. J.</given-names>
                  </name>
                  <name>
                    <surname>Seheult</surname>
                    <given-names>A. H.</given-names>
                  </name>
                  <name>
                    <surname>Silverman</surname>
                    <given-names>B. W.</given-names>
                  </name>
                </person-group>
                <article-title>Density Estimation for Statistics and Data Analysis</article-title>
                <source>Applied Statistics</source>
                <year>1988</year>
                <volume>37</volume>
                <issue>1</issue>
                <fpage>120</fpage>
                <pub-id pub-id-type="doi">10.2307/2347507</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR41">
              <label>41.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Yosipof</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Guedes</surname>
                    <given-names>RC</given-names>
                  </name>
                  <name>
                    <surname>García-Sosa</surname>
                    <given-names>AT</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Data mining and machine learning models for predicting drug likeness and their disease or organ category</article-title>
                <source>Front Chem</source>
                <year>2018</year>
                <volume>6</volume>
                <issue>May</issue>
                <fpage>162</fpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXisV2ks7zM</pub-id>
                <pub-id pub-id-type="doi">10.3389/fchem.2018.00162</pub-id>
                <pub-id pub-id-type="pmid">29868564</pub-id>
                <pub-id pub-id-type="pmcid">5954128</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR42">
              <label>42.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Jaworska</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Aldenberg</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Nikolova</surname>
                    <given-names>N</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Review of methods for QSAR applicability domain estimation by the training set</article-title>
                <source>Atla</source>
                <year>2005</year>
                <volume>33</volume>
                <fpage>445</fpage>
                <lpage>459</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2MXht1OgtLnJ</pub-id>
                <pub-id pub-id-type="pmid">16268757</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR43">
              <label>43.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Sahigara</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Mansouri</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Ballabio</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Mauri</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Consonni</surname>
                    <given-names>V</given-names>
                  </name>
                  <name>
                    <surname>Todeschini</surname>
                    <given-names>R</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Comparison of different approaches to define the applicability domain of QSAR models</article-title>
                <source>Molecules</source>
                <year>2012</year>
                <volume>17</volume>
                <issue>5</issue>
                <fpage>4791</fpage>
                <lpage>4810</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC38Xntlehsrs%3D</pub-id>
                <pub-id pub-id-type="doi">10.3390/molecules17054791</pub-id>
                <pub-id pub-id-type="pmid">22534664</pub-id>
                <pub-id pub-id-type="pmcid">6268288</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR44">
              <label>44.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Aniceto</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Freitas</surname>
                    <given-names>AA</given-names>
                  </name>
                  <name>
                    <surname>Bender</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Ghafourian</surname>
                    <given-names>T</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">A novel applicability domain technique for mapping predictive reliability across the chemical space of a QSAR: reliability-density neighbourhood</article-title>
                <source>J Cheminform</source>
                <year>2016</year>
                <volume>8</volume>
                <issue>1</issue>
                <fpage>1</fpage>
                <lpage>20</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXlsVCqt74%3D</pub-id>
                <pub-id pub-id-type="doi">10.1186/s13321-016-0182-y</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR45">
              <label>45.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Tropsha</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Golbraikh</surname>
                    <given-names>A</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Predictive QSAR modeling workflow, model applicability domains, and virtual screening</article-title>
                <source>Curr Pharm Des</source>
                <year>2007</year>
                <volume>13</volume>
                <issue>34</issue>
                <fpage>3494</fpage>
                <lpage>504</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2sXhsVOrs73F</pub-id>
                <pub-id pub-id-type="doi">10.2174/138161207782794257</pub-id>
                <pub-id pub-id-type="pmid">18220786</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR46">
              <label>46.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Lv</surname>
                    <given-names>Zhisheng</given-names>
                  </name>
                  <name>
                    <surname>Chen</surname>
                    <given-names>Yanfeng</given-names>
                  </name>
                  <name>
                    <surname>Wei</surname>
                    <given-names>Hengchen</given-names>
                  </name>
                  <name>
                    <surname>Li</surname>
                    <given-names>Fusheng</given-names>
                  </name>
                  <name>
                    <surname>Hu</surname>
                    <given-names>Yun</given-names>
                  </name>
                  <name>
                    <surname>Wei</surname>
                    <given-names>Chaohai</given-names>
                  </name>
                  <name>
                    <surname>Feng</surname>
                    <given-names>Chunhua</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">One-step electrosynthesis of polypyrrole/graphene oxide composites for microbial fuel cell application</article-title>
                <source>Electrochimica Acta</source>
                <year>2013</year>
                <volume>111</volume>
                <fpage>366</fpage>
                <lpage>373</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3sXhslCqsL7I</pub-id>
                <pub-id pub-id-type="doi">10.1016/j.electacta.2013.08.022</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR47">
              <label>47.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="editor">
                  <name>
                    <surname>Gasteiger</surname>
                    <given-names>Johann</given-names>
                  </name>
                </person-group>
                <source>Handbook of Chemoinformatics</source>
                <year>2003</year>
              </mixed-citation>
            </ref>
            <ref id="CR48">
              <label>48.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Todeschini</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Consonni</surname>
                    <given-names>V</given-names>
                  </name>
                </person-group>
                <source>Molecular descriptors for chemoinformatics. Methods and principles in medicinal chemistry</source>
                <year>2009</year>
                <publisher-loc>Weinheim</publisher-loc>
                <publisher-name>Wiley</publisher-name>
                <pub-id pub-id-type="doi">10.1002/9783527628766</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR49">
              <label>49.</label>
              <mixed-citation publication-type="other">James C, Weininger D, Delaney J (2011) Daylight theory manual version 4.9. <ext-link xlink:href="http://www.daylight.com/dayhtml/doc/theory/" ext-link-type="uri">http://www.daylight.com/dayhtml/doc/theory/</ext-link>. Accessed 30 Sept 2018</mixed-citation>
            </ref>
            <ref id="CR50">
              <label>50.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Willett</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The calculation of molecular structural similarity: principles and practice</article-title>
                <source>Mol Inform</source>
                <year>2014</year>
                <volume>33</volume>
                <issue>6–7</issue>
                <fpage>403</fpage>
                <lpage>413</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2cXntVSnt70%3D</pub-id>
                <pub-id pub-id-type="doi">10.1002/minf.201400024</pub-id>
                <pub-id pub-id-type="pmid">27485978</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR51">
              <label>51.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Muegge</surname>
                    <given-names>I</given-names>
                  </name>
                  <name>
                    <surname>Mukherjee</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">An overview of molecular fingerprint similarity search in virtual screening</article-title>
                <source>Expert Opin Drug Discov</source>
                <year>2016</year>
                <volume>11</volume>
                <issue>2</issue>
                <fpage>137</fpage>
                <lpage>148</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2MXhvFOmtLbF</pub-id>
                <pub-id pub-id-type="doi">10.1517/17460441.2016.1117070</pub-id>
                <pub-id pub-id-type="pmid">26558489</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR52">
              <label>52.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Jasial</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Hu</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Vogt</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Bajorath</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Activity-relevant similarity values for fingerprints and implications for similarity searching</article-title>
                <source>F1000Res</source>
                <year>2016</year>
                <volume>5</volume>
                <issue>0</issue>
                <fpage>591</fpage>
                <pub-id pub-id-type="doi">10.12688/f1000research.8357.2</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR53">
              <label>53.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Bajusz</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Rácz</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Héberger</surname>
                    <given-names>K</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Why is Tanimoto index an appropriate choice for fingerprint-based similarity calculations?</article-title>
                <source>J Cheminform</source>
                <year>2015</year>
                <volume>7</volume>
                <issue>1</issue>
                <fpage>1</fpage>
                <lpage>13</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC2MXht1ehsL7L</pub-id>
                <pub-id pub-id-type="doi">10.1186/s13321-015-0069-3</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR54">
              <label>54.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Seung-Seok</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Sung-Hyuk</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Tappert</surname>
                    <given-names>CC</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">A survey of binary similarity and distance measures</article-title>
                <source>J Syst Cybern Inform</source>
                <year>2010</year>
                <volume>8</volume>
                <issue>1</issue>
                <fpage>43</fpage>
                <lpage>48</lpage>
              </mixed-citation>
            </ref>
            <ref id="CR55">
              <label>55.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Johnston</surname>
                    <given-names>JW</given-names>
                  </name>
                </person-group>
                <source>Similarity indices I: what do they measure?</source>
                <year>1976</year>
                <publisher-loc>Richland</publisher-loc>
                <publisher-name>Battelle Pacific Northwest Laboratories</publisher-name>
                <pub-id pub-id-type="doi">10.2172/7256702</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR56">
              <label>56.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Flower</surname>
                    <given-names>DR</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">On the properties of bit string-based measures of chemical similarity</article-title>
                <source>J Chem Inf Model</source>
                <year>1998</year>
                <volume>38</volume>
                <issue>3</issue>
                <fpage>379</fpage>
                <lpage>386</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK1cXislShsbg%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci970437z</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR57">
              <label>57.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Gillet</surname>
                    <given-names>VJ</given-names>
                  </name>
                  <name>
                    <surname>Willett</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Bradshaw</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Similarity searching using reduced graphs</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>2003</year>
                <volume>43</volume>
                <issue>2</issue>
                <fpage>338</fpage>
                <lpage>345</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3sXhtVOjtbs%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci025592e</pub-id>
                <pub-id pub-id-type="pmid">12653495</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR58">
              <label>58.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Sheridan</surname>
                    <given-names>RP</given-names>
                  </name>
                  <name>
                    <surname>Kearsley</surname>
                    <given-names>SK</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Why do we need so many chemical similarity search methods?</article-title>
                <source>Drug Discov Today</source>
                <year>2002</year>
                <volume>7</volume>
                <issue>17</issue>
                <fpage>903</fpage>
                <lpage>911</lpage>
                <pub-id pub-id-type="doi">10.1016/S1359-6446(02)02411-X</pub-id>
                <pub-id pub-id-type="pmid">12546933</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR59">
              <label>59.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Batista</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Godden</surname>
                    <given-names>JW</given-names>
                  </name>
                  <name>
                    <surname>Bajorath</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Assessment of molecular similarity from the analysis of randomly generated structural fragment populations</article-title>
                <source>J Chem Inf Model</source>
                <year>2006</year>
                <volume>46</volume>
                <issue>5</issue>
                <fpage>1937</fpage>
                <lpage>1944</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD28XmvF2mtrc%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci0601261</pub-id>
                <pub-id pub-id-type="pmid">16995724</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR60">
              <label>60.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Graham</surname>
                    <given-names>DJ</given-names>
                  </name>
                  <name>
                    <surname>Malarkey</surname>
                    <given-names>C</given-names>
                  </name>
                  <name>
                    <surname>Schulmerich</surname>
                    <given-names>MV</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Information content in organic molecules: quantification and statistical structure via brownian processing</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>2004</year>
                <volume>44</volume>
                <issue>5</issue>
                <fpage>1601</fpage>
                <lpage>1611</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2cXlvVaqsrk%3D</pub-id>
                <pub-id pub-id-type="doi">10.1021/ci0400213</pub-id>
                <pub-id pub-id-type="pmid">15446817</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR61">
              <label>61.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Thorrington-Smith</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">West Indian Ocean phytoplankton: a numerical investigation of phytohydrographic regions and their characteristic phytoplankton associations</article-title>
                <source>Mar Biol</source>
                <year>1971</year>
                <volume>9</volume>
                <issue>2</issue>
                <fpage>115</fpage>
                <lpage>137</lpage>
                <pub-id pub-id-type="doi">10.1007/BF00348251</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR62">
              <label>62.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Todeschini</surname>
                    <given-names>R</given-names>
                  </name>
                  <name>
                    <surname>Ballabio</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Consonni</surname>
                    <given-names>V</given-names>
                  </name>
                  <name>
                    <surname>Mauri</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Pavan</surname>
                    <given-names>M</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">CAIMAN (Classification And Influence Matrix Analysis): a new approach to the classification based on leverage-scaled functions</article-title>
                <source>Chemometri Intell Lab Syst</source>
                <year>2007</year>
                <volume>87</volume>
                <issue>1</issue>
                <fpage>3</fpage>
                <lpage>17</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2sXkslyqsbg%3D</pub-id>
                <pub-id pub-id-type="doi">10.1016/j.chemolab.2005.11.001</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR63">
              <label>63.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Gray</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Moore</surname>
                    <given-names>A</given-names>
                  </name>
                </person-group>
                <person-group person-group-type="editor">
                  <name>
                    <surname>Barbara</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Kamath</surname>
                    <given-names>C</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Proceedings of the 2003 SIAM international conference on data mining</article-title>
                <source>Nonparametric density estimation: toward computational tractability</source>
                <year>2003</year>
                <publisher-loc>Philadelphia</publisher-loc>
                <publisher-name>Society for Industrial and Applied Mathematics</publisher-name>
                <pub-id pub-id-type="doi">10.1137/1.9781611972733.19</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR64">
              <label>64.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Duda</surname>
                    <given-names>RO</given-names>
                  </name>
                  <name>
                    <surname>Hart</surname>
                    <given-names>PE</given-names>
                  </name>
                  <name>
                    <surname>Stork</surname>
                    <given-names>DG</given-names>
                  </name>
                </person-group>
                <source>Pattern classification</source>
                <year>2000</year>
                <edition>2</edition>
                <publisher-loc>New York</publisher-loc>
                <publisher-name>Wiley</publisher-name>
              </mixed-citation>
            </ref>
            <ref id="CR65">
              <label>65.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Baldi</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Brunak</surname>
                    <given-names>SS</given-names>
                  </name>
                </person-group>
                <source>Bioinformatics: the machine learning approach</source>
                <year>2001</year>
                <publisher-loc>Cambridge</publisher-loc>
                <publisher-name>MIT Press</publisher-name>
                <fpage>1452</fpage>
                <pub-id pub-id-type="doi">10.1017/S0269888904220161</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR66">
              <label>66.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Gaulton</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Hersey</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Nowotka</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Bento</surname>
                    <given-names>AP</given-names>
                  </name>
                  <name>
                    <surname>Chambers</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Mendez</surname>
                    <given-names>D</given-names>
                  </name>
                  <name>
                    <surname>Mutowo</surname>
                    <given-names>P</given-names>
                  </name>
                  <name>
                    <surname>Atkinson</surname>
                    <given-names>F</given-names>
                  </name>
                  <name>
                    <surname>Bellis</surname>
                    <given-names>LJ</given-names>
                  </name>
                  <name>
                    <surname>Cibrián-Uhalte</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Davies</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Dedman</surname>
                    <given-names>N</given-names>
                  </name>
                  <name>
                    <surname>Karlsson</surname>
                    <given-names>A</given-names>
                  </name>
                  <name>
                    <surname>Magariños</surname>
                    <given-names>MP</given-names>
                  </name>
                  <name>
                    <surname>Overington</surname>
                    <given-names>JP</given-names>
                  </name>
                  <name>
                    <surname>Papadatos</surname>
                    <given-names>G</given-names>
                  </name>
                  <name>
                    <surname>Smit</surname>
                    <given-names>I</given-names>
                  </name>
                  <name>
                    <surname>Leach</surname>
                    <given-names>AR</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The ChEMBL database in 2017</article-title>
                <source>Nucleic Acids Res</source>
                <year>2017</year>
                <volume>45</volume>
                <issue>D1</issue>
                <fpage>945</fpage>
                <lpage>954</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC1cXhslWhurs%3D</pub-id>
                <pub-id pub-id-type="doi">10.1093/nar/gkw1074</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR67">
              <label>67.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Dudek</surname>
                    <given-names>AZ</given-names>
                  </name>
                  <name>
                    <surname>Arodz</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Galvez</surname>
                    <given-names>J</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Computational methods in developing quantitative structure-activity relationships (QSAR): a review</article-title>
                <source>Comb Chem High Throughput Screen</source>
                <year>2006</year>
                <volume>9</volume>
                <issue>3</issue>
                <fpage>213</fpage>
                <lpage>228</lpage>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD28XisVSqtbo%3D</pub-id>
                <pub-id pub-id-type="doi">10.2174/138620706776055539</pub-id>
                <pub-id pub-id-type="pmid">16533155</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR68">
              <label>68.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Kausar</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Falcao</surname>
                    <given-names>AO</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">An automated framework for QSAR model building</article-title>
                <source>J Cheminform</source>
                <year>2018</year>
                <volume>10</volume>
                <issue>1</issue>
                <fpage>1</fpage>
                <pub-id pub-id-type="doi">10.1186/s13321-017-0256-5</pub-id>
                <pub-id pub-id-type="pmid">29340790</pub-id>
                <pub-id pub-id-type="pmcid">5770354</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR69">
              <label>69.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="editor">
                  <name>
                    <surname>Fehske</surname>
                    <given-names>H.</given-names>
                  </name>
                  <name>
                    <surname>Schneider</surname>
                    <given-names>R.</given-names>
                  </name>
                  <name>
                    <surname>Weiße</surname>
                    <given-names>A.</given-names>
                  </name>
                </person-group>
                <source>Computational Many-Particle Physics</source>
                <year>2008</year>
                <publisher-loc>Berlin, Heidelberg</publisher-loc>
                <publisher-name>Springer Berlin Heidelberg</publisher-name>
              </mixed-citation>
            </ref>
            <ref id="CR70">
              <label>70.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Gower</surname>
                    <given-names>JC</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Some distance properties of latent root and vector methods used in multivariate analysis</article-title>
                <source>Biometrika</source>
                <year>1966</year>
                <volume>53</volume>
                <issue>3/4</issue>
                <fpage>325</fpage>
                <lpage>328</lpage>
                <pub-id pub-id-type="doi">10.2307/2333639</pub-id>
              </mixed-citation>
            </ref>
          </ref-list>
        </ref-list>
        <app-group>
          <app id="App1">
            <sec id="Sec234">
              <title>Supplementary information</title>
              <p>
                <supplementary-material content-type="local-data" id="MOESM1" xlink:title="Supplementary information">
                  <media mimetype="application" mime-subtype="x-zip-compressed" xlink:href="MediaObjects/13321_2019_386_MOESM1_ESM.zip" position="anchor">
                    <caption xml:lang="en">
                      <p><bold>Additional file 1: Figure S1a.</bold> Test set projection over PSMA with KMDS. <bold>b</bold> Test set projection over PSMA with SM. <bold>c</bold> Test set projection over PSMA with t-SNE. <bold>Figure S2a.</bold> DRD5 shepard plot for PCooA, KMDS, SM and t-SNE. <bold>b</bold> HRH1 shepard plot for PCooA, KMDS, SM and t-SNE. <bold>c</bold> SIGMAR1 shepard plot for PCooA, KMDS, SM and t-SNE.</p>
                    </caption>
                  </media>
                </supplementary-material>
                <supplementary-material content-type="local-data" id="MOESM2" xlink:title="Supplementary information">
                  <media mimetype="application" mime-subtype="x-zip-compressed" xlink:href="MediaObjects/13321_2019_386_MOESM2_ESM.zip" position="anchor">
                    <caption xml:lang="en">
                      <p><bold>Additional file 2.</bold> Contains all data sets (SIGMAR1, HRH1, HERG,and DRD5) retrieved from ChEMBL23, their computed NAMS similarities and R source code for analysis and inference of molecular activity spaces.</p>
                    </caption>
                  </media>
                </supplementary-material>
              </p>
            </sec>
          </app>
        </app-group>
        <notes notes-type="ESMHint">
          <title>Supplementary information</title>
          <p><bold>Supplementary information</bold> accompanies this paper at <ext-link xlink:href="10.1186/s13321-019-0386-z" ext-link-type="doi">https://doi.org/10.1186/s13321-019-0386-z</ext-link>.</p>
        </notes>
        <notes notes-type="Misc">
          <title>Publisher's Note</title>
          <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
        </notes>
      </back>
    </article>
