<?xml version="1.0"?>
<!ENTITY % article SYSTEM "http://jats.nlm.nih.gov/archiving/1.2/JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="research-article" xml:lang="en">
      <front>
        <journal-meta>
          <journal-id journal-id-type="publisher-id">13321</journal-id>
          <journal-title-group>
            <journal-title>Journal of Cheminformatics</journal-title>
            <abbrev-journal-title abbrev-type="publisher">J Cheminform</abbrev-journal-title>
          </journal-title-group>
          <issn pub-type="epub">1758-2946</issn>
          <publisher>
            <publisher-name>Springer International Publishing</publisher-name>
            <publisher-loc>Cham</publisher-loc>
          </publisher>
        </journal-meta>
        <article-meta>
          <article-id pub-id-type="publisher-id">BMC1758-2946-3-25</article-id>
          <article-id pub-id-type="manuscript">208</article-id>
          <article-id pub-id-type="doi">10.1186/1758-2946-3-25</article-id>
          <article-categories>
            <subj-group subj-group-type="heading">
              <subject>Research Article</subject>
            </subj-group>
            <subj-group subj-group-type="article-collection" specific-use="Regular">
              <subject>PubChem3D</subject>
            </subj-group>
          </article-categories>
          <title-group>
            <article-title xml:lang="en">PubChem3D: Shape compatibility filtering using molecular shape quadrupoles</article-title>
          </title-group>
          <contrib-group>
            <contrib contrib-type="author">
              <name>
                <surname>Kim</surname>
                <given-names>Sunghwan</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <contrib contrib-type="author" corresp="yes">
              <name>
                <surname>Bolton</surname>
                <given-names>Evan E</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
              <xref ref-type="corresp" rid="IDBMC17582946325_cor2">b</xref>
            </contrib>
            <contrib contrib-type="author">
              <name>
                <surname>Bryant</surname>
                <given-names>Stephen H</given-names>
              </name>
              <address>
                <email>HIDDEN</email>
              </address>
              <xref ref-type="aff" rid="Aff1">1</xref>
            </contrib>
            <aff id="Aff1">
              <label>1</label>
              <institution-wrap>
                <institution-id institution-id-type="GRID">grid.419234.9</institution-id>
                <institution-id institution-id-type="ISNI">0000000406045429</institution-id>
                <institution content-type="org-name">National Center for Biotechnology Information, National Library of Medicine, National Institutes of Health, Department of Health and Human Services</institution>
              </institution-wrap>
              <addr-line content-type="street">8600 Rockville Pike</addr-line>
              <addr-line content-type="postcode">20894</addr-line>
              <addr-line content-type="city">Bethesda</addr-line>
              <addr-line content-type="state">MD</addr-line>
              <country country="US">USA</country>
            </aff>
          </contrib-group>
          <author-notes>
            <corresp id="IDBMC17582946325_cor2">
              <label>b</label>
              <email>HIDDEN</email>
            </corresp>
          </author-notes>
          <pub-date date-type="pub" publication-format="electronic">
            <day>20</day>
            <month>7</month>
            <year>2011</year>
          </pub-date>
          <pub-date date-type="collection" publication-format="electronic">
            <month>12</month>
            <year>2011</year>
          </pub-date>
          <volume>3</volume>
          <issue seq="25">1</issue>
          <elocation-id>25</elocation-id>
          <history>
            <date date-type="registration">
              <day>12</day>
              <month>5</month>
              <year>2011</year>
            </date>
            <date date-type="received">
              <day>12</day>
              <month>5</month>
              <year>2011</year>
            </date>
            <date date-type="accepted">
              <day>20</day>
              <month>7</month>
              <year>2011</year>
            </date>
            <date date-type="online">
              <day>20</day>
              <month>7</month>
              <year>2011</year>
            </date>
          </history>
          <permissions>
            <copyright-statement content-type="compact">© Kim et al; licensee Chemistry Central Ltd. 2011</copyright-statement>
            <copyright-statement content-type="comment">This article is published under license to BioMed Central Ltd. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link xlink:href="http://creativecommons.org/licenses/by/2.0" ext-link-type="uri">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</copyright-statement>
            <copyright-year>2011</copyright-year>
            <copyright-holder>Kim et al; licensee Chemistry Central Ltd.</copyright-holder>
            <license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by-nc/2.0">
              <license-p><bold>Open Access</bold> This is an open access article distributed under the terms of the Creative Commons Attribution Noncommercial License ( 
    <ext-link xlink:href="https://creativecommons.org/licenses/by-nc/2.0" ext-link-type="uri">https://creativecommons.org/licenses/by-nc/2.0</ext-link> 
    ), which permits any noncommercial use, distribution, and reproduction in any medium, provided the original author(s) and source are credited. 
</license-p>
            </license>
          </permissions>
          <abstract xml:lang="en" id="Abs1">
            <title>Abstract</title>
            <sec id="ASec1">
              <title>Background</title>
              <p>PubChem provides a 3-D neighboring relationship, which involves finding the maximal shape overlap between two static compound 3-D conformations, a computationally intensive step. It is highly desirable to avoid this overlap computation, especially if it can be determined with certainty that a conformer pair cannot meet the criteria to be a 3-D neighbor. As such, PubChem employs a series of pre-filters, based on the concept of volume, to remove approximately 65% of all conformer neighbor pairs prior to shape overlap optimization. Given that molecular volume, a somewhat vague concept, is rather effective, it leads one to wonder: can the existing PubChem 3-D neighboring relationship, which consists of billions of shape similar conformer pairs from tens of millions of unique small molecules, be used to identify additional shape descriptor relationships? Or, put more specifically, can one place an upper bound on shape similarity using other "fuzzy" shape-like concepts like length, width, and height?</p>
            </sec>
            <sec id="ASec2">
              <title>Results</title>
              <p>Using a basis set of 4.18 billion 3-D neighbor pairs identified from single conformer per compound neighboring of 17.1 million molecules, shape descriptors were computed for all conformers. These steric shape descriptors included several forms of molecular volume and shape quadrupoles, which essentially embody the length, width, and height of a conformer. For a given 3-D neighbor conformer pair, the volume and each quadrupole component (Q<sub>x</sub>, Q<sub>y</sub>, and Q<sub>z</sub>) were binned and their frequency of occurrence was examined. Per molecular volume type, this effectively produced three different maps, one per quadrupole component (Q<sub>x</sub>, Q<sub>y</sub>, and Q<sub>z</sub>), of allowed values for the similarity metric, shape Tanimoto (ST) ≥ 0.8.</p>
              <p>The efficiency of these relationships (in terms of true positive, true negative, false positive and false negative) as a function of ST threshold was determined in a test run of 13.2 billion conformer pairs not previously considered by the 3-D neighbor set. At an ST ≥ 0.8, a filtering efficiency of 40.4% of true negatives was achieved with only 32 false negatives out of 24 million true positives, when applying the separate Q<sub>x</sub>, Q<sub>y</sub>, and Q<sub>z</sub> maps in a series (Q<sub>xyz</sub>). This efficiency increased linearly as a function of ST threshold in the range 0.8-0.99. The Q<sub>x</sub> filter was consistently the most efficient followed by Q<sub>y</sub> and then by Q<sub>z</sub>. Use of a monopole volume showed the best overall performance, followed by the self-overlap volume and then by the analytic volume.</p>
              <p>Application of the monopole-based Q<sub>xyz</sub> filter in a "real world" test of 3-D neighboring of 4,218 chemicals of biomedical interest against 26.1 million molecules in PubChem reduced the total CPU cost of neighboring by between 24-38% and, if used as the initial filter, removed from consideration 48.3% of all conformer pairs at almost negligible computational overhead.</p>
            </sec>
            <sec id="ASec3">
              <title>Conclusion</title>
              <p>Basic shape descriptors, such as those embodied by size, length, width, and height, can be highly effective in identifying shape incompatible compound conformer pairs. When performing a 3-D search using a shape similarity cut-off, computation can be avoided by identifying conformer pairs that cannot meet the result criteria. Applying this methodology as a filter for PubChem 3-D neighboring computation, an improvement of 31% was realized, increasing the average conformer pair throughput from 154,000 to 202,000 per second per CPU core.</p>
            </sec>
            <sec>
              <fig id="Figa" position="anchor">
                <graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_Figa_HTML.gif" position="anchor" />
              </fig>
            </sec>
          </abstract>
          <kwd-group xml:lang="en">
            <title>Keywords</title>
            <kwd>Quadrupole Moment</kwd>
            <kwd>Shape Descriptor</kwd>
            <kwd>Neighbor Pair</kwd>
            <kwd>Quadrupole Component</kwd>
            <kwd>Neighbor Count</kwd>
          </kwd-group>
          <custom-meta-group>
            <custom-meta>
              <meta-name>publisher-imprint-name</meta-name>
              <meta-value>Chemistry Central</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-issue-count</meta-name>
              <meta-value>1</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-article-count</meta-name>
              <meta-value>54</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-holder</meta-name>
              <meta-value>The Author(s)</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-copyright-year</meta-name>
              <meta-value>2011</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-contains-esm</meta-name>
              <meta-value>Yes</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-year</meta-name>
              <meta-value>2011</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-month</meta-name>
              <meta-value>5</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-registration-date-day</meta-name>
              <meta-value>12</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>toc-levels</meta-name>
              <meta-value>0</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>volume-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-product</meta-name>
              <meta-value>ArchiveJournal</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>numbering-style</meta-name>
              <meta-value>Unnumbered</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-grants-type</meta-name>
              <meta-value>OpenChoice</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>metadata-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>abstract-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodypdf-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bodyhtml-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>bibliography-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>esm-grant</meta-name>
              <meta-value>OpenAccess</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>online-first</meta-name>
              <meta-value>false</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-file-reference</meta-name>
              <meta-value>BodyRef/PDF/13321_2011_Article_208.pdf</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>pdf-type</meta-name>
              <meta-value>Typeset</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>target-type</meta-name>
              <meta-value>OnlinePDF</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>issue-type</meta-name>
              <meta-value>Regular</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>article-type</meta-name>
              <meta-value>OriginalPaper</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-primary</meta-name>
              <meta-value>Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computer Applications in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Documentation and Information in Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Theoretical and Computational Chemistry</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-secondary</meta-name>
              <meta-value>Computational Biology/Bioinformatics</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>journal-subject-collection</meta-name>
              <meta-value>Chemistry and Materials Science</meta-value>
            </custom-meta>
            <custom-meta>
              <meta-name>open-access</meta-name>
              <meta-value>true</meta-value>
            </custom-meta>
          </custom-meta-group>
        </article-meta>
        <notes notes-type="ESMHint">
          <title>Electronic supplementary material</title>
          <p>The online version of this article (doi:<ext-link xlink:href="10.1186/1758-2946-3-25" ext-link-type="doi">10.1186/1758-2946-3-25</ext-link>) contains supplementary material, which is available to authorized users.</p>
        </notes>
      </front>
      <body>
        <sec id="Sec1">
          <title>Background</title>
          <p>PubChem is an open and free resource of the biological activities of small molecules [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref>]. PubChem has an integrated theoretical 3-D layer, PubChem3D [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>], which provides a precomputed 3-D neighboring relationship called "Similar Conformers" [<xref ref-type="bibr" rid="CR7">7</xref>] to help users locate and relate data in the archive. "Similar Conformers" identifies chemicals with similar 3-D shape and similar 3-D orientation of functional groups typically used to define pharmacophores (defined here simply as "features"), complementing a PubChem 2-D neighboring relationship called "Similar Compounds", which identifies closely related chemical analogs using the PubChem 2-D subgraph fingerprint [<xref ref-type="bibr" rid="CR8">8</xref>]. Effectively, for each PubChem chemical structure, this 3-D neighboring relationship provides (at the time of writing) the results of a 3-D similarity search against 28.9 million compound records using three diverse conformers per molecule.</p>
          <p>The PubChem3D neighboring uses as a measure of molecular shape similarity the shape Tanimoto (ST) [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>], given as the following equation:<disp-formula id="Equ1"><label>1</label><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_Equ1_HTML.gif" /></disp-formula></p>
          <p>where <italic>V</italic><sub><italic>AA</italic></sub> and <italic>V</italic><sub><italic>BB</italic></sub> are the self-overlap volumes of conformers A and B, respectively, and <italic>V</italic><sub><italic>AB</italic></sub> is the common overlap volume between A and B. The 3-D neighboring requires finding the maximum shape similarity between static compound 3-D conformations, as dictated by <italic>V</italic><sub><italic>AB</italic></sub> in <bold>Equation 1</bold>, to calculate ST, a computationally intensive step. It is highly desirable to avoid this overlap computation, especially if it can be determined with certainty that a conformer pair cannot meet the criteria to be a 3-D neighbor. As such, PubChem employs a series of filters, based on the concept of volume, to effectively ignore approximately 65% of all conformer neighbor pairs during 3-D neighboring, thus dramatically accelerating processing [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
          <p>Volume, although a rather fuzzy concept, is rather effective as a filter between conformers dissimilar in shape and features [<xref ref-type="bibr" rid="CR7">7</xref>]. Conceivably there are other aspects of molecular shape beyond volume to "recognize" when two shapes are (dis)similar. A characteristic one can readily imagine are descriptors associated with aspects of length, width, and height. Steric shape quadrupoles embody such a concept and attempts have been made to use their differences as a shape similarity metric [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. This leads to the question: can additional simple shape descriptor relationships be identified that improve upon the volume-based filtering efficacy? Or, put another way, can one place an upper bound on shape similarity by identification of some (additional) crude shape compatibility between conformers?</p>
          <p>In this paper, we examine the use of shape descriptors as a means to rapidly identify "dissimilar" molecule shapes. As a part of this, we attempt to answer the critical questions: are vague shape descriptors representing the concepts of length, width, and height good discriminators of molecular shape? Can 3-D similarity searching speed be further accelerated using shape descriptors more sophisticated than volume? Is it possible to create a "shape compatibility" mapping indexed to shape similarity?</p>
        </sec>
        <sec id="Sec2">
          <title>Results and Discussion</title>
          <sec id="Sec3">
            <title>1. Distribution of shape descriptor components and their volume dependency</title>
            <p>The molecular shape quadrupoles in the principal-axes frame [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR13">13</xref>] are given as the following:<disp-formula id="Equ2"><label>2</label><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_Equ2_HTML.gif" /></disp-formula></p>
            <p>where, <italic>Q</italic><sub><italic>x</italic></sub><italic>, Q</italic><sub><italic>y</italic></sub>, and <italic>Q</italic><sub><italic>z</italic></sub> are the x, y, and z components of the quadrupole moment, respectively. The x, y, and z components are conceptually equivalent to the length, width, and height of a molecule, respectively, with the largest quadrupole component defined as <italic>Q</italic><sub><italic>x</italic></sub> and the smallest as <italic>Q</italic><sub><italic>z</italic></sub>, by convention. An assumption underlying this study is that there is a point whereby, if the shape quadrupole difference between two conformers is too large, they cannot meet the ST ≥ 0.8 threshold required by PubChem3D neighboring, as illustrated in Figure <xref rid="Fig1" ref-type="fig">1</xref>. This relationship, if it actually exists, would allow conformer pairs to be filtered out, avoiding the time-consuming shape superposition optimization step for those pairs and enhancing the throughput of the PubChem 3-D neighboring. To attempt to determine if a relationship can be found, the shape quadrupole differences for known 3-D "Similar Conformers" were analyzed.<fig id="Fig1"><label>Figure 1</label><caption xml:lang="en"><p><bold>Small changes in dimensions can result in large changes in overlap</bold>. Using a 2-D rectangle shape with constant area (0.4 in<sup>2</sup>), one can see that small changes in shape dimensions (length and width) can result in large changes in shape overlap (ST). Note that, for two shapes to be considered similar to each other (with a ST score of ≥ 0.8, indicated in red), the difference in length and width between them should be smaller than a certain threshold.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2011_Article_208_Fig1_HTML.jpg" /></fig></p>
            <p>At the time of quadrupole filter project initiation (in October, 2008), 3-D neighboring of 17,143,181 unique molecules, effectively covering the CID range 1-25,000,000, had been completed using a single conformer per compound, yielding 4,182,412,802 3-D neighbors. Table <xref rid="Tab1" ref-type="table">1</xref> shows the statistics of the three quadrupole components for those 17.1 million molecules. The mean and standard deviation for <italic>Q</italic><sub><italic>x</italic></sub><italic>, Q</italic><sub><italic>y</italic></sub>, and <italic>Q</italic><sub><italic>z</italic></sub> were 15.01 ± 8.07 Å<sup>5</sup>, 3.81 ± 1.80 Å<sup>5</sup>, and 1.52 ± 0.65 Å<sup>5</sup>, respectively. Figure <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref> display the distributions of <italic>Q</italic><sub><italic>x</italic></sub><italic>, Q</italic><sub><italic>y</italic></sub>, and <italic>Q</italic><sub><italic>z</italic></sub>, after they were binned into units of 2.5 Å<sup>5</sup>, 0.5 Å<sup>5</sup>, and 0.1 Å<sup>5</sup>, respectively. All three components showed strongly skewed distributions; however, most of the molecules were populated near the mean and relatively few molecules had quadrupole components much larger than the mean values.<table-wrap id="Tab1"><label>Table 1</label><caption xml:lang="en"><p>Quadrupole statistics</p></caption><table frame="hsides" rules="groups"><thead><tr><th /><th align="center"><p>Minimum</p></th><th align="center"><p>Median</p></th><th align="center"><p>Mean</p></th><th align="center"><p>Maximum</p></th><th align="center"><p>Standard Deviation</p></th></tr></thead><tbody><tr><td align="center"><p>Q<sub>x</sub></p></td><td align="center"><p>0.46</p></td><td align="center"><p>13.18</p></td><td align="center"><p>15.01</p></td><td align="center"><p>370.31</p></td><td align="center"><p>± 8.07</p></td></tr><tr><td align="center"><p>Q<sub>y</sub></p></td><td align="center"><p>0.46</p></td><td align="center"><p>3.49</p></td><td align="center"><p>3.81</p></td><td align="center"><p>67.99</p></td><td align="center"><p>± 1.80</p></td></tr><tr><td align="center"><p>Q<sub>z</sub></p></td><td align="center"><p>0.46</p></td><td align="center"><p>1.39</p></td><td align="center"><p>1.52</p></td><td align="center"><p>11.78</p></td><td align="center"><p>± 0.65</p></td></tr></tbody></table><table-wrap-foot><p>Distribution of the quadrupole moment components (Q<sub>x</sub>, Q<sub>y</sub>, and Q<sub>z</sub>), in units of Å<sup>5</sup>, for the 17.1 million molecules considered from the PubChem Compound database.</p></table-wrap-foot></table-wrap><fig id="Fig2"><label>Figure 2</label><caption xml:lang="en"><p><bold>Quadrupole distribution</bold>. The frequency of occurance of the three quadrupole moment components for 17.1 million molecules from the PubChem Compound database, where (a) <italic>Q</italic><sub><italic>x</italic></sub>, (b) <italic>Q</italic><sub><italic>y</italic></sub>, and (c) <italic>Q</italic><sub><italic>z</italic></sub> were binned into units of 2.5 Å<sup>5</sup>, 0.5 Å<sup>5</sup>, and 0.1 Å<sup>5</sup>, respectively.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2011_Article_208_Fig2_HTML.jpg" /></fig><fig id="Fig3"><label>Figure 3</label><caption xml:lang="en"><p><bold>Quadrupole interdependence</bold>. The distribution of 17.1 million molecules from the PubChem Compound database as a function of (a) <italic>Q</italic><sub><italic>x</italic></sub> and <italic>Q</italic><sub><italic>y</italic></sub>, (b) <italic>Q</italic><sub><italic>x</italic></sub> and <italic>Q</italic><sub><italic>z</italic></sub>, and (c) <italic>Q</italic><sub><italic>y</italic></sub> and <italic>Q</italic><sub><italic>z</italic></sub>, respectively. <italic>Q</italic><sub><italic>x</italic></sub><italic>, Q</italic><sub><italic>y</italic></sub>, and <italic>Q</italic><sub><italic>z</italic></sub> were binned into units of 2.5 Å<sup>5</sup>, 0.5 Å<sup>5</sup>, and 0.1 Å<sup>5</sup>, respectively. The legend indicates the frequency of observation.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2011_Article_208_Fig3_HTML.jpg" /></fig></p>
            <p>The molecular volume and quadrupole moments are correlated with each other according to the following equation:<disp-formula id="Equ3"><label>3</label><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_Equ3_HTML.gif" /></disp-formula></p>
            <p>where <italic>R</italic><sub><italic>g</italic></sub> is the radius of gyration and <italic>V</italic><sub><italic>mp</italic></sub> is the monopole volume, which corresponds to the monopole in the shape multipole expansion [<xref ref-type="bibr" rid="CR13">13</xref>]. <bold>Equation 3</bold> implies that the size of a molecule (represented by the molecular volume) is not completely independent of its quadrupole moment. Therefore, at the beginning of this study, the correlation between molecular volume and quadrupole moment was investigated. Note that, because the molecular volume is not a measurable quantity with a clear, unanimous definition, there are many ways to estimate it [<xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR18">18</xref>]. Therefore, in addition to the monopole volume, the PubChem 3-D information includes two other volumes computed in different ways. One is the analytic volume and the other is the self-overlap volume. The analytic volume is considered to be most consistent to other definitions of molecular volume among the three, but its computation is also the slowest. For this reason, evaluation of the ST score given in <bold>Equation 1</bold> uses the self-overlap volume, whose evaluation is considerably faster than the analytic volume; however, it typically overestimates the molecular volume by a factor of three greater than the analytic volume, as shown in Table <xref rid="Tab2" ref-type="table">2</xref>. Each compound conformer record in the PubChem provides all three volumes and they can be downloaded: individually from the Compound Summary pages, using a list from the PubChem Download Facility (<ext-link xlink:href="http://pubchem.ncbi.nlm.nih.gov/pc_fetch" ext-link-type="uri">http://pubchem.ncbi.nlm.nih.gov/pc_fetch</ext-link>), or in bulk from the PubChem FTP site (<ext-link xlink:href="ftp://ftp.ncbi.nlm.nih.gov/pubchem" ext-link-type="uri">ftp://ftp.ncbi.nlm.nih.gov/pubchem</ext-link>). To avoid confusion about these three different volumes used in the present paper, we denote the monopole volume, self-overlap volume, and analytic volume as <italic>V</italic><sub>mp</sub>, <italic>V</italic><sub>so</sub>, and <italic>V</italic><sub>an</sub>, respectively, whereas the volume in a general sense is denoted as <italic>V</italic> (without any subscript).<table-wrap id="Tab2"><label>Table 2</label><caption xml:lang="en"><p>Volume statistics</p></caption><table frame="hsides" rules="groups"><thead><tr><th /><th align="center"><p>Minimum</p></th><th align="center"><p>Median</p></th><th align="center"><p>Mean</p></th><th align="center"><p>Maximum</p></th><th align="center"><p>Standard Deviation</p></th></tr></thead><tbody><tr><td align="center"><p><italic>V</italic><sub><italic>an</italic></sub></p></td><td align="center"><p>13.3</p></td><td align="center"><p>286.9</p></td><td align="center"><p>286.5</p></td><td align="center"><p>894.1</p></td><td align="center"><p>± 76.1</p></td></tr><tr><td align="center"><p><italic>V</italic><sub><italic>mp</italic></sub></p></td><td align="center"><p>13.3</p></td><td align="center"><p>511.2</p></td><td align="center"><p>510.3</p></td><td align="center"><p>1,165.2</p></td><td align="center"><p>± 141.5</p></td></tr><tr><td align="center"><p><italic>V</italic><sub><italic>so</italic></sub></p></td><td align="center"><p>12.8</p></td><td align="center"><p>1,082.9</p></td><td align="center"><p>1,081.9</p></td><td align="center"><p>2,517.6</p></td><td align="center"><p>± 315.9</p></td></tr></tbody></table><table-wrap-foot><p>Distribution of the analytic volume (<italic>V</italic><sub><italic>an</italic></sub>), monopole volume (<italic>V</italic><sub><italic>mp</italic></sub>), and self-overlap volume (<italic>V</italic><sub><italic>so</italic></sub>), in units of Å<sup>3</sup>, for the 17.1 million molecules considered from the PubChem Compound database.</p></table-wrap-foot></table-wrap></p>
            <p>Figure <xref rid="Fig4" ref-type="fig">4</xref> displays the distribution of the three different volumes of the 17.1 million molecules from the PubChem Compound database. In general, <italic>V</italic><sub>so</sub> is the largest, and <italic>V</italic><sub>an</sub> is the smallest. As shown in Figure <xref rid="Fig5" ref-type="fig">5</xref>, the quadrupole moment increases with molecular size, implying that the effect of quadrupole difference between two molecules upon their shape similarity may depend on their relative molecular sizes. Therefore, the quadrupole differences of 3-D "Similar Conformer" neighbors as a function of volume need to be considered.<fig id="Fig4"><label>Figure 4</label><caption xml:lang="en"><p><bold>Volume distribution</bold>. The frequency of occurance of the three different volume types, analytic volume (<italic>V</italic><sub><italic>an</italic></sub>, blue), monopole volume (<italic>V</italic><sub><italic>mp</italic></sub>, red), and self-overlap volume (<italic>V</italic><sub><italic>so</italic></sub>, green), for 17.1 million molecules from the PubChem Compound database, where all three volumes were binned into units of 5.0 Å<sup>3</sup>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2011_Article_208_Fig4_HTML.jpg" /></fig><fig id="Fig5"><label>Figure 5</label><caption xml:lang="en"><p><bold>Volume-quadrupole interdependence</bold>. The distribution of 17.1 million molecules from the PubChem Compound database as a function of the molecular volume type and quadrupole component. <italic>V</italic><sub><italic>an</italic></sub> [in panel (a)-(c)], <italic>V</italic><sub><italic>mp</italic></sub> [in panel (d)-(f)], and <italic>V</italic><sub><italic>so</italic></sub> [in panel (g)-(i)] indicate the analytic volume, monopole volume, and self-overlap volume, respectively. <italic>Q</italic><sub><italic>x</italic></sub> [in panel (a), (d) and (g)], <italic>Q</italic><sub><italic>y</italic></sub> [in panel (b), (e) and (h)], and <italic>Q</italic><sub><italic>z</italic></sub> [in panel (c), (f) and (i)] indicate the three components of the quadrupole moment. All three volumes were binned into units of 5.0 Å<sup>3</sup> and the <italic>Q</italic><sub><italic>x</italic></sub><italic>, Q</italic><sub><italic>y</italic></sub>, and <italic>Q</italic><sub><italic>z</italic></sub> were binned into units of 2.5 Å<sup>5</sup>, 0.5 Å<sup>5</sup>, and 0.1 Å<sup>5</sup>, respectively. The legend indicates the frequency of observation.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2011_Article_208_Fig5_HTML.jpg" /></fig></p>
          </sec>
          <sec id="Sec4">
            <title>2. Design of 3-D neighbor filters using quadrupole moment differences</title>
            <p>As a general premise, if two molecules with the same volume also have identical values for the quadrupole components, they are likely to be shape similar to each other. In addition, as the quadrupole moment difference deviates from zero, the maximum shape similarity is expected to decrease (see Figure <xref rid="Fig1" ref-type="fig">1</xref>). When the quadrupole (and volume) difference becomes greater than some value or threshold, the shape dissimilarity is such that the molecule conformer pair cannot possibly meet the criteria to be a PubChem 3-D neighbor (ST ≥ 0.8). Therefore, if we know these quadrupole difference thresholds for a given volume pair, one may be able to preclude conformer pairs that are not sufficiently shape similar, using only knowledge of the volume and quadrupole moments.</p>
            <p>In the present study, the quadrupole moment differences of the 4.18 billion 3-D neighbors, identified from the 3-D neighboring of 17.1 million molecules, were analyzed to find the maximum possible quadrupole differences for two molecules to be neighbors (see also the "<italic>Materials and Methods</italic>" section). The volume and quadrupole moments of the two molecules in each neighbor pair were first converted into an integer value by using the following two equations:<disp-formula id="Equ4"><label>4</label><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_Equ4_HTML.gif" /></disp-formula><disp-formula id="Equ5"><label>5</label><graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_Equ5_HTML.gif" /></disp-formula></p>
            <p>where superscript "bin" is used to distinguish these integers from the original, non-binned values. The denominator <italic>Binsize</italic> was 5.0 Å<sup>3</sup> for all the three volumes, and 2.5 Å<sup>5</sup>, 0.5 Å<sup>5</sup>, and 0.1 Å<sup>5</sup>, for <italic>Q</italic><sub><italic>x</italic></sub><italic>, Q</italic><sub><italic>y</italic></sub>, and <italic>Q</italic><sub><italic>z</italic></sub>, respectively. After all 4.18 billion 3-D neighbors were binned according to their <italic>V</italic><sup><italic>bin</italic></sup> and <italic>Q</italic><sup><italic>bin</italic></sup> values, the 3-D neighbor distribution for a given (<inline-formula id="IEq1"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq1_HTML.gif" /></inline-formula>, <inline-formula id="IEq2"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq2_HTML.gif" /></inline-formula>) pair was analyzed as a function of Δ<italic>Q</italic><sup><italic>bin</italic></sup>.</p>
            <p>To illustrate the general premise above that quadrupole deviations from zero result in a reduction is shape similarity, Figure <xref rid="Fig6" ref-type="fig">6</xref> shows the neighbor count as a function of <inline-formula id="IEq3"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq3_HTML.gif" /></inline-formula> for (<inline-formula id="IEq4"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq4_HTML.gif" /></inline-formula>, <inline-formula id="IEq5"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq5_HTML.gif" /></inline-formula>) = (100, 110), (100, 120), and (100, 130). As anticipated, maximum neighbor populations exist when <inline-formula id="IEq6"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq3_HTML.gif" /></inline-formula> is near the origin, and rapidly decrease in count (nearly linear reduction on a log curve) as the <inline-formula id="IEq7"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq3_HTML.gif" /></inline-formula> deviates from zero. In addition, for a given (<inline-formula id="IEq8"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq4_HTML.gif" /></inline-formula><inline-formula id="IEq9"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq5_HTML.gif" /></inline-formula>) pair, neighbors were observed only for a certain range of <inline-formula id="IEq10"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq3_HTML.gif" /></inline-formula>, indicating that this range information can be used as a filter that pre-screens non-neighbor pairs. The asymmetric distribution of the 3-D neighbors in Figure <xref rid="Fig6" ref-type="fig">6</xref> with respect to the ordinate axis (<inline-formula id="IEq11"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq6_HTML.gif" /></inline-formula>) suggests that two different filters would need to be generated: one for <inline-formula id="IEq12"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq7_HTML.gif" /></inline-formula> and the other for <inline-formula id="IEq13"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq8_HTML.gif" /></inline-formula>.<fig id="Fig6"><label>Figure 6</label><caption xml:lang="en"><p><bold>Quadrupole difference tolerance</bold>. The distributions of the 3-D neighbors as a function of the binned quadrupole differences, <inline-formula id="IEq14"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq3_HTML.gif" /></inline-formula>, of the two moleclues in each neighbor for (<inline-formula id="IEq15"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq4_HTML.gif" /></inline-formula>, <inline-formula id="IEq16"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq5_HTML.gif" /></inline-formula>) = (100, 110), (100, 120), and (100, 130), respectively, illustrating how the frequency of Δ<italic>Q</italic><sup><italic>bin</italic></sup> rapidly decreases to zero as a function of magnitude.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2011_Article_208_Fig6_HTML.jpg" /></fig></p>
            <p>Figures <xref rid="Fig7" ref-type="fig">7</xref>, <xref rid="Fig8" ref-type="fig">8</xref> and <xref rid="Fig9" ref-type="fig">9</xref> show the Δ<italic>Q</italic><sup><italic>bin</italic></sup> threshold for each quadrupole component as a function of volume for the 4.18 billion 3-D neighbors. Note that, since PubChem regularly gets additional new unique content from its contributors, there is always a possibility that the 3-D neighboring of these new records may identify previously unseen cases of Δ<italic>Q</italic><sup><italic>bin</italic></sup> threshold. If we use these Δ<italic>Q</italic><sup><italic>bin</italic></sup> threshold maps [see panels (a) and (b) of Figures <xref rid="Fig7" ref-type="fig">7</xref>, <xref rid="Fig8" ref-type="fig">8</xref> and <xref rid="Fig9" ref-type="fig">9</xref>] as a filter during neighboring, we would preclude those 3-D neighbors. Therefore, we modified the maps [see panels (c) and (d) of Figures <xref rid="Fig7" ref-type="fig">7</xref>, <xref rid="Fig8" ref-type="fig">8</xref> and <xref rid="Fig9" ref-type="fig">9</xref>], as described in the "<italic>Materials and Methods</italic>" section, to extend Δ<italic>Q</italic><sup><italic>bin</italic></sup> difference values or to add neighboring bins where no population is found in an attempt to mitigate any such issues in the fringe regions on the maps.<fig id="Fig7"><label>Figure 7</label><caption xml:lang="en"><p><bold>Monopole volume</bold><inline-formula id="IEq17"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq3_HTML.gif" /></inline-formula> shape compatibility map and filter. The absolute value of the maximum possible value of <inline-formula id="IEq18"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq3_HTML.gif" /></inline-formula> for two molecules to be 3-D neighbors of each other, as a function of binned monopole volumes, <inline-formula id="IEq19"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq4_HTML.gif" /></inline-formula> and <inline-formula id="IEq20"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq5_HTML.gif" /></inline-formula> of molecules 1 and 2, respectively, at ST ≥ 0.8. The legend indicates the absolute value of <inline-formula id="IEq21"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq3_HTML.gif" /></inline-formula>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2011_Article_208_Fig7_HTML.jpg" /></fig><fig id="Fig8"><label>Figure 8</label><caption xml:lang="en"><p><bold>Monopole volume</bold><inline-formula id="IEq22"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq9_HTML.gif" /></inline-formula> shape compatibility map and filter. The absolute value of the maximum possible value of <inline-formula id="IEq23"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq9_HTML.gif" /></inline-formula> for two molecules to be 3-D neighbors of each other, as a function of binned monopole volumes, <inline-formula id="IEq24"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq4_HTML.gif" /></inline-formula> and <inline-formula id="IEq25"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq5_HTML.gif" /></inline-formula> of molecules 1 and 2, respectively, at ST ≥ 0.8. The legend indicates the absolute value of <inline-formula id="IEq26"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq9_HTML.gif" /></inline-formula>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2011_Article_208_Fig8_HTML.jpg" /></fig><fig id="Fig9"><label>Figure 9</label><caption xml:lang="en"><p><bold>Monopole volume</bold><inline-formula id="IEq27"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq10_HTML.gif" /></inline-formula> shape compatibility map and filter. The absolute value of the maximum possible value of <inline-formula id="IEq28"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq10_HTML.gif" /></inline-formula> for two molecules to be 3-D neighbors of each other, as a function of binned monopole volumes, <inline-formula id="IEq29"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq4_HTML.gif" /></inline-formula> and <inline-formula id="IEq30"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq5_HTML.gif" /></inline-formula> of molecules 1 and 2, respectively, at ST ≥ 0.8. The legend indicates the absolute value of <inline-formula id="IEq31"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq10_HTML.gif" /></inline-formula></p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2011_Article_208_Fig9_HTML.jpg" /></fig></p>
            <p>These modified Δ<italic>Q</italic><sup><italic>bin</italic></sup> threshold maps are designated as quadrupole filters. For simplicity, we name these filters with a capital letter "<bold>F</bold>" followed by a subscript, which represents one of the quadrupole components, and a superscript, which represents the type of volume involved. For example, filter "<inline-formula id="IEq32"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq11_HTML.gif" /></inline-formula>" indicates that the <italic>Q</italic><sub><italic>x</italic></sub> filter generated with the analytic volume, <italic>V</italic><sub><italic>an</italic></sub>.</p>
            <p>Given that these quadrupole filters were built using an existing set of 3-D neighbor cases, one needs to validate the extent of their efficacy. To do so, a 13.2 billion molecule conformer pair test set not considered as a part of the original 3-D neighboring training set, is utilized (see the "Materials and Methods" section). After computing the ST scores for the 13.2 billion pairs, the fraction of 3-D neighbors and non-neighbors, which would have been pre-screened if the quadrupole filters were applied, is summarized in Table <xref rid="Tab3" ref-type="table">3</xref>.<table-wrap id="Tab3"><label>Table 3</label><caption xml:lang="en"><p>Accuracy of filtering as a function of volume type and quadrupole component at ST ≥ 0.80 threshold</p></caption><table frame="hsides" rules="groups"><thead><tr><th /><th align="center"><p>TP<sup><italic>a</italic></sup></p><p>(millions)</p></th><th align="center"><p>FP<sup><italic>b</italic></sup></p><p>(millions)</p></th><th align="center"><p>FN<sup><italic>c</italic></sup></p></th><th align="center"><p>TN<sup><italic>d</italic></sup></p><p>(millions)</p></th></tr><tr><th align="left" colspan="5"><p>Analytic Volume</p></th></tr></thead><tbody><tr><td align="left"><p>Q<sub>x</sub></p></td><td align="center"><p>24</p></td><td align="center"><p>9,855</p></td><td align="center"><p>3</p></td><td align="center"><p>3,290</p></td></tr><tr><td /><td align="center"><p>(0.2%)</p></td><td align="center"><p>(74.8%)</p></td><td align="center"><p>(0.0%)</p></td><td align="center"><p>(25.0%)</p></td></tr><tr><td align="left"><p>Q<sub>y</sub></p></td><td align="center"><p>24</p></td><td align="center"><p>10,726</p></td><td align="center"><p>0</p></td><td align="center"><p>2,419</p></td></tr><tr><td /><td align="center"><p>(0.2%)</p></td><td align="center"><p>(81.4%)</p></td><td align="center"><p>(0.0%)</p></td><td align="center"><p>(18.4%)</p></td></tr><tr><td align="left"><p>Q<sub>z</sub></p></td><td align="center"><p>24</p></td><td align="center"><p>11,036</p></td><td align="center"><p>1</p></td><td align="center"><p>2,108</p></td></tr><tr><td /><td align="center"><p>(0.2%)</p></td><td align="center"><p>(83.8%)</p></td><td align="center"><p>(0.0%)</p></td><td align="center"><p>(16.0%)</p></td></tr><tr><td align="left"><p>Q<sub>xyz</sub></p></td><td align="center"><p>24</p></td><td align="center"><p>9,323</p></td><td align="center"><p>4</p></td><td align="center"><p>3,822</p></td></tr><tr><td /><td align="center"><p>(0.2%)</p></td><td align="center"><p>(70.8%)</p></td><td align="center"><p>(0.0%)</p></td><td align="center"><p>(29.0%)</p></td></tr><tr><td align="left" colspan="5"><p><bold>Monopole Volume</bold></p></td></tr><tr><td align="left"><p>Q<sub>x</sub></p></td><td align="center"><p>24</p></td><td align="center"><p>8,368</p></td><td align="center"><p>30</p></td><td align="center"><p>4,777</p></td></tr><tr><td /><td align="center"><p>(0.2%)</p></td><td align="center"><p>(63.5%)</p></td><td align="center"><p>(0.0%)</p></td><td align="center"><p>(36.3%)</p></td></tr><tr><td align="left"><p>Q<sub>y</sub></p></td><td align="center"><p>24</p></td><td align="center"><p>9,224</p></td><td align="center"><p>2</p></td><td align="center"><p>3,921</p></td></tr><tr><td /><td align="center"><p>(0.2%)</p></td><td align="center"><p>(70.0%)</p></td><td align="center"><p>(0.0%)</p></td><td align="center"><p>(29.8%)</p></td></tr><tr><td align="left"><p>Q<sub>z</sub></p></td><td align="center"><p>24</p></td><td align="center"><p>9,551</p></td><td align="center"><p>0</p></td><td align="center"><p>3,594</p></td></tr><tr><td /><td align="center"><p>(0.2%)</p></td><td align="center"><p>(72.5%)</p></td><td align="center"><p>(0.0%)</p></td><td align="center"><p>(27.3%)</p></td></tr><tr><td align="left"><p>Q<sub>xyz</sub></p></td><td align="center"><p>24</p></td><td align="center"><p>7,818</p></td><td align="center"><p>32</p></td><td align="center"><p>5,327</p></td></tr><tr><td /><td align="center"><p>(0.2%)</p></td><td align="center"><p>(59.4%)</p></td><td align="center"><p>(0.0%)</p></td><td align="center"><p>(40.4%)</p></td></tr><tr><td align="left" colspan="5"><p><bold>Self-Overlap Volume</bold></p></td></tr><tr><td align="left"><p>Q<sub>x</sub></p></td><td align="center"><p>24</p></td><td align="center"><p>8,684</p></td><td align="center"><p>234</p></td><td align="center"><p>4,461</p></td></tr><tr><td /><td align="center"><p>(0.2%)</p></td><td align="center"><p>(65.9%)</p></td><td align="center"><p>(0.0%)</p></td><td align="center"><p>(33.9%)</p></td></tr><tr><td align="left"><p>Q<sub>y</sub></p></td><td align="center"><p>24</p></td><td align="center"><p>9,223</p></td><td align="center"><p>56</p></td><td align="center"><p>3,922</p></td></tr><tr><td /><td align="center"><p>(0.2%)</p></td><td align="center"><p>(70.0%)</p></td><td align="center"><p>(0.0%)</p></td><td align="center"><p>(29.8%)</p></td></tr><tr><td align="left"><p>Q<sub>z</sub></p></td><td align="center"><p>24</p></td><td align="center"><p>9,835</p></td><td align="center"><p>52</p></td><td align="center"><p>3,310</p></td></tr><tr><td /><td align="center"><p>(0.2%)</p></td><td align="center"><p>(74.7%)</p></td><td align="center"><p>(0.0%)</p></td><td align="center"><p>(25.1%)</p></td></tr><tr><td align="left"><p>Q<sub>xyz</sub></p></td><td align="center"><p>24</p></td><td align="center"><p>7,993</p></td><td align="center"><p>288</p></td><td align="center"><p>5,152</p></td></tr><tr><td /><td align="center"><p>(0.2%)</p></td><td align="center"><p>(60.7%)</p></td><td align="center"><p>(0.0%)</p></td><td align="center"><p>(39.1%)</p></td></tr></tbody></table><table-wrap-foot><p><sup><italic>a</italic></sup> TP (true positive) = conformer pairs with ST≥0.8 that passed the quadrupole filter.</p><p><sup><italic>b</italic></sup> FP (false positive) = conformer pairs with ST&lt;0.8 that passed the quadrupole filter.</p><p><sup><italic>c</italic></sup> FN (false negative) = conformer pairs with ST≥0.8 that were filtered out by the quadrupole filter.</p><p><sup><italic>d</italic></sup> TN (true negative) = conformer pairs with ST &lt; 0.8 that were filtered out by quadrupole filter.</p></table-wrap-foot></table-wrap></p>
            <p>Of the three volume types utilized, the monopole-based quadrupole filters, <bold>F</bold><sup><italic>mp</italic></sup>, is arguably the best. Filter <inline-formula id="IEq33"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq12_HTML.gif" /></inline-formula> removed 4.78 billion pairs (36.3%), while incurring a loss of only 30 out of 24 million "potential" neighbors. [Note that the definition of a PubChem 3-D neighbor involves <italic>feature</italic> similarity as well as <italic>shape</italic> similarity, while the quadrupole filters deal only with shape similarity. As such, the 30 pairs filtered out had a ST score sufficient to be a 3-D neighbor, making it a "potential" 3-D neighbor.] The false negative count of 30 removed by <inline-formula id="IEq34"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq12_HTML.gif" /></inline-formula> is negligible, but does show that use of such a filter will result in precluding some potential 3-D neighbors in its use, in this case at a rate of 1 in 800,000.</p>
            <p>Filters <inline-formula id="IEq35"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq13_HTML.gif" /></inline-formula> and <inline-formula id="IEq36"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq14_HTML.gif" /></inline-formula> are not as efficient as <inline-formula id="IEq37"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq12_HTML.gif" /></inline-formula>, but could still filter out 3.92 billion pairs (29.8%), and 3.59 billion pairs (27.3%), respectively, when considered individually. If the three <bold>F</bold><sup><italic>mp</italic></sup> filters are used in a series (denoted as <inline-formula id="IEq38"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq15_HTML.gif" /></inline-formula>, and applied one after the other), 5.33 billion pairs (40.4%) could be removed with a loss of only 32 potential neighbors. Filter <bold>F</bold><sup><italic>so</italic></sup> showed similar performance to <bold>F</bold><sup><italic>mp</italic></sup>, but it filtered out more potential neighbors (288 for <inline-formula id="IEq39"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq16_HTML.gif" /></inline-formula> versus 32 for <inline-formula id="IEq40"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq15_HTML.gif" /></inline-formula>) and removed slightly fewer non-neighbors (39.1% for <inline-formula id="IEq41"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq16_HTML.gif" /></inline-formula> versus 40.4% for <inline-formula id="IEq42"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq15_HTML.gif" /></inline-formula>). The <bold>F</bold><sup><italic>an</italic></sup> filters showed the least loss of potential neighbors (4 for <inline-formula id="IEq43"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq17_HTML.gif" /></inline-formula> versus 32 for <inline-formula id="IEq44"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq15_HTML.gif" /></inline-formula>), but also removed the least non-neighbors (29.0% for <inline-formula id="IEq45"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq17_HTML.gif" /></inline-formula> versus 40.4% for <inline-formula id="IEq46"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq15_HTML.gif" /></inline-formula>).</p>
            <p>Effects of the ST threshold for PubChem 3-D neighboring upon the efficiency of the quadrupole filters were also investigated by generating a set of quadrupole filters, each using a different ST threshold, ranging from 0.80 to 0.99 with an increment of 0.01. As shown in Figure <xref rid="Fig10" ref-type="fig">10,</xref> the fraction of molecule pairs filtered increases almost linearly as a function of the ST threshold. For the entire ST range tested, the <inline-formula id="IEq47"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq15_HTML.gif" /></inline-formula> and <inline-formula id="IEq48"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq16_HTML.gif" /></inline-formula> filters showed better efficiencies than the <inline-formula id="IEq49"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq17_HTML.gif" /></inline-formula> filter.<fig id="Fig10"><label>Figure 10</label><caption xml:lang="en"><p><bold>Shape compatibility filtering efficiency</bold>. Performance of the <bold>F</bold><sub><bold><italic>xyz</italic></bold></sub>quadrupole filter to filter conformer pairs at different ST threshold values.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2011_Article_208_Fig10_HTML.jpg" /></fig></p>
          </sec>
          <sec id="Sec5">
            <title>3. Application of 3-D neighbor filters using quadrupole moment differences</title>
            <p>Given that filtering conformer pairs using steric shape quadrupoles is effective with minimal loss of potential 3-D neighbors, a "real world" test is made with <inline-formula id="IEq50"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq15_HTML.gif" /></inline-formula> to see how use of these filters in the context of PubChem 3-D neighboring improves throughput. To achieve this, comparison is made to earlier benchmarks [<xref ref-type="bibr" rid="CR7">7</xref>] whereby a set of known drugs and other molecules of keen biomedical interest are neighbored against the 3-D contents of PubChem. Table <xref rid="Tab4" ref-type="table">4</xref> and Table <xref rid="Tab5" ref-type="table">5</xref> summarize the results of these tests.<table-wrap id="Tab4"><label>Table 4</label><caption xml:lang="en"><p>Acceleration of PubChem 3-D neighboring using the <inline-formula id="IEq51"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq15_HTML.gif" /></inline-formula> quadrupole filter</p></caption><table frame="hsides" rules="groups"><thead><tr><th /><th align="center" colspan="5"><p>Diverse Conformer Count</p></th></tr><tr><th /><th align="right"><p>1</p></th><th align="right"><p>3</p></th><th align="right"><p>5</p></th><th align="right"><p>7</p></th><th align="right"><p>10</p></th></tr></thead><tbody><tr><td align="left"><p>Average <italic>Query</italic> Conformers per compound</p></td><td align="right"><p>1.0</p></td><td align="right"><p>2.7</p></td><td align="right"><p>4.1</p></td><td align="right"><p>5.4</p></td><td align="right"><p>7.2</p></td></tr><tr><td align="left"><p>Average <italic>Search</italic> Conformers per compound</p></td><td align="right"><p>1.0</p></td><td align="right"><p>3.0</p></td><td align="right"><p>4.9</p></td><td align="right"><p>6.7</p></td><td align="right"><p>9.4</p></td></tr><tr><td align="left"><p>Total Compound Pairs (billions)</p></td><td align="right"><p>110</p></td><td align="right"><p>110</p></td><td align="right"><p>110</p></td><td align="right"><p>110</p></td><td align="right"><p>110</p></td></tr><tr><td align="left"><p>Total Conformer Pairs (billions)</p></td><td align="right"><p>110</p></td><td align="right"><p>866</p></td><td align="right"><p>2,200</p></td><td align="right"><p>4,010</p></td><td align="right"><p>7,510</p></td></tr><tr><td align="left"><p>Total Search Time before (days)</p></td><td align="right"><p>8.2</p></td><td align="right"><p>68.5</p></td><td align="right"><p>163.1</p></td><td align="right"><p>296.9</p></td><td align="right"><p>564.9</p></td></tr><tr><td align="left"><p>Total Search Time after (days)</p></td><td align="right"><p>6.5</p></td><td align="right"><p>55.3</p></td><td align="right"><p>118.5</p></td><td align="right"><p>224.4</p></td><td align="right"><p>410.9</p></td></tr><tr><td align="left"><p>Conformer pair throughput (thousands/sec)</p></td><td align="right"><p>196</p></td><td align="right"><p>181</p></td><td align="right"><p>215</p></td><td align="right"><p>207</p></td><td align="right"><p>212</p></td></tr><tr><td align="left"><p>% Speed up</p></td><td align="right"><p>26%</p></td><td align="right"><p>24%</p></td><td align="right"><p>38%</p></td><td align="right"><p>32%</p></td><td align="right"><p>38%</p></td></tr></tbody></table><table-wrap-foot><p>Change in throughput as a result of quadrupole filtering when generating 3-D neighbors as a function of diverse conformer count for the 4,218 chemical structures (<italic>Query</italic>) with known biological function when neighbored against the entire "live" PubChem3D contents (<italic>Search</italic>) of 26,157,365 small molecules.</p></table-wrap-foot></table-wrap><table-wrap id="Tab5"><label>Table 5</label><caption xml:lang="en"><p>Efficiency of the <inline-formula id="IEq52"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq15_HTML.gif" /></inline-formula> quadrupole filter</p></caption><table frame="hsides" rules="groups"><thead><tr><th /><th align="center" colspan="5"><p>Diverse Conformer Count</p></th></tr><tr><th /><th align="right"><p>1</p></th><th align="right"><p>3</p></th><th align="right"><p>5</p></th><th align="right"><p>7</p></th><th align="right"><p>10</p></th></tr></thead><tbody><tr><td align="left"><p>Total Conformer Pairs (billions)</p></td><td align="right"><p>110</p></td><td align="right"><p>866</p></td><td align="right"><p>2,200</p></td><td align="right"><p>4,010</p></td><td align="right"><p>7,510</p></td></tr><tr><td align="left"><p>CT Feature Filter</p></td><td align="right"><p>65.7%</p></td><td align="right"><p>64.8%</p></td><td align="right"><p>65.0%</p></td><td align="right"><p>64.9%</p></td><td align="right"><p>64.7%</p></td></tr><tr><td align="left"><p>CT Volume Filter</p></td><td align="right"><p>0.2%</p></td><td align="right"><p>0.2%</p></td><td align="right"><p>0.2%</p></td><td align="right"><p>0.2%</p></td><td align="right"><p>0.2%</p></td></tr><tr><td align="left"><p>ST Volume Filter</p></td><td align="right"><p>2.9%</p></td><td align="right"><p>2.7%</p></td><td align="right"><p>2.6%</p></td><td align="right"><p>2.5%</p></td><td align="right"><p>2.4%</p></td></tr><tr><td align="left"><p><inline-formula id="IEq53"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq12_HTML.gif" /></inline-formula> Filter</p></td><td align="right"><p>6.3%</p></td><td align="right"><p>6.1%</p></td><td align="right"><p>5.9%</p></td><td align="right"><p>5.9%</p></td><td align="right"><p>5.9%</p></td></tr><tr><td align="left"><p><inline-formula id="IEq54"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq13_HTML.gif" /></inline-formula> Filter</p></td><td align="right"><p>0.7%</p></td><td align="right"><p>0.7%</p></td><td align="right"><p>0.7%</p></td><td align="right"><p>0.7%</p></td><td align="right"><p>0.7%</p></td></tr><tr><td align="left"><p><inline-formula id="IEq55"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq14_HTML.gif" /></inline-formula> Filter</p></td><td align="right"><p>0.4%</p></td><td align="right"><p>0.4%</p></td><td align="right"><p>0.4%</p></td><td align="right"><p>0.4%</p></td><td align="right"><p>0.4%</p></td></tr><tr><td align="left"><p>Alignment Recycling Fingerprint</p></td><td align="right"><p>2.0%</p></td><td align="right"><p>2.2%</p></td><td align="right"><p>2.2%</p></td><td align="right"><p>2.2%</p></td><td align="right"><p>2.3%</p></td></tr><tr><td align="left"><p>Alignment Recycling Overlap</p></td><td align="right"><p>21.5%</p></td><td align="right"><p>22.8%</p></td><td align="right"><p>22.8%</p></td><td align="right"><p>23.1%</p></td><td align="right"><p>23.3%</p></td></tr><tr><td align="left"><p>Filtering Time</p></td><td align="right"><p>1.3%</p></td><td align="right"><p>1.2%</p></td><td align="right"><p>1.2%</p></td><td align="right"><p>1.2%</p></td><td align="right"><p>1.1%</p></td></tr><tr><td align="left"><p>Alignment Recycling Time</p></td><td align="right"><p>75.8%</p></td><td align="right"><p>84.1%</p></td><td align="right"><p>86.1%</p></td><td align="right"><p>87.3%</p></td><td align="right"><p>88.9%</p></td></tr><tr><td align="left"><p>Superposition Optimization Time</p></td><td align="right"><p>12.4%</p></td><td align="right"><p>9.3%</p></td><td align="right"><p>8.5%</p></td><td align="right"><p>7.8%</p></td><td align="right"><p>7.0%</p></td></tr><tr><td align="left"><p>Other Overhead Time</p></td><td align="right"><p>10.5%</p></td><td align="right"><p>5.4%</p></td><td align="right"><p>4.2%</p></td><td align="right"><p>3.7%</p></td><td align="right"><p>3.1%</p></td></tr></tbody></table><table-wrap-foot><p>Relative performance of 3-D neighboring upon the addition of quadrupole filtering as a function of diverse conformer count for the 4,218 chemical structures (<italic>Query</italic>) with known biological function when neighbored against the entire "live" PubChem3D contents (<italic>Search</italic>) of 26,157,365 small molecules.</p></table-wrap-foot></table-wrap></p>
            <p>Considering PubChem 3-D neighboring is a precomputed similarity search, one can see that the neighboring throughput improvements using <inline-formula id="IEq56"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq15_HTML.gif" /></inline-formula> are substantial, with an average improvement of 31% across the range of conformer counts per compound. Perhaps surprising is that the <inline-formula id="IEq57"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq15_HTML.gif" /></inline-formula> filtering removes only 7% of the conformer pairs, yet achieves a 31% neighboring throughput improvement. This emphasizes the dramatic cost/benefit difference between the computation necessary to achieve the 7% reduction versus what is expended in its absence.</p>
            <p>It is important to note that <inline-formula id="IEq58"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq15_HTML.gif" /></inline-formula> is not the first filter applied in Table <xref rid="Tab5" ref-type="table">5</xref>, meaning that there are three other filters utilized before <inline-formula id="IEq59"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq15_HTML.gif" /></inline-formula>. The filter ordering is such so as to maximize the cost/benefit of each filter. To examine what happens if <inline-formula id="IEq60"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq15_HTML.gif" /></inline-formula> is used as the first filter, neighboring is repeated for the case of one diverse conformer per compound. When used first, <inline-formula id="IEq61"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq15_HTML.gif" /></inline-formula> removes 48.3% of all conformer pairs (44.8%, 2.1%, and 1.4% conformer pairs for <inline-formula id="IEq62"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq12_HTML.gif" /></inline-formula>, <inline-formula id="IEq63"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq13_HTML.gif" /></inline-formula>, and <inline-formula id="IEq64"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq14_HTML.gif" /></inline-formula>, applied in that order, respectively) versus the 7.4% as shown in Table <xref rid="Tab5" ref-type="table">5</xref>. The CT Feature, CT Volume, and ST Volume filters, applied in that order, remove 27.9%, 0.1%, and 0.002% conformer pairs, respectively, when <inline-formula id="IEq65"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq15_HTML.gif" /></inline-formula> is applied first.</p>
          </sec>
        </sec>
        <sec id="Sec6" sec-type="conclusions">
          <title>Conclusion</title>
          <p>Simple molecular shape descriptors, volume and steric quadrupole moments (embodying the length, width, and height of a shape), of 4.18 billion 3-D neighbor pairs resulting from PubChem 3-D neighboring of 17.1 million single conformer molecules were analyzed. The maximum quadrupole differences between neighbor conformers were determined. This examination demonstrated a distinct dependency of shape similarity upon quadrupole variation. With some slight modification of fringe regions, the results of this analysis were turned into computationally inexpensive, yet highly effective set of filters capable of removing 3-D conformer pairs that cannot meet a required shape similarity, using only knowledge of the volume and steric quadrupole moments of the conformer pair. When applied in the context of shape similarity searching, these filters can significantly improve throughput performance by avoiding expensive superposition optimization computation of conformer pairs that cannot possibly meet a pre-defined shape similarity search threshold.</p>
          <p>The filters devised were tested using a dataset of 13.2 billion compound pairs. The quadrupole filters based on a monopole volume showed the best efficacy, while the filters using an analytic volume had the lowest efficacy. For all the three volume types, the <italic>Q</italic><sub><italic>x</italic></sub> filters eliminated a larger portion of the compound pairs than the <italic>Q</italic><sub><italic>y</italic></sub> and <italic>Q</italic><sub><italic>z</italic></sub> filters. When the filters were used in a series simultaneously, they could eliminate 30~40% of non-neighbor pairs, with the removal of a negligible amount of potential neighbors. For example, the <italic>Q</italic><sub><italic>xyz</italic></sub> filter based on the monopole volumes (<inline-formula id="IEq66"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq15_HTML.gif" /></inline-formula>) could eliminate 40.4% of the 13.2 billion compound pairs with a loss of 32 potential neighbors out of 24 million at a shape Tanimoto (ST) threshold of 0.80. It was also demonstrated that this filtering efficiency improves linearly as a function of shape similarity threshold approaching 100% efficiency at an ST threshold of 0.99. Further testing of the <inline-formula id="IEq67"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq15_HTML.gif" /></inline-formula> filters in the context of PubChem 3-D neighboring processing resulted in conformer pair throughput improvements of 31% on average.</p>
          <p>In summary, the quadrupole filters developed in this study can speed up the PubChem 3-D neighbor processing with a negligible loss of the 3-D neighbors. However, its applicability is not just limited to PubChem 3-D neighboring. The results of the present study also suggest that the shape multipole moments can be applied generally to enhance the speed of 3-D similarity search methods by the rapid preclusion of dissimilar molecules that cannot be a result. This approach may be able to significantly speed up 3-D similarity search, especially if the 3-D shape superposition optimization is a bottleneck of the similarity search.</p>
        </sec>
        <sec id="Sec7" sec-type="materials|methods">
          <title>Materials and methods</title>
          <sec id="Sec8">
            <title>1. Datasets</title>
            <p>At the time of project initiation, PubChem 3-D neighboring of 17,143,181 unique molecules (ranging from CID 1 to CID 25,000,000) had been completed using a single conformer per compound, yielding 4,182,412,802 3-D neighbors. Using the Shape Toolkit from the OpenEye Software [<xref ref-type="bibr" rid="CR19">19</xref>], the analytic volume (<italic>V</italic><sub><italic>an</italic></sub>), monopole volume (<italic>V</italic><sub><italic>mp</italic></sub>), self-overlap volume (<italic>V</italic><sub><italic>so</italic></sub>), and steric shape quadrupole moments (<italic>Q</italic><sub><italic>x</italic></sub><italic>, Q</italic><sub><italic>y</italic></sub>, and <italic>Q</italic><sub><italic>z</italic></sub>) were computed for the theoretical conformer of all 17.1 million molecules. See Figures <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig4" ref-type="fig">4</xref> for the distributions of the computed values.</p>
          </sec>
          <sec id="Sec9">
            <title>2. Filter generation</title>
            <p>The quadrupole filters developed for pre-screening conformer-pairs based on quadrupole differences as a function of shape similarity ST threshold were generated using the following steps:</p>
            <p>1) The 4.18 billion 3-D neighbor pairs and their associated data were obtained from PubChem.</p>
            <p>2) The volumes (<italic>V</italic><sub><italic>mp</italic></sub><italic>, V</italic><sub><italic>so</italic></sub>, and <italic>V</italic><sub><italic>an</italic></sub>) and quadrupole components (<italic>Q</italic><sub><italic>x</italic></sub><italic>, Q</italic><sub><italic>y</italic></sub>, and <italic>Q</italic><sub><italic>z</italic></sub>) of the compound pair for each 3-D neighbor were converted into integers using <bold>Equations 4</bold> and <bold>5</bold> to yield <inline-formula id="IEq68"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq18_HTML.gif" /></inline-formula>, <inline-formula id="IEq69"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq19_HTML.gif" /></inline-formula>, <inline-formula id="IEq70"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq20_HTML.gif" /></inline-formula>, <inline-formula id="IEq71"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq21_HTML.gif" /></inline-formula>, <inline-formula id="IEq72"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq22_HTML.gif" /></inline-formula>, and <inline-formula id="IEq73"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq23_HTML.gif" /></inline-formula>, respectively. The denominator <italic>BinSize</italic> was 5.0 Å<sup>3</sup> for all three volume types and 2.5 Å<sup>5</sup>, 0.5 Å<sup>5</sup>, and 0.1 Å<sup>5</sup>, for <italic>Q</italic><sub><italic>x</italic></sub><italic>, Q</italic><sub><italic>y</italic></sub>, and <italic>Q</italic><sub><italic>z</italic></sub>, respectively.</p>
            <p>3) For each of the three binned volume types, the following was performed using the 3-D neighbor pairs (in this case using <inline-formula id="IEq74"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq18_HTML.gif" /></inline-formula> as an example):<list list-type="order"><list-item><p>Of the two conformers in a 3-D neighbor, the one with the smaller <inline-formula id="IEq75"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq18_HTML.gif" /></inline-formula> value was designated as molecule 1 and the other as molecule 2. When the <inline-formula id="IEq76"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq18_HTML.gif" /></inline-formula> value was the same for both, the one with the smaller <inline-formula id="IEq77"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq21_HTML.gif" /></inline-formula> value was designated as molecule 1. If both the <inline-formula id="IEq78"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq18_HTML.gif" /></inline-formula> and <inline-formula id="IEq79"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq21_HTML.gif" /></inline-formula> values were the same for both, the one with the smaller <inline-formula id="IEq80"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq22_HTML.gif" /></inline-formula> was designated as molecule 1. If <inline-formula id="IEq81"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq22_HTML.gif" /></inline-formula> was also the same for both molecules, the one with the smaller <inline-formula id="IEq82"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq23_HTML.gif" /></inline-formula> was designated as molecule 2. If all four descriptors are the same for both molecules, the one that appears first for the pair was designated as molecule 1.</p></list-item><list-item><p>For each of the three binned quadrupole components, and using <inline-formula id="IEq83"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq21_HTML.gif" /></inline-formula> as an example:<list list-type="order"><list-item><p>3-D neighbors were binned according to three indices, <inline-formula id="IEq84"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq4_HTML.gif" /></inline-formula>, <inline-formula id="IEq85"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq5_HTML.gif" /></inline-formula>, and <inline-formula id="IEq86"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq24_HTML.gif" /></inline-formula>, where subscripts 1 and 2 indicate molecules 1 and 2, respectively, determined in step 3a, and <inline-formula id="IEq87"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq25_HTML.gif" /></inline-formula> is the <italic>Q</italic><sub><italic>x</italic></sub> difference between the two molecules.</p></list-item><list-item><p>The neighbor count for all (<inline-formula id="IEq88"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq4_HTML.gif" /></inline-formula>, <inline-formula id="IEq89"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq5_HTML.gif" /></inline-formula>, <inline-formula id="IEq90"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq3_HTML.gif" /></inline-formula>) bins was analyzed to find the maximum possible absolute value of <inline-formula id="IEq91"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq3_HTML.gif" /></inline-formula> for a given (<inline-formula id="IEq92"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq4_HTML.gif" /></inline-formula>, <inline-formula id="IEq93"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq5_HTML.gif" /></inline-formula>) pair. It results in the <inline-formula id="IEq94"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq3_HTML.gif" /></inline-formula> difference maps as a function of binned volume pairs [see panels (a) and (b) in Figures <xref rid="Fig7" ref-type="fig">7</xref>, <xref rid="Fig8" ref-type="fig">8</xref> and <xref rid="Fig9" ref-type="fig">9</xref>].</p></list-item><list-item><p>The <inline-formula id="IEq95"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq3_HTML.gif" /></inline-formula> difference maps were modified, as described in the next section, to generate a final <italic>Q</italic><sub><italic>x</italic></sub> filter based on monopole volumes (<inline-formula id="IEq96"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq12_HTML.gif" /></inline-formula>) [see panels (c) and (d) in Figures <xref rid="Fig7" ref-type="fig">7</xref>, <xref rid="Fig8" ref-type="fig">8</xref> and <xref rid="Fig9" ref-type="fig">9</xref>].</p></list-item></list></p></list-item></list></p>
            <p>4) To obtain filters effective at an ST threshold other than ≥ 0.80, first restrict the original 4.18 billion 3-D neighbor pairs to those at or above the desired ST threshold and repeat step 3.</p>
          </sec>
          <sec id="Sec10">
            <title>3. Modification of filters</title>
            <p>Figure <xref rid="Fig11" ref-type="fig">11</xref> shows a schematic diagram describing how an original difference map is modified at a given Δ<italic>Q</italic><sup><italic>bin</italic></sup> value. In an original map [panel (a) of Figure <xref rid="Fig11" ref-type="fig">11</xref>], the (<inline-formula id="IEq97"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq1_HTML.gif" /></inline-formula>, <inline-formula id="IEq98"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq2_HTML.gif" /></inline-formula>) bins that have population are indicated in red. Note that not all bins are populated between the minimum and maximum values of <inline-formula id="IEq99"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq2_HTML.gif" /></inline-formula> for a given <inline-formula id="IEq100"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq1_HTML.gif" /></inline-formula> in the fringe area. It is likely that these bins could be occupied by 3-D neighbors in the future, simply lacking an example at this time. Therefore, these bins are included in the neighbor regions [as shown in panel (b) of Figure <xref rid="Fig11" ref-type="fig">11</xref>] at the given Δ<italic>Q</italic><sup><italic>bin</italic></sup> value. Similarly, any empty bins within the range of <inline-formula id="IEq101"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq1_HTML.gif" /></inline-formula> at a given <inline-formula id="IEq102"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq2_HTML.gif" /></inline-formula> are also set in the neighbor regions [panel (c) of Figure <xref rid="Fig11" ref-type="fig">11</xref>] for the given Δ<italic>Q</italic><sup><italic>bin</italic></sup> value.<fig id="Fig11"><label>Figure 11</label><caption xml:lang="en"><p><bold>Transformation of shape compatibility map into a filter</bold>. Schematic diagram describing modification of an original difference map at a given Δ<italic>Q</italic><sup><italic>bin</italic></sup> value: (a) in an original map, neighbor regions are indicated in red, (b) all empty bins between the minimum and maximum values of <inline-formula id="IEq103"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq2_HTML.gif" /></inline-formula> at each <inline-formula id="IEq104"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq1_HTML.gif" /></inline-formula> were set to neighbor regions (purple), and (c) all empty bins between the minimum and maximum values of <inline-formula id="IEq105"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq1_HTML.gif" /></inline-formula> at each <inline-formula id="IEq106"><inline-graphic specific-use="web" mime-subtype="GIF" xlink:href="MediaObjects/13321_2011_Article_208_IEq2_HTML.gif" /></inline-formula> (yellow) were set to neighbor regions.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2011_Article_208_Fig11_HTML.jpg" /></fig></p>
            <p>This procedure is performed for all unique Δ<italic>Q</italic><sup><italic>bin</italic></sup> values starting with the maximum. As lesser Δ<italic>Q</italic><sup><italic>bin</italic></sup> values are considered in this correction, greater Δ<italic>Q</italic><sup><italic>bin</italic></sup> values are considered at the Δ<italic>Q</italic><sup><italic>bin</italic></sup> value being considered. A pseudo-code implementation of this procedure is shown in Figure <xref rid="Fig12" ref-type="fig">12</xref>. All quadrupole filters resulting from this modification are available in Additional file <xref ref-type="supplementary-material" rid="MOESM1">1</xref>.<fig id="Fig12"><label>Figure 12</label><caption xml:lang="en"><p><bold>Pseudo code to transform shape compatibility map into a filter</bold>.</p></caption><graphic specific-use="web" mime-subtype="JPEG" xlink:href="MediaObjects/13321_2011_Article_208_Fig12_HTML.jpg" /></fig></p>
          </sec>
          <sec id="Sec11">
            <title>4. Efficiency test of filters</title>
            <p>To test the efficiency of the quadrupole filters devised, two sets of molecules were chosen. One set contains molecules in the PubChem CID range of 1 ~ 25,000,000, and the other contains those in the CID range of 25,000,001~25,001,000. Because a theoretical conformer was not generated for all CIDs or because compound records were not "live", the two datasets had 17,488,897 and 753 molecules, respectively. All-by-all comparison between the two sets gives 13,169,139,441 CID pairs. Using the first diverse conformer for each compound, the ST values for these 13.2 billion pairs were computed using ROCS [<xref ref-type="bibr" rid="CR20">20</xref>] from OpenEye software, Inc., consuming ~419 CPU days in total, and stored. These ST scores were used to estimate how many CID pairs would be filtered out when applying the quadrupole filters as a function of volume type and as a function of ST threshold, for example, as demonstrated in Table <xref rid="Tab3" ref-type="table">3</xref> and Figure <xref rid="Fig10" ref-type="fig">10</xref>.</p>
          </sec>
          <sec id="Sec12">
            <title>5. Effect of Quadrupole filters on PubChem3D Neighboring</title>
            <p>One aspect of this effort is to examine the change in real-world efficiency of PubChem3D neighboring processing when using quadrupole filters while computing the 3-D "Similar Conformers" relationship. To achieve this, the set of 4,218 biologically relevant chemical structures with known pharmacological actions from our earlier efforts [<xref ref-type="bibr" rid="CR7">7</xref>] was used. These small molecules with known biological action (<italic>Query set</italic>) were neighbored against 26,157,365 compound records (<italic>Search set</italic>), representing the entire "live" PubChem3D contents as of Oct. 2010, using up to 1, 3, 5, 7, and 10 diverse conformers per compound for both compound sets. Timing and efficiency differences with our earlier work are given in Tables <xref rid="Tab4" ref-type="table">4</xref> and <xref rid="Tab5" ref-type="table">5</xref>.</p>
          </sec>
        </sec>
      </body>
      <back>
        <ack>
          <title>Acknowledgements</title>
          <p>We are grateful to the NCBI Systems staff, especially Ron Patterson, Charlie Cook, and Don Preuss, whose efforts helped make the PubChem3D project possible. This research was supported by the Intramural Research Program of the National Library of Medicine, National Institutes of Health, U.S. Department of Health and Human Services.</p>
        </ack>
        <ref-list id="Bib1">
          <title>References</title>
          <ref-list>
            <ref id="CR1">
              <label>1.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Bolton</surname>
                    <given-names>EE</given-names>
                  </name>
                  <name>
                    <surname>Wang</surname>
                    <given-names>Y</given-names>
                  </name>
                  <name>
                    <surname>Thiessen</surname>
                    <given-names>PA</given-names>
                  </name>
                  <name>
                    <surname>Bryant</surname>
                    <given-names>SH</given-names>
                  </name>
                </person-group>
                <person-group person-group-type="editor">
                  <name>
                    <surname>Ralph</surname>
                    <given-names>AW</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">PubChem: integrated platform of small molecules and biological activities</article-title>
                <source>Annual Reports in Computational Chemistry</source>
                <year>2008</year>
                <publisher-loc>David CS</publisher-loc>
                <publisher-name>Elsevier</publisher-name>
                <fpage>217</fpage>
                <lpage>241</lpage>
                <comment>10.1016/S1574-1400(08)00012-1</comment>
              </mixed-citation>
            </ref>
            <ref id="CR2">
              <label>2.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Wang</surname>
                    <given-names>YL</given-names>
                  </name>
                  <name>
                    <surname>Xiao</surname>
                    <given-names>JW</given-names>
                  </name>
                  <name>
                    <surname>Suzek</surname>
                    <given-names>TO</given-names>
                  </name>
                  <name>
                    <surname>Zhang</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Wang</surname>
                    <given-names>JY</given-names>
                  </name>
                  <name>
                    <surname>Bryant</surname>
                    <given-names>SH</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">PubChem: a public information system for analyzing bioactivities of small molecules</article-title>
                <source>Nucleic Acids Res</source>
                <year>2009</year>
                <volume>37</volume>
                <fpage>W623</fpage>
                <lpage>W633</lpage>
                <pub-id pub-id-type="doi">10.1093/nar/gkp456</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD1MXosFSktL8%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR3">
              <label>3.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Wang</surname>
                    <given-names>YL</given-names>
                  </name>
                  <name>
                    <surname>Bolton</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Dracheva</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Karapetyan</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Shoemaker</surname>
                    <given-names>BA</given-names>
                  </name>
                  <name>
                    <surname>Suzek</surname>
                    <given-names>TO</given-names>
                  </name>
                  <name>
                    <surname>Wang</surname>
                    <given-names>JY</given-names>
                  </name>
                  <name>
                    <surname>Xiao</surname>
                    <given-names>JW</given-names>
                  </name>
                  <name>
                    <surname>Zhang</surname>
                    <given-names>J</given-names>
                  </name>
                  <name>
                    <surname>Bryant</surname>
                    <given-names>SH</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">An overview of the PubChem BioAssay resource</article-title>
                <source>Nucleic Acids Res</source>
                <year>2010</year>
                <volume>38</volume>
                <fpage>D255</fpage>
                <lpage>D266</lpage>
                <pub-id pub-id-type="doi">10.1093/nar/gkp965</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3cXktlKktA%3D%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR4">
              <label>4.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Sayers</surname>
                    <given-names>EW</given-names>
                  </name>
                  <name>
                    <surname>Barrett</surname>
                    <given-names>T</given-names>
                  </name>
                  <name>
                    <surname>Benson</surname>
                    <given-names>DA</given-names>
                  </name>
                  <name>
                    <surname>Bolton</surname>
                    <given-names>E</given-names>
                  </name>
                  <name>
                    <surname>Bryant</surname>
                    <given-names>SH</given-names>
                  </name>
                  <name>
                    <surname>Canese</surname>
                    <given-names>K</given-names>
                  </name>
                  <name>
                    <surname>Chetvernin</surname>
                    <given-names>V</given-names>
                  </name>
                  <name>
                    <surname>Church</surname>
                    <given-names>DM</given-names>
                  </name>
                  <name>
                    <surname>DiCuccio</surname>
                    <given-names>M</given-names>
                  </name>
                  <name>
                    <surname>Federhen</surname>
                    <given-names>S</given-names>
                  </name>
                  <etal />
                </person-group>
                <article-title xml:lang="en">Database resources of the National Center for Biotechnology Information</article-title>
                <source>Nucleic Acids Res</source>
                <year>2010</year>
                <volume>38</volume>
                <fpage>D5</fpage>
                <lpage>D16</lpage>
                <pub-id pub-id-type="doi">10.1093/nar/gkp967</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3cXktlOrtQ%3D%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR5">
              <label>5.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Bolton</surname>
                    <given-names>EE</given-names>
                  </name>
                  <name>
                    <surname>Kim</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Bryant</surname>
                    <given-names>SH</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">PubChem3D: conformer generation</article-title>
                <source>J Cheminformatics</source>
                <year>2011</year>
                <volume>3</volume>
                <fpage>4</fpage>
                <pub-id pub-id-type="doi">10.1186/1758-2946-3-4</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXitV2rtLo%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR6">
              <label>6.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Bolton</surname>
                    <given-names>EE</given-names>
                  </name>
                  <name>
                    <surname>Kim</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Bryant</surname>
                    <given-names>SH</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">PubChem3D: diversity of shape</article-title>
                <source>J Cheminformatics</source>
                <year>2011</year>
                <volume>3</volume>
                <fpage>9</fpage>
                <pub-id pub-id-type="doi">10.1186/1758-2946-3-9</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXksF2ju7c%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR7">
              <label>7.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Bolton</surname>
                    <given-names>EE</given-names>
                  </name>
                  <name>
                    <surname>Kim</surname>
                    <given-names>S</given-names>
                  </name>
                  <name>
                    <surname>Bryant</surname>
                    <given-names>SH</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">PubChem3D: similar conformers</article-title>
                <source>J Cheminformatics</source>
                <year>2011</year>
                <volume>3</volume>
                <fpage>13</fpage>
                <pub-id pub-id-type="doi">10.1186/1758-2946-3-13</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BC3MXmtlKltrc%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR8">
              <label>8.</label>
              <mixed-citation publication-type="other">PubChem substructure fingerprint description. [<ext-link xlink:href="ftp://ftp.ncbi.nlm.nih.gov/pubchem/specifications/pubchem_fingerprints.pdf" ext-link-type="uri">ftp://ftp.ncbi.nlm.nih.gov/pubchem/specifications/pubchem_fingerprints.pdf</ext-link>]</mixed-citation>
            </ref>
            <ref id="CR9">
              <label>9.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Grant</surname>
                    <given-names>JA</given-names>
                  </name>
                  <name>
                    <surname>Gallardo</surname>
                    <given-names>MA</given-names>
                  </name>
                  <name>
                    <surname>Pickup</surname>
                    <given-names>BT</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">A fast method of molecular shape comparison: a simple application of a Gaussian description of molecular shape</article-title>
                <source>J Comput Chem</source>
                <year>1996</year>
                <volume>17</volume>
                <fpage>1653</fpage>
                <lpage>1666</lpage>
                <pub-id pub-id-type="doi">10.1002/(SICI)1096-987X(19961115)17:14&lt;1653::AID-JCC7>3.0.CO;2-K</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK28XmsVGgsrs%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR10">
              <label>10.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Grant</surname>
                    <given-names>JA</given-names>
                  </name>
                  <name>
                    <surname>Pickup</surname>
                    <given-names>BT</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">A Gaussian description of molecular shape</article-title>
                <source>J Phys Chem</source>
                <year>1995</year>
                <volume>99</volume>
                <fpage>3503</fpage>
                <lpage>3510</lpage>
                <pub-id pub-id-type="doi">10.1021/j100011a016</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaK2MXktFensbw%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR11">
              <label>11.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Grant</surname>
                    <given-names>JA</given-names>
                  </name>
                  <name>
                    <surname>Pickup</surname>
                    <given-names>BT</given-names>
                  </name>
                </person-group>
                <person-group person-group-type="editor">
                  <name>
                    <surname>van Gunsteren</surname>
                    <given-names>WF</given-names>
                  </name>
                  <name>
                    <surname>Weiner</surname>
                    <given-names>PK</given-names>
                  </name>
                  <name>
                    <surname>Wilkinson</surname>
                    <given-names>AJ</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Gaussian shape methods</article-title>
                <source>Computer Simulation of Biomolecular Systems</source>
                <year>1997</year>
                <publisher-loc>Dordrecht</publisher-loc>
                <publisher-name>Kluwer Academic Publishers</publisher-name>
                <fpage>150</fpage>
                <lpage>176</lpage>
                <pub-id pub-id-type="doi">10.1007/978-94-017-1120-3_5</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR12">
              <label>12.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Haigh</surname>
                    <given-names>JA</given-names>
                  </name>
                  <name>
                    <surname>Pickup</surname>
                    <given-names>BT</given-names>
                  </name>
                  <name>
                    <surname>Grant</surname>
                    <given-names>JA</given-names>
                  </name>
                  <name>
                    <surname>Nicholls</surname>
                    <given-names>A</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Small molecule shape-fingerprints</article-title>
                <source>J Chem Inf Model</source>
                <year>2005</year>
                <volume>45</volume>
                <fpage>673</fpage>
                <lpage>684</lpage>
                <pub-id pub-id-type="doi">10.1021/ci049651v</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2MXjtlWktrw%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR13">
              <label>13.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Mansfield</surname>
                    <given-names>ML</given-names>
                  </name>
                  <name>
                    <surname>Covell</surname>
                    <given-names>DG</given-names>
                  </name>
                  <name>
                    <surname>Jernigan</surname>
                    <given-names>RL</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">A new class of molecular shape descriptors. 1. Theory and properties</article-title>
                <source>J Chem Inf Comput Sci</source>
                <year>2002</year>
                <volume>42</volume>
                <fpage>259</fpage>
                <lpage>273</lpage>
                <pub-id pub-id-type="doi">10.1021/ci000100o</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD38Xnt1GktA%3D%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR14">
              <label>14.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Gavezzotti</surname>
                    <given-names>A</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">The calculation of molecular volumes and the use of volume analysis in the investigation of structured media and of solid-state organic-reactivity</article-title>
                <source>J Am Chem Soc</source>
                <year>1983</year>
                <volume>105</volume>
                <fpage>5220</fpage>
                <lpage>5225</lpage>
                <pub-id pub-id-type="doi">10.1021/ja00354a007</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaL3sXks12ktLY%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR15">
              <label>15.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>La-Scalea</surname>
                    <given-names>MA</given-names>
                  </name>
                  <name>
                    <surname>Menezes</surname>
                    <given-names>CMS</given-names>
                  </name>
                  <name>
                    <surname>Ferreira</surname>
                    <given-names>EI</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Molecular volume calculation using AM1 semi-empirical method toward diffusion coefficients and electrophoretic mobility estimates in aqueous solution</article-title>
                <source>J Mol Struct Theochem</source>
                <year>2005</year>
                <volume>730</volume>
                <fpage>111</fpage>
                <lpage>120</lpage>
                <pub-id pub-id-type="doi">10.1016/j.theochem.2005.05.030</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD2MXhtVCltLfK</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR16">
              <label>16.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Edward</surname>
                    <given-names>JT</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Molecular volumes and Stokes-Einstein equation</article-title>
                <source>J Chem Educ</source>
                <year>1970</year>
                <volume>47</volume>
                <fpage>261</fpage>
                <lpage>270</lpage>
                <pub-id pub-id-type="doi">10.1021/ed047p261</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DyaE3cXktVOgtrs%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR17">
              <label>17.</label>
              <mixed-citation publication-type="journal">
                <person-group person-group-type="author">
                  <name>
                    <surname>Lepori</surname>
                    <given-names>L</given-names>
                  </name>
                  <name>
                    <surname>Gianni</surname>
                    <given-names>P</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Partial molar volumes of ionic and nonionic organic solutes in water: a simple additivity scheme based on the intrinsic volume approach</article-title>
                <source>J Solut Chem</source>
                <year>2000</year>
                <volume>29</volume>
                <fpage>405</fpage>
                <lpage>447</lpage>
                <pub-id pub-id-type="doi">10.1023/A:1005150616038</pub-id>
                <pub-id pub-id-type="other" assigning-authority="ChemPort ( Chemical Abstract Service )">1:CAS:528:DC%2BD3cXislylu7k%3D</pub-id>
              </mixed-citation>
            </ref>
            <ref id="CR18">
              <label>18.</label>
              <mixed-citation publication-type="book">
                <person-group person-group-type="author">
                  <name>
                    <surname>Spillane</surname>
                    <given-names>WJ</given-names>
                  </name>
                  <name>
                    <surname>Birch</surname>
                    <given-names>GG</given-names>
                  </name>
                  <name>
                    <surname>Drew</surname>
                    <given-names>MGB</given-names>
                  </name>
                  <name>
                    <surname>Bartolo</surname>
                    <given-names>I</given-names>
                  </name>
                </person-group>
                <article-title xml:lang="en">Correlation of computed van der waals and molecular volumes with apparent molar volumes (AMV) for amino-acid, carbohydrate and sulfamate tastant molecules. Relationship between Corey-Pauling-Koltun volumes (V<sub>cpk</sub>) and computed volumes</article-title>
                <source>J Chem Soc-Perkin Trans 2</source>
                <year>1992</year>
                <fpage>497</fpage>
                <lpage>503</lpage>
                <comment>10.1039/p29920000497</comment>
              </mixed-citation>
            </ref>
            <ref id="CR19">
              <label>19.</label>
              <mixed-citation publication-type="other">ShapeTK-C++. Version 1.8.0. 2010, OpenEye Scientific Software, Inc.: Santa Fe, NM</mixed-citation>
            </ref>
            <ref id="CR20">
              <label>20.</label>
              <mixed-citation publication-type="other">ROCS - Rapid Overlay of Chemical Structures. Version 2.2. 2006, OpenEye Scientific Software, Inc.: Santa Fe, NM</mixed-citation>
            </ref>
          </ref-list>
        </ref-list>
        <app-group>
          <app id="App1">
            <sec id="Sec13">
              <title>Electronic supplementary material</title>
              <p>
                <supplementary-material content-type="local-data" id="MOESM1" xlink:title="Electronic supplementary material">
                  <media mimetype="application" mime-subtype="x-zip-compressed" xlink:href="MediaObjects/13321_2011_208_MOESM1_ESM.ZIP" position="anchor">
                    <caption xml:lang="en">
                      <p>Additional file 1: Quadrupole filters. A zip archive of text files containing information on the maximum quadrupole differences as a function of molecular volumes. (ZIP 5 MB)</p>
                    </caption>
                  </media>
                </supplementary-material>
              </p>
            </sec>
            <sec id="Sec14">
              <title>Authors’ original submitted files for images</title>
              <p>Below are the links to the authors’ original submitted files for images.<supplementary-material content-type="local-data" id="MOESM2" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="tiff" xlink:href="MediaObjects/13321_2011_208_MOESM2_ESM.tiff" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 1</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM3" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="tiff" xlink:href="MediaObjects/13321_2011_208_MOESM3_ESM.tiff" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 2</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM4" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="tiff" xlink:href="MediaObjects/13321_2011_208_MOESM4_ESM.tiff" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 3</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM5" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="tiff" xlink:href="MediaObjects/13321_2011_208_MOESM5_ESM.tiff" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 4</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM6" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="tiff" xlink:href="MediaObjects/13321_2011_208_MOESM6_ESM.tiff" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 5</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM7" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="tiff" xlink:href="MediaObjects/13321_2011_208_MOESM7_ESM.tiff" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 6</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM8" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="tiff" xlink:href="MediaObjects/13321_2011_208_MOESM8_ESM.tiff" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 7</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM9" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="tiff" xlink:href="MediaObjects/13321_2011_208_MOESM9_ESM.tiff" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 8</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM10" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="tiff" xlink:href="MediaObjects/13321_2011_208_MOESM10_ESM.tiff" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 9</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM11" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="tiff" xlink:href="MediaObjects/13321_2011_208_MOESM11_ESM.tiff" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 10</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM12" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="tiff" xlink:href="MediaObjects/13321_2011_208_MOESM12_ESM.tiff" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 11</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="MOESM13" xlink:title="Authors’ original submitted files for images"><media mimetype="image" mime-subtype="tiff" xlink:href="MediaObjects/13321_2011_208_MOESM13_ESM.tiff" position="anchor"><caption xml:lang="en"><p>Authors’ original file for figure 12</p></caption></media></supplementary-material></p>
            </sec>
          </app>
        </app-group>
        <notes notes-type="Misc">
          <title>Competing interests</title>
          <p>The authors declare that they have no competing interests.</p>
        </notes>
        <notes notes-type="Misc">
          <title>Authors' contributions</title>
          <p>SK analyzed the quadrupole differences of the 3-D neighbors, generated the quadrupole filters, and wrote the first draft. EEB supervised the project and revised manuscript. SHB reviewed the final manuscript. All authors read and approved the final manuscript.</p>
        </notes>
      </back>
    </article>
